From aasdelat at aim.com  Mon Jun  1 12:15:58 2015
From: aasdelat at aim.com (Antonio Serrano)
Date: Mon, 1 Jun 2015 06:15:58 -0400
Subject: [R-sig-Geo] Residual maps in R
In-Reply-To: <CAJgdCD5dku6hk8MkbVqsxOmWeF8HcQQEohqKodDVir03FZ70Sw@mail.gmail.com>
References: <CAJgdCD5dku6hk8MkbVqsxOmWeF8HcQQEohqKodDVir03FZ70Sw@mail.gmail.com>
Message-ID: <14dae9ee566-32d6-a7d3@webprd-a59.mail.aol.com>

Hello, John:

   Obviously, you cannot print all residuals in the same pixel, so, you have to think on a statistics derived from the residuals that takes just one value.

   This statistic should be descriptive enough for your purpouses. 
   
   For example, if you want to "see" on the map, if the residuals are autocorrelated, you can plot using two colours: one for not autocorrelated residuals, and another for autocorrelated ones. And this could be choose using a hypothesis test with some confidence level.

   If you also want to "show" some other characteristic of the residuals, you have to look for another descriptive statistic.

  Hope this helps.


Antonio Serrano
aasdelat at aim.com
?

 

 

-----Original Message-----
From: John Wasige <johnwasige at gmail.com>
To: r-sig-geo <r-sig-geo at r-project.org>
Sent: Sun, May 31, 2015 1:35 pm
Subject: [R-sig-Geo] Residual maps in R


Hello guys, Could somebody help with an Idea on how I can generate residual
maps
from multiple
?linear ?
regression model of raster stack time series in
R.
Thanks

John

	[[alternative HTML version
deleted]]

_______________________________________________
R-sig-Geo mailing
list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Mon Jun  1 18:33:23 2015
From: englishchristophera at gmail.com (chris english)
Date: Mon, 1 Jun 2015 12:33:23 -0400
Subject: [R-sig-Geo] STIDF - endTime, STI -> Track
In-Reply-To: <5568EE9B.50502@uni-muenster.de>
References: <BAY172-W53AAAD09FA73E6FA62B9FC5CA0@phx.gbl>
	<5568EE9B.50502@uni-muenster.de>
Message-ID: <CAASFQpRhCHJEcZyt=5+ki_9rjJaCpqJ1fVC++2L_PctD1Pkopg@mail.gmail.com>

Edzer,

Thank you for your considered reply.  I did in fact do something like you
suggested and used my duration as my data.  It then occurred to me that
there were probably knock on consequences to relaxing Track to an STI, and
digging around find that gstat is looking for, or to my reading thus far,
is looking for ST*DF for variogramsST and krigingST, so ST*DF it will be.

Reading the code of Track (https://github.com/edzer/trajectories) has also
led me to reconsider my data preparation process because the @connections
contains pertinent information relating to the validity of a given trial.
The researcher's challenge was to observe the subject in real time and
reject trails that moved from a central fixation beyond 2 degrees of visual
angle.  And I now just find that this was done without the benefit of a
bounding circle to guide the 2 degree assessment.

So, what I think I might end up doing is borrow (and in my case then
mangle) your elegant connections code to track distance relative to the
central fixation point.  I assume that @connections$distance is the
distance from one sampling point/time and the subsequent.  And then check
whether accepted trials were actually valid as well.
And that will then be my data for the STIDF.

Thank you again,

Chris

On Fri, May 29, 2015 at 6:56 PM, Edzer Pebesma <
edzer.pebesma at uni-muenster.de> wrote:

>
>
> On 05/28/2015 12:28 PM, Chris English wrote:
> > Hi,
> >
> > I am wondering about the role of endTime in STIDF objects.  I am
> examining eye tracking data (previously cleaned of blinks) in relation to
> > presented stimuli that is for some subjects an optical illusion and for
> others not.  I want to examine where they were looking and when.
> >
> > My process is to make a STIDF from the eye tracking data case and a
> STSDF of the stimuli that was presented where and for how long,
> > convert the STIDF to a Track then do some 'over' analysis.
> >
> > If I build my endTime for the STIDF using the delta() function on N
> samples, I think I get something like N-1 endTimes, or every sample
> > is an endTime so N = N.
> >
> > If instead I am thinking of endTime(s) as an interval during which there
> is a cross hair and some tangential stimulus on the screen and
> > endTime is when a subject responds in some manner I can't build an STDIF
> due to the following test:
> >
> >> eye_5v1_stidf <- STIDF(eye_5v1_sp, eye_5v1_time, eye_5v1_data,
> > + eye_5v1_endTime)
> > Error: nrow(object at time) == length(object at endTime) is not TRUE
> >> nrow(eye_5v1_time)
> > [1] 4724
> >> length(eye_5v1_endTime)
> > [1] 63
> >>
>
> endTime is meant to give the end time of the time interval an
> observation refers to, and so the number of endTime s has to be
> identical to the number of time instances (number of observations). I
> guess you figure that out.
>
> >
> > Indeed, it is not true. But what information do I have in endTime other
> than my sensor sampling rate adjusted for blinks?  What I hoped to
> > achieve was to compare the spacetime aspects of the Track data through
> time periods consistent with the time periods in the STSDF.
> > Perhaps 'over' takes care of this for me and I don't have to attend if I
> just accept that endTime in the case of the STIDF is the end of each
> > sample.
> >
> > The eye tracking data I am examining is fairly simple: x, y, cumulative
> sum of samples in ms, duration between samples; from which
> > an STI can be constructed.  Not much more data than where the eyes were
> when.  It would seem that there would be a lot of simple sensor
> > data of this sort so I wonder if Track can relax its requirement of
> STIDF to allow STI.
>
> Good point - I wonder that too. For now, you could feed it a data.frame
> with zero columns, e.g. data.frame(matrix(nrow=n, ncol=0))
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Mon Jun  1 21:46:00 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 1 Jun 2015 12:46:00 -0700
Subject: [R-sig-Geo] Setting raster x- and y-resolutions equal
In-Reply-To: <174524AB15B8E6478D6F927B2131B09B8E20373A@SOAJNUEXMB3.soa.alaska.gov>
References: <174524AB15B8E6478D6F927B2131B09B8E20373A@SOAJNUEXMB3.soa.alaska.gov>
Message-ID: <CANtt_hzSVOpHZ7EF4RM9qkQLaf0rNwUfLMHV+U6AzfY7x_XvRQ@mail.gmail.com>

The problem is with  dynatopmodel::upslope.area  that uses
   xres(x)==yres(x)
where
   all.equal(xres(rast), yres(rast))
would be appropriate. One should not compare decimal numbers for
equality using '=='.

rast <- raster(nrows=4072, ncols=3111, xmn=656419.81022503704298,
xmx=730403.88166906696279,

ymn=794177.97668560303282,ymx=891016.01555416302290)
> xres(rast) == yres(rast)
[1] FALSE
> all.equal(xres(rast), yres(rast))
[1] TRUE

Robert

On Thu, May 28, 2015 at 5:37 PM, Gregovich, Dave P (DFG)
<dave.gregovich at alaska.gov> wrote:
> Hello,
> I have a stack of about 40 rasters with about 1 X 10^7 cells in each. I did not realize it, but it turns out the x-resolution and y-resolution differ at about the 13th decimal point. And I would like to feed this stack into a function (dynatopmodel::upslope.area) that requires xres(x)==yres(x).
> Because of the minute difference between the x- and y- resolutions, I am fine just setting the x- and y- resolutions equal to each other. That would save me the time of resampling all of the bands of the stack. However, this does not seem to be working for me when I try to reproduce the problem, as shown below using a single band that mimics a single band from the stack I am working with:
>
> library(raster);library(rgdal)
> options(digits=20)
>
> #Example 1, my situation, which is not working....
> rast <- raster(nrows=4072, ncols=3111, xmn=656419.81022503704298, xmx=730403.88166906696279,
>                                                                 ymn=794177.97668560303282,ymx=891016.01555416302290)
> rast[] <- rnorm(1:ncell(rast))
> proj4string(rast) <- '+init=epsg:26931'
> xres(rast);yres(rast)
> res(rast)<-c(xres(rast),xres(rast))
> #xres and yres differ!!!!....
> res(rast)
>
> #and then two examples that work, Example 2, with a raster of the same size but resetting the resolution to res(rast) <- c(5,5)....
> rast <- raster(nrows=4072, ncols=3111, xmn=656419.81022503704298, xmx=730403.88166906696279,
>                                                                 ymn=794177.97668560303282,ymx=891016.01555416302290)
> rast[] <- rnorm(1:ncell(rast))
> proj4string(rast) <- '+init=epsg:26931'
> xres(rast);yres(rast)
> res(rast)<-c(5,5)
> #new resolution as expected....
> res(rast)
>
> #and example 3, with a raster 100X smaller...
> rast <- raster(nrows=407, ncols=311, xmn=65641.981022503704298, xmx=73040.388166906696279,
>                                                                 ymn=79417.797668560303282,ymx=89101.601555416302290)
> rast[] <- rnorm(1:ncell(rast))
> proj4string(rast) <- '+init=epsg:26931'
> xres(rast);yres(rast)
> res(rast)<-c(xres(rast),xres(rast))
> res(rast)
>
> #salient session info
>
> R version 3.1.3 (2015-03-09)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
> raster_2.3-33      sp_1.0-17  rgdal_0.9-2
>
> Thanks kindly for any help you can provide, r-sig-geo!
> __________________________________
> Dave Gregovich
> Research Analyst
> Alaska Department of Fish and Game
> Wildlife Conservation Division
> Douglas, AK 99821
> (907) 465-4291
> dave.gregovich at alaska.gov
> __________________________________
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From plowright.andrew at gmail.com  Tue Jun  2 02:57:28 2015
From: plowright.andrew at gmail.com (Andrew Plowright)
Date: Mon, 1 Jun 2015 17:57:28 -0700
Subject: [R-sig-Geo] Differences in area between R sp and ArcGIS
Message-ID: <CAOHs3k0m4E2vXFGtu+wBaVt+KM0S048LANS58H6NUpzNqfU9ZA@mail.gmail.com>

Hello,

As my first email to this list, I just wanted to start out by thanking
everyone who has been involved in developing this excellent package, and to
everyone who has answered questions on this mailing list. I have been
consulting this list's archives for years, and the answers that have been
given have been a huge help.

My question is as follows:

I was just wondering if there was a known difference in between the way the
R sp's package computes area and the way ArcGIS does. Below is a link to a
subset of a dataset I am working on. Its attribute table contains two
columns: "Area_Arc" and "Area_R".

https://drive.google.com/folderview?id=0Bw1lKQwaoU84fmRwald5d0JqM1BEemFQX2FmVEFtdHk2RlltTzZFLU1EQ01CcURZcDdteUU&usp=sharing

"Area_R" was computed using the following lines in R:

> polySample <- readOGR("C:\\Users\\Andy\\Documents", "polySample")
> polySample[["Area_R"]] <- sapply(polyfile at polygons, function(x){x at area})

"Area_Arc" was computed using ArcMap's Calculate Geometry tool, using the
coordinate system associated with the file.

I tried reprojecting this file and repeating the process, but each time,
there is a discrepancy between the areas. Specifically, the area calculated
by ArcMap is always in the same ballpark but smaller.

> proj4string(polySample)
[1] "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000
+y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"
> sum(polySample[["Area_R"]])
[1] 15332220331
> sum(polySample[["Area_Arc"]])
[1] 12330204266

My understanding is that both of these methods use the same underlying
mathematics to compute area based on the projection system assigned to the
file, so I can't figure out why they would produce different results. I
apologize if this question has been addressed before, but I was unable to
come up with any answers from the R sp help file or on the mailing list's
archives.

Thank you very much
Andrew

	[[alternative HTML version deleted]]


From tephilippi at gmail.com  Tue Jun  2 04:55:41 2015
From: tephilippi at gmail.com (Tom Philippi)
Date: Mon, 1 Jun 2015 19:55:41 -0700
Subject: [R-sig-Geo] Differences in area between R sp and ArcGIS
In-Reply-To: <CAOHs3k0m4E2vXFGtu+wBaVt+KM0S048LANS58H6NUpzNqfU9ZA@mail.gmail.com>
References: <CAOHs3k0m4E2vXFGtu+wBaVt+KM0S048LANS58H6NUpzNqfU9ZA@mail.gmail.com>
Message-ID: <CALyPt8wh08gmb9prsbzOJrncZNXHwkH=Q+O7k5uDi7=H=aF7sA@mail.gmail.com>

Andrew--
I suspect that some of your polygons have holes in them.
The area slot of the Polygons class doesn't subtract off the area of
holes.  If you want the net area, I recommend using rgeos::gArea()

library(rgdal)
library(rgeos)
raw <- readOGR('k:/','polySample',stringsAsFactors=FALSE)
str(raw at data)
raw$Area_G <- gArea(raw,byid=TRUE)
raw at data[,17:19]

I hope that this helps.

Tom 2

On Mon, Jun 1, 2015 at 5:57 PM, Andrew Plowright <plowright.andrew at gmail.com
> wrote:

> Hello,
>
> As my first email to this list, I just wanted to start out by thanking
> everyone who has been involved in developing this excellent package, and to
> everyone who has answered questions on this mailing list. I have been
> consulting this list's archives for years, and the answers that have been
> given have been a huge help.
>
> My question is as follows:
>
> I was just wondering if there was a known difference in between the way the
> R sp's package computes area and the way ArcGIS does. Below is a link to a
> subset of a dataset I am working on. Its attribute table contains two
> columns: "Area_Arc" and "Area_R".
>
>
> https://drive.google.com/folderview?id=0Bw1lKQwaoU84fmRwald5d0JqM1BEemFQX2FmVEFtdHk2RlltTzZFLU1EQ01CcURZcDdteUU&usp=sharing
>
> "Area_R" was computed using the following lines in R:
>
> > polySample <- readOGR("C:\\Users\\Andy\\Documents", "polySample")
> > polySample[["Area_R"]] <- sapply(polyfile at polygons, function(x){x at area})
>
> "Area_Arc" was computed using ArcMap's Calculate Geometry tool, using the
> coordinate system associated with the file.
>
> I tried reprojecting this file and repeating the process, but each time,
> there is a discrepancy between the areas. Specifically, the area calculated
> by ArcMap is always in the same ballpark but smaller.
>
> > proj4string(polySample)
> [1] "+proj=aea +lat_1=50 +lat_2=58.5 +lat_0=45 +lon_0=-126 +x_0=1000000
> +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"
> > sum(polySample[["Area_R"]])
> [1] 15332220331
> > sum(polySample[["Area_Arc"]])
> [1] 12330204266
>
> My understanding is that both of these methods use the same underlying
> mathematics to compute area based on the projection system assigned to the
> file, so I can't figure out why they would produce different results. I
> apologize if this question has been addressed before, but I was unable to
> come up with any answers from the R sp help file or on the mailing list's
> archives.
>
> Thank you very much
> Andrew
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Tue Jun  2 08:45:46 2015
From: englishchristophera at gmail.com (chris english)
Date: Tue, 2 Jun 2015 02:45:46 -0400
Subject: [R-sig-Geo] STIDF - endTime, STI -> Track
In-Reply-To: <CAASFQpRhCHJEcZyt=5+ki_9rjJaCpqJ1fVC++2L_PctD1Pkopg@mail.gmail.com>
References: <BAY172-W53AAAD09FA73E6FA62B9FC5CA0@phx.gbl>
	<5568EE9B.50502@uni-muenster.de>
	<CAASFQpRhCHJEcZyt=5+ki_9rjJaCpqJ1fVC++2L_PctD1Pkopg@mail.gmail.com>
Message-ID: <CAASFQpTqiWQ0=hShRK0erbZ5gHBPKrGeO4BSHP+SFBOx8v=oZQ@mail.gmail.com>

What I actually ended up doing was using spDistsN1 as commented in your
code for use with sp-1.1-1 for the
distances, and copied wholesale your directions_ll function and padded it
with a trailing 0.0 as directions_ll
returns N-1.

In looking at head(trackObj at connections) I note an absence of row.names()
in @connections that one might find useful for tests between @connections
and the STIDF data using match. Could I suggest this as an enhancement to
Track?

Cheers,

Chris

On Mon, Jun 1, 2015 at 12:33 PM, chris english <
englishchristophera at gmail.com> wrote:

> Edzer,
>
> Thank you for your considered reply.  I did in fact do something like you
> suggested and used my duration as my data.  It then occurred to me that
> there were probably knock on consequences to relaxing Track to an STI, and
> digging around find that gstat is looking for, or to my reading thus far,
> is looking for ST*DF for variogramsST and krigingST, so ST*DF it will be.
>
> Reading the code of Track (https://github.com/edzer/trajectories) has
> also led me to reconsider my data preparation process because the
> @connections contains pertinent information relating to the validity of a
> given trial.  The researcher's challenge was to observe the subject in real
> time and reject trails that moved from a central fixation beyond 2 degrees
> of visual angle.  And I now just find that this was done without the
> benefit of a bounding circle to guide the 2 degree assessment.
>
> So, what I think I might end up doing is borrow (and in my case then
> mangle) your elegant connections code to track distance relative to the
> central fixation point.  I assume that @connections$distance is the
> distance from one sampling point/time and the subsequent.  And then check
> whether accepted trials were actually valid as well.
> And that will then be my data for the STIDF.
>
> Thank you again,
>
> Chris
>
> On Fri, May 29, 2015 at 6:56 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
>
>>
>>
>> On 05/28/2015 12:28 PM, Chris English wrote:
>> > Hi,
>> >
>> > I am wondering about the role of endTime in STIDF objects.  I am
>> examining eye tracking data (previously cleaned of blinks) in relation to
>> > presented stimuli that is for some subjects an optical illusion and for
>> others not.  I want to examine where they were looking and when.
>> >
>> > My process is to make a STIDF from the eye tracking data case and a
>> STSDF of the stimuli that was presented where and for how long,
>> > convert the STIDF to a Track then do some 'over' analysis.
>> >
>> > If I build my endTime for the STIDF using the delta() function on N
>> samples, I think I get something like N-1 endTimes, or every sample
>> > is an endTime so N = N.
>> >
>> > If instead I am thinking of endTime(s) as an interval during which
>> there is a cross hair and some tangential stimulus on the screen and
>> > endTime is when a subject responds in some manner I can't build an
>> STDIF due to the following test:
>> >
>> >> eye_5v1_stidf <- STIDF(eye_5v1_sp, eye_5v1_time, eye_5v1_data,
>> > + eye_5v1_endTime)
>> > Error: nrow(object at time) == length(object at endTime) is not TRUE
>> >> nrow(eye_5v1_time)
>> > [1] 4724
>> >> length(eye_5v1_endTime)
>> > [1] 63
>> >>
>>
>> endTime is meant to give the end time of the time interval an
>> observation refers to, and so the number of endTime s has to be
>> identical to the number of time instances (number of observations). I
>> guess you figure that out.
>>
>> >
>> > Indeed, it is not true. But what information do I have in endTime other
>> than my sensor sampling rate adjusted for blinks?  What I hoped to
>> > achieve was to compare the spacetime aspects of the Track data through
>> time periods consistent with the time periods in the STSDF.
>> > Perhaps 'over' takes care of this for me and I don't have to attend if
>> I just accept that endTime in the case of the STIDF is the end of each
>> > sample.
>> >
>> > The eye tracking data I am examining is fairly simple: x, y, cumulative
>> sum of samples in ms, duration between samples; from which
>> > an STI can be constructed.  Not much more data than where the eyes were
>> when.  It would seem that there would be a lot of simple sensor
>> > data of this sort so I wonder if Track can relax its requirement of
>> STIDF to allow STI.
>>
>> Good point - I wonder that too. For now, you could feed it a data.frame
>> with zero columns, e.g. data.frame(matrix(nrow=n, ncol=0))
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi),  University of M?nster,
>> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
>> Journal of Statistical Software:   http://www.jstatsoft.org/
>> Computers & Geosciences:   http://elsevier.com/locate/cageo/
>> Spatial Statistics Society http://www.spatialstatistics.info
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Tue Jun  2 09:02:51 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 02 Jun 2015 09:02:51 +0200
Subject: [R-sig-Geo] STIDF - endTime, STI -> Track
In-Reply-To: <CAASFQpTqiWQ0=hShRK0erbZ5gHBPKrGeO4BSHP+SFBOx8v=oZQ@mail.gmail.com>
References: <BAY172-W53AAAD09FA73E6FA62B9FC5CA0@phx.gbl>	<5568EE9B.50502@uni-muenster.de>	<CAASFQpRhCHJEcZyt=5+ki_9rjJaCpqJ1fVC++2L_PctD1Pkopg@mail.gmail.com>
	<CAASFQpTqiWQ0=hShRK0erbZ5gHBPKrGeO4BSHP+SFBOx8v=oZQ@mail.gmail.com>
Message-ID: <556D551B.2050100@uni-muenster.de>



On 06/02/2015 08:45 AM, chris english wrote:
> What I actually ended up doing was using spDistsN1 as commented in your
> code for use with sp-1.1-1 for the
> distances, and copied wholesale your directions_ll function and padded
> it with a trailing 0.0 as directions_ll
> returns N-1.
> 
> In looking at head(trackObj at connections) I note an absence of
> row.names() in @connections that one might find useful for tests between
> @connections and the STIDF data using match. Could I suggest this as an
> enhancement to Track?

Sure, but so far I've seen no cases where the points from which these
connections are computed have meaningful row.names. And the match is
essentially by row order, meaning you don't need base::match to match,
right?

> 
> Cheers,
> 
> Chris
> 
> On Mon, Jun 1, 2015 at 12:33 PM, chris english
> <englishchristophera at gmail.com <mailto:englishchristophera at gmail.com>>
> wrote:
> 
>     Edzer,
> 
>     Thank you for your considered reply.  I did in fact do something
>     like you suggested and used my duration as my data.  It then
>     occurred to me that there were probably knock on consequences to
>     relaxing Track to an STI, and
>     digging around find that gstat is looking for, or to my reading thus
>     far, is looking for ST*DF for variogramsST and krigingST, so ST*DF
>     it will be.
> 
>     Reading the code of Track (https://github.com/edzer/trajectories)
>     has also led me to reconsider my data preparation process because
>     the @connections contains pertinent information relating to the
>     validity of a given trial.  The researcher's challenge was to
>     observe the subject in real time and reject trails that moved from a
>     central fixation beyond 2 degrees of visual angle.  And I now just
>     find that this was done without the benefit of a bounding circle to
>     guide the 2 degree assessment.
> 
>     So, what I think I might end up doing is borrow (and in my case then
>     mangle) your elegant connections code to track distance relative to
>     the central fixation point.  I assume that @connections$distance is
>     the distance from one sampling point/time and the subsequent.  And
>     then check whether accepted trials were actually valid as well.
>     And that will then be my data for the STIDF.
> 
>     Thank you again,
> 
>     Chris
> 
>     On Fri, May 29, 2015 at 6:56 PM, Edzer Pebesma
>     <edzer.pebesma at uni-muenster.de
>     <mailto:edzer.pebesma at uni-muenster.de>> wrote:
> 
> 
> 
>         On 05/28/2015 12:28 PM, Chris English wrote:
>         > Hi,
>         >
>         > I am wondering about the role of endTime in STIDF objects.  I
>         am examining eye tracking data (previously cleaned of blinks) in
>         relation to
>         > presented stimuli that is for some subjects an optical
>         illusion and for others not.  I want to examine where they were
>         looking and when.
>         >
>         > My process is to make a STIDF from the eye tracking data case
>         and a STSDF of the stimuli that was presented where and for how
>         long,
>         > convert the STIDF to a Track then do some 'over' analysis.
>         >
>         > If I build my endTime for the STIDF using the delta() function
>         on N samples, I think I get something like N-1 endTimes, or
>         every sample
>         > is an endTime so N = N.
>         >
>         > If instead I am thinking of endTime(s) as an interval during
>         which there is a cross hair and some tangential stimulus on the
>         screen and
>         > endTime is when a subject responds in some manner I can't
>         build an STDIF due to the following test:
>         >
>         >> eye_5v1_stidf <- STIDF(eye_5v1_sp, eye_5v1_time, eye_5v1_data,
>         > + eye_5v1_endTime)
>         > Error: nrow(object at time) == length(object at endTime) is not TRUE
>         >> nrow(eye_5v1_time)
>         > [1] 4724
>         >> length(eye_5v1_endTime)
>         > [1] 63
>         >>
> 
>         endTime is meant to give the end time of the time interval an
>         observation refers to, and so the number of endTime s has to be
>         identical to the number of time instances (number of
>         observations). I
>         guess you figure that out.
> 
>         >
>         > Indeed, it is not true. But what information do I have in
>         endTime other than my sensor sampling rate adjusted for blinks? 
>         What I hoped to
>         > achieve was to compare the spacetime aspects of the Track data
>         through time periods consistent with the time periods in the STSDF.
>         > Perhaps 'over' takes care of this for me and I don't have to
>         attend if I just accept that endTime in the case of the STIDF is
>         the end of each
>         > sample.
>         >
>         > The eye tracking data I am examining is fairly simple: x, y,
>         cumulative sum of samples in ms, duration between samples; from
>         which
>         > an STI can be constructed.  Not much more data than where the
>         eyes were when.  It would seem that there would be a lot of
>         simple sensor
>         > data of this sort so I wonder if Track can relax its
>         requirement of STIDF to allow STI.
> 
>         Good point - I wonder that too. For now, you could feed it a
>         data.frame
>         with zero columns, e.g. data.frame(matrix(nrow=n, ncol=0))
> 
>         --
>         Edzer Pebesma
>         Institute for Geoinformatics (ifgi),  University of M?nster,
>         Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
>         <tel:%2B49%20251%2083%2033081>
>         Journal of Statistical Software:   http://www.jstatsoft.org/
>         Computers & Geosciences:   http://elsevier.com/locate/cageo/
>         Spatial Statistics Society http://www.spatialstatistics.info
> 
> 
>         _______________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150602/8039c9de/attachment.bin>

From englishchristophera at gmail.com  Tue Jun  2 09:43:56 2015
From: englishchristophera at gmail.com (chris english)
Date: Tue, 2 Jun 2015 03:43:56 -0400
Subject: [R-sig-Geo] STIDF - endTime, STI -> Track
In-Reply-To: <556D551B.2050100@uni-muenster.de>
References: <BAY172-W53AAAD09FA73E6FA62B9FC5CA0@phx.gbl>
	<5568EE9B.50502@uni-muenster.de>
	<CAASFQpRhCHJEcZyt=5+ki_9rjJaCpqJ1fVC++2L_PctD1Pkopg@mail.gmail.com>
	<CAASFQpTqiWQ0=hShRK0erbZ5gHBPKrGeO4BSHP+SFBOx8v=oZQ@mail.gmail.com>
	<556D551B.2050100@uni-muenster.de>
Message-ID: <CAASFQpQxRZrAdTL5Uos3kQ6D=ChmoyrqA9sTg+m4tcQjowYdMQ@mail.gmail.com>

>> In looking at head(trackObj at connections) I note an absence of
>> row.names() in @connections that one might find useful for tests between
>> @connections and the STIDF data using match. Could I suggest this as an
>> enhancement to Track?

>Sure, but so far I've seen no cases where the points from which these
>connections are computed have meaningful row.names. And the match is
>essentially by row order, meaning you don't need base::match to match,
>right?

History being a good guide, if you say I don't need match I know its
right.  I came to R from
SQL and view (viewed) base::match as something analogous to a where
clause in select, a comfort to myself in my query that I was asking for
what I
thought I was asking for, by name. I'll try and wrap my thinking around row
order relative to my needs and possible tests.  I think I was considering
ID's because
as I understand ST objects they are immutable once created so slap in
everything
you might need before you build it...

I'll concentrate on row order.

Thanks again,

Chris

On Tue, Jun 2, 2015 at 3:02 AM, Edzer Pebesma <edzer.pebesma at uni-muenster.de
> wrote:

>
>
> On 06/02/2015 08:45 AM, chris english wrote:
> > What I actually ended up doing was using spDistsN1 as commented in your
> > code for use with sp-1.1-1 for the
> > distances, and copied wholesale your directions_ll function and padded
> > it with a trailing 0.0 as directions_ll
> > returns N-1.
> >
> > In looking at head(trackObj at connections) I note an absence of
> > row.names() in @connections that one might find useful for tests between
> > @connections and the STIDF data using match. Could I suggest this as an
> > enhancement to Track?
>
> Sure, but so far I've seen no cases where the points from which these
> connections are computed have meaningful row.names. And the match is
> essentially by row order, meaning you don't need base::match to match,
> right?
>
> >
> > Cheers,
> >
> > Chris
> >
> > On Mon, Jun 1, 2015 at 12:33 PM, chris english
> > <englishchristophera at gmail.com <mailto:englishchristophera at gmail.com>>
> > wrote:
> >
> >     Edzer,
> >
> >     Thank you for your considered reply.  I did in fact do something
> >     like you suggested and used my duration as my data.  It then
> >     occurred to me that there were probably knock on consequences to
> >     relaxing Track to an STI, and
> >     digging around find that gstat is looking for, or to my reading thus
> >     far, is looking for ST*DF for variogramsST and krigingST, so ST*DF
> >     it will be.
> >
> >     Reading the code of Track (https://github.com/edzer/trajectories)
> >     has also led me to reconsider my data preparation process because
> >     the @connections contains pertinent information relating to the
> >     validity of a given trial.  The researcher's challenge was to
> >     observe the subject in real time and reject trails that moved from a
> >     central fixation beyond 2 degrees of visual angle.  And I now just
> >     find that this was done without the benefit of a bounding circle to
> >     guide the 2 degree assessment.
> >
> >     So, what I think I might end up doing is borrow (and in my case then
> >     mangle) your elegant connections code to track distance relative to
> >     the central fixation point.  I assume that @connections$distance is
> >     the distance from one sampling point/time and the subsequent.  And
> >     then check whether accepted trials were actually valid as well.
> >     And that will then be my data for the STIDF.
> >
> >     Thank you again,
> >
> >     Chris
> >
> >     On Fri, May 29, 2015 at 6:56 PM, Edzer Pebesma
> >     <edzer.pebesma at uni-muenster.de
> >     <mailto:edzer.pebesma at uni-muenster.de>> wrote:
> >
> >
> >
> >         On 05/28/2015 12:28 PM, Chris English wrote:
> >         > Hi,
> >         >
> >         > I am wondering about the role of endTime in STIDF objects.  I
> >         am examining eye tracking data (previously cleaned of blinks) in
> >         relation to
> >         > presented stimuli that is for some subjects an optical
> >         illusion and for others not.  I want to examine where they were
> >         looking and when.
> >         >
> >         > My process is to make a STIDF from the eye tracking data case
> >         and a STSDF of the stimuli that was presented where and for how
> >         long,
> >         > convert the STIDF to a Track then do some 'over' analysis.
> >         >
> >         > If I build my endTime for the STIDF using the delta() function
> >         on N samples, I think I get something like N-1 endTimes, or
> >         every sample
> >         > is an endTime so N = N.
> >         >
> >         > If instead I am thinking of endTime(s) as an interval during
> >         which there is a cross hair and some tangential stimulus on the
> >         screen and
> >         > endTime is when a subject responds in some manner I can't
> >         build an STDIF due to the following test:
> >         >
> >         >> eye_5v1_stidf <- STIDF(eye_5v1_sp, eye_5v1_time, eye_5v1_data,
> >         > + eye_5v1_endTime)
> >         > Error: nrow(object at time) == length(object at endTime) is not TRUE
> >         >> nrow(eye_5v1_time)
> >         > [1] 4724
> >         >> length(eye_5v1_endTime)
> >         > [1] 63
> >         >>
> >
> >         endTime is meant to give the end time of the time interval an
> >         observation refers to, and so the number of endTime s has to be
> >         identical to the number of time instances (number of
> >         observations). I
> >         guess you figure that out.
> >
> >         >
> >         > Indeed, it is not true. But what information do I have in
> >         endTime other than my sensor sampling rate adjusted for blinks?
> >         What I hoped to
> >         > achieve was to compare the spacetime aspects of the Track data
> >         through time periods consistent with the time periods in the
> STSDF.
> >         > Perhaps 'over' takes care of this for me and I don't have to
> >         attend if I just accept that endTime in the case of the STIDF is
> >         the end of each
> >         > sample.
> >         >
> >         > The eye tracking data I am examining is fairly simple: x, y,
> >         cumulative sum of samples in ms, duration between samples; from
> >         which
> >         > an STI can be constructed.  Not much more data than where the
> >         eyes were when.  It would seem that there would be a lot of
> >         simple sensor
> >         > data of this sort so I wonder if Track can relax its
> >         requirement of STIDF to allow STI.
> >
> >         Good point - I wonder that too. For now, you could feed it a
> >         data.frame
> >         with zero columns, e.g. data.frame(matrix(nrow=n, ncol=0))
> >
> >         --
> >         Edzer Pebesma
> >         Institute for Geoinformatics (ifgi),  University of M?nster,
> >         Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> >         <tel:%2B49%20251%2083%2033081>
> >         Journal of Statistical Software:   http://www.jstatsoft.org/
> >         Computers & Geosciences:   http://elsevier.com/locate/cageo/
> >         Spatial Statistics Society http://www.spatialstatistics.info
> >
> >
> >         _______________________________________________
> >         R-sig-Geo mailing list
> >         R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>

	[[alternative HTML version deleted]]


From sadaouimahrez at outlook.com  Tue Jun  2 12:10:44 2015
From: sadaouimahrez at outlook.com (sadaoui)
Date: Tue, 2 Jun 2015 03:10:44 -0700 (MST)
Subject: [R-sig-Geo] How to multiply my raster by factors depending on each
	polygon
Message-ID: <1433239844522-7588395.post@n2.nabble.com>

Hello,

I want to correct my raster with correction factors for each polygon.
each polygon I have to correct it with its own correction factor.

Is it possible to make the manipulation at once:  import my raster and my
polygons, then I will multiply my raster with a factor of each polygon.

or I must to cut my raster according to all polygons and then I multiply
each raster by its factor,  one by one (it is too long)

Best regards



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-multiply-my-raster-by-factors-depending-on-each-polygon-tp7588395.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mauricioromerolondono at gmail.com  Tue Jun  2 17:28:49 2015
From: mauricioromerolondono at gmail.com (Mauricio Romero)
Date: Tue, 2 Jun 2015 08:28:49 -0700
Subject: [R-sig-Geo] Bug in raster projectRaster?
Message-ID: <CAPjE+LSVeTO0V+AUX=tz0-vWN__A29_qPqeYdzcN32_u-Y8Adw@mail.gmail.com>

Hi,

I'm sorry I cant post a reproducible example, but the data sets involve are
too large. I'm currently trying to create a mosaic from 2 different Landsat
7 scenes. One of them is in UTM 18 and the other in UTM 17. Before using
the mosaic command, I'm doing

LandsatTransform=projectRaster(from=LandsatUTM17, to=LandsatUTM18)

but i get a raster that is full of NAs and the following warning message

Warning message:
In .rasterFromRasterFile(grdfile, band = band, objecttype, ...) :
  size of values file does not match the number of cells (given the data
type)

Not sure what to do. Any help is really appreciated.

Thanks,

Mauricio

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Tue Jun  2 17:33:30 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 02 Jun 2015 15:33:30 +0000
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes
In-Reply-To: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
References: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
Message-ID: <CAAcGz99LfkGXSCBG283eCyB_Tr2Bnnpzi=2xAireEJGt603OaQ@mail.gmail.com>

Magic! This is really good news, thanks so much.

But, I get this:

sudo R CMD INSTALL rgdal_0.6-28.tar.gz
* installing to library ?/usr/local/lib/R/site-library?
* installing *source* package ?rgdal? ...
gdal-config: gdal-config
GDAL version 2.0.0 found ...
For building this version, at least GDAL version 1.3.1 is required.
ERROR: configuration failed for package ?rgdal?
* removing ?/usr/local/lib/R/site-library/rgdal?

gdal-config --prefix
/usr/local
gdal-config --libs
-L/usr/local/lib -lgdal
gdal-config --dep-libs
-L/usr/lib -lnetcdf -lmfhdf -ldf -ljpeg -lz -lpthread -lm -lrt -ldl
gdal-config --cflags
-I/usr/local/include
gdal-config --datadir
/usr/local/share/gdal
gdal-config --version
2.0.0
gdal-config --ogr-enabled
yes

Build notes below


Cheers, Mike.

git clone https://github.com/OSGeo/gdal.git

cd gdal
./configure
make
make install
export LD_LIBRARY_PATH=/usr/local/lib

cd ~
svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
svn export trunk rgdal
R CMD build rgdal
R CMD INSTALL rgdal_0.6-28.tar.gz

Rscript -e "library(sp); print(sessionInfo())"

R version 3.2.0 (2015-04-16)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.2 LTS

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  base

other attached packages:
[1] sp_1.1-0

loaded via a namespace (and not attached):
[1] grid_3.2.0      methods_3.2.0   lattice_0.20-31



On Mon, 1 Jun 2015 at 04:00 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> The second beta of GDAL 2 is now available, and as of revision 535 on
> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>
> One or two issues are known (Integer64 in vector fields and FIDs not
> supported in R; gdalDrivers() reports both raster and vector drivers; the
> MapInfo File TAB driver doesn't work for writing, ...), but others remain
> to be discovered.
>
> For those who need rgdal in production, and can install the 2.0.0 beta, it
> would be a really good use of time to identify issues now, rather than
> when GDAL 2 starts to become the standard, stable release. Anyone else
> needing an itch to scratch is also, of course, welcome to contribute.
>
> The rgdal package will continue to condition on GDAL 1 or 2, so hopefully
> those users who do not need to move to GDAL 2 will not be affected.
> However, it is worth noting that GDAL is maintained by very, very, few
> volunteers (even plural is questionable here), and when they feel that
> backporting fixed from GDAL 2 to GDAL 1 is taking time from more important
> things, you will be stranded with EOL software.
>
> So please consider taking the time to contribute to the idenfication of
> issues in the development version of rgdal built against GDAL 2 and/or 1,
> available for anonymous SVN checkout at:
>
> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>
> Enjoy!
>
> Roger
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Tue Jun  2 17:35:32 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 02 Jun 2015 15:35:32 +0000
Subject: [R-sig-Geo] Bug in raster projectRaster?
In-Reply-To: <CAPjE+LSVeTO0V+AUX=tz0-vWN__A29_qPqeYdzcN32_u-Y8Adw@mail.gmail.com>
References: <CAPjE+LSVeTO0V+AUX=tz0-vWN__A29_qPqeYdzcN32_u-Y8Adw@mail.gmail.com>
Message-ID: <CAAcGz9-LHF-R8OqBgf-Hmy8+mjcUF1Ys0nGV8brEbHxZ32ffBw@mail.gmail.com>

Check first if there's any intersection between their extents:

library(rgdal);library(raster)
## ... whatever you did to create these objects . . .
## what follows is untested
ext18 <- extent(LandsatUTM18)
ext17_in_18 <- projectExtent(LandsatUTM17, crs = projection(LandsatUTM18))

plot(union(ext18, ext17_in_18))
plot(ext18, add = TRUE)
plot(ext17_in_18, add = TRUE)

You might need to reproject to the union of their extents?
But this is bad, generally if you need to align data from two incompatible
projections there's probably a better path. Are you forced to use UTM? Why?

Cheers, Mike

On Wed, 3 Jun 2015 at 01:29 Mauricio Romero <mauricioromerolondono at gmail.com>
wrote:

> Hi,
>
> I'm sorry I cant post a reproducible example, but the data sets involve are
> too large. I'm currently trying to create a mosaic from 2 different Landsat
> 7 scenes. One of them is in UTM 18 and the other in UTM 17. Before using
> the mosaic command, I'm doing
>
> LandsatTransform=projectRaster(from=LandsatUTM17, to=LandsatUTM18)
>
> but i get a raster that is full of NAs and the following warning message
>
> Warning message:
> In .rasterFromRasterFile(grdfile, band = band, objecttype, ...) :
>   size of values file does not match the number of cells (given the data
> type)
>
> Not sure what to do. Any help is really appreciated.
>
> Thanks,
>
> Mauricio
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From luc.steinbuch at wur.nl  Tue Jun  2 18:10:24 2015
From: luc.steinbuch at wur.nl (Steinbuch, Luc)
Date: Tue, 2 Jun 2015 16:10:24 +0000
Subject: [R-sig-Geo] Scales in "bubble" {sp}
Message-ID: <b1220e0724f64514b56653e03868cdb8@scomp5292.wurnet.nl>

Hi,

I would like to have nice scales with '?N' etc. in a bubble plot.

Example:

###################
library(sp)

### example dataset
sp_yield = new("SpatialPointsDataFrame"
    , data = structure(list(Yw = c(6.6, 6, 7.7, 4.4, 7.4)), .Names = "Yw", row.names = c(NA, 5L), class = "data.frame")
    , coords.nrs = numeric(0)
    , coords = structure(c(9.817, 6.017, -4.317, -0.137, -0.867, 10.283, 9.1, 11.167, 12.974, 10.8), .Dim = c(5L, 2L), .Dimnames = list(NULL,
    c("Longitude_dd", "Latitude_dd")))
    , bbox = structure(c(-4.317, 9.1, 9.817, 12.974), .Dim = c(2L, 2L), .Dimnames = list(
    c("Longitude_dd", "Latitude_dd"), c("min", "max")))
    , proj4string = new("CRS"
    , projargs = "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
)
)


### with spplot (and this datum, and this area in sp_yield) automatically nice scales are generated,
# with degrees North and degrees East:
spplot(sp_yield,
       zcol = "Yw",
       scales = list(draw = TRUE)
)

### .. with bubble however not:
bubble(sp_yield,
       zcol = "Yw",
       scales = list(draw = TRUE)
)
###################

Any ideas..?

Luc

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Tue Jun  2 18:11:50 2015
From: btupper at bigelow.org (Ben Tupper)
Date: Tue, 2 Jun 2015 12:11:50 -0400
Subject: [R-sig-Geo] OSX, rgdal, GDAL drivers and HDF4
Message-ID: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>

Hello,

This is my attempt to look before I leap into installing GDAL on OSX. (You can probably hear my pitiful groaning and knee-knocking in the background.)

I want to read many HDF4 files for which I do not have the GDAL HDF4 driver installed.  I used William Kyngesburye's nice framework (http://www.kyngchaos.com/software:frameworks) to install GDAL but it came without the HDF4 driver.

Reading this somewhat dated exchange... 

http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-td6750856.html

... I think I understand that if I want the HDF4 driver I must build GDAL on my system manually.  Is my understanding correct, or is there another (easier) way to read HDF4 files directly in R?

Thanks!
Ben


> library(rgdal)
Loading required package: sp
rgdal: version: 0.9-3, (SVN revision 530)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
 Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
 Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/proj
 Linking to sp version: 1.1-0 
> x <- gdalDrivers()
> any(x$name %in% c("HDF4", "HDF"))
[1] FALSE

> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.9.5 (Mavericks)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.9-3 sp_1.1-0   

loaded via a namespace (and not attached):
[1] grid_3.2.0      lattice_0.20-31



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From Roger.Bivand at nhh.no  Tue Jun  2 18:37:11 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 2 Jun 2015 18:37:11 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes
In-Reply-To: <CAAcGz99LfkGXSCBG283eCyB_Tr2Bnnpzi=2xAireEJGt603OaQ@mail.gmail.com>
References: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
	<CAAcGz99LfkGXSCBG283eCyB_Tr2Bnnpzi=2xAireEJGt603OaQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1506021833420.16043@reclus.nhh.no>

Please do not use trunk, I never have, and it reflects a frozen state from 
years ago. The live code is in pkg/, current package version 1.0-2. It 
passes check, and packages depending on, importing, or suggesting rgdal 
also pass check if their suggested packages are ignored with this version 
of rgdal and both GDAL 1.11.2 and 2.0.0.beta2.

Hope this helps,

Roger

On Tue, 2 Jun 2015, Michael Sumner wrote:

> Magic! This is really good news, thanks so much.
>
> But, I get this:
>
> sudo R CMD INSTALL rgdal_0.6-28.tar.gz
> * installing to library ?/usr/local/lib/R/site-library?
> * installing *source* package ?rgdal? ...
> gdal-config: gdal-config
> GDAL version 2.0.0 found ...
> For building this version, at least GDAL version 1.3.1 is required.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/usr/local/lib/R/site-library/rgdal?
>
> gdal-config --prefix
> /usr/local
> gdal-config --libs
> -L/usr/local/lib -lgdal
> gdal-config --dep-libs
> -L/usr/lib -lnetcdf -lmfhdf -ldf -ljpeg -lz -lpthread -lm -lrt -ldl
> gdal-config --cflags
> -I/usr/local/include
> gdal-config --datadir
> /usr/local/share/gdal
> gdal-config --version
> 2.0.0
> gdal-config --ogr-enabled
> yes
>
> Build notes below
>
>
> Cheers, Mike.
>
> git clone https://github.com/OSGeo/gdal.git
>
> cd gdal
> ./configure
> make
> make install
> export LD_LIBRARY_PATH=/usr/local/lib
>
> cd ~
> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
> svn export trunk rgdal
> R CMD build rgdal
> R CMD INSTALL rgdal_0.6-28.tar.gz
>
> Rscript -e "library(sp); print(sessionInfo())"
>
> R version 3.2.0 (2015-04-16)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 14.04.2 LTS
>
> locale:
> [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8
> [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8
> [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  base
>
> other attached packages:
> [1] sp_1.1-0
>
> loaded via a namespace (and not attached):
> [1] grid_3.2.0      methods_3.2.0   lattice_0.20-31
>
>
>
> On Mon, 1 Jun 2015 at 04:00 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> The second beta of GDAL 2 is now available, and as of revision 535 on
>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>
>> One or two issues are known (Integer64 in vector fields and FIDs not
>> supported in R; gdalDrivers() reports both raster and vector drivers; the
>> MapInfo File TAB driver doesn't work for writing, ...), but others remain
>> to be discovered.
>>
>> For those who need rgdal in production, and can install the 2.0.0 beta, it
>> would be a really good use of time to identify issues now, rather than
>> when GDAL 2 starts to become the standard, stable release. Anyone else
>> needing an itch to scratch is also, of course, welcome to contribute.
>>
>> The rgdal package will continue to condition on GDAL 1 or 2, so hopefully
>> those users who do not need to move to GDAL 2 will not be affected.
>> However, it is worth noting that GDAL is maintained by very, very, few
>> volunteers (even plural is questionable here), and when they feel that
>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more important
>> things, you will be stranded with EOL software.
>>
>> So please consider taking the time to contribute to the idenfication of
>> issues in the development version of rgdal built against GDAL 2 and/or 1,
>> available for anonymous SVN checkout at:
>>
>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>
>> Enjoy!
>>
>> Roger
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From jgrn at illinois.edu  Tue Jun  2 19:09:18 2015
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 02 Jun 2015 17:09:18 +0000
Subject: [R-sig-Geo] Quickest way to tell if an arbitrary file is a
	raster/vector?
Message-ID: <CABG0rfs6sq84h0nW7QD7d_6HbGTi_1xL1+=PD34yv=-WW7qE6Q@mail.gmail.com>

r-sig-geo'ers:

I'm working on a GIS cataloging function to add-in to spatial.tools, and
one thing I'm struggling with is the quickest way to tell if a given file
is a GDAL/OGR readable raster/vector.  Any ideas?

--j

	[[alternative HTML version deleted]]


From gbl1 at hi.is  Tue Jun  2 19:31:14 2015
From: gbl1 at hi.is (Gilles Benjamin Leduc)
Date: Tue, 02 Jun 2015 17:31:14 +0000
Subject: [R-sig-Geo] =?utf-8?q?OSX=2C_rgdal=2C_GDAL_drivers_and_HDF4?=
In-Reply-To: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>
Message-ID: <61e8-556de880-1ab-2737ce00@121434889>

 
 Hi, 

I looked how I did. it seems I used a framwork named GDAL_Complete-1.11.dmg. I haven't used HDF4, so I don't know more 

Benjamin  
 
On Tuesday, June 2, 2015 16:11 GMT, Ben Tupper <btupper at bigelow.org> wrote: 
 
> Hello,
> 
> This is my attempt to look before I leap into installing GDAL on OSX. (You can probably hear my pitiful groaning and knee-knocking in the background.)
> 
> I want to read many HDF4 files for which I do not have the GDAL HDF4 driver installed.  I used William Kyngesburye's nice framework (http://www.kyngchaos.com/software:frameworks) to install GDAL but it came without the HDF4 driver.
> 
> Reading this somewhat dated exchange... 
> 
> http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-td6750856.html

> 
> ... I think I understand that if I want the HDF4 driver I must build GDAL on my system manually.  Is my understanding correct, or is there another (easier) way to read HDF4 files directly in R?
> 
> Thanks!
> Ben
> 
> 
> > library(rgdal)
> Loading required package: sp
> rgdal: version: 0.9-3, (SVN revision 530)
>  Geospatial Data Abstraction Library extensions to R successfully loaded
>  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
>  Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/gdal
>  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>  Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/proj
>  Linking to sp version: 1.1-0 
> > x <- gdalDrivers()
> > any(x$name %in% c("HDF4", "HDF"))
> [1] FALSE
> 
> > sessionInfo()
> R version 3.2.0 (2015-04-16)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> other attached packages:
> [1] rgdal_0.9-3 sp_1.1-0   
> 
> loaded via a namespace (and not attached):
> [1] grid_3.2.0      lattice_0.20-31
> 
> 
> 
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From SWalbridge at esri.com  Tue Jun  2 19:56:39 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Tue, 2 Jun 2015 17:56:39 +0000
Subject: [R-sig-Geo] OSX, rgdal, GDAL drivers and HDF4
In-Reply-To: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>
References: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>
Message-ID: <D19365A4.2784F%swalbridge@esri.com>

Have you tried with the homebrew project? HDF4 isn?t a default supported
driver, but it?s easy enough to add:

  brew install hdf4
  # prefer hdf4 links over NetCDF
  brew link --overwrite hdf4
  brew install gdal --complete --enable-unsupported --with-hdf4

  # check what drivers are installed, list should include ?hdf4?:
  gdal-config --formats

I?d use that as a starting point.

Cheers,
Shaun



On 6/2/15, 12:11 PM, "Ben Tupper" <btupper at bigelow.org> wrote:

>Hello,
>
>This is my attempt to look before I leap into installing GDAL on OSX.
>(You can probably hear my pitiful groaning and knee-knocking in the
>background.)
>
>I want to read many HDF4 files for which I do not have the GDAL HDF4
>driver installed.  I used William Kyngesburye's nice framework
>(http://www.kyngchaos.com/software:frameworks) to install GDAL but it
>came without the HDF4 driver.
>
>Reading this somewhat dated exchange...
>
>http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-td6750856.html
>
>... I think I understand that if I want the HDF4 driver I must build GDAL
>on my system manually.  Is my understanding correct, or is there another
>(easier) way to read HDF4 files directly in R?
>
>Thanks!
>Ben
>
>
>> library(rgdal)
>Loading required package: sp
>rgdal: version: 0.9-3, (SVN revision 530)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
> Path to GDAL shared files:
>/Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
> Path to PROJ.4 shared files:
>/Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/proj
> Linking to sp version: 1.1-0
>> x <- gdalDrivers()
>> any(x$name %in% c("HDF4", "HDF"))
>[1] FALSE
>
>> sessionInfo()
>R version 3.2.0 (2015-04-16)
>Platform: x86_64-apple-darwin13.4.0 (64-bit)
>Running under: OS X 10.9.5 (Mavericks)
>
>locale:
>[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
>attached base packages:
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>other attached packages:
>[1] rgdal_0.9-3 sp_1.1-0
>
>loaded via a namespace (and not attached):
>[1] grid_3.2.0      lattice_0.20-31
>
>
>
>Ben Tupper
>Bigelow Laboratory for Ocean Sciences
>60 Bigelow Drive, P.O. Box 380
>East Boothbay, Maine 04544
>http://www.bigelow.org
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From englishchristophera at gmail.com  Tue Jun  2 21:28:12 2015
From: englishchristophera at gmail.com (chris english)
Date: Tue, 2 Jun 2015 15:28:12 -0400
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
Message-ID: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>

Roger,

I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack based
on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with R
 and was disappointed that I couldn't use  2.0.0.beta  because at the point
only sp-1.1-1 was supported.

I have a couple of future projects that are going to fundamentally depend
on GDAL and I hope to be able to address them from within R.  As an R
beginner I'm happy I have in my notes on how to point to my /opt/gdal(
please excuse if generalizing between an installed /opt/gdal(2.0,0.beta and
 /usr/local/gdal(earlier.build)  build, but many people perhaps have not
been making a diary of R success(es).

In the simplest case it could be a reminder to us beginners how we might
load a library(rgdal("in this case 2.0.0.beta vs our normal
library(rgdal)).  Well we are beginners, but we still want out stuff to
work and we want to contribute to a successful and comprehensive 2.2.0
release. So we'll run our particular research examples through 2.0.0 and
report results, if we know how to load one vs. another library.

If intermediate or expert, different examples would be deployed.

I apologize in advance if these issues  or methods have already been
addressed at SVN and I failed to notice them.  If that is the case I will
dig further, and please ignore me.

I think GDAL and rgdal are intrinsically important tools to this community
and everyone wants them to work; please just tell us, by general example,
how we might be best of service.

I hope the foregoing is comprehensible. My thoughts, and looking forward to
to contributing in a useful fashion to this important package (as a
beginner).

Cheers,

Chris


The second beta of GDAL 2 is now available, and as of revision 535 on
> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>
> One or two issues are known (Integer64 in vector fields and FIDs not
> supported in R; gdalDrivers() reports both raster and vector drivers; the
> MapInfo File TAB driver doesn't work for writing, ...), but others remain
> to be discovered.
>
> For those who need rgdal in production, and can install the 2.0.0 beta, it
> would be a really good use of time to identify issues now, rather than when
> GDAL 2 starts to become the standard, stable release. Anyone else needing
> an itch to scratch is also, of course, welcome to contribute.
>
> The rgdal package will continue to condition on GDAL 1 or 2, so hopefully
> those users who do not need to move to GDAL 2 will not be affected.
> However, it is worth noting that GDAL is maintained by very, very, few
> volunteers (even plural is questionable here), and when they feel that
> backporting fixed from GDAL 2 to GDAL 1 is taking time from more important
> things, you will be stranded with EOL software.
>
> So please consider taking the time to contribute to the idenfication of
> issues in the development version of rgdal built against GDAL 2 and/or 1,
> available for anonymous SVN checkout at:
>
> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>
> Enjoy!
>
> Roger
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From b.rowlingson at lancaster.ac.uk  Tue Jun  2 21:36:03 2015
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 2 Jun 2015 20:36:03 +0100
Subject: [R-sig-Geo] Quickest way to tell if an arbitrary file is a
	raster/vector?
In-Reply-To: <CABG0rfs6sq84h0nW7QD7d_6HbGTi_1xL1+=PD34yv=-WW7qE6Q@mail.gmail.com>
References: <CABG0rfs6sq84h0nW7QD7d_6HbGTi_1xL1+=PD34yv=-WW7qE6Q@mail.gmail.com>
Message-ID: <CANVKczM-gsoHuSJQ6hPjD_iKo4n-8SVBeVpN5uYqEiqyKRLk+w@mail.gmail.com>

Tricky, because OGR (at least) doesn't have a 1-1 mapping of "file" to
"data source"....

* I think any component of a shapefile can be used as a data source of
a single-layer. Command-line ogrinfo on my machine thinks so:

$ ogrinfo DSMW.dbf
INFO: Open of `DSMW.dbf'
      using driver `ESRI Shapefile' successful.
1: DSMW (Polygon)

As does rgdal::functions:

 > ogrListLayers("DSMW.shx")
[1] "DSMW"
attr(,"driver")
[1] "ESRI Shapefile"
attr(,"nlayers")
[1] 1


* Then a folder containing shapefiles can be used as a data source
where each shapefile is a layer...

I'd think about wrapping ogrInfo and GDALinfo in "try" clauses, and
then clearing up the duplicates...

Barry



On Tue, Jun 2, 2015 at 6:09 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> r-sig-geo'ers:
>
> I'm working on a GIS cataloging function to add-in to spatial.tools, and
> one thing I'm struggling with is the quickest way to tell if a given file
> is a GDAL/OGR readable raster/vector.  Any ideas?
>
> --j
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Tue Jun  2 22:52:02 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 02 Jun 2015 22:52:02 +0200
Subject: [R-sig-Geo] Scales in "bubble" {sp}
In-Reply-To: <b1220e0724f64514b56653e03868cdb8@scomp5292.wurnet.nl>
References: <b1220e0724f64514b56653e03868cdb8@scomp5292.wurnet.nl>
Message-ID: <556E1772.7020807@uni-muenster.de>

Good suggestion; I added this, on r-forge.

On 06/02/2015 06:10 PM, Steinbuch, Luc wrote:
> Hi,
> 
> I would like to have nice scales with '?N' etc. in a bubble plot.
> 
> Example:
> 
> ###################
> library(sp)
> 
> ### example dataset
> sp_yield = new("SpatialPointsDataFrame"
>     , data = structure(list(Yw = c(6.6, 6, 7.7, 4.4, 7.4)), .Names = "Yw", row.names = c(NA, 5L), class = "data.frame")
>     , coords.nrs = numeric(0)
>     , coords = structure(c(9.817, 6.017, -4.317, -0.137, -0.867, 10.283, 9.1, 11.167, 12.974, 10.8), .Dim = c(5L, 2L), .Dimnames = list(NULL,
>     c("Longitude_dd", "Latitude_dd")))
>     , bbox = structure(c(-4.317, 9.1, 9.817, 12.974), .Dim = c(2L, 2L), .Dimnames = list(
>     c("Longitude_dd", "Latitude_dd"), c("min", "max")))
>     , proj4string = new("CRS"
>     , projargs = "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
> )
> )
> 
> 
> ### with spplot (and this datum, and this area in sp_yield) automatically nice scales are generated,
> # with degrees North and degrees East:
> spplot(sp_yield,
>        zcol = "Yw",
>        scales = list(draw = TRUE)
> )
> 
> ### .. with bubble however not:
> bubble(sp_yield,
>        zcol = "Yw",
>        scales = list(draw = TRUE)
> )
> ###################
> 
> Any ideas..?
> 
> Luc
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150602/76347889/attachment.bin>

From Roger.Bivand at nhh.no  Wed Jun  3 09:13:34 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jun 2015 09:13:34 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>

On Tue, 2 Jun 2015, chris english wrote:

> Roger,
>
> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack based
> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with R
> and was disappointed that I couldn't use  2.0.0.beta  because at the point
> only sp-1.1-1 was supported.

Chris,

Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that it 
makes the code base easier to maintain because only the GDAL driver 
manager is supported, and vector drivers have been folded into the same 
model. Beyond that, we have continuing feature creep (e.g. use of 
Integer64 to hold IDs that notionally should be strings (no arithmetic) 
and which always lose leading zeros, and others. The key challenge 
(threat) to GDAL is the very limited number of core developers, followed 
by the same danger affecting many of GDAL's external dependencies.

General comment: Could someone who knows how to do it please set up a 
searchable scribble sheet to which ordered examples, open issues, ideas, 
etc. could be contributed? This thread is now the prime location, but 
probably will become unwieldy.

You will never be able to switch easily between rgdal installed against 
GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only 
available to those installing GDAL from source, then rgdal from source, as 
GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if 
--prefix= is the same. If --prefix= is different between 1 and 2 when 
installing GDAL, and you take care with LD path names and use of ldconfig, 
you can pass these different locations of GDAL 1 and GDAL 2 through when 
installing rgdal. Then you'd also have to remember to install rgdal for 
GDAL 1 in say one R library folder, for GDAL 2 in a different library 
folder, and add the appropriate one to .libPaths(). It would be messy.

Performance-wise, there should be no user-impacting difference between 
GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<= 
0.9-3), which blocks GDAL 2.

The task now is to locate possible differences in behaviour between rgdal 
0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are 
1|2 differences, are they because of changes in GDAL, or because rgdal was 
making inappropriate assumptions about GDAL?

So far, we really don't know the Integer64 field type in GDAL 2 vectors is 
going to play out - as of now rgdal 1.0-2 truncates to integer. We don't 
know how the changes in the driver manager for vector dsn and layers 
affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in 
GDAL 2, and apparently different behaviour for some drivers). Writing 
MapInfo File TAB files looks broken (maybe a dsn creation option needs 
setting, when it wasn't needed before), etc.

Some of this can be fixed by nasty kludges in rgdal, some should be fixed 
in GDAL 2, some are real misunderstandings. I don't have the time to try 
to make an rgdal Windows binary built against Windows GDAL 2 by 
cross-compiling for trying things out under Windows without user 
compilation. The transition will take time, but anyone who can install 
GDAL and rgdal from source, and who is interested and/or needs rgdal to 
work predictably, is welcome to run some standard procedures with rgdal 
0.9-3 and GDAL 1, storing a text version of key results; install rgdal 
1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and living 
under pkg/:

#cd rgdal
R CMD build pkg
R CMD check rgdal_1.0-2.tar.gz
# maybe --install-args='--configure.args=...'
R CMD INSTALL rgdal_1.0-2.tar.gz
# maybe --configure.args=...

rerun the procedure and compare the results to see whether changes in 
rgdal have led to changes in the results, the re-install rgdal 1.0-2 with 
GDAL 2, rerun the procedure and compare the results, and compare those for 
GDAL 1 and GDAL 2.

In particular, we need confirmation that the database access drivers work 
across these shifts.

Roger

>
> I have a couple of future projects that are going to fundamentally depend
> on GDAL and I hope to be able to address them from within R.  As an R
> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta and
> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
> been making a diary of R success(es).
>
> In the simplest case it could be a reminder to us beginners how we might
> load a library(rgdal("in this case 2.0.0.beta vs our normal
> library(rgdal)).  Well we are beginners, but we still want out stuff to
> work and we want to contribute to a successful and comprehensive 2.2.0
> release. So we'll run our particular research examples through 2.0.0 and
> report results, if we know how to load one vs. another library.
>
> If intermediate or expert, different examples would be deployed.
>
> I apologize in advance if these issues  or methods have already been
> addressed at SVN and I failed to notice them.  If that is the case I will
> dig further, and please ignore me.
>
> I think GDAL and rgdal are intrinsically important tools to this community
> and everyone wants them to work; please just tell us, by general example,
> how we might be best of service.
>
> I hope the foregoing is comprehensible. My thoughts, and looking forward to
> to contributing in a useful fashion to this important package (as a
> beginner).
>
> Cheers,
>
> Chris
>
>
> The second beta of GDAL 2 is now available, and as of revision 535 on
>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>
>> One or two issues are known (Integer64 in vector fields and FIDs not
>> supported in R; gdalDrivers() reports both raster and vector drivers; the
>> MapInfo File TAB driver doesn't work for writing, ...), but others remain
>> to be discovered.
>>
>> For those who need rgdal in production, and can install the 2.0.0 beta, it
>> would be a really good use of time to identify issues now, rather than when
>> GDAL 2 starts to become the standard, stable release. Anyone else needing
>> an itch to scratch is also, of course, welcome to contribute.
>>
>> The rgdal package will continue to condition on GDAL 1 or 2, so hopefully
>> those users who do not need to move to GDAL 2 will not be affected.
>> However, it is worth noting that GDAL is maintained by very, very, few
>> volunteers (even plural is questionable here), and when they feel that
>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more important
>> things, you will be stranded with EOL software.
>>
>> So please consider taking the time to contribute to the idenfication of
>> issues in the development version of rgdal built against GDAL 2 and/or 1,
>> available for anonymous SVN checkout at:
>>
>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>
>> Enjoy!
>>
>> Roger
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Wed Jun  3 10:12:57 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 03 Jun 2015 08:12:57 +0000
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
	<alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
Message-ID: <CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>

On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 2 Jun 2015, chris english wrote:
>
> > Roger,
> >
> > I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
> based
> > on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with R
> > and was disappointed that I couldn't use  2.0.0.beta  because at the
> point
> > only sp-1.1-1 was supported.
>
> Chris,
>
> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that it
> makes the code base easier to maintain because only the GDAL driver
> manager is supported, and vector drivers have been folded into the same
> model. Beyond that, we have continuing feature creep (e.g. use of
> Integer64 to hold IDs that notionally should be strings (no arithmetic)
> and which always lose leading zeros, and others. The key challenge
> (threat) to GDAL is the very limited number of core developers, followed
> by the same danger affecting many of GDAL's external dependencies.
>
> General comment: Could someone who knows how to do it please set up a
> searchable scribble sheet to which ordered examples, open issues, ideas,
> etc. could be contributed? This thread is now the prime location, but
> probably will become unwieldy.
>
>
What about MoPad?
https://etherpad.mozilla.org/8bU6hpr0YY

I set up a repo in github too but that might not be of interest since we
need pull-requests, forks etc.

https://github.com/mdsumner/rgdal_scribblesheet

Happy to help with any of this in whatever way people prefer.

Cheers, Mike.



> You will never be able to switch easily between rgdal installed against
> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
> available to those installing GDAL from source, then rgdal from source, as
> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
> --prefix= is the same. If --prefix= is different between 1 and 2 when
> installing GDAL, and you take care with LD path names and use of ldconfig,
> you can pass these different locations of GDAL 1 and GDAL 2 through when
> installing rgdal. Then you'd also have to remember to install rgdal for
> GDAL 1 in say one R library folder, for GDAL 2 in a different library
> folder, and add the appropriate one to .libPaths(). It would be messy.
>
> Performance-wise, there should be no user-impacting difference between
> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
> 0.9-3), which blocks GDAL 2.
>
> The task now is to locate possible differences in behaviour between rgdal
> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
> 1|2 differences, are they because of changes in GDAL, or because rgdal was
> making inappropriate assumptions about GDAL?
>
> So far, we really don't know the Integer64 field type in GDAL 2 vectors is
> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
> know how the changes in the driver manager for vector dsn and layers
> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
> GDAL 2, and apparently different behaviour for some drivers). Writing
> MapInfo File TAB files looks broken (maybe a dsn creation option needs
> setting, when it wasn't needed before), etc.
>
> Some of this can be fixed by nasty kludges in rgdal, some should be fixed
> in GDAL 2, some are real misunderstandings. I don't have the time to try
> to make an rgdal Windows binary built against Windows GDAL 2 by
> cross-compiling for trying things out under Windows without user
> compilation. The transition will take time, but anyone who can install
> GDAL and rgdal from source, and who is interested and/or needs rgdal to
> work predictably, is welcome to run some standard procedures with rgdal
> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and living
> under pkg/:
>
> #cd rgdal
> R CMD build pkg
> R CMD check rgdal_1.0-2.tar.gz
> # maybe --install-args='--configure.args=...'
> R CMD INSTALL rgdal_1.0-2.tar.gz
> # maybe --configure.args=...
>
> rerun the procedure and compare the results to see whether changes in
> rgdal have led to changes in the results, the re-install rgdal 1.0-2 with
> GDAL 2, rerun the procedure and compare the results, and compare those for
> GDAL 1 and GDAL 2.
>
> In particular, we need confirmation that the database access drivers work
> across these shifts.
>
> Roger
>
> >
> > I have a couple of future projects that are going to fundamentally depend
> > on GDAL and I hope to be able to address them from within R.  As an R
> > beginner I'm happy I have in my notes on how to point to my /opt/gdal(
> > please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
> and
> > /usr/local/gdal(earlier.build)  build, but many people perhaps have not
> > been making a diary of R success(es).
> >
> > In the simplest case it could be a reminder to us beginners how we might
> > load a library(rgdal("in this case 2.0.0.beta vs our normal
> > library(rgdal)).  Well we are beginners, but we still want out stuff to
> > work and we want to contribute to a successful and comprehensive 2.2.0
> > release. So we'll run our particular research examples through 2.0.0 and
> > report results, if we know how to load one vs. another library.
> >
> > If intermediate or expert, different examples would be deployed.
> >
> > I apologize in advance if these issues  or methods have already been
> > addressed at SVN and I failed to notice them.  If that is the case I will
> > dig further, and please ignore me.
> >
> > I think GDAL and rgdal are intrinsically important tools to this
> community
> > and everyone wants them to work; please just tell us, by general example,
> > how we might be best of service.
> >
> > I hope the foregoing is comprehensible. My thoughts, and looking forward
> to
> > to contributing in a useful fashion to this important package (as a
> > beginner).
> >
> > Cheers,
> >
> > Chris
> >
> >
> > The second beta of GDAL 2 is now available, and as of revision 535 on
> >> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
> >> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
> >>
> >> One or two issues are known (Integer64 in vector fields and FIDs not
> >> supported in R; gdalDrivers() reports both raster and vector drivers;
> the
> >> MapInfo File TAB driver doesn't work for writing, ...), but others
> remain
> >> to be discovered.
> >>
> >> For those who need rgdal in production, and can install the 2.0.0 beta,
> it
> >> would be a really good use of time to identify issues now, rather than
> when
> >> GDAL 2 starts to become the standard, stable release. Anyone else
> needing
> >> an itch to scratch is also, of course, welcome to contribute.
> >>
> >> The rgdal package will continue to condition on GDAL 1 or 2, so
> hopefully
> >> those users who do not need to move to GDAL 2 will not be affected.
> >> However, it is worth noting that GDAL is maintained by very, very, few
> >> volunteers (even plural is questionable here), and when they feel that
> >> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
> important
> >> things, you will be stranded with EOL software.
> >>
> >> So please consider taking the time to contribute to the idenfication of
> >> issues in the development version of rgdal built against GDAL 2 and/or
> 1,
> >> available for anonymous SVN checkout at:
> >>
> >> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
> >>
> >> Enjoy!
> >>
> >> Roger
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; fax +47 55 95 91 00
> >> e-mail: Roger.Bivand at nhh.no
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jun  3 11:20:58 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jun 2015 11:20:58 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
	<alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
	<CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1506031118330.28754@reclus.nhh.no>

On Wed, 3 Jun 2015, Michael Sumner wrote:

> On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 2 Jun 2015, chris english wrote:
>>
>>> Roger,
>>>
>>> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
>> based
>>> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with R
>>> and was disappointed that I couldn't use  2.0.0.beta  because at the
>> point
>>> only sp-1.1-1 was supported.
>>
>> Chris,
>>
>> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that it
>> makes the code base easier to maintain because only the GDAL driver
>> manager is supported, and vector drivers have been folded into the same
>> model. Beyond that, we have continuing feature creep (e.g. use of
>> Integer64 to hold IDs that notionally should be strings (no arithmetic)
>> and which always lose leading zeros, and others. The key challenge
>> (threat) to GDAL is the very limited number of core developers, followed
>> by the same danger affecting many of GDAL's external dependencies.
>>
>> General comment: Could someone who knows how to do it please set up a
>> searchable scribble sheet to which ordered examples, open issues, ideas,
>> etc. could be contributed? This thread is now the prime location, but
>> probably will become unwieldy.
>>
>>
> What about MoPad?
> https://etherpad.mozilla.org/8bU6hpr0YY

OK, thanks, I've added som comments. I've also removed the 
trunk/tags/branch structure on R-Forge, so

svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg

does a clean checkout that can be updated, but should be put in an rgdal 
folder to avoid splatter.

Roger

>
> I set up a repo in github too but that might not be of interest since we
> need pull-requests, forks etc.
>
> https://github.com/mdsumner/rgdal_scribblesheet
>
> Happy to help with any of this in whatever way people prefer.
>
> Cheers, Mike.
>
>
>
>> You will never be able to switch easily between rgdal installed against
>> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
>> available to those installing GDAL from source, then rgdal from source, as
>> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
>> --prefix= is the same. If --prefix= is different between 1 and 2 when
>> installing GDAL, and you take care with LD path names and use of ldconfig,
>> you can pass these different locations of GDAL 1 and GDAL 2 through when
>> installing rgdal. Then you'd also have to remember to install rgdal for
>> GDAL 1 in say one R library folder, for GDAL 2 in a different library
>> folder, and add the appropriate one to .libPaths(). It would be messy.
>>
>> Performance-wise, there should be no user-impacting difference between
>> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
>> 0.9-3), which blocks GDAL 2.
>>
>> The task now is to locate possible differences in behaviour between rgdal
>> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
>> 1|2 differences, are they because of changes in GDAL, or because rgdal was
>> making inappropriate assumptions about GDAL?
>>
>> So far, we really don't know the Integer64 field type in GDAL 2 vectors is
>> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
>> know how the changes in the driver manager for vector dsn and layers
>> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
>> GDAL 2, and apparently different behaviour for some drivers). Writing
>> MapInfo File TAB files looks broken (maybe a dsn creation option needs
>> setting, when it wasn't needed before), etc.
>>
>> Some of this can be fixed by nasty kludges in rgdal, some should be fixed
>> in GDAL 2, some are real misunderstandings. I don't have the time to try
>> to make an rgdal Windows binary built against Windows GDAL 2 by
>> cross-compiling for trying things out under Windows without user
>> compilation. The transition will take time, but anyone who can install
>> GDAL and rgdal from source, and who is interested and/or needs rgdal to
>> work predictably, is welcome to run some standard procedures with rgdal
>> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
>> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and living
>> under pkg/:
>>
>> #cd rgdal
>> R CMD build pkg
>> R CMD check rgdal_1.0-2.tar.gz
>> # maybe --install-args='--configure.args=...'
>> R CMD INSTALL rgdal_1.0-2.tar.gz
>> # maybe --configure.args=...
>>
>> rerun the procedure and compare the results to see whether changes in
>> rgdal have led to changes in the results, the re-install rgdal 1.0-2 with
>> GDAL 2, rerun the procedure and compare the results, and compare those for
>> GDAL 1 and GDAL 2.
>>
>> In particular, we need confirmation that the database access drivers work
>> across these shifts.
>>
>> Roger
>>
>>>
>>> I have a couple of future projects that are going to fundamentally depend
>>> on GDAL and I hope to be able to address them from within R.  As an R
>>> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
>>> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
>> and
>>> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
>>> been making a diary of R success(es).
>>>
>>> In the simplest case it could be a reminder to us beginners how we might
>>> load a library(rgdal("in this case 2.0.0.beta vs our normal
>>> library(rgdal)).  Well we are beginners, but we still want out stuff to
>>> work and we want to contribute to a successful and comprehensive 2.2.0
>>> release. So we'll run our particular research examples through 2.0.0 and
>>> report results, if we know how to load one vs. another library.
>>>
>>> If intermediate or expert, different examples would be deployed.
>>>
>>> I apologize in advance if these issues  or methods have already been
>>> addressed at SVN and I failed to notice them.  If that is the case I will
>>> dig further, and please ignore me.
>>>
>>> I think GDAL and rgdal are intrinsically important tools to this
>> community
>>> and everyone wants them to work; please just tell us, by general example,
>>> how we might be best of service.
>>>
>>> I hope the foregoing is comprehensible. My thoughts, and looking forward
>> to
>>> to contributing in a useful fashion to this important package (as a
>>> beginner).
>>>
>>> Cheers,
>>>
>>> Chris
>>>
>>>
>>> The second beta of GDAL 2 is now available, and as of revision 535 on
>>>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>>>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>>>
>>>> One or two issues are known (Integer64 in vector fields and FIDs not
>>>> supported in R; gdalDrivers() reports both raster and vector drivers;
>> the
>>>> MapInfo File TAB driver doesn't work for writing, ...), but others
>> remain
>>>> to be discovered.
>>>>
>>>> For those who need rgdal in production, and can install the 2.0.0 beta,
>> it
>>>> would be a really good use of time to identify issues now, rather than
>> when
>>>> GDAL 2 starts to become the standard, stable release. Anyone else
>> needing
>>>> an itch to scratch is also, of course, welcome to contribute.
>>>>
>>>> The rgdal package will continue to condition on GDAL 1 or 2, so
>> hopefully
>>>> those users who do not need to move to GDAL 2 will not be affected.
>>>> However, it is worth noting that GDAL is maintained by very, very, few
>>>> volunteers (even plural is questionable here), and when they feel that
>>>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
>> important
>>>> things, you will be stranded with EOL software.
>>>>
>>>> So please consider taking the time to contribute to the idenfication of
>>>> issues in the development version of rgdal built against GDAL 2 and/or
>> 1,
>>>> available for anonymous SVN checkout at:
>>>>
>>>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>>>
>>>> Enjoy!
>>>>
>>>> Roger
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From frtog at vestas.com  Wed Jun  3 14:33:04 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Wed, 3 Jun 2015 14:33:04 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <alpine.LFD.2.11.1506031118330.28754@reclus.nhh.no>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
	<alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
	<CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>
	<alpine.LFD.2.11.1506031118330.28754@reclus.nhh.no>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC485886848CDA@DKRDSEXC016.vestas.net>

Hi

Anyone else having problem with checking out the repos?

On my Windows box:

Command: Checkout from svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg, revision HEAD, Fully recursive, Externals included  
Error: Unable to connect to a repository at URL  
Error:  'svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg'  
Error: Can't connect to host 'scm.r-forge.r-project.org': No connection could be made  
Error:  because the target machine actively refused it.  
Completed!:   


On our cluster:

[frtog at dkrdsfshn2 ~]$ svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg rgdal
svn: Can't connect to host 'scm.r-forge.r-project.org': Connection refused
[frtog at dkrdsfshn2 ~]$

So no anonymous access?


Yours sincerely / Med venlig hilsen

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Roger Bivand
Sent: 3. juni 2015 11:21
To: Michael Sumner
Cc: r-sig-geo
Subject: Re: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to their means

On Wed, 3 Jun 2015, Michael Sumner wrote:

> On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 2 Jun 2015, chris english wrote:
>>
>>> Roger,
>>>
>>> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
>> based
>>> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with R
>>> and was disappointed that I couldn't use  2.0.0.beta  because at the
>> point
>>> only sp-1.1-1 was supported.
>>
>> Chris,
>>
>> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that it
>> makes the code base easier to maintain because only the GDAL driver
>> manager is supported, and vector drivers have been folded into the same
>> model. Beyond that, we have continuing feature creep (e.g. use of
>> Integer64 to hold IDs that notionally should be strings (no arithmetic)
>> and which always lose leading zeros, and others. The key challenge
>> (threat) to GDAL is the very limited number of core developers, followed
>> by the same danger affecting many of GDAL's external dependencies.
>>
>> General comment: Could someone who knows how to do it please set up a
>> searchable scribble sheet to which ordered examples, open issues, ideas,
>> etc. could be contributed? This thread is now the prime location, but
>> probably will become unwieldy.
>>
>>
> What about MoPad?
> https://etherpad.mozilla.org/8bU6hpr0YY

OK, thanks, I've added som comments. I've also removed the 
trunk/tags/branch structure on R-Forge, so

svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg

does a clean checkout that can be updated, but should be put in an rgdal 
folder to avoid splatter.

Roger

>
> I set up a repo in github too but that might not be of interest since we
> need pull-requests, forks etc.
>
> https://github.com/mdsumner/rgdal_scribblesheet
>
> Happy to help with any of this in whatever way people prefer.
>
> Cheers, Mike.
>
>
>
>> You will never be able to switch easily between rgdal installed against
>> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
>> available to those installing GDAL from source, then rgdal from source, as
>> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
>> --prefix= is the same. If --prefix= is different between 1 and 2 when
>> installing GDAL, and you take care with LD path names and use of ldconfig,
>> you can pass these different locations of GDAL 1 and GDAL 2 through when
>> installing rgdal. Then you'd also have to remember to install rgdal for
>> GDAL 1 in say one R library folder, for GDAL 2 in a different library
>> folder, and add the appropriate one to .libPaths(). It would be messy.
>>
>> Performance-wise, there should be no user-impacting difference between
>> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
>> 0.9-3), which blocks GDAL 2.
>>
>> The task now is to locate possible differences in behaviour between rgdal
>> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
>> 1|2 differences, are they because of changes in GDAL, or because rgdal was
>> making inappropriate assumptions about GDAL?
>>
>> So far, we really don't know the Integer64 field type in GDAL 2 vectors is
>> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
>> know how the changes in the driver manager for vector dsn and layers
>> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
>> GDAL 2, and apparently different behaviour for some drivers). Writing
>> MapInfo File TAB files looks broken (maybe a dsn creation option needs
>> setting, when it wasn't needed before), etc.
>>
>> Some of this can be fixed by nasty kludges in rgdal, some should be fixed
>> in GDAL 2, some are real misunderstandings. I don't have the time to try
>> to make an rgdal Windows binary built against Windows GDAL 2 by
>> cross-compiling for trying things out under Windows without user
>> compilation. The transition will take time, but anyone who can install
>> GDAL and rgdal from source, and who is interested and/or needs rgdal to
>> work predictably, is welcome to run some standard procedures with rgdal
>> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
>> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and living
>> under pkg/:
>>
>> #cd rgdal
>> R CMD build pkg
>> R CMD check rgdal_1.0-2.tar.gz
>> # maybe --install-args='--configure.args=...'
>> R CMD INSTALL rgdal_1.0-2.tar.gz
>> # maybe --configure.args=...
>>
>> rerun the procedure and compare the results to see whether changes in
>> rgdal have led to changes in the results, the re-install rgdal 1.0-2 with
>> GDAL 2, rerun the procedure and compare the results, and compare those for
>> GDAL 1 and GDAL 2.
>>
>> In particular, we need confirmation that the database access drivers work
>> across these shifts.
>>
>> Roger
>>
>>>
>>> I have a couple of future projects that are going to fundamentally depend
>>> on GDAL and I hope to be able to address them from within R.  As an R
>>> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
>>> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
>> and
>>> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
>>> been making a diary of R success(es).
>>>
>>> In the simplest case it could be a reminder to us beginners how we might
>>> load a library(rgdal("in this case 2.0.0.beta vs our normal
>>> library(rgdal)).  Well we are beginners, but we still want out stuff to
>>> work and we want to contribute to a successful and comprehensive 2.2.0
>>> release. So we'll run our particular research examples through 2.0.0 and
>>> report results, if we know how to load one vs. another library.
>>>
>>> If intermediate or expert, different examples would be deployed.
>>>
>>> I apologize in advance if these issues  or methods have already been
>>> addressed at SVN and I failed to notice them.  If that is the case I will
>>> dig further, and please ignore me.
>>>
>>> I think GDAL and rgdal are intrinsically important tools to this
>> community
>>> and everyone wants them to work; please just tell us, by general example,
>>> how we might be best of service.
>>>
>>> I hope the foregoing is comprehensible. My thoughts, and looking forward
>> to
>>> to contributing in a useful fashion to this important package (as a
>>> beginner).
>>>
>>> Cheers,
>>>
>>> Chris
>>>
>>>
>>> The second beta of GDAL 2 is now available, and as of revision 535 on
>>>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>>>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>>>
>>>> One or two issues are known (Integer64 in vector fields and FIDs not
>>>> supported in R; gdalDrivers() reports both raster and vector drivers;
>> the
>>>> MapInfo File TAB driver doesn't work for writing, ...), but others
>> remain
>>>> to be discovered.
>>>>
>>>> For those who need rgdal in production, and can install the 2.0.0 beta,
>> it
>>>> would be a really good use of time to identify issues now, rather than
>> when
>>>> GDAL 2 starts to become the standard, stable release. Anyone else
>> needing
>>>> an itch to scratch is also, of course, welcome to contribute.
>>>>
>>>> The rgdal package will continue to condition on GDAL 1 or 2, so
>> hopefully
>>>> those users who do not need to move to GDAL 2 will not be affected.
>>>> However, it is worth noting that GDAL is maintained by very, very, few
>>>> volunteers (even plural is questionable here), and when they feel that
>>>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
>> important
>>>> things, you will be stranded with EOL software.
>>>>
>>>> So please consider taking the time to contribute to the idenfication of
>>>> issues in the development version of rgdal built against GDAL 2 and/or
>> 1,
>>>> available for anonymous SVN checkout at:
>>>>
>>>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>>>
>>>> Enjoy!
>>>>
>>>> Roger
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From englishchristophera at gmail.com  Wed Jun  3 15:03:19 2015
From: englishchristophera at gmail.com (chris english)
Date: Wed, 3 Jun 2015 09:03:19 -0400
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <B078CDF40DFE4045AF172A8B4F68FC485886848CDA@DKRDSEXC016.vestas.net>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
	<alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
	<CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>
	<alpine.LFD.2.11.1506031118330.28754@reclus.nhh.no>
	<B078CDF40DFE4045AF172A8B4F68FC485886848CDA@DKRDSEXC016.vestas.net>
Message-ID: <CAASFQpRO=LNnWajEOt0v-hY5Hq=66Y4oiadFcQLM8c-hvHJbkA@mail.gmail.com>

Successful linux download an hour ago.

Chris

On Wed, Jun 3, 2015 at 8:33 AM, Frede Aakmann T?gersen <frtog at vestas.com>
wrote:

> Hi
>
> Anyone else having problem with checking out the repos?
>
> On my Windows box:
>
> Command: Checkout from svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg,
> revision HEAD, Fully recursive, Externals included
> Error: Unable to connect to a repository at URL
> Error:  'svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg'
> Error: Can't connect to host 'scm.r-forge.r-project.org': No connection
> could be made
> Error:  because the target machine actively refused it.
> Completed!:
>
>
> On our cluster:
>
> [frtog at dkrdsfshn2 ~]$ svn checkout svn://
> scm.r-forge.r-project.org/svnroot/rgdal/pkg rgdal
> svn: Can't connect to host 'scm.r-forge.r-project.org': Connection refused
> [frtog at dkrdsfshn2 ~]$
>
> So no anonymous access?
>
>
> Yours sincerely / Med venlig hilsen
>
> Frede Aakmann T?gersen
> Specialist, M.Sc., Ph.D.
> Plant Performance & Modeling
>
> Technology & Service Solutions
> T +45 9730 5135
> M +45 2547 6050
> frtog at vestas.com
> http://www.vestas.com
>
> Company reg. name: Vestas Wind Systems A/S
> This e-mail is subject to our e-mail disclaimer statement.
> Please refer to www.vestas.com/legal/notice
> If you have received this e-mail in error please contact the sender.
>
>
>
> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> Roger Bivand
> Sent: 3. juni 2015 11:21
> To: Michael Sumner
> Cc: r-sig-geo
> Subject: Re: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
> their means
>
> On Wed, 3 Jun 2015, Michael Sumner wrote:
>
> > On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> >> On Tue, 2 Jun 2015, chris english wrote:
> >>
> >>> Roger,
> >>>
> >>> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
> >> based
> >>> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with
> R
> >>> and was disappointed that I couldn't use  2.0.0.beta  because at the
> >> point
> >>> only sp-1.1-1 was supported.
> >>
> >> Chris,
> >>
> >> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that
> it
> >> makes the code base easier to maintain because only the GDAL driver
> >> manager is supported, and vector drivers have been folded into the same
> >> model. Beyond that, we have continuing feature creep (e.g. use of
> >> Integer64 to hold IDs that notionally should be strings (no arithmetic)
> >> and which always lose leading zeros, and others. The key challenge
> >> (threat) to GDAL is the very limited number of core developers, followed
> >> by the same danger affecting many of GDAL's external dependencies.
> >>
> >> General comment: Could someone who knows how to do it please set up a
> >> searchable scribble sheet to which ordered examples, open issues, ideas,
> >> etc. could be contributed? This thread is now the prime location, but
> >> probably will become unwieldy.
> >>
> >>
> > What about MoPad?
> > https://etherpad.mozilla.org/8bU6hpr0YY
>
> OK, thanks, I've added som comments. I've also removed the
> trunk/tags/branch structure on R-Forge, so
>
> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg
>
> does a clean checkout that can be updated, but should be put in an rgdal
> folder to avoid splatter.
>
> Roger
>
> >
> > I set up a repo in github too but that might not be of interest since we
> > need pull-requests, forks etc.
> >
> > https://github.com/mdsumner/rgdal_scribblesheet
> >
> > Happy to help with any of this in whatever way people prefer.
> >
> > Cheers, Mike.
> >
> >
> >
> >> You will never be able to switch easily between rgdal installed against
> >> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
> >> available to those installing GDAL from source, then rgdal from source,
> as
> >> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
> >> --prefix= is the same. If --prefix= is different between 1 and 2 when
> >> installing GDAL, and you take care with LD path names and use of
> ldconfig,
> >> you can pass these different locations of GDAL 1 and GDAL 2 through when
> >> installing rgdal. Then you'd also have to remember to install rgdal for
> >> GDAL 1 in say one R library folder, for GDAL 2 in a different library
> >> folder, and add the appropriate one to .libPaths(). It would be messy.
> >>
> >> Performance-wise, there should be no user-impacting difference between
> >> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
> >> 0.9-3), which blocks GDAL 2.
> >>
> >> The task now is to locate possible differences in behaviour between
> rgdal
> >> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
> >> 1|2 differences, are they because of changes in GDAL, or because rgdal
> was
> >> making inappropriate assumptions about GDAL?
> >>
> >> So far, we really don't know the Integer64 field type in GDAL 2 vectors
> is
> >> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
> >> know how the changes in the driver manager for vector dsn and layers
> >> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
> >> GDAL 2, and apparently different behaviour for some drivers). Writing
> >> MapInfo File TAB files looks broken (maybe a dsn creation option needs
> >> setting, when it wasn't needed before), etc.
> >>
> >> Some of this can be fixed by nasty kludges in rgdal, some should be
> fixed
> >> in GDAL 2, some are real misunderstandings. I don't have the time to try
> >> to make an rgdal Windows binary built against Windows GDAL 2 by
> >> cross-compiling for trying things out under Windows without user
> >> compilation. The transition will take time, but anyone who can install
> >> GDAL and rgdal from source, and who is interested and/or needs rgdal to
> >> work predictably, is welcome to run some standard procedures with rgdal
> >> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
> >> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and
> living
> >> under pkg/:
> >>
> >> #cd rgdal
> >> R CMD build pkg
> >> R CMD check rgdal_1.0-2.tar.gz
> >> # maybe --install-args='--configure.args=...'
> >> R CMD INSTALL rgdal_1.0-2.tar.gz
> >> # maybe --configure.args=...
> >>
> >> rerun the procedure and compare the results to see whether changes in
> >> rgdal have led to changes in the results, the re-install rgdal 1.0-2
> with
> >> GDAL 2, rerun the procedure and compare the results, and compare those
> for
> >> GDAL 1 and GDAL 2.
> >>
> >> In particular, we need confirmation that the database access drivers
> work
> >> across these shifts.
> >>
> >> Roger
> >>
> >>>
> >>> I have a couple of future projects that are going to fundamentally
> depend
> >>> on GDAL and I hope to be able to address them from within R.  As an R
> >>> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
> >>> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
> >> and
> >>> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
> >>> been making a diary of R success(es).
> >>>
> >>> In the simplest case it could be a reminder to us beginners how we
> might
> >>> load a library(rgdal("in this case 2.0.0.beta vs our normal
> >>> library(rgdal)).  Well we are beginners, but we still want out stuff to
> >>> work and we want to contribute to a successful and comprehensive 2.2.0
> >>> release. So we'll run our particular research examples through 2.0.0
> and
> >>> report results, if we know how to load one vs. another library.
> >>>
> >>> If intermediate or expert, different examples would be deployed.
> >>>
> >>> I apologize in advance if these issues  or methods have already been
> >>> addressed at SVN and I failed to notice them.  If that is the case I
> will
> >>> dig further, and please ignore me.
> >>>
> >>> I think GDAL and rgdal are intrinsically important tools to this
> >> community
> >>> and everyone wants them to work; please just tell us, by general
> example,
> >>> how we might be best of service.
> >>>
> >>> I hope the foregoing is comprehensible. My thoughts, and looking
> forward
> >> to
> >>> to contributing in a useful fashion to this important package (as a
> >>> beginner).
> >>>
> >>> Cheers,
> >>>
> >>> Chris
> >>>
> >>>
> >>> The second beta of GDAL 2 is now available, and as of revision 535 on
> >>>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
> >>>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
> >>>>
> >>>> One or two issues are known (Integer64 in vector fields and FIDs not
> >>>> supported in R; gdalDrivers() reports both raster and vector drivers;
> >> the
> >>>> MapInfo File TAB driver doesn't work for writing, ...), but others
> >> remain
> >>>> to be discovered.
> >>>>
> >>>> For those who need rgdal in production, and can install the 2.0.0
> beta,
> >> it
> >>>> would be a really good use of time to identify issues now, rather than
> >> when
> >>>> GDAL 2 starts to become the standard, stable release. Anyone else
> >> needing
> >>>> an itch to scratch is also, of course, welcome to contribute.
> >>>>
> >>>> The rgdal package will continue to condition on GDAL 1 or 2, so
> >> hopefully
> >>>> those users who do not need to move to GDAL 2 will not be affected.
> >>>> However, it is worth noting that GDAL is maintained by very, very, few
> >>>> volunteers (even plural is questionable here), and when they feel that
> >>>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
> >> important
> >>>> things, you will be stranded with EOL software.
> >>>>
> >>>> So please consider taking the time to contribute to the idenfication
> of
> >>>> issues in the development version of rgdal built against GDAL 2 and/or
> >> 1,
> >>>> available for anonymous SVN checkout at:
> >>>>
> >>>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
> >>>>
> >>>> Enjoy!
> >>>>
> >>>> Roger
> >>>>
> >>>> --
> >>>> Roger Bivand
> >>>> Department of Economics, Norwegian School of Economics,
> >>>> Helleveien 30, N-5045 Bergen, Norway.
> >>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
> >>>> e-mail: Roger.Bivand at nhh.no
> >>>>
> >>>> _______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at r-project.org
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>>
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; fax +47 55 95 91 00
> >> e-mail: Roger.Bivand at nhh.no
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jun  3 15:08:37 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jun 2015 15:08:37 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
In-Reply-To: <CAASFQpRO=LNnWajEOt0v-hY5Hq=66Y4oiadFcQLM8c-hvHJbkA@mail.gmail.com>
References: <CAASFQpR8Kw9--ok3KertH-Aqenyrm_GNyGhktXcEOq-o+je6Lg@mail.gmail.com>
	<alpine.LFD.2.11.1506030837360.22371@reclus.nhh.no>
	<CAAcGz98eZ7UKDCNhu+m7gbLXaq-yhLX1kCrqs+J8hj8BK2tiNw@mail.gmail.com>
	<alpine.LFD.2.11.1506031118330.28754@reclus.nhh.no>
	<B078CDF40DFE4045AF172A8B4F68FC485886848CDA@DKRDSEXC016.vestas.net>
	<CAASFQpRO=LNnWajEOt0v-hY5Hq=66Y4oiadFcQLM8c-hvHJbkA@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1506031504410.7553@reclus.nhh.no>

In case problems persist, a copy of the source tarball is at:

http://spatial.nhh.no/R/rgdal/rgdal_1.0-2.tar.gz

However, SVN access is easier as updating the local copy is simpler than 
downloading again, if we need to interact in fixing bugs.

Roger

On Wed, 3 Jun 2015, chris english wrote:

> Successful linux download an hour ago.
>
> Chris
>
> On Wed, Jun 3, 2015 at 8:33 AM, Frede Aakmann T?gersen <frtog at vestas.com>
> wrote:
>
>> Hi
>>
>> Anyone else having problem with checking out the repos?
>>
>> On my Windows box:
>>
>> Command: Checkout from svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg,
>> revision HEAD, Fully recursive, Externals included
>> Error: Unable to connect to a repository at URL
>> Error:  'svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg'
>> Error: Can't connect to host 'scm.r-forge.r-project.org': No connection
>> could be made
>> Error:  because the target machine actively refused it.
>> Completed!:
>>
>>
>> On our cluster:
>>
>> [frtog at dkrdsfshn2 ~]$ svn checkout svn://
>> scm.r-forge.r-project.org/svnroot/rgdal/pkg rgdal
>> svn: Can't connect to host 'scm.r-forge.r-project.org': Connection refused
>> [frtog at dkrdsfshn2 ~]$
>>
>> So no anonymous access?
>>
>>
>> Yours sincerely / Med venlig hilsen
>>
>> Frede Aakmann T?gersen
>> Specialist, M.Sc., Ph.D.
>> Plant Performance & Modeling
>>
>> Technology & Service Solutions
>> T +45 9730 5135
>> M +45 2547 6050
>> frtog at vestas.com
>> http://www.vestas.com
>>
>> Company reg. name: Vestas Wind Systems A/S
>> This e-mail is subject to our e-mail disclaimer statement.
>> Please refer to www.vestas.com/legal/notice
>> If you have received this e-mail in error please contact the sender.
>>
>>
>>
>> -----Original Message-----
>> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
>> Roger Bivand
>> Sent: 3. juni 2015 11:21
>> To: Michael Sumner
>> Cc: r-sig-geo
>> Subject: Re: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
>> their means
>>
>> On Wed, 3 Jun 2015, Michael Sumner wrote:
>>
>>> On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Tue, 2 Jun 2015, chris english wrote:
>>>>
>>>>> Roger,
>>>>>
>>>>> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
>>>> based
>>>>> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with
>> R
>>>>> and was disappointed that I couldn't use  2.0.0.beta  because at the
>>>> point
>>>>> only sp-1.1-1 was supported.
>>>>
>>>> Chris,
>>>>
>>>> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that
>> it
>>>> makes the code base easier to maintain because only the GDAL driver
>>>> manager is supported, and vector drivers have been folded into the same
>>>> model. Beyond that, we have continuing feature creep (e.g. use of
>>>> Integer64 to hold IDs that notionally should be strings (no arithmetic)
>>>> and which always lose leading zeros, and others. The key challenge
>>>> (threat) to GDAL is the very limited number of core developers, followed
>>>> by the same danger affecting many of GDAL's external dependencies.
>>>>
>>>> General comment: Could someone who knows how to do it please set up a
>>>> searchable scribble sheet to which ordered examples, open issues, ideas,
>>>> etc. could be contributed? This thread is now the prime location, but
>>>> probably will become unwieldy.
>>>>
>>>>
>>> What about MoPad?
>>> https://etherpad.mozilla.org/8bU6hpr0YY
>>
>> OK, thanks, I've added som comments. I've also removed the
>> trunk/tags/branch structure on R-Forge, so
>>
>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg
>>
>> does a clean checkout that can be updated, but should be put in an rgdal
>> folder to avoid splatter.
>>
>> Roger
>>
>>>
>>> I set up a repo in github too but that might not be of interest since we
>>> need pull-requests, forks etc.
>>>
>>> https://github.com/mdsumner/rgdal_scribblesheet
>>>
>>> Happy to help with any of this in whatever way people prefer.
>>>
>>> Cheers, Mike.
>>>
>>>
>>>
>>>> You will never be able to switch easily between rgdal installed against
>>>> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
>>>> available to those installing GDAL from source, then rgdal from source,
>> as
>>>> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
>>>> --prefix= is the same. If --prefix= is different between 1 and 2 when
>>>> installing GDAL, and you take care with LD path names and use of
>> ldconfig,
>>>> you can pass these different locations of GDAL 1 and GDAL 2 through when
>>>> installing rgdal. Then you'd also have to remember to install rgdal for
>>>> GDAL 1 in say one R library folder, for GDAL 2 in a different library
>>>> folder, and add the appropriate one to .libPaths(). It would be messy.
>>>>
>>>> Performance-wise, there should be no user-impacting difference between
>>>> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
>>>> 0.9-3), which blocks GDAL 2.
>>>>
>>>> The task now is to locate possible differences in behaviour between
>> rgdal
>>>> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
>>>> 1|2 differences, are they because of changes in GDAL, or because rgdal
>> was
>>>> making inappropriate assumptions about GDAL?
>>>>
>>>> So far, we really don't know the Integer64 field type in GDAL 2 vectors
>> is
>>>> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
>>>> know how the changes in the driver manager for vector dsn and layers
>>>> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
>>>> GDAL 2, and apparently different behaviour for some drivers). Writing
>>>> MapInfo File TAB files looks broken (maybe a dsn creation option needs
>>>> setting, when it wasn't needed before), etc.
>>>>
>>>> Some of this can be fixed by nasty kludges in rgdal, some should be
>> fixed
>>>> in GDAL 2, some are real misunderstandings. I don't have the time to try
>>>> to make an rgdal Windows binary built against Windows GDAL 2 by
>>>> cross-compiling for trying things out under Windows without user
>>>> compilation. The transition will take time, but anyone who can install
>>>> GDAL and rgdal from source, and who is interested and/or needs rgdal to
>>>> work predictably, is welcome to run some standard procedures with rgdal
>>>> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
>>>> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and
>> living
>>>> under pkg/:
>>>>
>>>> #cd rgdal
>>>> R CMD build pkg
>>>> R CMD check rgdal_1.0-2.tar.gz
>>>> # maybe --install-args='--configure.args=...'
>>>> R CMD INSTALL rgdal_1.0-2.tar.gz
>>>> # maybe --configure.args=...
>>>>
>>>> rerun the procedure and compare the results to see whether changes in
>>>> rgdal have led to changes in the results, the re-install rgdal 1.0-2
>> with
>>>> GDAL 2, rerun the procedure and compare the results, and compare those
>> for
>>>> GDAL 1 and GDAL 2.
>>>>
>>>> In particular, we need confirmation that the database access drivers
>> work
>>>> across these shifts.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> I have a couple of future projects that are going to fundamentally
>> depend
>>>>> on GDAL and I hope to be able to address them from within R.  As an R
>>>>> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
>>>>> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
>>>> and
>>>>> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
>>>>> been making a diary of R success(es).
>>>>>
>>>>> In the simplest case it could be a reminder to us beginners how we
>> might
>>>>> load a library(rgdal("in this case 2.0.0.beta vs our normal
>>>>> library(rgdal)).  Well we are beginners, but we still want out stuff to
>>>>> work and we want to contribute to a successful and comprehensive 2.2.0
>>>>> release. So we'll run our particular research examples through 2.0.0
>> and
>>>>> report results, if we know how to load one vs. another library.
>>>>>
>>>>> If intermediate or expert, different examples would be deployed.
>>>>>
>>>>> I apologize in advance if these issues  or methods have already been
>>>>> addressed at SVN and I failed to notice them.  If that is the case I
>> will
>>>>> dig further, and please ignore me.
>>>>>
>>>>> I think GDAL and rgdal are intrinsically important tools to this
>>>> community
>>>>> and everyone wants them to work; please just tell us, by general
>> example,
>>>>> how we might be best of service.
>>>>>
>>>>> I hope the foregoing is comprehensible. My thoughts, and looking
>> forward
>>>> to
>>>>> to contributing in a useful fashion to this important package (as a
>>>>> beginner).
>>>>>
>>>>> Cheers,
>>>>>
>>>>> Chris
>>>>>
>>>>>
>>>>> The second beta of GDAL 2 is now available, and as of revision 535 on
>>>>>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>>>>>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>>>>>
>>>>>> One or two issues are known (Integer64 in vector fields and FIDs not
>>>>>> supported in R; gdalDrivers() reports both raster and vector drivers;
>>>> the
>>>>>> MapInfo File TAB driver doesn't work for writing, ...), but others
>>>> remain
>>>>>> to be discovered.
>>>>>>
>>>>>> For those who need rgdal in production, and can install the 2.0.0
>> beta,
>>>> it
>>>>>> would be a really good use of time to identify issues now, rather than
>>>> when
>>>>>> GDAL 2 starts to become the standard, stable release. Anyone else
>>>> needing
>>>>>> an itch to scratch is also, of course, welcome to contribute.
>>>>>>
>>>>>> The rgdal package will continue to condition on GDAL 1 or 2, so
>>>> hopefully
>>>>>> those users who do not need to move to GDAL 2 will not be affected.
>>>>>> However, it is worth noting that GDAL is maintained by very, very, few
>>>>>> volunteers (even plural is questionable here), and when they feel that
>>>>>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
>>>> important
>>>>>> things, you will be stranded with EOL software.
>>>>>>
>>>>>> So please consider taking the time to contribute to the idenfication
>> of
>>>>>> issues in the development version of rgdal built against GDAL 2 and/or
>>>> 1,
>>>>>> available for anonymous SVN checkout at:
>>>>>>
>>>>>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>>>>>
>>>>>> Enjoy!
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From btupper at bigelow.org  Wed Jun  3 15:55:22 2015
From: btupper at bigelow.org (Ben Tupper)
Date: Wed, 3 Jun 2015 09:55:22 -0400
Subject: [R-sig-Geo] OSX, rgdal, GDAL drivers and HDF4
In-Reply-To: <D19365A4.2784F%swalbridge@esri.com>
References: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>
	<D19365A4.2784F%swalbridge@esri.com>
Message-ID: <FD7DD841-5CB6-45FD-8591-761BD74C0BC0@bigelow.org>

Hi,

On Jun 2, 2015, at 1:56 PM, Shaun Walbridge <SWalbridge at esri.com> wrote:

> Have you tried with the homebrew project? HDF4 isn?t a default supported
> driver, but it?s easy enough to add:
> 
>  brew install hdf4
>  # prefer hdf4 links over NetCDF
>  brew link --overwrite hdf4
>  brew install gdal --complete --enable-unsupported --with-hdf4
> 
>  # check what drivers are installed, list should include ?hdf4?:
>  gdal-config --formats
> 
> I?d use that as a starting point.
> 

Thanks!  I have not used brew before but it seems like it should be easy, or will be as soon as I figure out what this means...

ben at gale ~ $ brew install hdf4
Error: No available formula for hdf4 
Searching formulae...
Searching taps...
homebrew/versions/hdf4


Cheers,
Ben



> Cheers,
> Shaun
> 
> 
> 
> On 6/2/15, 12:11 PM, "Ben Tupper" <btupper at bigelow.org> wrote:
> 
>> Hello,
>> 
>> This is my attempt to look before I leap into installing GDAL on OSX.
>> (You can probably hear my pitiful groaning and knee-knocking in the
>> background.)
>> 
>> I want to read many HDF4 files for which I do not have the GDAL HDF4
>> driver installed.  I used William Kyngesburye's nice framework
>> (http://www.kyngchaos.com/software:frameworks) to install GDAL but it
>> came without the HDF4 driver.
>> 
>> Reading this somewhat dated exchange...
>> 
>> http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-td6750856.html
>> 
>> ... I think I understand that if I want the HDF4 driver I must build GDAL
>> on my system manually.  Is my understanding correct, or is there another
>> (easier) way to read HDF4 files directly in R?
>> 
>> Thanks!
>> Ben
>> 
>> 
>>> library(rgdal)
>> Loading required package: sp
>> rgdal: version: 0.9-3, (SVN revision 530)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
>> Path to GDAL shared files:
>> /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/gdal
>> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>> Path to PROJ.4 shared files:
>> /Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/proj
>> Linking to sp version: 1.1-0
>>> x <- gdalDrivers()
>>> any(x$name %in% c("HDF4", "HDF"))
>> [1] FALSE
>> 
>>> sessionInfo()
>> R version 3.2.0 (2015-04-16)
>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> Running under: OS X 10.9.5 (Mavericks)
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> other attached packages:
>> [1] rgdal_0.9-3 sp_1.1-0
>> 
>> loaded via a namespace (and not attached):
>> [1] grid_3.2.0      lattice_0.20-31
>> 
>> 
>> 
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From frtog at vestas.com  Wed Jun  3 16:24:45 2015
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Wed, 3 Jun 2015 16:24:45 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
 their means
Message-ID: <690xli1g10f9an534j8lao61.1433341480957@email.android.com>

Okay, it seems to be an issue on our side. I'll get some help from our sysadmin at least on the linux cluster.

Br. Frede


Sendt fra Samsung mobil


-------- Oprindelig meddelelse --------
Fra: Roger Bivand
Dato:03/06/2015 15.10 (GMT+01:00)
Til: chris english
Cc: Frede Aakmann T?gersen ,Michael Sumner ,r-sig-geo
Emne: Re: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to their means

In case problems persist, a copy of the source tarball is at:

http://spatial.nhh.no/R/rgdal/rgdal_1.0-2.tar.gz

However, SVN access is easier as updating the local copy is simpler than
downloading again, if we need to interact in fixing bugs.

Roger

On Wed, 3 Jun 2015, chris english wrote:

> Successful linux download an hour ago.
>
> Chris
>
> On Wed, Jun 3, 2015 at 8:33 AM, Frede Aakmann T?gersen <frtog at vestas.com>
> wrote:
>
>> Hi
>>
>> Anyone else having problem with checking out the repos?
>>
>> On my Windows box:
>>
>> Command: Checkout from svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg,
>> revision HEAD, Fully recursive, Externals included
>> Error: Unable to connect to a repository at URL
>> Error:  'svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg'
>> Error: Can't connect to host 'scm.r-forge.r-project.org': No connection
>> could be made
>> Error:  because the target machine actively refused it.
>> Completed!:
>>
>>
>> On our cluster:
>>
>> [frtog at dkrdsfshn2 ~]$ svn checkout svn://
>> scm.r-forge.r-project.org/svnroot/rgdal/pkg rgdal
>> svn: Can't connect to host 'scm.r-forge.r-project.org': Connection refused
>> [frtog at dkrdsfshn2 ~]$
>>
>> So no anonymous access?
>>
>>
>> Yours sincerely / Med venlig hilsen
>>
>> Frede Aakmann T?gersen
>> Specialist, M.Sc., Ph.D.
>> Plant Performance & Modeling
>>
>> Technology & Service Solutions
>> T +45 9730 5135
>> M +45 2547 6050
>> frtog at vestas.com
>> http://www.vestas.com
>>
>> Company reg. name: Vestas Wind Systems A/S
>> This e-mail is subject to our e-mail disclaimer statement.
>> Please refer to www.vestas.com/legal/notice<http://www.vestas.com/legal/notice>
>> If you have received this e-mail in error please contact the sender.
>>
>>
>>
>> -----Original Message-----
>> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
>> Roger Bivand
>> Sent: 3. juni 2015 11:21
>> To: Michael Sumner
>> Cc: r-sig-geo
>> Subject: Re: [R-sig-Geo] Pre-GDAL 2: rgdal changes - from all according to
>> their means
>>
>> On Wed, 3 Jun 2015, Michael Sumner wrote:
>>
>>> On Wed, 3 Jun 2015 at 17:14 Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Tue, 2 Jun 2015, chris english wrote:
>>>>
>>>>> Roger,
>>>>>
>>>>> I second Michael Sumner's excitement. I built a POSTGist SFCGAL stack
>>>> based
>>>>> on GDAL 2.0.0beta, anticipating that I could seamlessly integrate with
>> R
>>>>> and was disappointed that I couldn't use  2.0.0.beta  because at the
>>>> point
>>>>> only sp-1.1-1 was supported.
>>>>
>>>> Chris,
>>>>
>>>> Excitement doesn't help. GDAL 2 is only an advance over GDAL 1 in that
>> it
>>>> makes the code base easier to maintain because only the GDAL driver
>>>> manager is supported, and vector drivers have been folded into the same
>>>> model. Beyond that, we have continuing feature creep (e.g. use of
>>>> Integer64 to hold IDs that notionally should be strings (no arithmetic)
>>>> and which always lose leading zeros, and others. The key challenge
>>>> (threat) to GDAL is the very limited number of core developers, followed
>>>> by the same danger affecting many of GDAL's external dependencies.
>>>>
>>>> General comment: Could someone who knows how to do it please set up a
>>>> searchable scribble sheet to which ordered examples, open issues, ideas,
>>>> etc. could be contributed? This thread is now the prime location, but
>>>> probably will become unwieldy.
>>>>
>>>>
>>> What about MoPad?
>>> https://etherpad.mozilla.org/8bU6hpr0YY
>>
>> OK, thanks, I've added som comments. I've also removed the
>> trunk/tags/branch structure on R-Forge, so
>>
>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/pkg
>>
>> does a clean checkout that can be updated, but should be put in an rgdal
>> folder to avoid splatter.
>>
>> Roger
>>
>>>
>>> I set up a repo in github too but that might not be of interest since we
>>> need pull-requests, forks etc.
>>>
>>> https://github.com/mdsumner/rgdal_scribblesheet
>>>
>>> Happy to help with any of this in whatever way people prefer.
>>>
>>> Cheers, Mike.
>>>
>>>
>>>
>>>> You will never be able to switch easily between rgdal installed against
>>>> GDAL 1 and rgdal installed against GDAL 2. Any possibilities are only
>>>> available to those installing GDAL from source, then rgdal from source,
>> as
>>>> GDAL 2 overwrites GDAL 1 (same name for gdal-config, same app names) if
>>>> --prefix= is the same. If --prefix= is different between 1 and 2 when
>>>> installing GDAL, and you take care with LD path names and use of
>> ldconfig,
>>>> you can pass these different locations of GDAL 1 and GDAL 2 through when
>>>> installing rgdal. Then you'd also have to remember to install rgdal for
>>>> GDAL 1 in say one R library folder, for GDAL 2 in a different library
>>>> folder, and add the appropriate one to .libPaths(). It would be messy.
>>>>
>>>> Performance-wise, there should be no user-impacting difference between
>>>> GDAL 1 and 2, or between rgdal opening for GDAL 1 or 2, and rgdal (<=
>>>> 0.9-3), which blocks GDAL 2.
>>>>
>>>> The task now is to locate possible differences in behaviour between
>> rgdal
>>>> 0.9-3 with GDAL 1, and rgdal 1.0-2 with either GDAL 1 or 2. If there are
>>>> 1|2 differences, are they because of changes in GDAL, or because rgdal
>> was
>>>> making inappropriate assumptions about GDAL?
>>>>
>>>> So far, we really don't know the Integer64 field type in GDAL 2 vectors
>> is
>>>> going to play out - as of now rgdal 1.0-2 truncates to integer. We don't
>>>> know how the changes in the driver manager for vector dsn and layers
>>>> affect layer and dsn overwriting (I'm seeing very odd OGRErr numbers in
>>>> GDAL 2, and apparently different behaviour for some drivers). Writing
>>>> MapInfo File TAB files looks broken (maybe a dsn creation option needs
>>>> setting, when it wasn't needed before), etc.
>>>>
>>>> Some of this can be fixed by nasty kludges in rgdal, some should be
>> fixed
>>>> in GDAL 2, some are real misunderstandings. I don't have the time to try
>>>> to make an rgdal Windows binary built against Windows GDAL 2 by
>>>> cross-compiling for trying things out under Windows without user
>>>> compilation. The transition will take time, but anyone who can install
>>>> GDAL and rgdal from source, and who is interested and/or needs rgdal to
>>>> work predictably, is welcome to run some standard procedures with rgdal
>>>> 0.9-3 and GDAL 1, storing a text version of key results; install rgdal
>>>> 1.0-2 (or later) and GDAL 1 (or later checked out from R-Forge and
>> living
>>>> under pkg/:
>>>>
>>>> #cd rgdal
>>>> R CMD build pkg
>>>> R CMD check rgdal_1.0-2.tar.gz
>>>> # maybe --install-args='--configure.args=...'
>>>> R CMD INSTALL rgdal_1.0-2.tar.gz
>>>> # maybe --configure.args=...
>>>>
>>>> rerun the procedure and compare the results to see whether changes in
>>>> rgdal have led to changes in the results, the re-install rgdal 1.0-2
>> with
>>>> GDAL 2, rerun the procedure and compare the results, and compare those
>> for
>>>> GDAL 1 and GDAL 2.
>>>>
>>>> In particular, we need confirmation that the database access drivers
>> work
>>>> across these shifts.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> I have a couple of future projects that are going to fundamentally
>> depend
>>>>> on GDAL and I hope to be able to address them from within R.  As an R
>>>>> beginner I'm happy I have in my notes on how to point to my /opt/gdal(
>>>>> please excuse if generalizing between an installed /opt/gdal(2.0,0.beta
>>>> and
>>>>> /usr/local/gdal(earlier.build)  build, but many people perhaps have not
>>>>> been making a diary of R success(es).
>>>>>
>>>>> In the simplest case it could be a reminder to us beginners how we
>> might
>>>>> load a library(rgdal("in this case 2.0.0.beta vs our normal
>>>>> library(rgdal)).  Well we are beginners, but we still want out stuff to
>>>>> work and we want to contribute to a successful and comprehensive 2.2.0
>>>>> release. So we'll run our particular research examples through 2.0.0
>> and
>>>>> report results, if we know how to load one vs. another library.
>>>>>
>>>>> If intermediate or expert, different examples would be deployed.
>>>>>
>>>>> I apologize in advance if these issues  or methods have already been
>>>>> addressed at SVN and I failed to notice them.  If that is the case I
>> will
>>>>> dig further, and please ignore me.
>>>>>
>>>>> I think GDAL and rgdal are intrinsically important tools to this
>>>> community
>>>>> and everyone wants them to work; please just tell us, by general
>> example,
>>>>> how we might be best of service.
>>>>>
>>>>> I hope the foregoing is comprehensible. My thoughts, and looking
>> forward
>>>> to
>>>>> to contributing in a useful fashion to this important package (as a
>>>>> beginner).
>>>>>
>>>>> Cheers,
>>>>>
>>>>> Chris
>>>>>
>>>>>
>>>>> The second beta of GDAL 2 is now available, and as of revision 535 on
>>>>>> R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>>>>>> 1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>>>>>>
>>>>>> One or two issues are known (Integer64 in vector fields and FIDs not
>>>>>> supported in R; gdalDrivers() reports both raster and vector drivers;
>>>> the
>>>>>> MapInfo File TAB driver doesn't work for writing, ...), but others
>>>> remain
>>>>>> to be discovered.
>>>>>>
>>>>>> For those who need rgdal in production, and can install the 2.0.0
>> beta,
>>>> it
>>>>>> would be a really good use of time to identify issues now, rather than
>>>> when
>>>>>> GDAL 2 starts to become the standard, stable release. Anyone else
>>>> needing
>>>>>> an itch to scratch is also, of course, welcome to contribute.
>>>>>>
>>>>>> The rgdal package will continue to condition on GDAL 1 or 2, so
>>>> hopefully
>>>>>> those users who do not need to move to GDAL 2 will not be affected.
>>>>>> However, it is worth noting that GDAL is maintained by very, very, few
>>>>>> volunteers (even plural is questionable here), and when they feel that
>>>>>> backporting fixed from GDAL 2 to GDAL 1 is taking time from more
>>>> important
>>>>>> things, you will be stranded with EOL software.
>>>>>>
>>>>>> So please consider taking the time to contribute to the idenfication
>> of
>>>>>> issues in the development version of rgdal built against GDAL 2 and/or
>>>> 1,
>>>>>> available for anonymous SVN checkout at:
>>>>>>
>>>>>> svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>>>>>>
>>>>>> Enjoy!
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

	[[alternative HTML version deleted]]


From donfouetz at yahoo.fr  Wed Jun  3 23:26:11 2015
From: donfouetz at yahoo.fr (Hermann Pythagore DONFOUET)
Date: Wed, 3 Jun 2015 21:26:11 +0000 (UTC)
Subject: [R-sig-Geo] Request about creating spatial weight matrix
Message-ID: <1175524273.7330798.1433366771806.JavaMail.yahoo@mail.yahoo.com>

Dear R experts,

I'm contacting about creating a spatial weight matrix in R software which takes the value one if households belong to the same village and zero otherwise. I do have six villages and 369 households scattered in those villages. The intuition is that households belonging to the same village will behave the same. Thus, my spatial weight matrix of 369x369 will be like a social network matrix taking the value one if households belong to the same village and otherwise. I also want to standardise this spatial weight matrix.



Regards

Hermann , post-doc fellow in INRA, France

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jun  3 23:34:05 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 3 Jun 2015 23:34:05 +0200
Subject: [R-sig-Geo] Request about creating spatial weight matrix
In-Reply-To: <1175524273.7330798.1433366771806.JavaMail.yahoo@mail.yahoo.com>
References: <1175524273.7330798.1433366771806.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <alpine.LFD.2.11.1506032332460.14589@reclus.nhh.no>

On Wed, 3 Jun 2015, Hermann Pythagore DONFOUET wrote:

> Dear R experts,
>
> I'm contacting about creating a spatial weight matrix in R software 
> which takes the value one if households belong to the same village and 
> zero otherwise. I do have six villages and 369 households scattered in 
> those villages. The intuition is that households belonging to the same 
> village will behave the same. Thus, my spatial weight matrix of 369x369 
> will be like a social network matrix taking the value one if households 
> belong to the same village and otherwise. I also want to standardise 
> this spatial weight matrix.

?spdep::nb2blocknb

Roger

>
>
>
> Regards
>
> Hermann , post-doc fellow in INRA, France
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From katharine.walter at yale.edu  Wed Jun  3 23:34:52 2015
From: katharine.walter at yale.edu (Katharine Walter)
Date: Wed, 3 Jun 2015 17:34:52 -0400
Subject: [R-sig-Geo] Stplot for discrete data
Message-ID: <CACAXSaVi01Gff7QfQ43Nras7mye6-Ac03bDLnwefXY-=hYRAQw@mail.gmail.com>

Hi, I am trying to use the spacetime package to plot a timeseries of
discrete data.  My dataset consists of the values: 0, 1, NA.  Is there a
way to plot each value in a different color and construct a key indicating
these discrete values?

I am plotting with the following command which automatically generates a
color ramp from 0 to 1: stplot(stfdf[,,"report"], names.attr=year).

Thank you for your help and for providing an excellent package.

Best,

	[[alternative HTML version deleted]]


From SWalbridge at esri.com  Thu Jun  4 04:39:09 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Thu, 4 Jun 2015 02:39:09 +0000
Subject: [R-sig-Geo] OSX, rgdal, GDAL drivers and HDF4
In-Reply-To: <FD7DD841-5CB6-45FD-8591-761BD74C0BC0@bigelow.org>
References: <ABD5F46B-236F-490D-84FA-EAD90728670A@bigelow.org>
	<D19365A4.2784F%swalbridge@esri.com>
	<FD7DD841-5CB6-45FD-8591-761BD74C0BC0@bigelow.org>
Message-ID: <D195319F.27901%swalbridge@esri.com>

I missed a step -- first you'll need to add Homebrew-versions [1], which
provides older releases of existing packages:

  brew tap homebrew/versions

The commands listed should then work.

1. https://github.com/Homebrew/homebrew-versions
-- 
Shaun Walbridge
GIS Developer
c: 805.722.9025 t: @scw <http://twitter.com/scw>



On 6/3/15, 9:55 AM, "Ben Tupper" <btupper at bigelow.org> wrote:

>Hi,
>
>On Jun 2, 2015, at 1:56 PM, Shaun Walbridge <SWalbridge at esri.com> wrote:
>
>> Have you tried with the homebrew project? HDF4 isn?t a default supported
>> driver, but it?s easy enough to add:
>> 
>>  brew install hdf4
>>  # prefer hdf4 links over NetCDF
>>  brew link --overwrite hdf4
>>  brew install gdal --complete --enable-unsupported --with-hdf4
>> 
>>  # check what drivers are installed, list should include ?hdf4?:
>>  gdal-config --formats
>> 
>> I?d use that as a starting point.
>> 
>
>Thanks!  I have not used brew before but it seems like it should be easy,
>or will be as soon as I figure out what this means...
>
>ben at gale ~ $ brew install hdf4
>Error: No available formula for hdf4
>Searching formulae...
>Searching taps...
>homebrew/versions/hdf4
>
>
>Cheers,
>Ben
>
>
>
>> Cheers,
>> Shaun
>> 
>> 
>> 
>> On 6/2/15, 12:11 PM, "Ben Tupper" <btupper at bigelow.org> wrote:
>> 
>>> Hello,
>>> 
>>> This is my attempt to look before I leap into installing GDAL on OSX.
>>> (You can probably hear my pitiful groaning and knee-knocking in the
>>> background.)
>>> 
>>> I want to read many HDF4 files for which I do not have the GDAL HDF4
>>> driver installed.  I used William Kyngesburye's nice framework
>>> (http://www.kyngchaos.com/software:frameworks) to install GDAL but it
>>> came without the HDF4 driver.
>>> 
>>> Reading this somewhat dated exchange...
>>> 
>>> http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-td6750856.html
>>> 
>>> ... I think I understand that if I want the HDF4 driver I must build
>>>GDAL
>>> on my system manually.  Is my understanding correct, or is there
>>>another
>>> (easier) way to read HDF4 files directly in R?
>>> 
>>> Thanks!
>>> Ben
>>> 
>>> 
>>>> library(rgdal)
>>> Loading required package: sp
>>> rgdal: version: 0.9-3, (SVN revision 530)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
>>> Path to GDAL shared files:
>>> 
>>>/Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/gda
>>>l
>>> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>>> Path to PROJ.4 shared files:
>>> 
>>>/Library/Frameworks/R.framework/Versions/3.2/Resources/library/rgdal/pro
>>>j
>>> Linking to sp version: 1.1-0
>>>> x <- gdalDrivers()
>>>> any(x$name %in% c("HDF4", "HDF"))
>>> [1] FALSE
>>> 
>>>> sessionInfo()
>>> R version 3.2.0 (2015-04-16)
>>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>>> Running under: OS X 10.9.5 (Mavericks)
>>> 
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> 
>>> other attached packages:
>>> [1] rgdal_0.9-3 sp_1.1-0
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.2.0      lattice_0.20-31
>>> 
>>> 
>>> 
>>> Ben Tupper
>>> Bigelow Laboratory for Ocean Sciences
>>> 60 Bigelow Drive, P.O. Box 380
>>> East Boothbay, Maine 04544
>>> http://www.bigelow.org
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
>Ben Tupper
>Bigelow Laboratory for Ocean Sciences
>60 Bigelow Drive, P.O. Box 380
>East Boothbay, Maine 04544
>http://www.bigelow.org
>
>
>
>
>
>
>
>
>


From thi_veloso at yahoo.com.br  Thu Jun  4 07:24:45 2015
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Thu, 4 Jun 2015 05:24:45 +0000 (UTC)
Subject: [R-sig-Geo] writeRaster does not preserve names when writing
	to	NetCDF
In-Reply-To: <1423243934203-7587744.post@n2.nabble.com>
References: <1423243934203-7587744.post@n2.nabble.com>
Message-ID: <498503303.4780497.1433395485716.JavaMail.yahoo@mail.yahoo.com>

Is there any news on this topic?
I am facing the same problems trying to preserve layer names (usually dates) when writing a netcdf file. This piece of information is critical when working with temporal series in netcdf files.
Perhaps a solution would be adding a "zname" argument to writeRaster (as Mark Payne suggested) which would use ncdf4's ncatt_put as a wrapper (as per from Dominik's?suggestion?).
Would this be feasible to incorporate in the writeRaster function?

I am quite sure it can be done with ncdf4 but it would involve perhaps a dozen lines of code.??
Greetings,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898 


     On Friday, February 6, 2015 11:34 AM, dschneiderch <Dominik.Schneider at colorado.edu> wrote:
   

 I was running into this problem and wondering if there was any progress?
As a workaround, I was trying to add an attribute to my variable using
ncput_att but it doesn't show more than 1 (no warning was shown that only 1
could be accepted and the min/max attributes have a value for each layer).

r=raster(matrix(runif(9),nrow=3))
r2=raster(matrix(runif(9),nrow=3))
s=stack(r,r2)
names(s)=c('X20120101','X20120108')

writeRaster(s,filename='~/Desktop/test.nc', format='CDF', varname='swe',
varunit='meters', xname='long', xunit='deg', yname='lat', yunit='deg',
zname='time', zunit='day', overwrite=T, NAflag=-99)

#Note the names of the written stack are generic.
#Now I try to add an attribute to the swe variable in the file so I can
retrieve later but it only lists the first name
n=nc_open('~/Desktop/test.nc',write=T)
ncatt_put(n,varid='swe',attname='dates',attval=names(s),prec='text')
nc_close(n)

nc_open('~/Desktop/test.nc',write=F)
File ~/Desktop/test.nc (NC_FORMAT_CLASSIC):

? ? 1 variables (excluding dimension variables):
? ? ? ? float swe[long,lat,time]? 
? ? ? ? ? ? units: meters
? ? ? ? ? ? _FillValue: -99
? ? ? ? ? ? missing_value: -99
? ? ? ? ? ? long_name: swe
? ? ? ? ? ? min: 0.0572868520393968
? ? ? ? ? ? min: 0.1845921901986
? ? ? ? ? ? max: 0.852122258627787
? ? ? ? ? ? max: 0.772868746891618
? ? ? ? ? ? dates: X20120101

? ? 3 dimensions:
? ? ? ? long? Size:3
? ? ? ? ? ? units: degrees_east
? ? ? ? ? ? long_name: long
? ? ? ? lat? Size:3
? ? ? ? ? ? units: degrees_north
? ? ? ? ? ? long_name: lat
? ? ? ? time? Size:2? *** is unlimited ***
? ? ? ? ? ? units: day
? ? ? ? ? ? long_name: time

? ? 3 global attributes:
? ? ? ? Conventions: CF-1.4
? ? ? ? created_by: R, packages ncdf and raster (version 2.3-24)
? ? ? ? date: 2015-02-06 10:18:51


Could that be a bug in ncatt_put? Or, are there any suggestions for storing
irregular spatial-temporal data (consistent spatial grid, but inconsistent
time slices that therefore require some annotation about the date)
 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/writeRaster-does-not-preserve-names-when-writing-to-NetCDF-tp7586909p7587744.html
Sent from the R-sig-geo mailing list archive at Nabble.com.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


  
	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Thu Jun  4 12:44:36 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 04 Jun 2015 12:44:36 +0200
Subject: [R-sig-Geo] Stplot for discrete data
In-Reply-To: <CACAXSaVi01Gff7QfQ43Nras7mye6-Ac03bDLnwefXY-=hYRAQw@mail.gmail.com>
References: <CACAXSaVi01Gff7QfQ43Nras7mye6-Ac03bDLnwefXY-=hYRAQw@mail.gmail.com>
Message-ID: <55702C14.40904@uni-muenster.de>

try converting variable report into a factor, by

stplot$report = factor(stfdf$report)

and give them meaningful levels if you want to see those in the legend.
The NA values will be missing from the plot, intentionally; if you'd
want to see them, give them another value before conversion to factor,
e.g. by:

stplot$report[is.na(stplot$report)] = 2

On 06/03/2015 11:34 PM, Katharine Walter wrote:
> Hi, I am trying to use the spacetime package to plot a timeseries of
> discrete data.  My dataset consists of the values: 0, 1, NA.  Is there a
> way to plot each value in a different color and construct a key indicating
> these discrete values?
> 
> I am plotting with the following command which automatically generates a
> color ramp from 0 to 1: stplot(stfdf[,,"report"], names.attr=year).
> 
> Thank you for your help and for providing an excellent package.
> 
> Best,
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150604/14f0d3c9/attachment.bin>

From edzer.pebesma at uni-muenster.de  Thu Jun  4 12:51:21 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 04 Jun 2015 12:51:21 +0200
Subject: [R-sig-Geo] Stplot for discrete data
In-Reply-To: <55702C14.40904@uni-muenster.de>
References: <CACAXSaVi01Gff7QfQ43Nras7mye6-Ac03bDLnwefXY-=hYRAQw@mail.gmail.com>
	<55702C14.40904@uni-muenster.de>
Message-ID: <55702DA9.60507@uni-muenster.de>

(not entirely woken up it seems: I meant "stfdf" where I wrote "stplot")

On 06/04/2015 12:44 PM, Edzer Pebesma wrote:
> try converting variable report into a factor, by
> 
> stplot$report = factor(stfdf$report)
> 
> and give them meaningful levels if you want to see those in the legend.
> The NA values will be missing from the plot, intentionally; if you'd
> want to see them, give them another value before conversion to factor,
> e.g. by:
> 
> stplot$report[is.na(stplot$report)] = 2
> 
> On 06/03/2015 11:34 PM, Katharine Walter wrote:
>> Hi, I am trying to use the spacetime package to plot a timeseries of
>> discrete data.  My dataset consists of the values: 0, 1, NA.  Is there a
>> way to plot each value in a different color and construct a key indicating
>> these discrete values?
>>
>> I am plotting with the following command which automatically generates a
>> color ramp from 0 to 1: stplot(stfdf[,,"report"], names.attr=year).
>>
>> Thank you for your help and for providing an excellent package.
>>
>> Best,
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150604/75d7c99c/attachment.bin>

From Rainer at krugs.de  Thu Jun  4 15:48:57 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 04 Jun 2015 15:48:57 +0200
Subject: [R-sig-Geo] R interface to grass 7.1
Message-ID: <m2y4jzbn3q.fsf@krugs.de>

Hi

I guess you have seen the announcement from Vaclac Petras about the new
command line interface to R. This sounds very exciting and I would like
to start playing with the R-GRASS 7.1 interface. What would be the best
approach concerning git / svn? should I setup my own github for this or
should I slot in one of the spgrass repositories?

Thanks,

Rainer



http://permalink.gmane.org/gmane.comp.gis.grass.user/51680

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 494 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150604/bc5d4c90/attachment.bin>

From yanruxing at ufl.edu  Thu Jun  4 21:52:54 2015
From: yanruxing at ufl.edu (Xing,Yanru)
Date: Thu, 4 Jun 2015 19:52:54 +0000
Subject: [R-sig-Geo] plot (wrld_simpl)
Message-ID: <31267FA0-FAEF-4B45-87E1-E3EB50E2D845@ufl.edu>

When I used the following code to plot the world country boundary and found out that there is no boundary between South Sudan and North Sudan. Any one know how to solve that?

data(wrld_simpl) 
plot(wrld_simpl,add=TRUE) 

From Roger.Bivand at nhh.no  Thu Jun  4 22:17:30 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 4 Jun 2015 22:17:30 +0200
Subject: [R-sig-Geo] plot (wrld_simpl)
In-Reply-To: <31267FA0-FAEF-4B45-87E1-E3EB50E2D845@ufl.edu>
References: <31267FA0-FAEF-4B45-87E1-E3EB50E2D845@ufl.edu>
Message-ID: <alpine.LFD.2.11.1506042212230.15439@reclus.nhh.no>

On Thu, 4 Jun 2015, Xing,Yanru wrote:

> When I used the following code to plot the world country boundary and 
> found out that there is no boundary between South Sudan and North Sudan. 
> Any one know how to solve that?
>

library(maptools) # by the way - always state packages used
> data(wrld_simpl)
> plot(wrld_simpl,add=TRUE)

The dataset in maptools is kept the way it was in 2007. For an 
alternative, see:

library(rworldmap)
data(countriesLow)
plot(countriesLow)

and the vignette in the rworldmap for metadata. See also the cshapes 
package for boundaries tracking changes over time.

Hope this helps,

Roger

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From rotundo.jose at gmail.com  Fri Jun  5 21:00:23 2015
From: rotundo.jose at gmail.com (=?UTF-8?Q?Jos=C3=A9_Luis_Rotundo?=)
Date: Fri, 5 Jun 2015 16:00:23 -0300
Subject: [R-sig-Geo] plotting spatial data on a map
Message-ID: <CADBY2pr-ou4VeDR0vsY-wkp=cZMnrT=WoS122wMT6mizWYRGvQ@mail.gmail.com>

Dear List,

I am trying to have some spatial data of an atrribute (protein.db) in
a map from Argentina that has county level boundaries.I need to
convert and plot the map and data points in UTM 20 south. What I want
to achieve is a map with the counties and the data plotted.

The following error message is shown at the last sentence of the script:
Error in matrix(0, rows.per.page, cols.per.page) :
  invalid 'nrow' value (too large or NA)

The database is here: http://www.filedropper.com/datosproteina12131314

The script is as follows:

data<-Datos.Proteina.1213.1314

library(gstat)
library(sp)
library(maptools)

coordinates(data) <- c('Longitud' , 'Latitud')
proj_geog <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
proj4string(data) <- CRS(proj_geog)
summary(data)

library(raster)
library(rgdal)

## Download data from gadm.org
mapArg <- getData('GADM', country='ARG', level=2)
summary(mapArg)
plot(mapArg)

utm.arg <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
data <- spTransform(data, CRS(utm.arg))
mapArg.sp <- spTransform(mapArg, CRS(utm.arg))
plot(mapArg.sp)

l3 <- list("sp.polygons", mapArg.sp,  lwd = 0.3, first = FALSE)
spplot(data, "Protein.db", pch=20, col="grey", sp.layout = l3)


Thanks in advance for any help in solving this issue.

Best,

Jose



-- 

Jos? L. Rotundo
CONICET
Facultad de Ciencias Agrarias
Univ. Nacional de Rosario
Zavalla, Santa Fe
Argentina


From macqueen1 at llnl.gov  Fri Jun  5 21:22:27 2015
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 5 Jun 2015 19:22:27 +0000
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes
In-Reply-To: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
References: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
Message-ID: <D197423B.12D2BB%macqueen1@llnl.gov>

Roger (and others),

I'm able to use my laptop, a Mac OS X running 10.9.5, as a testbed, so as
not to disrupt my current work on my desktop machine.

Thus far, my attempt to install GDAL 2 from source failed. I'm not sure
where best to ask for help on that, and I'm more of a user than a
developer. I don't consider myself to be very good at this kind of thing.
So suggestions for where best to ask questions on that aspect would be
welcome. When I do ask, I will of course include details.

I have been using William Kyngesburye's framework builds for years now, so
this testing will mean I'll have a mixture, such as proj.4 from a
framework and GDAL 2 installed from sources. I'm not sure how much this
will affect installation -- but I'm optimistic it will be not much.

Thanks
-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 5/31/15, 10:59 AM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

>The second beta of GDAL 2 is now available, and as of revision 535 on
>R-Forge, the legacy rgdal package passes R CMD check with either GDAL
>1.11.2 (or earlier) or GDAL 2.0.0 beta 2.
>
>One or two issues are known (Integer64 in vector fields and FIDs not
>supported in R; gdalDrivers() reports both raster and vector drivers; the
>MapInfo File TAB driver doesn't work for writing, ...), but others remain
>to be discovered.
>
>For those who need rgdal in production, and can install the 2.0.0 beta,
>it 
>would be a really good use of time to identify issues now, rather than
>when GDAL 2 starts to become the standard, stable release. Anyone else
>needing an itch to scratch is also, of course, welcome to contribute.
>
>The rgdal package will continue to condition on GDAL 1 or 2, so hopefully
>those users who do not need to move to GDAL 2 will not be affected.
>However, it is worth noting that GDAL is maintained by very, very, few
>volunteers (even plural is questionable here), and when they feel that
>backporting fixed from GDAL 2 to GDAL 1 is taking time from more
>important 
>things, you will be stranded with EOL software.
>
>So please consider taking the time to contribute to the idenfication of
>issues in the development version of rgdal built against GDAL 2 and/or 1,
>available for anonymous SVN checkout at:
>
>svn checkout svn://scm.r-forge.r-project.org/svnroot/rgdal/trunk
>
>Enjoy!
>
>Roger
>
>-- 
>Roger Bivand
>Department of Economics, Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 91 00
>e-mail: Roger.Bivand at nhh.no
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vijaylulla at gmail.com  Fri Jun  5 21:58:49 2015
From: vijaylulla at gmail.com (Vijay Lulla)
Date: Fri, 5 Jun 2015 15:58:49 -0400
Subject: [R-sig-Geo] plotting spatial data on a map
In-Reply-To: <CADBY2pr-ou4VeDR0vsY-wkp=cZMnrT=WoS122wMT6mizWYRGvQ@mail.gmail.com>
References: <CADBY2pr-ou4VeDR0vsY-wkp=cZMnrT=WoS122wMT6mizWYRGvQ@mail.gmail.com>
Message-ID: <CAKkiGbsOqjRbR-n38Z98MQDmOAaZfR+K7SSXGZKGQXV2Kke4Kw@mail.gmail.com>

There's a mistake in proj_geog line.  Shouldn't it be

proj_geog <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84"
?

On Fri, Jun 5, 2015 at 3:00 PM, Jos? Luis Rotundo
<rotundo.jose at gmail.com> wrote:
> Dear List,
>
> I am trying to have some spatial data of an atrribute (protein.db) in
> a map from Argentina that has county level boundaries.I need to
> convert and plot the map and data points in UTM 20 south. What I want
> to achieve is a map with the counties and the data plotted.
>
> The following error message is shown at the last sentence of the script:
> Error in matrix(0, rows.per.page, cols.per.page) :
>   invalid 'nrow' value (too large or NA)
>
> The database is here: http://www.filedropper.com/datosproteina12131314
>
> The script is as follows:
>
> data<-Datos.Proteina.1213.1314
>
> library(gstat)
> library(sp)
> library(maptools)
>
> coordinates(data) <- c('Longitud' , 'Latitud')
> proj_geog <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
> proj4string(data) <- CRS(proj_geog)
> summary(data)
>
> library(raster)
> library(rgdal)
>
> ## Download data from gadm.org
> mapArg <- getData('GADM', country='ARG', level=2)
> summary(mapArg)
> plot(mapArg)
>
> utm.arg <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
> data <- spTransform(data, CRS(utm.arg))
> mapArg.sp <- spTransform(mapArg, CRS(utm.arg))
> plot(mapArg.sp)
>
> l3 <- list("sp.polygons", mapArg.sp,  lwd = 0.3, first = FALSE)
> spplot(data, "Protein.db", pch=20, col="grey", sp.layout = l3)
>
>
> Thanks in advance for any help in solving this issue.
>
> Best,
>
> Jose
>
>
>
> --
>
> Jos? L. Rotundo
> CONICET
> Facultad de Ciencias Agrarias
> Univ. Nacional de Rosario
> Zavalla, Santa Fe
> Argentina
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From timmermann at gmx.at  Sat Jun  6 00:03:39 2015
From: timmermann at gmx.at (Andrea Timmermann)
Date: Sat, 6 Jun 2015 00:03:39 +0200
Subject: [R-sig-Geo] Problem with raster package and nc4 file
Message-ID: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>

Hi, 

I have daymet data in nc4 format and could open it with the ncdf4 package. I also have the coordinates of some polygons representing ecological areas. 
Both, the polygon vertices and the nc4 file have the same projection (LCC) and units (degrees). What I would like to do is to get the average temperature for each ecological area. So I wanted to use the polygons as a mask for the temperature raster and then get the average temperature for each polygon. 

I wanted to create a raster object (using the raster function in the raster package):

ncic <- nc_open("tmin_1980.nc4")
raster(ncic, 'tmin')

But I get this error:
Error in (function (classes, fdef, mtable)  : 
  unable to find an inherited method for function ?raster? for signature ?"ncdf4"?

Does anyone know how to fix this? Is there another way to get the data that I need?

I am a bit confused by the fact that the temperature data consists of one matrix with latitude data, one with longitude data and one with the temperature values. And by the fact that the spacing between the latitude and longitude matrices is not uniform. Is the raster package accounting somehow for this? 

Thanks a lot. Andi.


From rotundo.jose at gmail.com  Sat Jun  6 00:47:47 2015
From: rotundo.jose at gmail.com (=?UTF-8?Q?Jos=C3=A9_Luis_Rotundo?=)
Date: Fri, 5 Jun 2015 19:47:47 -0300
Subject: [R-sig-Geo] plotting spatial data on a map
In-Reply-To: <CAKkiGbsOqjRbR-n38Z98MQDmOAaZfR+K7SSXGZKGQXV2Kke4Kw@mail.gmail.com>
References: <CADBY2pr-ou4VeDR0vsY-wkp=cZMnrT=WoS122wMT6mizWYRGvQ@mail.gmail.com>
	<CAKkiGbsOqjRbR-n38Z98MQDmOAaZfR+K7SSXGZKGQXV2Kke4Kw@mail.gmail.com>
Message-ID: <CADBY2ppDyONXeHssi8DQ+aY2eSwxjUYoxESKNsjgkm5dxgx2vA@mail.gmail.com>

Thanks Vijay, it worked perfect now!

Best,

Jose


2015-06-05 16:58 GMT-03:00 Vijay Lulla <vijaylulla at gmail.com>:
> There's a mistake in proj_geog line.  Shouldn't it be
>
> proj_geog <- "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84"
> ?
>
> On Fri, Jun 5, 2015 at 3:00 PM, Jos? Luis Rotundo
> <rotundo.jose at gmail.com> wrote:
>> Dear List,
>>
>> I am trying to have some spatial data of an atrribute (protein.db) in
>> a map from Argentina that has county level boundaries.I need to
>> convert and plot the map and data points in UTM 20 south. What I want
>> to achieve is a map with the counties and the data plotted.
>>
>> The following error message is shown at the last sentence of the script:
>> Error in matrix(0, rows.per.page, cols.per.page) :
>>   invalid 'nrow' value (too large or NA)
>>
>> The database is here: http://www.filedropper.com/datosproteina12131314
>>
>> The script is as follows:
>>
>> data<-Datos.Proteina.1213.1314
>>
>> library(gstat)
>> library(sp)
>> library(maptools)
>>
>> coordinates(data) <- c('Longitud' , 'Latitud')
>> proj_geog <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
>> proj4string(data) <- CRS(proj_geog)
>> summary(data)
>>
>> library(raster)
>> library(rgdal)
>>
>> ## Download data from gadm.org
>> mapArg <- getData('GADM', country='ARG', level=2)
>> summary(mapArg)
>> plot(mapArg)
>>
>> utm.arg <- "+proj=utm +zone=20 +south +datum=WGS84 +units=m +ellps=WGS84"
>> data <- spTransform(data, CRS(utm.arg))
>> mapArg.sp <- spTransform(mapArg, CRS(utm.arg))
>> plot(mapArg.sp)
>>
>> l3 <- list("sp.polygons", mapArg.sp,  lwd = 0.3, first = FALSE)
>> spplot(data, "Protein.db", pch=20, col="grey", sp.layout = l3)
>>
>>
>> Thanks in advance for any help in solving this issue.
>>
>> Best,
>>
>> Jose
>>
>>
>>
>> --
>>
>> Jos? L. Rotundo
>> CONICET
>> Facultad de Ciencias Agrarias
>> Univ. Nacional de Rosario
>> Zavalla, Santa Fe
>> Argentina
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 

Jos? L. Rotundo
CONICET
Facultad de Ciencias Agrarias
Univ. Nacional de Rosario
Zavalla, Santa Fe
Argentina


From mdsumner at gmail.com  Sat Jun  6 00:53:46 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 05 Jun 2015 22:53:46 +0000
Subject: [R-sig-Geo] Problem with raster package and nc4 file
In-Reply-To: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>
References: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>
Message-ID: <CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>

On Sat, 6 Jun 2015 at 08:04 Andrea Timmermann <timmermann at gmx.at> wrote:

> Hi,
>
> I have daymet data in nc4 format and could open it with the ncdf4 package.
> I also have the coordinates of some polygons representing ecological areas.
> Both, the polygon vertices and the nc4 file have the same projection (LCC)
> and units (degrees).



Do you have grid data in LCC but stored with longitude/latitude
coordinates? This is unfortunate, but you can restore the LCC grid
probably. I would try

r <- raster("tmin_1980.nc4")

and then print it out and tell us the result (or post the errors if it
fails):

r

Do you have the details of the LCC projection? At a bare minimum you need
the centre longitude and centre latitude, and the two standard parallels,
and the datum/ellipsoid.  Can you open the file with ncdf4 and print out
this?

ncic <- nc_open("tmin_1980.nc4")
print(ncic)

 You are not supposed to mix use of the ncdf4 package functions with those
of raster, raster is designed to do all the work - but it does expect
sensibly specified regular grids.  If your data really are regular in LCC I
would recommend sorting that out. Can you share the file, or a link to an
analogous one?

Once you have it sorted out in raster, you can read your shapefile in and
do this

meanpolydata <- extract(r, poly, fun = mean)

Cheers, Mike.

What I would like to do is to get the average temperature for each
> ecological area. So I wanted to use the polygons as a mask for the
> temperature raster and then get the average temperature for each polygon.
>
> I wanted to create a raster object (using the raster function in the
> raster package):
>
> ncic <- nc_open("tmin_1980.nc4")
> raster(ncic, 'tmin')
>
> But I get this error:
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?raster? for signature
> ?"ncdf4"?
>
> Does anyone know how to fix this? Is there another way to get the data
> that I need?
>
> I am a bit confused by the fact that the temperature data consists of one
> matrix with latitude data, one with longitude data and one with the
> temperature values. And by the fact that the spacing between the latitude
> and longitude matrices is not uniform. Is the raster package accounting
> somehow for this?
>
> Thanks a lot. Andi.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Sat Jun  6 01:30:19 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 05 Jun 2015 23:30:19 +0000
Subject: [R-sig-Geo] Problem with raster package and nc4 file
In-Reply-To: <CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
References: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>
	<CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
Message-ID: <CAAcGz9_hH6mzAV-r6527g8jCZFf8PDVsvEuV8s-JOpZGDaGsFg@mail.gmail.com>

You don't need any hacky workarounds, this is a respectable NetCDF file. I
have an account on that system and found a file called "tmin_1999.nc4" -
this is large, ~ 1.5Gb.   Extracting pixel values with a polygon object is
pretty straightforward, but this is quite a large data set so

- test carefully on just a single layer
- check that the automatic transformation of your polygons to the grid by
extract() is sensible (or do it yourself)
- consider subsetting the grid if you don't need all of its extent in
space/time
- extract will be efficient for multilayer grids, but you might consider
use cellnumbers = TRUE if you want to save the index for later extractions

HTH

Cheers, Mike.

## this requires registration at
http://daac.ornl.gov/DAYMET/guides/Daymet_mosaics.html
##f <- "
ftp://ftp.daac.ornl.gov/data/daymet/Daymet_mosaics/data/tmin_1999.nc4"
##download.file(f, basename(f), mode = "wb")
## (could also use OpenDAP to read this if you have rgdal built with that)

## all the information is here:
##http://daac.ornl.gov/DAYMET/guides/Daymet_mosaics.html

## raster already knows:
r <- stack( basename(f))
class       : RasterStack
dimensions  : 4823, 5268, 25407564, 365  (nrow, ncol, ncell, nlayers)
resolution  : 1000, 1000  (x, y)
extent      : -2015000, 3253000, -3037000, 1786000  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=lcc +lon_0=-100 +lat_0=42.5 +x_0=0 +y_0=0 +lat_1=25
+lat_2=60 +ellps=WGS84
names       : X1999.01.01, X1999.01.02, X1999.01.03, X1999.01.04,
X1999.01.05, X1999.01.06, X1999.01.07, X1999.01.08, X1999.01.09,
X1999.01.10, X1999.01.11, X1999.01.12, X1999.01.13, X1999.01.14,
X1999.01.15, ...

## check with a map
library(rworldmap)
data(countriesLow)
library(rgdal)
namerica <- subset(countriesLow, SOVEREIGNT %in% c("United States of
America", "Mexico", "Canada"))
wm <- spTransform(namerica, CRS(projection(r)))

plot(r[[1]])
plot(wm, add = TRUE)  ## looks fine to me . . .

## this code untested obviously
## read in your shapefile
# poly <- shapefile("poly.shp")
# polyvals <- extract(r, poly, fun = mean, na.rm = TRUE) ## use r[[1]] to
test on a single layer and see notes above

## dumb polygon extraction test - this will take some time to run, so try
small tests first
extract(r[[1]], wm, fun = mean, na.rm = TRUE)


On Sat, 6 Jun 2015 at 08:53 Michael Sumner <mdsumner at gmail.com> wrote:

> On Sat, 6 Jun 2015 at 08:04 Andrea Timmermann <timmermann at gmx.at> wrote:
>
>> Hi,
>>
>> I have daymet data in nc4 format and could open it with the ncdf4
>> package. I also have the coordinates of some polygons representing
>> ecological areas.
>> Both, the polygon vertices and the nc4 file have the same projection
>> (LCC) and units (degrees).
>
>
>
> Do you have grid data in LCC but stored with longitude/latitude
> coordinates? This is unfortunate, but you can restore the LCC grid
> probably. I would try
>
> r <- raster("tmin_1980.nc4")
>
> and then print it out and tell us the result (or post the errors if it
> fails):
>
> r
>
> Do you have the details of the LCC projection? At a bare minimum you need
> the centre longitude and centre latitude, and the two standard parallels,
> and the datum/ellipsoid.  Can you open the file with ncdf4 and print out
> this?
>
> ncic <- nc_open("tmin_1980.nc4")
> print(ncic)
>
>  You are not supposed to mix use of the ncdf4 package functions with those
> of raster, raster is designed to do all the work - but it does expect
> sensibly specified regular grids.  If your data really are regular in LCC I
> would recommend sorting that out. Can you share the file, or a link to an
> analogous one?
>
> Once you have it sorted out in raster, you can read your shapefile in and
> do this
>
> meanpolydata <- extract(r, poly, fun = mean)
>
> Cheers, Mike.
>
> What I would like to do is to get the average temperature for each
>> ecological area. So I wanted to use the polygons as a mask for the
>> temperature raster and then get the average temperature for each polygon.
>>
>> I wanted to create a raster object (using the raster function in the
>> raster package):
>>
>> ncic <- nc_open("tmin_1980.nc4")
>> raster(ncic, 'tmin')
>>
>> But I get this error:
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method for function ?raster? for signature
>> ?"ncdf4"?
>>
>> Does anyone know how to fix this? Is there another way to get the data
>> that I need?
>>
>> I am a bit confused by the fact that the temperature data consists of one
>> matrix with latitude data, one with longitude data and one with the
>> temperature values. And by the fact that the spacing between the latitude
>> and longitude matrices is not uniform. Is the raster package accounting
>> somehow for this?
>>
>> Thanks a lot. Andi.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From timmermann at gmx.at  Sat Jun  6 01:37:32 2015
From: timmermann at gmx.at (Andrea Timmermann)
Date: Sat, 6 Jun 2015 01:37:32 +0200
Subject: [R-sig-Geo] Problem with raster package and nc4 file
In-Reply-To: <CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
References: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>,
	<CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
Message-ID: <trinity-b5605423-7ea0-48b6-8804-26318349be8d-1433547452080@3capp-gmx-bs40>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150606/126393d7/attachment.html>

From mdsumner at gmail.com  Sat Jun  6 01:52:42 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 05 Jun 2015 23:52:42 +0000
Subject: [R-sig-Geo] Problem with raster package and nc4 file
In-Reply-To: <trinity-b5605423-7ea0-48b6-8804-26318349be8d-1433547452080@3capp-gmx-bs40>
References: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>
	<CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
	<trinity-b5605423-7ea0-48b6-8804-26318349be8d-1433547452080@3capp-gmx-bs40>
Message-ID: <CAAcGz9-nn2Y0QBOmNUuj6kBeCC82wJhFCDQPo1vyTz0fp3f2Uw@mail.gmail.com>

Just another short comment below

On Sat, 6 Jun 2015 at 09:37 Andrea Timmermann <timmermann at gmx.at> wrote:

> Hi!
> Thanks a lot !!! I could get the raster now.
> This is what I got:
> > r
> class       : RasterLayer
> band        : 1  (of  365  bands)
> dimensions  : 4823, 5268, 25407564  (nrow, ncol, ncell)
>
> resolution  : 1000, 1000  (x, y)
> extent      : -2015000, 3253000, -3037000, 1786000  (xmin, xmax, ymin,
> ymax)
> coord. ref. : +proj=lcc +lon_0=-100 +lat_0=42.5 +x_0=0 +y_0=0 +lon_0=0
> +lat_1=25 +lat_2=60
> data source : C:\Users\Andi\Desktop\1980\tmin_1980.nc4
> names       : daily.minimum.temperature
> z-value     : 1980-01-01
> zvar        : tmin
>
>
> and
>
> > print(ncic)
> [1] "File tmin_1980.nc4 (NC_FORMAT_NETCDF4_CLASSIC):"
> [1] ""
> [1] "     6 variables (excluding dimension variables):"
> [1] "        short lambert_conformal_conic[]   "
> [1] "            grid_mapping_name: lambert_conformal_conic"
> [1] "            longitude_of_central_meridian: -100"
> [1] "            latitude_of_projection_origin: 42.5"
> [1] "            false_easting: 0"
> [1] "            false_northing: 0"
> [1] "            standard_parallel: 25" "            standard_parallel: 60"
> [1] "            longitude_of_prime_meridian: 0"
> [1] "        float lat[x,y]   "
> [1] "            units: degrees_north"
> [1] "            long_name: latitude coordinate"
> [1] "            standard_name: latitude"
> [1] "        float lon[x,y]   "
> [1] "            units: degrees_east"
> [1] "            long_name: longitude coordinate"
> [1] "            standard_name: longitude"
> [1] "        float time_bnds[nv,time]   "
> [1] "        float tmin[x,y,time]   "
> [1] "            long_name: daily minimum temperature"
> [1] "            units: degrees C"
> [1] "            missing_value: -9999"
> [1] "            _FillValue: -9999"
> [1] "            valid_range: -50" "            valid_range: 50"
> [1] "            coordinates: lat lon"
> [1] "            grid_mapping: lambert_conformal_conic"
> [1] "            cell_methods: area: mean time: minimum"
> [1] "        short yearday[time]   "
> [1] "            long_name: yearday"
> [1] "            valid_range: 1"   "            valid_range: 365"
> [1] ""
> [1] "     4 dimensions:"
> [1] "        y  Size:4823"
> [1] "            units: m"
> [1] "            long_name: y coordinate of projection"
> [1] "            standard_name: projection_y_coordinate"
> [1] "        x  Size:5268"
> [1] "            units: m"
> [1] "            long_name: x coordinate of projection"
> [1] "            standard_name: projection_x_coordinate"
> [1] "        time  Size:365   *** is unlimited ***"
> [1] "            long_name: time"
> [1] "            calendar: standard"
> [1] "            units: days since 1980-01-01 00:00:00 UTC"
> [1] "            bounds: time_bnds"
> [1] "        nv  Size:2"
> [1] ""
> [1] "    8 global attributes:"
> [1] "        start_year: 1980"
> [1] "        source: Daymet Software Version 2.0"
> [1] "        Version_software: Daymet Software Version 2.0"
> [1] "        Version_data: Daymet Data Version 2.1"
> [1] "        Conventions: CF-1.4"
> [1] "        citation: Please see http://daymet.ornl.gov/ for current
> Daymet data citation information"
> [1] "        references: Please see http://daymet.ornl.gov/ for current
> information on Daymet references"
> [1] "        institution: Oak Ridge National Laboratory Distributed Active
> Archive Center (ORNL DAAC)"
>
> The file can be downloaded from: http://daymet.ornl.gov/mosaics.html (The
> files with the daylength data are much smaller.)
> When I open the lat layer I see that the differences between consecutive
> cells are different depending on the location on the file, so I think that
> the sizes are not uniform.
> I am not sure how I can fix that.
>

There's nothing to fix, this is a regular grid in metres and is sensibly
specified by an extent in the projected coordinates - you don't need to
work with every cell's coordinate explicitly, and you can always generate
them on the fly as required - in whatever coordinate system you want. But I
don't think you need that at all.

Storing every coordinate in lon/lat arrays in that file is just an
unnecessary waste really, this is one of those "modelling/GIS" crossover
areas where things just don't quite mesh in a sensible way.

Cheers, Mike.


>
> Thanks a lot.
> Andi
>  *Gesendet:* Freitag, 05. Juni 2015 um 23:53 Uhr
> *Von:* "Michael Sumner" <mdsumner at gmail.com>
> *An:* "Andrea Timmermann" <timmermann at gmx.at>, r-sig-geo at r-project.org
> *Betreff:* Re: [R-sig-Geo] Problem with raster package and nc4 file
>
> On Sat, 6 Jun 2015 at 08:04 Andrea Timmermann <timmermann at gmx.at> wrote:
>
>> Hi,
>>
>> I have daymet data in nc4 format and could open it with the ncdf4
>> package. I also have the coordinates of some polygons representing
>> ecological areas.
>> Both, the polygon vertices and the nc4 file have the same projection
>> (LCC) and units (degrees).
>
>
>
> Do you have grid data in LCC but stored with longitude/latitude
> coordinates? This is unfortunate, but you can restore the LCC grid
> probably. I would try
>
> r <- raster("tmin_1980.nc4")
>
> and then print it out and tell us the result (or post the errors if it
> fails):
>
> r
>
> Do you have the details of the LCC projection? At a bare minimum you need
> the centre longitude and centre latitude, and the two standard parallels,
> and the datum/ellipsoid.  Can you open the file with ncdf4 and print out
> this?
>
> ncic <- nc_open("tmin_1980.nc4")
> print(ncic)
>
>  You are not supposed to mix use of the ncdf4 package functions with those
> of raster, raster is designed to do all the work - but it does expect
> sensibly specified regular grids.  If your data really are regular in LCC I
> would recommend sorting that out. Can you share the file, or a link to an
> analogous one?
>
> Once you have it sorted out in raster, you can read your shapefile in and
> do this
>
> meanpolydata <- extract(r, poly, fun = mean)
>
> Cheers, Mike.
>
>
>> What I would like to do is to get the average temperature for each
>> ecological area. So I wanted to use the polygons as a mask for the
>> temperature raster and then get the average temperature for each polygon.
>>
>> I wanted to create a raster object (using the raster function in the
>> raster package):
>>
>> ncic <- nc_open("tmin_1980.nc4")
>> raster(ncic, 'tmin')
>>
>> But I get this error:
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method for function ?raster? for signature
>> ?"ncdf4"?
>>
>> Does anyone know how to fix this? Is there another way to get the data
>> that I need?
>>
>> I am a bit confused by the fact that the temperature data consists of one
>> matrix with latitude data, one with longitude data and one with the
>> temperature values. And by the fact that the spacing between the latitude
>> and longitude matrices is not uniform. Is the raster package accounting
>> somehow for this?
>>
>> Thanks a lot. Andi.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From Beaulieu.Jake at epa.gov  Sat Jun  6 03:38:20 2015
From: Beaulieu.Jake at epa.gov (Beaulieu, Jake)
Date: Sat, 6 Jun 2015 01:38:20 +0000
Subject: [R-sig-Geo] lollipop plot via plotKML
Message-ID: <DM2PR09MB0352A0675CC1D8C31B4991DCF3B10@DM2PR09MB0352.namprd09.prod.outlook.com>

Hello,
I would like make a lollipop plot displaying soil characteristics using plotKML, similar to Fig.3 in Hengl's 2015 plotKML paper in JSS.

I'm using the eberg dataset in the plotKML package as a demo.  All points need to be plotted the same size and the image must include line segments joining the points to their projection on the xy plane.  Here is my progress so far.

> plotKML(eberg["CLYMHT_A"], colour_scale=rep("#FFFF00", 2), points_names="", size=1, altitude = CLYMHT_A)
Error in `[.data.frame`(obj at data, , deparse(size)) :
  undefined columns selected

I'm having issues with both the size and altitude arguments.  Any suggestions?

Thanks!


Jake J Beaulieu, PhD
United States Environmental Protection Agency
Office of Research and Development
National Risk Management Research Laboratory
Water Supply and Water Resources Division
Urban Waters Management Branch
26 W MLK Dr.
MS 698
Cincinnati, OH 45268
Phone: 513-569-7842


	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Sat Jun  6 04:30:19 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 5 Jun 2015 19:30:19 -0700
Subject: [R-sig-Geo] Problem with raster package and nc4 file
In-Reply-To: <CAAcGz9-nn2Y0QBOmNUuj6kBeCC82wJhFCDQPo1vyTz0fp3f2Uw@mail.gmail.com>
References: <trinity-85ee43d1-362a-4c7a-a654-abf92816cdba-1433541819840@3capp-gmx-bs40>
	<CAAcGz9_kmLRzY5sRbOSLQTsDob_cf-GXFWwL-rz=ZaMWOoWkBg@mail.gmail.com>
	<trinity-b5605423-7ea0-48b6-8804-26318349be8d-1433547452080@3capp-gmx-bs40>
	<CAAcGz9-nn2Y0QBOmNUuj6kBeCC82wJhFCDQPo1vyTz0fp3f2Uw@mail.gmail.com>
Message-ID: <CANtt_hyNKaH1w=JRMp447xZtgNe9aUTZh5-PYtcKw2MoPNuEWw@mail.gmail.com>

Andrea,

One small addition. To get all layers (one for each day, in stead of
the single layer you get with 'raster'), use the brick function:

b <- brick("tmin_1980.nc4")

Robert

On Fri, Jun 5, 2015 at 4:52 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> Just another short comment below
>
> On Sat, 6 Jun 2015 at 09:37 Andrea Timmermann <timmermann at gmx.at> wrote:
>
>> Hi!
>> Thanks a lot !!! I could get the raster now.
>> This is what I got:
>> > r
>> class       : RasterLayer
>> band        : 1  (of  365  bands)
>> dimensions  : 4823, 5268, 25407564  (nrow, ncol, ncell)
>>
>> resolution  : 1000, 1000  (x, y)
>> extent      : -2015000, 3253000, -3037000, 1786000  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=lcc +lon_0=-100 +lat_0=42.5 +x_0=0 +y_0=0 +lon_0=0
>> +lat_1=25 +lat_2=60
>> data source : C:\Users\Andi\Desktop\1980\tmin_1980.nc4
>> names       : daily.minimum.temperature
>> z-value     : 1980-01-01
>> zvar        : tmin
>>
>>
>> and
>>
>> > print(ncic)
>> [1] "File tmin_1980.nc4 (NC_FORMAT_NETCDF4_CLASSIC):"
>> [1] ""
>> [1] "     6 variables (excluding dimension variables):"
>> [1] "        short lambert_conformal_conic[]   "
>> [1] "            grid_mapping_name: lambert_conformal_conic"
>> [1] "            longitude_of_central_meridian: -100"
>> [1] "            latitude_of_projection_origin: 42.5"
>> [1] "            false_easting: 0"
>> [1] "            false_northing: 0"
>> [1] "            standard_parallel: 25" "            standard_parallel: 60"
>> [1] "            longitude_of_prime_meridian: 0"
>> [1] "        float lat[x,y]   "
>> [1] "            units: degrees_north"
>> [1] "            long_name: latitude coordinate"
>> [1] "            standard_name: latitude"
>> [1] "        float lon[x,y]   "
>> [1] "            units: degrees_east"
>> [1] "            long_name: longitude coordinate"
>> [1] "            standard_name: longitude"
>> [1] "        float time_bnds[nv,time]   "
>> [1] "        float tmin[x,y,time]   "
>> [1] "            long_name: daily minimum temperature"
>> [1] "            units: degrees C"
>> [1] "            missing_value: -9999"
>> [1] "            _FillValue: -9999"
>> [1] "            valid_range: -50" "            valid_range: 50"
>> [1] "            coordinates: lat lon"
>> [1] "            grid_mapping: lambert_conformal_conic"
>> [1] "            cell_methods: area: mean time: minimum"
>> [1] "        short yearday[time]   "
>> [1] "            long_name: yearday"
>> [1] "            valid_range: 1"   "            valid_range: 365"
>> [1] ""
>> [1] "     4 dimensions:"
>> [1] "        y  Size:4823"
>> [1] "            units: m"
>> [1] "            long_name: y coordinate of projection"
>> [1] "            standard_name: projection_y_coordinate"
>> [1] "        x  Size:5268"
>> [1] "            units: m"
>> [1] "            long_name: x coordinate of projection"
>> [1] "            standard_name: projection_x_coordinate"
>> [1] "        time  Size:365   *** is unlimited ***"
>> [1] "            long_name: time"
>> [1] "            calendar: standard"
>> [1] "            units: days since 1980-01-01 00:00:00 UTC"
>> [1] "            bounds: time_bnds"
>> [1] "        nv  Size:2"
>> [1] ""
>> [1] "    8 global attributes:"
>> [1] "        start_year: 1980"
>> [1] "        source: Daymet Software Version 2.0"
>> [1] "        Version_software: Daymet Software Version 2.0"
>> [1] "        Version_data: Daymet Data Version 2.1"
>> [1] "        Conventions: CF-1.4"
>> [1] "        citation: Please see http://daymet.ornl.gov/ for current
>> Daymet data citation information"
>> [1] "        references: Please see http://daymet.ornl.gov/ for current
>> information on Daymet references"
>> [1] "        institution: Oak Ridge National Laboratory Distributed Active
>> Archive Center (ORNL DAAC)"
>>
>> The file can be downloaded from: http://daymet.ornl.gov/mosaics.html (The
>> files with the daylength data are much smaller.)
>> When I open the lat layer I see that the differences between consecutive
>> cells are different depending on the location on the file, so I think that
>> the sizes are not uniform.
>> I am not sure how I can fix that.
>>
>
> There's nothing to fix, this is a regular grid in metres and is sensibly
> specified by an extent in the projected coordinates - you don't need to
> work with every cell's coordinate explicitly, and you can always generate
> them on the fly as required - in whatever coordinate system you want. But I
> don't think you need that at all.
>
> Storing every coordinate in lon/lat arrays in that file is just an
> unnecessary waste really, this is one of those "modelling/GIS" crossover
> areas where things just don't quite mesh in a sensible way.
>
> Cheers, Mike.
>
>
>>
>> Thanks a lot.
>> Andi
>>  *Gesendet:* Freitag, 05. Juni 2015 um 23:53 Uhr
>> *Von:* "Michael Sumner" <mdsumner at gmail.com>
>> *An:* "Andrea Timmermann" <timmermann at gmx.at>, r-sig-geo at r-project.org
>> *Betreff:* Re: [R-sig-Geo] Problem with raster package and nc4 file
>>
>> On Sat, 6 Jun 2015 at 08:04 Andrea Timmermann <timmermann at gmx.at> wrote:
>>
>>> Hi,
>>>
>>> I have daymet data in nc4 format and could open it with the ncdf4
>>> package. I also have the coordinates of some polygons representing
>>> ecological areas.
>>> Both, the polygon vertices and the nc4 file have the same projection
>>> (LCC) and units (degrees).
>>
>>
>>
>> Do you have grid data in LCC but stored with longitude/latitude
>> coordinates? This is unfortunate, but you can restore the LCC grid
>> probably. I would try
>>
>> r <- raster("tmin_1980.nc4")
>>
>> and then print it out and tell us the result (or post the errors if it
>> fails):
>>
>> r
>>
>> Do you have the details of the LCC projection? At a bare minimum you need
>> the centre longitude and centre latitude, and the two standard parallels,
>> and the datum/ellipsoid.  Can you open the file with ncdf4 and print out
>> this?
>>
>> ncic <- nc_open("tmin_1980.nc4")
>> print(ncic)
>>
>>  You are not supposed to mix use of the ncdf4 package functions with those
>> of raster, raster is designed to do all the work - but it does expect
>> sensibly specified regular grids.  If your data really are regular in LCC I
>> would recommend sorting that out. Can you share the file, or a link to an
>> analogous one?
>>
>> Once you have it sorted out in raster, you can read your shapefile in and
>> do this
>>
>> meanpolydata <- extract(r, poly, fun = mean)
>>
>> Cheers, Mike.
>>
>>
>>> What I would like to do is to get the average temperature for each
>>> ecological area. So I wanted to use the polygons as a mask for the
>>> temperature raster and then get the average temperature for each polygon.
>>>
>>> I wanted to create a raster object (using the raster function in the
>>> raster package):
>>>
>>> ncic <- nc_open("tmin_1980.nc4")
>>> raster(ncic, 'tmin')
>>>
>>> But I get this error:
>>> Error in (function (classes, fdef, mtable)  :
>>>   unable to find an inherited method for function ?raster? for signature
>>> ?"ncdf4"?
>>>
>>> Does anyone know how to fix this? Is there another way to get the data
>>> that I need?
>>>
>>> I am a bit confused by the fact that the temperature data consists of one
>>> matrix with latitude data, one with longitude data and one with the
>>> temperature values. And by the fact that the spacing between the latitude
>>> and longitude matrices is not uniform. Is the raster package accounting
>>> somehow for this?
>>>
>>> Thanks a lot. Andi.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From englishchristophera at gmail.com  Sat Jun  6 07:58:54 2015
From: englishchristophera at gmail.com (chris english)
Date: Sat, 6 Jun 2015 01:58:54 -0400
Subject: [R-sig-Geo] Extend spacetime ST
Message-ID: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>

Hi,

I am attempting to extent spacetime ST to include an ID class for a
spacetime watch circle object.  I am doing this in order to be able to
relatively easily test that I have unique ID(s) across several similar
objects for plotting purposes.

I can build my watch circle:

> setClass("watch_circ",
+ slots = c(sp = "Spatial", time = "xts", ID = "character",
+ endTime = "POSIXct"),
+ validity = function(object) {
+ stopifnot(length(object at sp) >= 1)
+ stopifnot(nrow(object at time) >= 1)
+ stopifnot(is.char(object at ID))
+ stopifnot(nrow(object at time) == length(object at endTime))
+ # do the tzones if not set, if set
+ tz1 = attr(object at time, "tzone")
+ tz2 = attr(object at emdTime, "tzone")
+ tz1.set = (!is.null(tz1) && !nchar(tz1)==0)
+ tz2.set = (!is.null(tz2) && !nchar(tz2)==0)
+ stopifnot(tz1 == tz2)
+ if (tz1.set)
+ stopifnot(tz1 == tz2)
+ if (any(names(object at time) %in% names(object at sp)))
+ stop("name conflict: attribute names in sp and time slot must differ")
+ return(TRUE)
+ }
+ )
> getClassDef('watch_circ')
Class "watch_circ" [in ".GlobalEnv"]

Slots:

Name:         sp      time        ID   endTime
Class:   Spatial       xts character   POSIXct

But not extend ST.

> setClass("watch_circ_1", representation = "ST")
> getClassDef('watch_circ_1')
Class "watch_circ_1" [in ".GlobalEnv"]

Slots:

Name:       sp    time endTime
Class: Spatial     xts POSIXct

Extends: "ST"
> ?what am I doing wrong here?

This is probably due to my shallow understanding of the difference between
slots and representation, and possibly this whole operation is unnecessary
if plot checks sp for unique ID(s) among objects.

Thanks in advance,

Cheers,
Chris

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Sat Jun  6 13:09:41 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 6 Jun 2015 13:09:41 +0200
Subject: [R-sig-Geo] Pre-GDAL 2: rgdal changes
In-Reply-To: <D197423B.12D2BB%macqueen1@llnl.gov>
References: <alpine.LFD.2.11.1505311943450.25089@reclus.nhh.no>
	<D197423B.12D2BB%macqueen1@llnl.gov>
Message-ID: <alpine.LFD.2.11.1506061302060.13550@reclus.nhh.no>

Thanks for being willing to help! It may be worth asking William 
Kyngesburye whether he has tried building a GDAL 2.0.0 framework - the 
first release candidate was released yesterday (and yes, rgdal 1.0-2 
passes check under Fedora with yesterday's GDAL 2.0.0 RC1). If he is 
willing, you would be a tester helping him too. The release of GDAL 2 is 
impending (actually, it was meant to follow 1.9, but got held up).

Roger

On Fri, 5 Jun 2015, MacQueen, Don wrote:

> Roger (and others),
>
> I'm able to use my laptop, a Mac OS X running 10.9.5, as a testbed, so as
> not to disrupt my current work on my desktop machine.
>
> Thus far, my attempt to install GDAL 2 from source failed. I'm not sure
> where best to ask for help on that, and I'm more of a user than a
> developer. I don't consider myself to be very good at this kind of thing.
> So suggestions for where best to ask questions on that aspect would be
> welcome. When I do ask, I will of course include details.
>
> I have been using William Kyngesburye's framework builds for years now, so
> this testing will mean I'll have a mixture, such as proj.4 from a
> framework and GDAL 2 installed from sources. I'm not sure how much this
> will affect installation -- but I'm optimistic it will be not much.
>
> Thanks
> -Don
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Sat Jun  6 15:21:48 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 06 Jun 2015 13:21:48 +0000
Subject: [R-sig-Geo] graticules for maps in R
Message-ID: <CAAcGz9-0FbgLDaowsniKTNKkdrRt+wHXk5QiztE9tQaGeuAA3A@mail.gmail.com>

Hello, I've put together an R package on GitHub for building and plotting
graticules in the ways that I wanted.

https://github.com/mdsumner/graticule

Graticules are the grid of longitude and latitude lines on maps, and in the
readme for this package I show a few examples and discuss why I created a
new approach.

Hope it's of interest.

Cheers, Mike.

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Sat Jun  6 15:47:10 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 06 Jun 2015 15:47:10 +0200
Subject: [R-sig-Geo] Extend spacetime ST
In-Reply-To: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>
References: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>
Message-ID: <5572F9DE.1090107@uni-muenster.de>

Chris, I'd use the following for a class "watch_circ" that extends ST
and adds a character ID slot:

> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> showClass("watch_circ")
Class "watch_circ" [in ".GlobalEnv"]

Slots:

Name:         ID        sp      time   endTime
Class: character   Spatial       xts   POSIXct

Extends: "ST"
>

On 06/06/2015 07:58 AM, chris english wrote:
> Hi,
> 
> I am attempting to extent spacetime ST to include an ID class for a
> spacetime watch circle object.  I am doing this in order to be able to
> relatively easily test that I have unique ID(s) across several similar
> objects for plotting purposes.
> 
> I can build my watch circle:
> 
>> setClass("watch_circ",
> + slots = c(sp = "Spatial", time = "xts", ID = "character",
> + endTime = "POSIXct"),
> + validity = function(object) {
> + stopifnot(length(object at sp) >= 1)
> + stopifnot(nrow(object at time) >= 1)
> + stopifnot(is.char(object at ID))
> + stopifnot(nrow(object at time) == length(object at endTime))
> + # do the tzones if not set, if set
> + tz1 = attr(object at time, "tzone")
> + tz2 = attr(object at emdTime, "tzone")
> + tz1.set = (!is.null(tz1) && !nchar(tz1)==0)
> + tz2.set = (!is.null(tz2) && !nchar(tz2)==0)
> + stopifnot(tz1 == tz2)
> + if (tz1.set)
> + stopifnot(tz1 == tz2)
> + if (any(names(object at time) %in% names(object at sp)))
> + stop("name conflict: attribute names in sp and time slot must differ")
> + return(TRUE)
> + }
> + )
>> getClassDef('watch_circ')
> Class "watch_circ" [in ".GlobalEnv"]
> 
> Slots:
> 
> Name:         sp      time        ID   endTime
> Class:   Spatial       xts character   POSIXct
> 
> But not extend ST.
> 
>> setClass("watch_circ_1", representation = "ST")
>> getClassDef('watch_circ_1')
> Class "watch_circ_1" [in ".GlobalEnv"]
> 
> Slots:
> 
> Name:       sp    time endTime
> Class: Spatial     xts POSIXct
> 
> Extends: "ST"
>> ?what am I doing wrong here?
> 
> This is probably due to my shallow understanding of the difference between
> slots and representation, and possibly this whole operation is unnecessary
> if plot checks sp for unique ID(s) among objects.
> 
> Thanks in advance,
> 
> Cheers,
> Chris
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150606/7dd02e2e/attachment.bin>

From englishchristophera at gmail.com  Sun Jun  7 10:31:35 2015
From: englishchristophera at gmail.com (chris english)
Date: Sun, 7 Jun 2015 04:31:35 -0400
Subject: [R-sig-Geo] Extend spacetime ST
In-Reply-To: <5572F9DE.1090107@uni-muenster.de>
References: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>
	<5572F9DE.1090107@uni-muenster.de>
Message-ID: <CAASFQpQoR3rS3CT0h-cSbOvMu59hXGXR8h30sfa-Q5QQsZqtmg@mail.gmail.com>

Edzer,

Upon implementing your suggested:

> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> showClass("watch_circ")
Class "watch_circ" [in ".GlobalEnv"]

Slots:

Name:         ID        sp      time   endTime
Class: character   Spatial       xts   POSIXct

Extends: "ST"

I had to do more reading unless all I was going to say was "Wow".

> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> showClass("watch_circ")
Class "watch_circ" [in ".GlobalEnv"]

Slots:

Name:         ID        sp      time   endTime
Class: character   Spatial       xts   POSIXct

Extends: "ST"

> extends("watch_circ", fullInfo = TRUE)
$ST
An object of class "SClassExtension"
Slot "subClass":
[1] "watch_circ"

Slot "superClass":
[1] "ST"

Slot "package":
[1] ".GlobalEnv"

Slot "coerce":
function (from, strict = TRUE)
{
    class(from) <- "ST"
    from
}

Slot "test":
function (object)
TRUE
<bytecode: 0x19516f58>
<environment: namespace:methods>

Slot "replace":
function (from, to, value)
{
    for (what in c("sp", "time", "ID", "endTime")) slot(from,
        what) <- slot(value, what)
    from
}

Slot "simple":
[1] TRUE

Slot "by":
character(0)

Slot "dataPart":
[1] FALSE

Slot "distance":
[1] 1


$watch_circ
[1] TRUE

>
Is there a way to control the slots =c(ID, "character") order as to
prepending or postpending.
ie. (sp, time, endTime, ID) vs (ID, sp, time, endTime), or is the behavior
of subclassing the
superclass necessarily going to prepend the subclass slot(s) to the
superclass slots. It just seems on
a vernacular level that the order (sp, time, endTime, ID) is more ST-like
and signals the extending.

contains = does just what I need, or more properly want, is powerful, and
probably should be used
with caution by the magician's apprentice.

contains also leads me back to my prior 'wish list' of epochal endTimes.
Even the constraint language
of ST construction:

if (any(is.na(endTime)))
        stop("NA endTime values not allowed")

suggests toying with the concept of multiple (user defined) endTimes, or it
would merely say "NA endTime value not allowed", singular as to value, full
stop.  And with contains in mind and Pebesma (2008) "Customizing spatial
data
classes and methods" I start to see a way, ala Michael Sumner to
potentially using epochal endTimes
to extract all valid (or invalid for that matter) condition 2 quadrant 3
paths for normals and subjects to
evaluate as a TracksCollection.  Well, we'll see.

Thanks very much,

Chris




On Sat, Jun 6, 2015 at 9:47 AM, Edzer Pebesma <edzer.pebesma at uni-muenster.de
> wrote:

> Chris, I'd use the following for a class "watch_circ" that extends ST
> and adds a character ID slot:
>
> > setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> > showClass("watch_circ")
> Class "watch_circ" [in ".GlobalEnv"]
>
> Slots:
>
> Name:         ID        sp      time   endTime
> Class: character   Spatial       xts   POSIXct
>
> Extends: "ST"
>


> >
>
> On 06/06/2015 07:58 AM, chris english wrote:
> > Hi,
> >
> > I am attempting to extent spacetime ST to include an ID class for a
> > spacetime watch circle object.  I am doing this in order to be able to
> > relatively easily test that I have unique ID(s) across several similar
> > objects for plotting purposes.
> >
> > I can build my watch circle:
> >
> >> setClass("watch_circ",
> > + slots = c(sp = "Spatial", time = "xts", ID = "character",
> > + endTime = "POSIXct"),
> > + validity = function(object) {
> > + stopifnot(length(object at sp) >= 1)
> > + stopifnot(nrow(object at time) >= 1)
> > + stopifnot(is.char(object at ID))
> > + stopifnot(nrow(object at time) == length(object at endTime))
> > + # do the tzones if not set, if set
> > + tz1 = attr(object at time, "tzone")
> > + tz2 = attr(object at emdTime, "tzone")
> > + tz1.set = (!is.null(tz1) && !nchar(tz1)==0)
> > + tz2.set = (!is.null(tz2) && !nchar(tz2)==0)
> > + stopifnot(tz1 == tz2)
> > + if (tz1.set)
> > + stopifnot(tz1 == tz2)
> > + if (any(names(object at time) %in% names(object at sp)))
> > + stop("name conflict: attribute names in sp and time slot must differ")
> > + return(TRUE)
> > + }
> > + )
> >> getClassDef('watch_circ')
> > Class "watch_circ" [in ".GlobalEnv"]
> >
> > Slots:
> >
> > Name:         sp      time        ID   endTime
> > Class:   Spatial       xts character   POSIXct
> >
> > But not extend ST.
> >
> >> setClass("watch_circ_1", representation = "ST")
> >> getClassDef('watch_circ_1')
> > Class "watch_circ_1" [in ".GlobalEnv"]
> >
> > Slots:
> >
> > Name:       sp    time endTime
> > Class: Spatial     xts POSIXct
> >
> > Extends: "ST"
> >> ?what am I doing wrong here?
> >
> > This is probably due to my shallow understanding of the difference
> between
> > slots and representation, and possibly this whole operation is
> unnecessary
> > if plot checks sp for unique ID(s) among objects.
> >
> > Thanks in advance,
> >
> > Cheers,
> > Chris
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jun  8 00:51:00 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 07 Jun 2015 23:51:00 +0100
Subject: [R-sig-Geo] Extend spacetime ST
In-Reply-To: <CAASFQpQoR3rS3CT0h-cSbOvMu59hXGXR8h30sfa-Q5QQsZqtmg@mail.gmail.com>
References: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>	<5572F9DE.1090107@uni-muenster.de>
	<CAASFQpQoR3rS3CT0h-cSbOvMu59hXGXR8h30sfa-Q5QQsZqtmg@mail.gmail.com>
Message-ID: <5574CAD4.2000900@uni-muenster.de>



On 06/07/2015 09:31 AM, chris english wrote:
> Edzer,
> 
> Upon implementing your suggested:
> 
>> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
>> showClass("watch_circ")
> Class "watch_circ" [in ".GlobalEnv"]
> 
> Slots:
> 
> Name:         ID        sp      time   endTime
> Class: character   Spatial       xts   POSIXct
> 
> Extends: "ST"
> 
> I had to do more reading unless all I was going to say was "Wow".
> 
>> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
>> showClass("watch_circ")
> Class "watch_circ" [in ".GlobalEnv"]
> 
> Slots:
> 
> Name:         ID        sp      time   endTime
> Class: character   Spatial       xts   POSIXct
> 
> Extends: "ST"
> 
>> extends("watch_circ", fullInfo = TRUE)
> $ST
> An object of class "SClassExtension"
> Slot "subClass":
> [1] "watch_circ"
> 
> Slot "superClass":
> [1] "ST"
> 
> Slot "package":
> [1] ".GlobalEnv"
> 
> Slot "coerce":
> function (from, strict = TRUE) 
> {
>     class(from) <- "ST"
>     from
> }
> 
> Slot "test":
> function (object) 
> TRUE
> <bytecode: 0x19516f58>
> <environment: namespace:methods>
> 
> Slot "replace":
> function (from, to, value) 
> {
>     for (what in c("sp", "time", "ID", "endTime")) slot(from, 
>         what) <- slot(value, what)
>     from
> }
> 
> Slot "simple":
> [1] TRUE
> 
> Slot "by":
> character(0)
> 
> Slot "dataPart":
> [1] FALSE
> 
> Slot "distance":
> [1] 1
> 
> 
> $watch_circ
> [1] TRUE
> 
>> 
> Is there a way to control the slots =c(ID, "character") order as to
> prepending or postpending.
> ie. (sp, time, endTime, ID) vs (ID, sp, time, endTime), or is the
> behavior of subclassing the
> superclass necessarily going to prepend the subclass slot(s) to the
> superclass slots. It just seems on
> a vernacular level that the order (sp, time, endTime, ID) is more
> ST-like and signals the extending.

Slot order does not matter, as they're addressed only by name.

> 
> contains = does just what I need, or more properly want, is powerful,
> and probably should be used
> with caution by the magician's apprentice.
> 
> contains also leads me back to my prior 'wish list' of epochal endTimes.
> Even the constraint language
> of ST construction: 
> 
> if (any(is.na <http://is.na>(endTime))) 
>         stop("NA endTime values not allowed")
> 
> suggests toying with the concept of multiple (user defined) endTimes, or
> it would merely say "NA endTime value not allowed", singular as to
> value, full stop.  And with contains in mind and Pebesma (2008)
> "Customizing spatial data
> classes and methods" I start to see a way, ala Michael Sumner to
> potentially using epochal endTimes
> to extract all valid (or invalid for that matter) condition 2 quadrant 3
> paths for normals and subjects to
> evaluate as a TracksCollection.  Well, we'll see.  

You may want to think about subclassing STI instead of ST; ST is meant
as a virtual class, not something to actually hold data. It has some
methods, but only those that can be implemented identically for all
subclasses. STI for instance has a subsetting method, "[", as well as
over & aggregate.

> 
> Thanks very much,
> 
> Chris
> 
> 
> 
> 
> On Sat, Jun 6, 2015 at 9:47 AM, Edzer Pebesma
> <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> wrote:
> 
>     Chris, I'd use the following for a class "watch_circ" that extends ST
>     and adds a character ID slot:
> 
>     > setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
>     > showClass("watch_circ")
>     Class "watch_circ" [in ".GlobalEnv"]
> 
>     Slots:
> 
>     Name:         ID        sp      time   endTime
>     Class: character   Spatial       xts   POSIXct
> 
>     Extends: "ST"
> 
>  
> 
>     >
> 
>     On 06/06/2015 07:58 AM, chris english wrote:
>     > Hi,
>     >
>     > I am attempting to extent spacetime ST to include an ID class for a
>     > spacetime watch circle object.  I am doing this in order to be able to
>     > relatively easily test that I have unique ID(s) across several similar
>     > objects for plotting purposes.
>     >
>     > I can build my watch circle:
>     >
>     >> setClass("watch_circ",
>     > + slots = c(sp = "Spatial", time = "xts", ID = "character",
>     > + endTime = "POSIXct"),
>     > + validity = function(object) {
>     > + stopifnot(length(object at sp) >= 1)
>     > + stopifnot(nrow(object at time) >= 1)
>     > + stopifnot(is.char(object at ID))
>     > + stopifnot(nrow(object at time) == length(object at endTime))
>     > + # do the tzones if not set, if set
>     > + tz1 = attr(object at time, "tzone")
>     > + tz2 = attr(object at emdTime, "tzone")
>     > + tz1.set = (!is.null(tz1) && !nchar(tz1)==0)
>     > + tz2.set = (!is.null(tz2) && !nchar(tz2)==0)
>     > + stopifnot(tz1 == tz2)
>     > + if (tz1.set)
>     > + stopifnot(tz1 == tz2)
>     > + if (any(names(object at time) %in% names(object at sp)))
>     > + stop("name conflict: attribute names in sp and time slot must
>     differ")
>     > + return(TRUE)
>     > + }
>     > + )
>     >> getClassDef('watch_circ')
>     > Class "watch_circ" [in ".GlobalEnv"]
>     >
>     > Slots:
>     >
>     > Name:         sp      time        ID   endTime
>     > Class:   Spatial       xts character   POSIXct
>     >
>     > But not extend ST.
>     >
>     >> setClass("watch_circ_1", representation = "ST")
>     >> getClassDef('watch_circ_1')
>     > Class "watch_circ_1" [in ".GlobalEnv"]
>     >
>     > Slots:
>     >
>     > Name:       sp    time endTime
>     > Class: Spatial     xts POSIXct
>     >
>     > Extends: "ST"
>     >> ?what am I doing wrong here?
>     >
>     > This is probably due to my shallow understanding of the difference
>     between
>     > slots and representation, and possibly this whole operation is
>     unnecessary
>     > if plot checks sp for unique ID(s) among objects.
>     >
>     > Thanks in advance,
>     >
>     > Cheers,
>     > Chris
>     >
>     >       [[alternative HTML version deleted]]
>     >
>     > _______________________________________________
>     > R-sig-Geo mailing list
>     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >
> 
>     --
>     Edzer Pebesma
>     Institute for Geoinformatics (ifgi),  University of M?nster,
>     Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
>     <tel:%2B49%20251%2083%2033081>
>     Journal of Statistical Software:   http://www.jstatsoft.org/
>     Computers & Geosciences:   http://elsevier.com/locate/cageo/
>     Spatial Statistics Society http://www.spatialstatistics.info
> 
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150607/0b053a8f/attachment.bin>

From englishchristophera at gmail.com  Mon Jun  8 05:42:40 2015
From: englishchristophera at gmail.com (chris english)
Date: Sun, 7 Jun 2015 23:42:40 -0400
Subject: [R-sig-Geo] Extend spacetime ST
In-Reply-To: <5574CAD4.2000900@uni-muenster.de>
References: <CAASFQpRBauxDmWDW1AO+MLBGQud9R__2dFd_oevw6javG0OBKQ@mail.gmail.com>
	<5572F9DE.1090107@uni-muenster.de>
	<CAASFQpQoR3rS3CT0h-cSbOvMu59hXGXR8h30sfa-Q5QQsZqtmg@mail.gmail.com>
	<5574CAD4.2000900@uni-muenster.de>
Message-ID: <CAASFQpTo8QPVrSh-4u5urzVeV1Oiwfi4a_jeoTXwKPgVDvDCPw@mail.gmail.com>

Thanks especially for reminding me of the ST vs STI  as of course I'm going
to want "[",
aggregate and over.  I remember reading ST was virtual and then forgot.

Cheers,
Chris

On Sun, Jun 7, 2015 at 6:51 PM, Edzer Pebesma <edzer.pebesma at uni-muenster.de
> wrote:

>
>
> On 06/07/2015 09:31 AM, chris english wrote:
> > Edzer,
> >
> > Upon implementing your suggested:
> >
> >> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> >> showClass("watch_circ")
> > Class "watch_circ" [in ".GlobalEnv"]
> >
> > Slots:
> >
> > Name:         ID        sp      time   endTime
> > Class: character   Spatial       xts   POSIXct
> >
> > Extends: "ST"
> >
> > I had to do more reading unless all I was going to say was "Wow".
> >
> >> setClass("watch_circ", contains = "ST", slots = c(ID = "character"))
> >> showClass("watch_circ")
> > Class "watch_circ" [in ".GlobalEnv"]
> >
> > Slots:
> >
> > Name:         ID        sp      time   endTime
> > Class: character   Spatial       xts   POSIXct
> >
> > Extends: "ST"
> >
> >> extends("watch_circ", fullInfo = TRUE)
> > $ST
> > An object of class "SClassExtension"
> > Slot "subClass":
> > [1] "watch_circ"
> >
> > Slot "superClass":
> > [1] "ST"
> >
> > Slot "package":
> > [1] ".GlobalEnv"
> >
> > Slot "coerce":
> > function (from, strict = TRUE)
> > {
> >     class(from) <- "ST"
> >     from
> > }
> >
> > Slot "test":
> > function (object)
> > TRUE
> > <bytecode: 0x19516f58>
> > <environment: namespace:methods>
> >
> > Slot "replace":
> > function (from, to, value)
> > {
> >     for (what in c("sp", "time", "ID", "endTime")) slot(from,
> >         what) <- slot(value, what)
> >     from
> > }
> >
> > Slot "simple":
> > [1] TRUE
> >
> > Slot "by":
> > character(0)
> >
> > Slot "dataPart":
> > [1] FALSE
> >
> > Slot "distance":
> > [1] 1
> >
> >
> > $watch_circ
> > [1] TRUE
> >
> >>
> > Is there a way to control the slots =c(ID, "character") order as to
> > prepending or postpending.
> > ie. (sp, time, endTime, ID) vs (ID, sp, time, endTime), or is the
> > behavior of subclassing the
> > superclass necessarily going to prepend the subclass slot(s) to the
> > superclass slots. It just seems on
> > a vernacular level that the order (sp, time, endTime, ID) is more
> > ST-like and signals the extending.
>
> Slot order does not matter, as they're addressed only by name.
>
> >
> > contains = does just what I need, or more properly want, is powerful,
> > and probably should be used
> > with caution by the magician's apprentice.
> >
> > contains also leads me back to my prior 'wish list' of epochal endTimes.
> > Even the constraint language
> > of ST construction:
> >
> > if (any(is.na <http://is.na>(endTime)))
> >         stop("NA endTime values not allowed")
> >
> > suggests toying with the concept of multiple (user defined) endTimes, or
> > it would merely say "NA endTime value not allowed", singular as to
> > value, full stop.  And with contains in mind and Pebesma (2008)
> > "Customizing spatial data
> > classes and methods" I start to see a way, ala Michael Sumner to
> > potentially using epochal endTimes
> > to extract all valid (or invalid for that matter) condition 2 quadrant 3
> > paths for normals and subjects to
> > evaluate as a TracksCollection.  Well, we'll see.
>
> You may want to think about subclassing STI instead of ST; ST is meant
> as a virtual class, not something to actually hold data. It has some
> methods, but only those that can be implemented identically for all
> subclasses. STI for instance has a subsetting method, "[", as well as
> over & aggregate.
>
> >
> > Thanks very much,
> >
> > Chris
> >
> >
> >
> >
> > On Sat, Jun 6, 2015 at 9:47 AM, Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> > wrote:
> >
> >     Chris, I'd use the following for a class "watch_circ" that extends ST
> >     and adds a character ID slot:
> >
> >     > setClass("watch_circ", contains = "ST", slots = c(ID =
> "character"))
> >     > showClass("watch_circ")
> >     Class "watch_circ" [in ".GlobalEnv"]
> >
> >     Slots:
> >
> >     Name:         ID        sp      time   endTime
> >     Class: character   Spatial       xts   POSIXct
> >
> >     Extends: "ST"
> >
> >
> >
> >     >
> >
> >     On 06/06/2015 07:58 AM, chris english wrote:
> >     > Hi,
> >     >
> >     > I am attempting to extent spacetime ST to include an ID class for a
> >     > spacetime watch circle object.  I am doing this in order to be
> able to
> >     > relatively easily test that I have unique ID(s) across several
> similar
> >     > objects for plotting purposes.
> >     >
> >     > I can build my watch circle:
> >     >
> >     >> setClass("watch_circ",
> >     > + slots = c(sp = "Spatial", time = "xts", ID = "character",
> >     > + endTime = "POSIXct"),
> >     > + validity = function(object) {
> >     > + stopifnot(length(object at sp) >= 1)
> >     > + stopifnot(nrow(object at time) >= 1)
> >     > + stopifnot(is.char(object at ID))
> >     > + stopifnot(nrow(object at time) == length(object at endTime))
> >     > + # do the tzones if not set, if set
> >     > + tz1 = attr(object at time, "tzone")
> >     > + tz2 = attr(object at emdTime, "tzone")
> >     > + tz1.set = (!is.null(tz1) && !nchar(tz1)==0)
> >     > + tz2.set = (!is.null(tz2) && !nchar(tz2)==0)
> >     > + stopifnot(tz1 == tz2)
> >     > + if (tz1.set)
> >     > + stopifnot(tz1 == tz2)
> >     > + if (any(names(object at time) %in% names(object at sp)))
> >     > + stop("name conflict: attribute names in sp and time slot must
> >     differ")
> >     > + return(TRUE)
> >     > + }
> >     > + )
> >     >> getClassDef('watch_circ')
> >     > Class "watch_circ" [in ".GlobalEnv"]
> >     >
> >     > Slots:
> >     >
> >     > Name:         sp      time        ID   endTime
> >     > Class:   Spatial       xts character   POSIXct
> >     >
> >     > But not extend ST.
> >     >
> >     >> setClass("watch_circ_1", representation = "ST")
> >     >> getClassDef('watch_circ_1')
> >     > Class "watch_circ_1" [in ".GlobalEnv"]
> >     >
> >     > Slots:
> >     >
> >     > Name:       sp    time endTime
> >     > Class: Spatial     xts POSIXct
> >     >
> >     > Extends: "ST"
> >     >> ?what am I doing wrong here?
> >     >
> >     > This is probably due to my shallow understanding of the difference
> >     between
> >     > slots and representation, and possibly this whole operation is
> >     unnecessary
> >     > if plot checks sp for unique ID(s) among objects.
> >     >
> >     > Thanks in advance,
> >     >
> >     > Cheers,
> >     > Chris
> >     >
> >     >       [[alternative HTML version deleted]]
> >     >
> >     > _______________________________________________
> >     > R-sig-Geo mailing list
> >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     >
> >
> >     --
> >     Edzer Pebesma
> >     Institute for Geoinformatics (ifgi),  University of M?nster,
> >     Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> >     <tel:%2B49%20251%2083%2033081>
> >     Journal of Statistical Software:   http://www.jstatsoft.org/
> >     Computers & Geosciences:   http://elsevier.com/locate/cageo/
> >     Spatial Statistics Society http://www.spatialstatistics.info
> >
> >
> >     _______________________________________________
> >     R-sig-Geo mailing list
> >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>

	[[alternative HTML version deleted]]


From Angelika.Gummert at gmx.de  Mon Jun  8 12:23:23 2015
From: Angelika.Gummert at gmx.de (Angelika Gummert)
Date: Mon, 8 Jun 2015 12:23:23 +0200
Subject: [R-sig-Geo] Counting kernelUD home range polygons
Message-ID: <trinity-cc96614e-5df1-44dd-a151-253622ba6ef7-1433759003014@3capp-gmx-bs28>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150608/ddfd16c5/attachment.html>

From dhaulsee at udel.edu  Mon Jun  8 18:17:59 2015
From: dhaulsee at udel.edu (Danielle Haulsee)
Date: Mon, 08 Jun 2015 16:17:59 +0000
Subject: [R-sig-Geo] error projecting with rgdal::project()
Message-ID: <CAOPy_r=_5uoa9aJAWMnRghqGR-VmZ6JC5knn+QbYrOwnfwya7A@mail.gmail.com>

Hello,

I recently updated R and a bunch of packages and am now finding bits of old
code that no longer run (of course!). Specifically I am having issues with
project() and spTransform(), likely both due to the same issue. It seems to
perhaps be an issue with rgdal or perhaps one of its dependencies because
the problem does not appear related to the r-version.

I ran the following example code on two different machines, both running

R version 3.0.3 (2014-03-06) -- "Warm Puppy", and either got an error or no
error depending on the version of rgdal installed.

*This version was successful. *
require(rgdal)

Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.9-1, (SVN revision 518)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75 +lat_2=39")

*This version gives me an error. *
require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.8-16, (SVN revision 498)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: /usr/share/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75 +lat_2=39")
*Error in project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
+lat_2=39") : *
*  major axis or radius = 0 or not given*

I also get the same error when running R version 3.2.0 (2015-04-16) --
"Full of Ingredients" and rgdal version:
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.9-2, (SVN revision 526)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
Path to GDAL shared files:
Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
Path to PROJ.4 shared files: (autodetected)

Does anyone have any ideas as to what is going on? I'm also getting the
same error (major axis or radius = 0 or not given), when using the
spTransform function. I've tried searching for this error and haven't come
up with much. Let me know if more information is needed. Thanks in advance
for any insight you might have.

  [image: photo]
*Danielle Haulsee*
PhD Candidate, University of Delaware
 m:(717)451-7636 | e:dhaulsee at udel.edu | w:www.orb.ceoe.udel.edu | a:700
Pilottown Rd. Lewes, DE 19958
    Get a signature like this:
<https://ws-stats.appspot.com/r?rdata=eyJydXJsIjogImh0dHA6Ly93d3cud2lzZXN0YW1wLmNvbS8/dXRtX3NvdXJjZT1leHRlbnNpb24mdXRtX21lZGl1bT1lbWFpbCZ1dG1fY2FtcGFpZ249cHJvbW9fNDUiLCAiZSI6ICJwcm9tb180NV9jbGljayJ9>
Click
here!
<https://ws-stats.appspot.com/r?rdata=eyJydXJsIjogImh0dHA6Ly93d3cud2lzZXN0YW1wLmNvbS8/dXRtX3NvdXJjZT1leHRlbnNpb24mdXRtX21lZGl1bT1lbWFpbCZ1dG1fY2FtcGFpZ249cHJvbW9fNDUiLCAiZSI6ICJwcm9tb180NV9jbGljayJ9>

	[[alternative HTML version deleted]]


From macqueen1 at llnl.gov  Mon Jun  8 20:33:06 2015
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 8 Jun 2015 18:33:06 +0000
Subject: [R-sig-Geo] error projecting with rgdal::project()
In-Reply-To: <CAOPy_r=_5uoa9aJAWMnRghqGR-VmZ6JC5knn+QbYrOwnfwya7A@mail.gmail.com>
References: <CAOPy_r=_5uoa9aJAWMnRghqGR-VmZ6JC5knn+QbYrOwnfwya7A@mail.gmail.com>
Message-ID: <D19B2AD8.12D610%macqueen1@llnl.gov>

If it helps (and since I could do it quickly and easily), I have success
with
  R 3.2.0
  gdal 1.11.2
  rgdal 0.9-3
  sp_1.1-0
  proj.4 4.9.1
(on a Mac; see below)

If I read your email correctly, that is a combination you haven't tried
(you have rgdal 0.9-2 with R 3.2.0).


> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.9-3, (SVN revision 530)
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
 Path to GDAL shared files:
/Users/macqueen1/Library/R/3.2/library/rgdal/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
 Path to PROJ.4 shared files:
/Users/macqueen1/Library/R/3.2/library/rgdal/proj
 Linking to sp version: 1.1-0
> 
> 
> tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
+ c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
> 
> xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
>+lat_2=39")
> 
> 
> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.9.5 (Mavericks)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.9-3 sp_1.1-0

loaded via a namespace (and not attached):
[1] grid_3.2.0      lattice_0.20-31
>



I don't know what "autodetected" in the path to proj.4 means, but that's
another difference between mine and yours.

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 6/8/15, 9:17 AM, "Danielle Haulsee" <dhaulsee at udel.edu> wrote:

>Hello,
>
>I recently updated R and a bunch of packages and am now finding bits of
>old
>code that no longer run (of course!). Specifically I am having issues with
>project() and spTransform(), likely both due to the same issue. It seems
>to
>perhaps be an issue with rgdal or perhaps one of its dependencies because
>the problem does not appear related to the r-version.
>
>I ran the following example code on two different machines, both running
>
>R version 3.0.3 (2014-03-06) -- "Warm Puppy", and either got an error or
>no
>error depending on the version of rgdal installed.
>
>*This version was successful. *
>require(rgdal)
>
>Loading required package: rgdal
>Loading required package: sp
>rgdal: version: 0.9-1, (SVN revision 518)
>Geospatial Data Abstraction Library extensions to R successfully loaded
>Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>Path to GDAL shared files:
>/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
>Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>Path to PROJ.4 shared files:
>/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
>tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
>c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
>xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
>+lat_2=39")
>
>*This version gives me an error. *
>require(rgdal)
>Loading required package: rgdal
>Loading required package: sp
>rgdal: version: 0.8-16, (SVN revision 498)
>Geospatial Data Abstraction Library extensions to R successfully loaded
>Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>Path to GDAL shared files: /usr/share/gdal
>Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>Path to PROJ.4 shared files: (autodetected)
>
>tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
>c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
>xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
>+lat_2=39")
>*Error in project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
>+lat_2=39") : *
>*  major axis or radius = 0 or not given*
>
>I also get the same error when running R version 3.2.0 (2015-04-16) --
>"Full of Ingredients" and rgdal version:
>Loading required package: rgdal
>Loading required package: sp
>rgdal: version: 0.9-2, (SVN revision 526)
>Geospatial Data Abstraction Library extensions to R successfully loaded
>Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
>Path to GDAL shared files:
>Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>Path to PROJ.4 shared files: (autodetected)
>
>Does anyone have any ideas as to what is going on? I'm also getting the
>same error (major axis or radius = 0 or not given), when using the
>spTransform function. I've tried searching for this error and haven't come
>up with much. Let me know if more information is needed. Thanks in advance
>for any insight you might have.
>
>  [image: photo]
>*Danielle Haulsee*
>PhD Candidate, University of Delaware
> m:(717)451-7636 | e:dhaulsee at udel.edu | w:www.orb.ceoe.udel.edu | a:700
>Pilottown Rd. Lewes, DE 19958
>    Get a signature like this:
><https://ws-stats.appspot.com/r?rdata=eyJydXJsIjogImh0dHA6Ly93d3cud2lzZXN0
>YW1wLmNvbS8/dXRtX3NvdXJjZT1leHRlbnNpb24mdXRtX21lZGl1bT1lbWFpbCZ1dG1fY2FtcG
>FpZ249cHJvbW9fNDUiLCAiZSI6ICJwcm9tb180NV9jbGljayJ9>
>Click
>here!
><https://ws-stats.appspot.com/r?rdata=eyJydXJsIjogImh0dHA6Ly93d3cud2lzZXN0
>YW1wLmNvbS8/dXRtX3NvdXJjZT1leHRlbnNpb24mdXRtX21lZGl1bT1lbWFpbCZ1dG1fY2FtcG
>FpZ249cHJvbW9fNDUiLCAiZSI6ICJwcm9tb180NV9jbGljayJ9>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Jun  9 05:51:54 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 9 Jun 2015 05:51:54 +0200
Subject: [R-sig-Geo] error projecting with rgdal::project()
In-Reply-To: <D19B2AD8.12D610%macqueen1@llnl.gov>
References: <CAOPy_r=_5uoa9aJAWMnRghqGR-VmZ6JC5knn+QbYrOwnfwya7A@mail.gmail.com>
	<D19B2AD8.12D610%macqueen1@llnl.gov>
Message-ID: <alpine.LFD.2.11.1506090517100.19287@reclus.nhh.no>

On Mon, 8 Jun 2015, MacQueen, Don wrote:

> If it helps (and since I could do it quickly and easily), I have success
> with
>  R 3.2.0
>  gdal 1.11.2
>  rgdal 0.9-3
>  sp_1.1-0
>  proj.4 4.9.1
> (on a Mac; see below)
>
> If I read your email correctly, that is a combination you haven't tried
> (you have rgdal 0.9-2 with R 3.2.0).
>
>
>> require(rgdal)
> Loading required package: rgdal
> Loading required package: sp
> rgdal: version: 0.9-3, (SVN revision 530)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
> Path to GDAL shared files:
> /Users/macqueen1/Library/R/3.2/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
> Path to PROJ.4 shared files:
> /Users/macqueen1/Library/R/3.2/library/rgdal/proj
> Linking to sp version: 1.1-0
>>
>>
>> tst <- cbind(c(-75.13574,-75.02346, -74.98747, -74.87270, -74.86581),
> + c(38.89733, 38.74623, 38.56410, 38.56395, 38.45108))
>>
>> xy <- project(tst, "+proj=tpeqd +lon_1=-80 +lat_1=33 +lon_2=-75
>> +lat_2=39")
>>
>>
>> sessionInfo()
> R version 3.2.0 (2015-04-16)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
>
> locale:
> [1] C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.9-3 sp_1.1-0
>
> loaded via a namespace (and not attached):
> [1] grid_3.2.0      lattice_0.20-31
>>
>
>
>
> I don't know what "autodetected" in the path to proj.4 means, but that's
> another difference between mine and yours.
>

The interpretation of the messages is (using my rgdal - Fedora 21, PROJ.4 
and GDAL installed from source):

> library(rgdal)
Loading required package: sp

* rgdal depends on sp, so attaches it if not already attached.

rgdal: version: 1.0-2, (SVN revision 532)

* the version of rgdal, together with the source code repository revision
   number. In released versions of rgdal, the version and revision number
   are in lockstep, in development versions not.

  Geospatial Data Abstraction Library extensions to R successfully loaded

* confirmation message.

  Loaded GDAL runtime: GDAL 2.0.0, released 2015/06/05

* version of GDAL runtime linked (dynamic for most source installs of
   rgdal - so the GDAL found on the platform, static for CRAN Windows and
   OSX binary packages, so included in the binary package)

>> * If you see: "but rgdal build and GDAL runtime not in sync: ...
    consider re-installing rgdal!!", pay attention, as the version of
    GDAL on your system is not the one used to compile code in the rgdal
    package. Often the API does not change, but the ABI is more fragile,
    and may need attention <<

  Path to GDAL shared files: /usr/local/share/gdal

* value returned by getGDAL_DATA_Path() - where the GDAL metadata files
   live. This is needed and if not present (a future version of rgdal will
   issue a warning if not found), GDAL was not completely installed, and
   gdal-config --datadir (or an environment variable) needs attention.

>> * some systems may warn: "GDAL does not use iconv for recoding strings"
>>   at this point - this refers to the possibility to change the encoding
>>   of data and field names read from shapefiles <<

  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]

* same for PROJ.4 runtime version - version of linked runtime.

  Path to PROJ.4 shared files: (autodetected)

* Either the location of PROJ.4 metadata files, for example for CRAN
   Windows and OSX binaries which ship with these files. In rgdal 0.9-3, an
   error in the PROJ.4 4.9.1 release is fixed. The PROJ.4 metadata file
   proj/proj_def.dat was forgotten in that release, and unfortunately rgdal
   used the presence of that file in the metadata folder to test whether to
   set the PROJ_LIB environment variable to the rgdal package location or
   not. The test is now on proj/nad.lst. A symptom of proj/proj_def.dat not
   being found or present is the major axis/radius error essage from the
   PROJ.4 runtime. All projection definitions should have at least one tag
   defining the size of the ellipsoid, but if omitted and
   proj/proj_def.dat, the default +ellps=WGS84 is added. If you see the
   error in rgdal < 0.9-3, your installation of PROJ.4 (either platform or
   in the CRAN OSX Mavericks binary for a few days in May 2015) is
   incomplete. The best remedy is to update rgdal to >= 0.9-3 or put a copy
   of the missing file in the appropriate place (in rgdal/proj/ for CRAN
   OSX or Windows binaries [1].

  Linking to sp version: 1.1-0

* shows the version of sp compiled code linked to rgdal compiled code.

The code used to produce the messages is in:

https://r-forge.r-project.org/scm/viewvc.php/pkg/R/AAA.R?view=markup&revision=530&root=rgdal

Hope this clarifies,

Roger

[1] https://svn.osgeo.org/metacrs/sr.org/epsg/proj/proj_def.dat

>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From sadaouimahrez at outlook.com  Tue Jun  9 14:05:49 2015
From: sadaouimahrez at outlook.com (sadaoui)
Date: Tue, 9 Jun 2015 05:05:49 -0700 (MST)
Subject: [R-sig-Geo] I can not install the package RHydro on my computer
	(windows)
Message-ID: <1433851549501-7588448.post@n2.nabble.com>

Hello,

I want to know how to install the package RHydro  in R (3.2) ( computer with
windows system)

I try this in R : 

> install.packages("RHydro", repos="http://R-Forge.R-project.org")


Installing package into ?C:/Users/sadaoui/Documents/R/win-library/3.2?
(as ?lib? is unspecified)
Warning in install.packages :
  dependency ?lhs? is not available
also installing the dependency ?qualV?

Packages which are only available in source form, and may need compilation
of C/C++/Fortran: ?qualV? ?RHydro?
  These will not be installed

best regards 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/I-can-not-install-the-package-RHydro-on-my-computer-windows-tp7588448.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From debangs at uwaterloo.ca  Tue Jun  9 20:20:33 2015
From: debangs at uwaterloo.ca (Donovan Bangs)
Date: Tue, 9 Jun 2015 14:20:33 -0400
Subject: [R-sig-Geo] RSAGA Package Update Available
Message-ID: <001801d0a2e0$fd553c20$f7ffb460$@connect.uwaterloo.ca>

Greetings R-sig-Geo,

The latest version of RSAGA (0.94-1) is now available on CRAN. This package
provides access to geocomputing and terrain analysis functions of SAGA GIS
by running the command line version of SAGA. Updates to this package are
compatible with SAGA versions 2.0.4 to 2.1.4.

Current users of RSAGA - please note that some function changes may affect
older scripts, particularly using the "Slope, Aspect, Curvature" module of
SAGA. Please see details of these changes at:
github.com/debangs/RSAGA

Cheers,

Donovan Bangs
University of Waterloo
github.com/debangs


From Angelika.Gummert at gmx.de  Wed Jun 10 14:16:46 2015
From: Angelika.Gummert at gmx.de (Angelika Gummert)
Date: Wed, 10 Jun 2015 14:16:46 +0200
Subject: [R-sig-Geo] Counting kernelUD home range polygons
Message-ID: <000001d0a377$52f63fd0$f8e2bf70$@gmx.de>

Hi,

I am sending my question again since there was a problem with my email,
making my message unreadable in the archive.

 

-------

 

Hi,

I wanted to count the number of polygons (home ranges of my species) inside
a grid in order to estimate the number of species in a given area.  I
followed the example on this website, but it doesn't work properly:
<https://3c.gmx.net/mail/client/dereferrer?redirectUrl=http%3A%2F%2Fgis.stac
kexchange.com%2Fquestions%2F116388%2Fcount-overlapping-polygons-in-single-sh
ape-file-with-r>
http://gis.stackexchange.com/questions/116388/count-overlapping-polygons-in-
single-shape-file-with-r

 

Here is what I did:

 

#Data

You can download a part of my data here:
<https://3c.gmx.net/mail/client/dereferrer?redirectUrl=http%3A%2F%2Fwww.link
file.de%2Fdownload-136449c43d7939ea2de29accbc9cc981.php>
http://www.linkfile.de/download-136449c43d7939ea2de29accbc9cc981.php

 

#Calculation of the species home range

 

Fishsplit<-split(Data, f=Data$Species ) #split data

HaeVit<-Fishsplit[["Haemulon vittata"]]

HaeVit2 <- SpatialPoints(HaeVit[,2:3])

HaeVitKernel<-kernelUD(HaeVit2,  kern ="epa") #home range estimation

HomeRange1 <- getverticeshr(HaeVitKernel, 95) #create Polygon

 

Question1: I repeated the calculation for each individual species. I have in
total around 600 species, so it will take a long time if I do it like this.
The function kernelUD returns a list of elements of class estUD when the
object xy passed as argument contains the relocations of several animals
(i.e., belong to the class SpatialPointsDataFrame). But somehow I am unable
to convert my species data to  a SpatialPointsDataFrame which allows me to
calculate several home ranges.

 

Question2: I would like to define a barrier (boundary of the Ocean) that
cannot be crossed by the animals. I know that there is an argument named
boundary, but I don't know how I can used it in order to add the ocean
borders of the Caribbean sea (shapefile) as boundary.

 

# Load shapefile of the Caribbean Sea (you are able to download it at
<https://3c.gmx.net/mail/client/dereferrer?redirectUrl=http%3A%2F%2Fwww.natu
ralearthdata.com%2Fdownloads%2F10m-physical-vectors%2F10m-ocean%2F>
http://www.naturalearthdata.com/downloads/10m-physical-vectors/10m-ocean/

 

World <- readOGR(dsn = "Z:/./Oceans", layer = "LME66") 

Caribbean <- World[World at data$OBJECTID %in% c("25"),]

 

#create a grid

 

bb <- bbox(Caribbean)

cs <- c(1, 1)*0.5 # cell size

cc <- bb[, 1] + (cs/2)  # cell offset

cd <- ceiling(diff(t(bb))/cs)  # number of cells per direction

grd <- GridTopology(cellcentre.offset=cc, cellsize=cs, cells.dim=cd)

grd

 

# find the count of polygons below each grid cell

 

sp_grd <- SpatialGrid(grd)

proj4string(sp_grd) <- CRS("+proj=cea +datum=WGS84 +ellps=WGS84
+towgs84=0,0,0")   

 

Polygons<-Homerange1+ Homerange 2+ Homerange 3+ Homerange 4

 

Question3: I don't know how I should "combine" the polygons. This is not
working since I can not count the polygons (see result). I don't know if it
is even necessary if I calculate the home range for several species at once.

 

PolygonsSP<- as(Polygons, "SpatialPolygons")

crs(sp_grd)<-crs(PolygonsSP)

o <- over(sp_grd, CombinedPolyTestSP, returnList=TRUE)

ct <- sapply(o, length)

summary(ct)

SGDF <- SpatialGridDataFrame(sp_grd, data=data.frame(ct=ct))

 

# plot

 

spplot (SGDF, "ct", colorkey=TRUE,col.regions=colorRampPalette(c("white",
"red"), bias=2),

             panel = function(...) {

                  panel.gridplot(..., border="black")

                  sp.polygons(Caribbean)

                  sp.points(Data[,2:3], cex=1,pch = 20, col="black")

               })

 

Result: the plot shows, that only 1 Polygon was counted in each grid cell.
So the 4 home range polygons were counted as one.

 

I hope you can help me to fix this problem,

Best regards

 


	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Jun 10 14:36:11 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 10 Jun 2015 14:36:11 +0200
Subject: [R-sig-Geo] I can not install the package RHydro on my computer
 (windows)
In-Reply-To: <1433851549501-7588448.post@n2.nabble.com>
References: <1433851549501-7588448.post@n2.nabble.com>
Message-ID: <55782F3B.6030004@uni-muenster.de>

R for windows faq 4.1:

http://cran.r-project.org/bin/windows/base/rw-FAQ.html#Can-I-install-packages-into-libraries-in-this-version_003f

short answer: install Rtools first.

On 06/09/2015 02:05 PM, sadaoui wrote:
> Hello,
> 
> I want to know how to install the package RHydro  in R (3.2) ( computer with
> windows system)
> 
> I try this in R : 
> 
>> install.packages("RHydro", repos="http://R-Forge.R-project.org")
> 
> 
> Installing package into ?C:/Users/sadaoui/Documents/R/win-library/3.2?
> (as ?lib? is unspecified)
> Warning in install.packages :
>   dependency ?lhs? is not available
> also installing the dependency ?qualV?
> 
> Packages which are only available in source form, and may need compilation
> of C/C++/Fortran: ?qualV? ?RHydro?
>   These will not be installed
> 
> best regards 
> 
> 
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/I-can-not-install-the-package-RHydro-on-my-computer-windows-tp7588448.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150610/08da4b51/attachment.bin>

From jaonyango at yahoo.com  Wed Jun 10 17:35:57 2015
From: jaonyango at yahoo.com (Joshua Onyango)
Date: Wed, 10 Jun 2015 15:35:57 +0000 (UTC)
Subject: [R-sig-Geo] Plotting box plots boxplots
Message-ID: <364748107.301995.1433950557077.JavaMail.yahoo@mail.yahoo.com>

Hello?
I am trying to plot some box plots in ggplot2 for disease cases against a risk factor where this should appear in 8 coded regions. However when I try run this in R I keep getting this error message: ggplot2 doesn't know how to deal with data of class Spatial Points Data Frame.

?Here is the script:?
qplot(factor(Region.Coding), Cases2012, data=orf, geom_poin=c("boxplot", "jitter"),? ? ? main="2012 Cases by Nettles and Regions",fill=factor(Nettles),? ? ? xlab="Regions", ylab="Number of cases")
Any help will be highly appreciated
Thanks
Josh
?
	[[alternative HTML version deleted]]


From Dominik.Schneider at colorado.edu  Wed Jun 10 17:43:16 2015
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Wed, 10 Jun 2015 09:43:16 -0600
Subject: [R-sig-Geo] Plotting box plots boxplots
In-Reply-To: <364748107.301995.1433950557077.JavaMail.yahoo@mail.yahoo.com>
References: <364748107.301995.1433950557077.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAHYDKLYH1oOs3Nom-rN1-BwdCeizt2EdzehD+VCJU7hi5z4yMg@mail.gmail.com>

Josh -
ggplot doesn't work with the spatial classes of data.  try doing
orf.df=as.data.frame(orf)   first and then plotting orf.df.

Also, you have at least one typo - it should be geom_poin*t*
I always get confused with the qplot syntax so not sure if the rest if
right. I think ggplot()+ is much easier syntax.
ds




On Wed, Jun 10, 2015 at 9:35 AM, Joshua Onyango via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hello
> I am trying to plot some box plots in ggplot2 for disease cases against a
> risk factor where this should appear in 8 coded regions. However when I try
> run this in R I keep getting this error message: ggplot2 doesn't know how
> to deal with data of class Spatial Points Data Frame.
>
>  Here is the script:
> qplot(factor(Region.Coding), Cases2012, data=orf, geom_poin=c("boxplot",
> "jitter"),      main="2012 Cases by Nettles and
> Regions",fill=factor(Nettles),      xlab="Regions", ylab="Number of cases")
> Any help will be highly appreciated
> Thanks
> Josh
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jo.lists at gmail.com  Wed Jun 10 18:07:06 2015
From: jo.lists at gmail.com (JiHO)
Date: Wed, 10 Jun 2015 18:07:06 +0200
Subject: [R-sig-Geo] correlation betwee two grids acounting for
 univariate spatial autocorrelation, how to do it?
In-Reply-To: <53065A18.5010000@upm.es>
References: <025b01cf2e6c$c1a25260$44e6f720$@csic.es> <53065A18.5010000@upm.es>
Message-ID: <CAKhbdUYj_ftMFMfqTBWObLYCL9FR7OUQQOjZ9O6-9amNmK8iNA@mail.gmail.com>

Hi,

Sorry to revive an old topic but I have the exact same problem and was
wondering whether you found a solution. I've been looking into Lee's L
but have the same concerns. I had implemented Syrjala's test (before
the ecespa package even existed!) but it is not appropriate for the
type of data I am dealing with now (not abundances).

I would be very interested in any pointer.

The current state of my thinking about this issue is this:
- let A and B be two variables sampled at the same locations
- let r be a measure of correlation between A and B at all sites (a
simple one would be Pearson's correlation coefficient)
- let I be a measure of the global spatial autocorrelation of one
variable (for, example Moran's I)
- then, we can simulate a spatial pattern with the same spatial
autocorrelation characteristic as A (same I) and the same range of
values (by sampling them in observed values of A for example), do the
same for B, compute r for these two simulated distributions.
Repeat this 1000 times and compare r_observed to the 1000 simulated r;
that would give me a measure of the probability of getting my observed
correlation at random, taking into account the autocorrelation of each
variable.

Does this thinking make sense?

If it does, so far I am stuck trying to simulate distributions with
the same Moran's I as my observed distribution. I've seen:
https://stat.ethz.ch/pipermail/r-sig-geo/2011-September/012679.html
but I am not sure how to get from rho to I or how to estimate rho on
my observed data.

I have also found:
Simulating two?dimensional autocorrelated surfaces
R Haining, DA Griffith, R Bennett - Geographical Analysis, 1983
http://onlinelibrary.wiley.com/store/10.1111/j.1538-4632.1983.tb00785.x/asset/j.1538-4632.1983.tb00785.x.pdf?v=1&t=iaqvy4zx&s=64a6bf69d77c2588c66c332006f380f78cc8b80f
which points to
Algorithm 9: Simulation of autocorrelation for aggregate data
MF Goodchild - Environment and Planning A, 1980
http://envplan.com/fulltext_temp/0/a121073.pdf
but it is a rather brute force approach to getting close to I and it
does not seem feasible with a large number of sites.

Thanks in advance for your help! Sincerely,


On Thu, Feb 20, 2014 at 8:40 PM, Marcelino de la Cruz
<marcelino.delacruz at upm.es> wrote:
> Hi Jes?s,
>
> If you are talking about gridded maps, you could consider Syrjala's test
> (Stephen E. Syrjala 1996. A Statistical Test for a Difference between the
> Spatial Distributions of Two Populations. Ecology 77:75?80.
> http://dx.doi.org/10.2307/2265656). It is implemented in the ecespa package.
>
>
> Cheers,
>
> Marcelino
>
>
>
>
> El 20/02/2014 19:51, Jes?s Mu?oz escribi?:
>>
>> Dear colleagues,
>>
>> I needed to measure the association degree (and ideally its p-value)
>> between
>> two maps, one representing richness of European bryophytes and the other
>> vascular plant richeness. From the maps it is clear the two patterns are
>> reversed: bryophytes 'rule' in the north, and vascular plant richness is
>> higher in  southern Europe.
>>
>> I have used isodata algorithm followed by a Maximum-likelihood
>> classification to generate a map showing four different areas in Europe
>> (lowbryo-lowvasc, lowbryo-highvasc, highbryo-lowvasc, and
>> highbryo-highvasc). Additionally, I would like to run a correlation
>> analysis
>> but corrected for the univariate spatial correlation of each variable
>> (bryophytes and vascular plant richness); a global correlation map-to-map
>> is
>> meaningless here.
>>
>> I found a statistic that would suit my needs (Lee, S.-I. 2001. Developing
>> a
>> bivariate spatial association measure: An integration of Pearson's r and
>> Moran's I. Journal of Geographical Systems 3(4): 369-385). It is
>> implemented
>> in 'The Map Comparison Kit' (http://www.riks.nl/mck/), but it return
>> values
>> outside the -1 to 1 values, which makes me think there is something wrong
>> in
>> the code or the statistic.
>>
>> Can somebody guide me to a R package allowing me to measure the
>> association
>> between these two grids?
>>
>> thanks in advance,
>>
>> Jes?s
>>
>>
>>
>>
>>
>> *************************************************************************
>>
>> Jes?s Mu?oz PhD            e-mail: jmunoz at rjb.csic.es
>>
>> Real Jard?n Bot?nico (CSIC)
>>
>> C/ Claudio Moyano 1        tlf. +34 91 420 3017
>>
>> E-28014 Madrid             fax. +34 91 420 0157
>>
>> ESPA?A (Spain)
>>
>>
>>
>> http://www.masterenbiodiversidad.org
>>
>>
>>
>>
>> http://www.rjb.csic.es/jardinbotanico/jardin/contenido.php?Pag=413&tipo=cien
>> tifico&cod=66
>>
>>
>>
>> KRAKEN research group (environmental modelling, data processing &
>> analysis):
>>
>>
>> http://www.unex.es/investigacion/grupos/kraken
>>
>>
>>
>> SYNTHESYS: EU funds short visits to our institution:
>>
>> http://www.synthesys.info/index.htm
>>
>> *************************************************************************
>>
>>
>>
>>
>>
>> __________ Informaci?n de ESET Endpoint Security, versi?n de la base de
>> firmas de virus 9449 (20140220) __________
>>
>> ESET Endpoint Security ha comprobado este mensaje.
>>
>> http://www.eset.com
>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jaonyango at yahoo.com  Wed Jun 10 18:52:13 2015
From: jaonyango at yahoo.com (Joshua Onyango)
Date: Wed, 10 Jun 2015 16:52:13 +0000 (UTC)
Subject: [R-sig-Geo] Plotting box plots boxplots
In-Reply-To: <CAHYDKLYH1oOs3Nom-rN1-BwdCeizt2EdzehD+VCJU7hi5z4yMg@mail.gmail.com>
References: <CAHYDKLYH1oOs3Nom-rN1-BwdCeizt2EdzehD+VCJU7hi5z4yMg@mail.gmail.com>
Message-ID: <2137020901.391382.1433955133946.JavaMail.yahoo@mail.yahoo.com>

Many thanks Domnik - your suggestion worked perfectly fine
Josh 


     On Wednesday, 10 June 2015, 16:43, Dominik Schneider <Dominik.Schneider at Colorado.EDU> wrote:
   

 Josh - 
ggplot doesn't work with the spatial classes of data.? try doing
orf.df=as.data.frame(orf)?? first and then plotting orf.df.

Also, you have at least one typo - it should be geom_point
I always get confused with the qplot syntax so not sure if the rest if right. I think ggplot()+ is much easier syntax.
ds




On Wed, Jun 10, 2015 at 9:35 AM, Joshua Onyango via R-sig-Geo <r-sig-geo at r-project.org> wrote:

Hello?
I am trying to plot some box plots in ggplot2 for disease cases against a risk factor where this should appear in 8 coded regions. However when I try run this in R I keep getting this error message: ggplot2 doesn't know how to deal with data of class Spatial Points Data Frame.

?Here is the script:?
qplot(factor(Region.Coding), Cases2012, data=orf, geom_poin=c("boxplot", "jitter"),? ? ? main="2012 Cases by Nettles and Regions",fill=factor(Nettles),? ? ? xlab="Regions", ylab="Number of cases")
Any help will be highly appreciated
Thanks
Josh
?
? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




  
	[[alternative HTML version deleted]]


From jaonyango at yahoo.com  Wed Jun 10 21:50:13 2015
From: jaonyango at yahoo.com (Joshua Onyango)
Date: Wed, 10 Jun 2015 19:50:13 +0000 (UTC)
Subject: [R-sig-Geo] Disease Mapping & Spatial Statistics
Message-ID: <1287170638.512309.1433965813967.JavaMail.yahoo@mail.yahoo.com>

Hello
I am just started learning how to use R and do find this forum helpful.

I want to carry out spatial statistics and disease mapping to explain possible differences in distribution in 8 regions of England.?
1. How can I go about importing a nice map of England with eight regions plus boundaries similar to the one found on goggle -?http://www.britaingallery.com/england_regions.php
?2. Map cases per regions
3. Apply spatial statistics if possible to show how factors of interests such as latitude, mean temperature, precipitation, flock size and vegetation (thistles) could be used to explain differences is distribution of cases.
Any response will be highly appreciated
Thanks
Josh
	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Thu Jun 11 11:40:28 2015
From: englishchristophera at gmail.com (chris english)
Date: Thu, 11 Jun 2015 05:40:28 -0400
Subject: [R-sig-Geo] Disease Mapping & Spatial Statistics
In-Reply-To: <1287170638.512309.1433965813967.JavaMail.yahoo@mail.yahoo.com>
References: <1287170638.512309.1433965813967.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAASFQpQd1Z_b15w+wDBwkdqB1CL1=wOraexhc6Vxvq13mF+fFQ@mail.gmail.com>

Hi Josh,

I find this forum very helpful as well and like yourself am new to and
learning R and spatial statistics.  With that in mind I will leave some of
your specifics aside to those better qualified (for example your earlier
discussion with Dominik regarding box plots in ggplot) and describe a
process I use to better ground myself in both understanding and finally
executing what I want (hope) to accomplish.

Like yourself I generally have a specific that I am chasing, but over time
I've found it is less productive for me to chase it directly, and that I am
(eventually) better grounded if I start from a ten thousand foot view. I
still want to achieve my specifics, but I also want to understand
comprehensively what happened in the course of the process especially if I
am going to report/defend results.  Basically I don't want to view the
'lines of code' that got me to my particular specific as a kind of 'black
box' that worked, but rather I want to understand the step by step and be
able to reprise whether the result arrived at was the specific I intended,
or that my originally imagined specific was appropriate to the analysis I
hoped to perform.

I start with a couple of assumptions: many researchers have had the same
problem before, gotten stuck, and asked for help (and probably gotten help
or gotten some suggestions).  So I start with a couple of google searches:

cran r (avian) disease mapping vignettes

(some package) site:stat.ethz.ch (avian) disease mapping vignettes

and work the vignettes (as in type it out) to get a sense of how someone
else solved the problem. And maybe that's sufficient.  But it allows me the
opportunity to examine a range of items (how is my ground cover data
structured, how are my disease instances structured, does the data I have
fit with the assumptions of a package I've elected to use, is there a
direct or indirect coersion path between packages that allows me to use the
tools of a given package upon an object of another & etc).

Then I can drill in and see if I can address my specifics and derive
results that are reasonable and understandable to me (and others).

Finally I read as much code as I can and see if I can get an inkling of
what is going on where and when, and potentially why.

http://stackoverflow.com/questions/19226816/how-can-i-view-the-source-code-for-a-function

And read source code where ever I can find it.

It is something of a grind to step back and do this, but it has given me a
better appreciation of the wealth of tools available.  And even as they may
not be applicable to my problem at hand, to the extent that I understand my
problem, knowing about them informs me for analyzing future problems to
which they may be more properly applicable.

The foregoing process may not be applicable to your present needs, but I
imagine it may help with developing a sense of fluency within this system
of tools.  Of course eventually I may regret every word here, but this
approach has helped me so far.

HTH,
Cheers
Chris



On Wed, Jun 10, 2015 at 3:50 PM, Joshua Onyango via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hello
> I am just started learning how to use R and do find this forum helpful.
>
> I want to carry out spatial statistics and disease mapping to explain
> possible differences in distribution in 8 regions of England.
> 1. How can I go about importing a nice map of England with eight regions
> plus boundaries similar to the one found on goggle -
> http://www.britaingallery.com/england_regions.php
>  2. Map cases per regions
> 3. Apply spatial statistics if possible to show how factors of interests
> such as latitude, mean temperature, precipitation, flock size and
> vegetation (thistles) could be used to explain differences is distribution
> of cases.
> Any response will be highly appreciated
> Thanks
> Josh
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From adrian.stoica at icbcluj.ro  Thu Jun 11 12:03:18 2015
From: adrian.stoica at icbcluj.ro (Adi)
Date: Thu, 11 Jun 2015 03:03:18 -0700 (MST)
Subject: [R-sig-Geo] Failure during raster IO
In-Reply-To: <1372118637340-7583906.post@n2.nabble.com>
References: <CAPD=AxpFNas=+yxg_cUK9-+GXT6s4ED6GBaswKtah-WiRmRmhQ@mail.gmail.com>
	<CANtt_hxEcK7FPxrjDUQXTO4vFQHsKsDW6JfDmkD+jjOVs_VfrA@mail.gmail.com>
	<1359672082466-7582447.post@n2.nabble.com>
	<CANtt_hzt3Lt_p9nsF6ro=u8L-Uf5BMkOT2Cj9ufAsMSuZV51mA@mail.gmail.com>
	<1372118637340-7583906.post@n2.nabble.com>
Message-ID: <1434016998368-7588458.post@n2.nabble.com>

I just got "Failure during raster IO" error when I used the extract function
in the raster package.
I was working with a big raster stack (43 rasters).
The cause was that one of these rasters was corrupted on the disk.
It would be useful to check with a GIS viewer each raster individually.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Failure-during-raster-IO-tp7582421p7588458.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From acanion at gmail.com  Thu Jun 11 15:56:46 2015
From: acanion at gmail.com (acanion)
Date: Thu, 11 Jun 2015 06:56:46 -0700 (MST)
Subject: [R-sig-Geo] Gaussian transformation
In-Reply-To: <CAGOAjXPkRuD-a1yEkFcAE85jRss2vwdZts1fuKPviYg=MD8o_g@mail.gmail.com>
References: <CAGOAjXPkRuD-a1yEkFcAE85jRss2vwdZts1fuKPviYg=MD8o_g@mail.gmail.com>
Message-ID: <1434031006782-7588459.post@n2.nabble.com>

Carlo,

I am also interested in this because I'm working with groundwater nitrate
data that is zero-inflated.  

I wrote some code to perform the Gaussian anamorphosis in RGeostats (see the
example below with Meuse data), then do the kriging and simulation in gstat,
and finally back-transform the results using RGeostats.  I am not a serious
geostatistics person, so it would be nice if someone could confirm that this
is ok to do.  

My main issue is that the gaussian anamorphosis fit doesn't really seem to
work with this zero inflated data, altough I've seen references that say it
should 
(e.g, http://www.sciencedirect.com/science/article/pii/S0269749104002738).  
Any thoughts from the community here?

Anyway, here is my example code with the meuse data set.  The final result
is a data frame with x/y coordinates and each simulation result.  If you run
enough simluations, you can calcuate probabilities of exceeding a
concentration at each point.  

#01. Fit Gaussian Anamorphosis 
mdb = meuse[,c("x","y","zinc")] #must be 3 columns: x,y,z
mdb.rgdb = db.create(mdb,ndim=2,autoname=F)
mdb.herm = anam.fit(mdb.rgdb,name="zinc",type="hermitian")
mdb.hermtrans =
anam.z2y(mdb.rgdb,names=db.getname(mdb.rgdb,"z",1),anam=mdb.herm)
zinc.trans = mdb.hermtrans at items$Gaussian.zinc

#02. Variogram fit to gaussian transformed data using gstat 
meuse$zn.trans= zinc.trans
coordinates(meuse) = ~x+y
zn.svgm <- variogram(zn.trans~1,data=meuse)
vgm1 = vgm(1.17,"Sph",1022, 0.0925)
plot(zn.svgm,vgm1)
meuse.gstat <- gstat(id="zn.trans", formula=zn.trans~1, model=vgm1,
data=meuse,nmin=2, nmax=30)

#03. Kriging predictions with 4 simulations for simplicity (gstat)
data(meuse.grid)
coordinates(meuse.grid) = ~x+y
gridded(meuse.grid)=T
nsim = 4
zntrans.ok = predict.gstat(meuse.gstat,meuse.grid,nsim=nsim) #multiple
simulations

#04. Back transform using RGeostats
zn.bts = cbind(coordinates(zntrans.ok),zntrans.ok at data)
zn.bts.db = db.create(zn.bts,autoname = F)
transout = zn.bts
transout[,3:length(transout)]=NA

  #This loops through each  item in the RGeostats DB and backtransform it
for(i in 4:(nsim+4)){
  
  sim = db.getname(zn.bts.db,rank = i)
  simtrans = paste("Raw.",sim,sep="")
  tempdb = anam.y2z(zn.bts.db,names=sim,anam = mdb.herm)
  transout[,i-1] = eval(parse(text =
paste("tempdb at items$",simtrans,sep="")))
  
} 











--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Gaussian-transformation-tp7588126p7588459.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From strimas at zoology.ubc.ca  Fri Jun 12 18:23:38 2015
From: strimas at zoology.ubc.ca (Matt Strimas-Mackey)
Date: Fri, 12 Jun 2015 09:23:38 -0700
Subject: [R-sig-Geo] Error in sp::aggregate() when raster package is loaded
Message-ID: <CAHb9yCAUcSPfVMSwLGKBFR3xWWRDMpmTsQAFOB5h+s=EXmENVA@mail.gmail.com>

I'm trying to run sp::aggregate() with SpatialPolygons objects.
Everything works as expected, unless the raster package is loaded in
which case I get the following error:

Error in unique.default(v) : unique() applies only to vectors

I suppose I could unload and reload raster, but ideally I'd like to
avoid this. I'm running this on a Mac in RStudio with R version: 3.2.0
(2015-04-16) -- "Full of Ingredients". All packages are up to date.

Here's a example from the help for aggregate(), which reproduces the error:


library(sp)
library(raster) # Error unless this line is commented out

# Area-weighted example, using two partly overlapping grids:

gt1 = SpatialGrid(GridTopology(c(0,0), c(1,1), c(4,4)))
gt2 = SpatialGrid(GridTopology(c(-1.25,-1.25), c(1,1), c(4,4)))

# convert both to polygons; give p1 attributes to aggregate
p1 = SpatialPolygonsDataFrame(as(gt1, "SpatialPolygons"),
                              data.frame(v = 1:16, w=5:20,
x=factor(1:16)), match.ID = FALSE)
p2 = as(gt2, "SpatialPolygons")

# all-factor attributes: compute area-dominant factor level:
ret = aggregate(p1["x"], p2, areaWeighted = TRUE)
# Error in unique.default(v) : unique() applies only to vectors


Thanks!


From strimas at zoology.ubc.ca  Fri Jun 12 19:10:29 2015
From: strimas at zoology.ubc.ca (Matt Strimas-Mackey)
Date: Fri, 12 Jun 2015 10:10:29 -0700
Subject: [R-sig-Geo] Error in sp::aggregate() when raster package is
	loaded
In-Reply-To: <CAHb9yCAUcSPfVMSwLGKBFR3xWWRDMpmTsQAFOB5h+s=EXmENVA@mail.gmail.com>
References: <CAHb9yCAUcSPfVMSwLGKBFR3xWWRDMpmTsQAFOB5h+s=EXmENVA@mail.gmail.com>
Message-ID: <CAHb9yCCZpU=p6XiNmVe1OAV8WKvPPLKHpVzv32Fjoxxzn96--w@mail.gmail.com>

It seems I posted this too soon and I've answered my own question.
Obviously, raster has its own aggregate function, and I now realize
the error is occurring because raster::aggregate was being called
rather than sp::aggregate. Oddly, when I tried sp::aggregate() or
sp:::aggregate(), I get
Error: 'aggregate' is not an exported object from 'namespace:sp'
and
Error in get(name, envir = asNamespace(pkg), inherits = FALSE) :
  object 'aggregate' not found
respectively. However, I finally managed to fix this using:

spAgg <- get('aggregate', envir=as.environment("package:sp"))
ret2 <- spAgg(p1["x"], p2, areaWeighted = TRUE)

Apologies for posting unnecessarily!

On Fri, Jun 12, 2015 at 9:23 AM, Matt Strimas-Mackey
<strimas at zoology.ubc.ca> wrote:
> I'm trying to run sp::aggregate() with SpatialPolygons objects.
> Everything works as expected, unless the raster package is loaded in
> which case I get the following error:
>
> Error in unique.default(v) : unique() applies only to vectors
>
> I suppose I could unload and reload raster, but ideally I'd like to
> avoid this. I'm running this on a Mac in RStudio with R version: 3.2.0
> (2015-04-16) -- "Full of Ingredients". All packages are up to date.
>
> Here's a example from the help for aggregate(), which reproduces the error:
>
>
> library(sp)
> library(raster) # Error unless this line is commented out
>
> # Area-weighted example, using two partly overlapping grids:
>
> gt1 = SpatialGrid(GridTopology(c(0,0), c(1,1), c(4,4)))
> gt2 = SpatialGrid(GridTopology(c(-1.25,-1.25), c(1,1), c(4,4)))
>
> # convert both to polygons; give p1 attributes to aggregate
> p1 = SpatialPolygonsDataFrame(as(gt1, "SpatialPolygons"),
>                               data.frame(v = 1:16, w=5:20,
> x=factor(1:16)), match.ID = FALSE)
> p2 = as(gt2, "SpatialPolygons")
>
> # all-factor attributes: compute area-dominant factor level:
> ret = aggregate(p1["x"], p2, areaWeighted = TRUE)
> # Error in unique.default(v) : unique() applies only to vectors
>
>
> Thanks!


From edzer.pebesma at uni-muenster.de  Fri Jun 12 21:43:04 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 12 Jun 2015 21:43:04 +0200
Subject: [R-sig-Geo] Error in sp::aggregate() when raster package is
	loaded
In-Reply-To: <CAHb9yCCZpU=p6XiNmVe1OAV8WKvPPLKHpVzv32Fjoxxzn96--w@mail.gmail.com>
References: <CAHb9yCAUcSPfVMSwLGKBFR3xWWRDMpmTsQAFOB5h+s=EXmENVA@mail.gmail.com>
	<CAHb9yCCZpU=p6XiNmVe1OAV8WKvPPLKHpVzv32Fjoxxzn96--w@mail.gmail.com>
Message-ID: <557B3648.5010604@uni-muenster.de>

Thanks for bringing this up, Matt. I appreciate your creative solution,
but this of course drives ordinary users nuts.

Package raster (which is about "Geographic Data Analysis and Modeling")
is moving into areas that have nothing to do with rasters. Robert and I
need to sort this out.

On 06/12/2015 07:10 PM, Matt Strimas-Mackey wrote:
> It seems I posted this too soon and I've answered my own question.
> Obviously, raster has its own aggregate function, and I now realize
> the error is occurring because raster::aggregate was being called
> rather than sp::aggregate. Oddly, when I tried sp::aggregate() or
> sp:::aggregate(), I get
> Error: 'aggregate' is not an exported object from 'namespace:sp'
> and
> Error in get(name, envir = asNamespace(pkg), inherits = FALSE) :
>   object 'aggregate' not found
> respectively. However, I finally managed to fix this using:
> 
> spAgg <- get('aggregate', envir=as.environment("package:sp"))
> ret2 <- spAgg(p1["x"], p2, areaWeighted = TRUE)
> 
> Apologies for posting unnecessarily!
> 
> On Fri, Jun 12, 2015 at 9:23 AM, Matt Strimas-Mackey
> <strimas at zoology.ubc.ca> wrote:
>> I'm trying to run sp::aggregate() with SpatialPolygons objects.
>> Everything works as expected, unless the raster package is loaded in
>> which case I get the following error:
>>
>> Error in unique.default(v) : unique() applies only to vectors
>>
>> I suppose I could unload and reload raster, but ideally I'd like to
>> avoid this. I'm running this on a Mac in RStudio with R version: 3.2.0
>> (2015-04-16) -- "Full of Ingredients". All packages are up to date.
>>
>> Here's a example from the help for aggregate(), which reproduces the error:
>>
>>
>> library(sp)
>> library(raster) # Error unless this line is commented out
>>
>> # Area-weighted example, using two partly overlapping grids:
>>
>> gt1 = SpatialGrid(GridTopology(c(0,0), c(1,1), c(4,4)))
>> gt2 = SpatialGrid(GridTopology(c(-1.25,-1.25), c(1,1), c(4,4)))
>>
>> # convert both to polygons; give p1 attributes to aggregate
>> p1 = SpatialPolygonsDataFrame(as(gt1, "SpatialPolygons"),
>>                               data.frame(v = 1:16, w=5:20,
>> x=factor(1:16)), match.ID = FALSE)
>> p2 = as(gt2, "SpatialPolygons")
>>
>> # all-factor attributes: compute area-dominant factor level:
>> ret = aggregate(p1["x"], p2, areaWeighted = TRUE)
>> # Error in unique.default(v) : unique() applies only to vectors
>>
>>
>> Thanks!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150612/fd41b252/attachment.bin>

From jaonyango at yahoo.com  Sat Jun 13 00:05:18 2015
From: jaonyango at yahoo.com (Joshua Onyango)
Date: Fri, 12 Jun 2015 22:05:18 +0000 (UTC)
Subject: [R-sig-Geo] Disease Mapping & Spatial Statistics
In-Reply-To: <CAASFQpQd1Z_b15w+wDBwkdqB1CL1=wOraexhc6Vxvq13mF+fFQ@mail.gmail.com>
References: <CAASFQpQd1Z_b15w+wDBwkdqB1CL1=wOraexhc6Vxvq13mF+fFQ@mail.gmail.com>
Message-ID: <844555600.1993894.1434146718329.JavaMail.yahoo@mail.yahoo.com>

Hi Chris
Thanks for the constructive response including several suggestions.?
Cheers
Josh
 


     On Thursday, 11 June 2015, 10:40, chris english <englishchristophera at gmail.com> wrote:
   

 Hi Josh,?
I find this forum very helpful as well and like yourself am new to and learning R and spatial statistics.? With that in mind I will leave some of your specifics aside to those better qualified (for example your earlier discussion with Dominik regarding box plots in ggplot) and describe a process I use to better ground myself in both understanding and finally executing what I want (hope) to accomplish.
Like yourself I generally have a specific that I am chasing, but over time I've found it is less productive for me to chase it directly, and that I am (eventually) better grounded if I start from a ten thousand foot view. I still want to achieve my specifics, but I also want to understand comprehensively what happened in the course of the process especially if I am going to report/defend results.? Basically I don't want to view the 'lines of code' that got me to my particular specific as a kind of 'black box' that worked, but rather I want to understand the step by step and be able to reprise whether the result arrived at was the specific I intended, or that my originally imagined specific was appropriate to the analysis I hoped to perform.
I start with a couple of assumptions: many researchers have had the same problem before, gotten stuck, and asked for help (and probably gotten help or gotten some suggestions).? So I start with a couple of google searches:
cran r (avian) disease mapping vignettes
(some package) site:stat.ethz.ch (avian) disease mapping vignettes
and work the vignettes (as in type it out) to get a sense of how someone else solved the problem. And maybe that's sufficient.? But it allows me the opportunity to examine a range of items (how is my ground cover data structured, how are my disease instances structured, does the data I have fit with the assumptions of a package I've elected to use, is there a direct or indirect coersion path between packages that allows me to use the tools of a given package upon an object of another & etc).
Then I can drill in and see if I can address my specifics and derive results that are reasonable and understandable to me (and others).
Finally I read as much code as I can and see if I can get an inkling of what is going on where and when, and potentially why.
http://stackoverflow.com/questions/19226816/how-can-i-view-the-source-code-for-a-function

And read source code where ever I can find it.?
It is something of a grind to step back and do this, but it has given me a better appreciation of the wealth of tools available.? And even as they may not be applicable to my problem at hand, to the extent that I understand my problem, knowing about them informs me for analyzing future problems to which they may be more properly applicable.?
The foregoing process may not be applicable to your present needs, but I imagine it may help with developing a sense of fluency within this system of tools.? Of course eventually I may regret every word here, but this approach has helped me so far.
HTH,CheersChris


On Wed, Jun 10, 2015 at 3:50 PM, Joshua Onyango via R-sig-Geo <r-sig-geo at r-project.org> wrote:

Hello
I am just started learning how to use R and do find this forum helpful.

I want to carry out spatial statistics and disease mapping to explain possible differences in distribution in 8 regions of England.?
1. How can I go about importing a nice map of England with eight regions plus boundaries similar to the one found on goggle -?http://www.britaingallery.com/england_regions.php
?2. Map cases per regions
3. Apply spatial statistics if possible to show how factors of interests such as latitude, mean temperature, precipitation, flock size and vegetation (thistles) could be used to explain differences is distribution of cases.
Any response will be highly appreciated
Thanks
Josh
? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




  
	[[alternative HTML version deleted]]


From adeela.uaf at gmail.com  Sat Jun 13 06:05:32 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Sat, 13 Jun 2015 09:05:32 +0500
Subject: [R-sig-Geo] Spatial Stationarity
Message-ID: <CABGg3O7zPvgakG64+Lz+D-=SXTaWC1t0L2gnqi+A7U_AXWdwqQ@mail.gmail.com>

Hi,
I am quite new to R. I want to apply ordinary kriging for the cadmium
level in groundwater (the sample is taken from 60 places in a town)
but before doing this I want to check the spatial stationarity of the
data. I am reading many packages such as spatstat and sp but not
getting how to check whether the data is stationary or not for a
continuous variable. Please help me regarding this.
Adeela


From erich.subs at neuwirth.priv.at  Sun Jun 14 15:12:39 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Sun, 14 Jun 2015 15:12:39 +0200
Subject: [R-sig-Geo] tooltips or annotation
Message-ID: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>

Is it possible to produce chorepeth maps with tooltips in svg?

I found
http://aaronecay.com/blog/2014/02/tooltips-in-ggplot/ <http://aaronecay.com/blog/2014/02/tooltips-in-ggplot/>

But could not make it work in my case.

Does anybody have a tool for my purpose?




	[[alternative HTML version deleted]]


From bob at rudis.net  Sun Jun 14 15:18:13 2015
From: bob at rudis.net (boB Rudis)
Date: Sun, 14 Jun 2015 09:18:13 -0400
Subject: [R-sig-Geo] tooltips or annotation
In-Reply-To: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>
References: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>
Message-ID: <CAJ4QxaPR-W_Vi4swCR=G0kP6D_So3b1RdrMUO6drO_7qnxyQcA@mail.gmail.com>

You could always try using leaflet :
http://rstudio-pubs-static.s3.amazonaws.com/57933_7b3caba2c24e4af686420c9f27437719.html

On Sun, Jun 14, 2015 at 9:12 AM, Erich Subscriptions
<erich.subs at neuwirth.priv.at> wrote:
> Is it possible to produce chorepeth maps with tooltips in svg?
>
> I found
> http://aaronecay.com/blog/2014/02/tooltips-in-ggplot/ <http://aaronecay.com/blog/2014/02/tooltips-in-ggplot/>
>
> But could not make it work in my case.
>
> Does anybody have a tool for my purpose?
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From hiztirab at yahoo.com  Mon Jun 15 10:34:10 2015
From: hiztirab at yahoo.com (Iztirab Hussain)
Date: Mon, 15 Jun 2015 08:34:10 +0000 (UTC)
Subject: [R-sig-Geo] How to make time interval from available temporal data.
Message-ID: <237070459.2918879.1434357250460.JavaMail.yahoo@mail.yahoo.com>

Hi?I am new here, so may be my problem is quite typical.
I have 16 years daily precipitation data and want to convert it into 15 days and 3 months interval.Anyone would like to share me the source code and appropriate package name?
Regards
Iztirab
	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jun 15 10:42:18 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 15 Jun 2015 10:42:18 +0200
Subject: [R-sig-Geo] How to make time interval from available temporal
 data.
In-Reply-To: <237070459.2918879.1434357250460.JavaMail.yahoo@mail.yahoo.com>
References: <237070459.2918879.1434357250460.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <557E8FEA.7010508@uni-muenster.de>

I would recommend looking into packages zoo, and maybe xts, and their
aggregate methods:

library(zoo)
example(aggregate.zoo)

has an example aggregating daily data to quarterly data.

On 06/15/2015 10:34 AM, Iztirab Hussain via R-sig-Geo wrote:
> Hi I am new here, so may be my problem is quite typical.
> I have 16 years daily precipitation data and want to convert it into 15 days and 3 months interval.Anyone would like to share me the source code and appropriate package name?
> Regards
> Iztirab
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150615/5ae6a72c/attachment.bin>

From Andy.Bunn at wwu.edu  Mon Jun 15 19:16:44 2015
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 15 Jun 2015 17:16:44 +0000
Subject: [R-sig-Geo] adding text to levelplot panels with rasterVis and
 level(panel.text(...))
Message-ID: <D1A45686.3C976%andy.bunn@wwu.edu>

Hi all, I want to add a different label to each panel of a levelplot using
panel.text. Is there a way to do this by updating the plot rather than
writing a panel function in the main call?

E.g., something like the code below rather than levelplot(s, panel =
function(x, y, ..., subscripts){} etc.)

Many thanks, Andy


require(rasterVis)
text2add <- c("plot 1", "plot 2", "plot 3")
f <- system.file("external/test.grd", package="raster")
r <- raster(f)
s <- stack(r, r+500, r-500)
levelplot(s) +
  layer(panel.text(179500, 333000, text2add))


	[[alternative HTML version deleted]]


From oscar.perpinan at gmail.com  Mon Jun 15 23:06:42 2015
From: oscar.perpinan at gmail.com (Oscar =?UTF-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Mon, 15 Jun 2015 23:06:42 +0200
Subject: [R-sig-Geo] adding text to levelplot panels with rasterVis and
 level(panel.text(...))
In-Reply-To: <D1A45686.3C976%andy.bunn@wwu.edu>
References: <D1A45686.3C976%andy.bunn@wwu.edu>
Message-ID: <20150615230642.0c663804@Triskela>

Hi,

I think this is what you are looking for:

levelplot(s) +
    layer(panel.text(179500, 333000,
                     text2add[panel.number()]))

Best,

Oscar.
----------------
Oscar Perpi??n Lamigueiro
Dpto. Ing. El?ctrica, Electr?nica, Autom?tica y F?sica Aplicada
(ETSIDI-UPM) Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io


From Andy.Bunn at wwu.edu  Tue Jun 16 03:08:01 2015
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Tue, 16 Jun 2015 01:08:01 +0000
Subject: [R-sig-Geo] adding text to levelplot panels with rasterVis and
 level(panel.text(...))
In-Reply-To: <20150615230642.0c663804@Triskela>
References: <D1A45686.3C976%andy.bunn@wwu.edu>
	<20150615230642.0c663804@Triskela>
Message-ID: <D1A4C4F3.3C9F0%andy.bunn@wwu.edu>

Indeed. Many thanks.

On 6/15/15, 2:06 PM, "Oscar Perpi??n Lamigueiro"
<oscar.perpinan at gmail.com> wrote:

>Hi,
>
>I think this is what you are looking for:
>
>levelplot(s) +
>    layer(panel.text(179500, 333000,
>                     text2add[panel.number()]))
>
>Best,
>
>Oscar.
>----------------
>Oscar Perpi??n Lamigueiro
>Dpto. Ing. El?ctrica, Electr?nica, Autom?tica y F?sica Aplicada
>(ETSIDI-UPM) Grupo de Sistemas Fotovoltaicos (IES-UPM)
>URL: http://oscarperpinan.github.io


From erich.subs at neuwirth.priv.at  Tue Jun 16 15:55:53 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Tue, 16 Jun 2015 15:55:53 +0200
Subject: [R-sig-Geo] tooltips or annotation
In-Reply-To: <CAJ4QxaPVA=VhcZi5OvBZVeTTAPk4ko0Xp=wS8GTErDLuHeFesA@mail.gmail.com>
References: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>
	<CAJ4QxaPR-W_Vi4swCR=G0kP6D_So3b1RdrMUO6drO_7qnxyQcA@mail.gmail.com>
	<F32E15F4-6D6C-48F9-A513-A829D94F10B3@neuwirth.priv.at>
	<CAJ4QxaPVA=VhcZi5OvBZVeTTAPk4ko0Xp=wS8GTErDLuHeFesA@mail.gmail.com>
Message-ID: <6F230C6F-469E-484A-8451-FCEC4F2EEF23@neuwirth.priv.at>

Here is a minimalistic example (adapted demo)

cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")
is.na(cities$POPULATION) <- cities$POPULATION == -99
summary(cities$POPULATION)
td <- "."
writeOGR(cities, td, "cities", driver="ESRI Shapefile") # this works
writeOGR(cities, td, "cities", driver="GeoJSON") # this fails



writing ESRI Shapefile works, but writing GeoJSON files fails.


I installed the current version of GDAL from
http://www.kyngchaos.com/software/frameworks <http://www.kyngchaos.com/software/frameworks>
and the I installed rgdal from source.
I also tried this with rgdal installed from mercenaries on CRAN.

The problem seems to the the GeoJSON driver.




> On 15 Jun 2015, at 01:14, boB Rudis <bob at rudis.net> wrote:
> 
> All you have to do is upgrade GDAL and re-install rgdal. I have the
> same system & R versions and I use this all the time.
> 
> On Sun, Jun 14, 2015 at 5:30 PM, Erich Subscriptions
> <erich.subs at neuwirth.priv.at> wrote:
>> Alas,
>> this does not work on my setup:
>> OSX 10.10.3  R 3.2.0
>> 
>> rgdal 0.9-3 produces an error when I try to use
>> writeOGR
>> 
>> I am not the only one experiencing this, see e,g,
>> 
>> http://r-sig-geo.2731867.n2.nabble.com/GeoJSON-errors-when-reading-writing-with-rgdal-td7586801.html
>> 
>> 


	[[alternative HTML version deleted]]


From erich.subs at neuwirth.priv.at  Tue Jun 16 16:09:07 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Tue, 16 Jun 2015 16:09:07 +0200
Subject: [R-sig-Geo] tooltips or annotation
In-Reply-To: <6F230C6F-469E-484A-8451-FCEC4F2EEF23@neuwirth.priv.at>
References: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>
	<CAJ4QxaPR-W_Vi4swCR=G0kP6D_So3b1RdrMUO6drO_7qnxyQcA@mail.gmail.com>
	<F32E15F4-6D6C-48F9-A513-A829D94F10B3@neuwirth.priv.at>
	<CAJ4QxaPVA=VhcZi5OvBZVeTTAPk4ko0Xp=wS8GTErDLuHeFesA@mail.gmail.com>
	<6F230C6F-469E-484A-8451-FCEC4F2EEF23@neuwirth.priv.at>
Message-ID: <C65A161E-9353-4F50-9BBF-D829869B1CF9@neuwirth.priv.at>

I just tried the same test  on Ubuntu with all the latest packages and had the same problem.

writeOGR does not work for GeoJSON

cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")
is.na(cities$POPULATION) <- cities$POPULATION == -99
summary(cities$POPULATION)
td <- "."
writeOGR(cities, td, "cities", driver="ESRI Shapefile") # this works
writeOGR(cities, td, "cities", driver="GeoJSON") # this fails


From Roger.Bivand at nhh.no  Tue Jun 16 16:28:44 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 16 Jun 2015 16:28:44 +0200
Subject: [R-sig-Geo] tooltips or annotation
In-Reply-To: <C65A161E-9353-4F50-9BBF-D829869B1CF9@neuwirth.priv.at>
References: <AA8C7463-34CD-4D0E-8347-CBB52C42BFB7@neuwirth.priv.at>
	<CAJ4QxaPR-W_Vi4swCR=G0kP6D_So3b1RdrMUO6drO_7qnxyQcA@mail.gmail.com>
	<F32E15F4-6D6C-48F9-A513-A829D94F10B3@neuwirth.priv.at>
	<CAJ4QxaPVA=VhcZi5OvBZVeTTAPk4ko0Xp=wS8GTErDLuHeFesA@mail.gmail.com>
	<6F230C6F-469E-484A-8451-FCEC4F2EEF23@neuwirth.priv.at>
	<C65A161E-9353-4F50-9BBF-D829869B1CF9@neuwirth.priv.at>
Message-ID: <alpine.LFD.2.11.1506161621210.3954@reclus.nhh.no>

On Tue, 16 Jun 2015, Erich Subscriptions wrote:

> I just tried the same test on Ubuntu with all the latest packages and 
> had the same problem.
>
> writeOGR does not work for GeoJSON

Yes it does, just read the driver page on OGR/GDAL:

http://www.gdal.org/drv_geojson.html

For GDAL 2.0.0RC2:

writeOGR(cities, paste(td, ".geojson", sep="/"), "OGRGeoJSON",
   driver="GeoJSON")
writeOGR(cities, paste(td, "cities.geojson", sep="/"), "OGRGeoJSON",
   driver="GeoJSON")
writeOGR(cities, paste(td, "cities.geojson", sep="/"), "cities",
   driver="GeoJSON")

all work (the file name extension in the dsn= argument matters); note 
that only:

writeOGR(cities, paste(td, ".geojson", sep="/"), "OGRGeoJSON",
   driver="GeoJSON")

works in GDAL 1.11.2.

So until you have GDAL 2, the file name must be ".geojson" (nothing before 
the dot), and probably the layer name must be "OGRGeoJSON".

Roger

>
> cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")
> is.na(cities$POPULATION) <- cities$POPULATION == -99
> summary(cities$POPULATION)
> td <- "."
> writeOGR(cities, td, "cities", driver="ESRI Shapefile") # this works
> writeOGR(cities, td, "cities", driver="GeoJSON") # this fails
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From adeela.uaf at gmail.com  Wed Jun 17 04:49:56 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Wed, 17 Jun 2015 07:49:56 +0500
Subject: [R-sig-Geo] (no subject)
Message-ID: <CABGg3O68=L8ouTDGkC8X21qH9mdGEiWoDOXrfTRrcKcMTm6sNA@mail.gmail.com>

Hi all,
I want to do ordinary kriging on the cadmium level in soil. The data
were taken from 4 towns. First of all, I checked about spatial
autocorrelation in R using Moran's I test and the p-value was greater
then 0.05. May I go to kriging then?
Regards
Adeela


From vickup at mcmaster.ca  Thu Jun 18 16:57:50 2015
From: vickup at mcmaster.ca (Victor Kuperman)
Date: Thu, 18 Jun 2015 10:57:50 -0400
Subject: [R-sig-Geo] how to determine which administrative area a point
	belong to
Message-ID: <032101d0a9d7$25909700$70b1c500$@mcmaster.ca>

I have a large number of data points with longitude and latitude coordinates
(e.g. 57.118, -2.167). I am interested in knowing which administrative areas
in the UK these points fall into. I have downloaded administrative areas for
the UK:

adm <- getData('GADM', country='GBR', level=2)

 

Now I cannot identify an R function that would associate a data point with
an administrative area. 

Help will be greatly appreciated.

 

 

Victor Kuperman, Ph.D.

Assistant Professor, Linguistics and Languages

McMaster University

Togo Salmon Hall 626

1280 Main Street West

Hamilton, Ontario, Canada L8S 4M2

phone: 905-525-9140, x. 20384

vickup at mcmaster.ca

www.humanities.mcmaster.ca/~vickup

 

 


	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Thu Jun 18 17:13:03 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 18 Jun 2015 17:13:03 +0200
Subject: [R-sig-Geo] how to determine which administrative area a point
 belong to
In-Reply-To: <032101d0a9d7$25909700$70b1c500$@mcmaster.ca>
References: <032101d0a9d7$25909700$70b1c500$@mcmaster.ca>
Message-ID: <5582DFFF.5030401@uni-muenster.de>



On 06/18/2015 04:57 PM, Victor Kuperman wrote:
> I have a large number of data points with longitude and latitude coordinates
> (e.g. 57.118, -2.167). I am interested in knowing which administrative areas
> in the UK these points fall into. I have downloaded administrative areas for
> the UK:
> 
> adm <- getData('GADM', country='GBR', level=2)
> 

pts = spsample(adm, 100, "random") # samples 100 points from adm

plot(adm)
points(pts, col = 'red')

over(pts, adm)

>  
> 
> Now I cannot identify an R function that would associate a data point with
> an administrative area. 
> 
> Help will be greatly appreciated.
> 
>  
> 
>  
> 
> Victor Kuperman, Ph.D.
> 
> Assistant Professor, Linguistics and Languages
> 
> McMaster University
> 
> Togo Salmon Hall 626
> 
> 1280 Main Street West
> 
> Hamilton, Ontario, Canada L8S 4M2
> 
> phone: 905-525-9140, x. 20384
> 
> vickup at mcmaster.ca
> 
> www.humanities.mcmaster.ca/~vickup
> 
>  
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150618/d0ce50b3/attachment.bin>

From macqueen1 at llnl.gov  Fri Jun 19 00:08:09 2015
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Thu, 18 Jun 2015 22:08:09 +0000
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CANvsoOuVw1AVq=G751XjtPF93k3zHVRoJPeWszvxeeVNkg79nA@mail.gmail.com>
References: <CANvsoOuVw1AVq=G751XjtPF93k3zHVRoJPeWszvxeeVNkg79nA@mail.gmail.com>
Message-ID: <D1A88F08.12EBAF%macqueen1@llnl.gov>

This is a question for R-help, not R-sig-Geo.
Please also provide a subject, and do not send html.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 12/9/14, 7:17 AM, "R-sig-Geo on behalf of rpaolo1967 RP"
<r-sig-geo-bounces at r-project.org on behalf of rpaolo1967 at gmail.com> wrote:

>Hi everybody,
>
>
>
>I apologize for this simple question. I?m running a code which, at each
>step of a loop, generates a data frame similar to this one:
>
>
>
>d <- rep(1:10, each = 6, len = 60)
>
>a <- rep(0:5, each = 1, len = 60)
>
>v <- rep(sort(runif(5, 30, 50), decreasing = T), each = 1, len = 60)
>
>x <- data.frame(t(cbind(d,a,v)))
>
>
>
>I want to create and save plots of the results, once data frames are
>created. I?m using this code within the loop, after the creation of the
>data frame:
>
>
>
># library(lattice)
>
>svg("eraseMe.svg") # Format doesn?t matter, and name is iteratively
>created
>
>xyplot(v ~ a | d, x, aspect = 5, type = "o", xlab = "a", ylab = "v")
>
>update(trellis.last.object(),
>
>    strip = strip.custom(strip.names = FALSE, strip.levels = i),
>
>    par.strip.text = list(cex = 1.1))
>
>dev.off()
>
>
>
>where ?i? is something as simple as
>
>
>
>i <- as.numeric(c(1:10))
>
>
>
>It works troublelessly on my laptop (under 32 bits Windows Vista), but I
>get the following message when running in computers under ubuntu or 64
>bits
>Windows 7:
>
>
>
>Error in !lattice.getStatus("current.plot.saved", prefix = prefix) :
>
>  invalid argument type
>
>
>
>Notwithstanding, when I simply copy and paste again the following code,
>after getting the message, it works fine (but loop is interrupted).
>
>
>
>svg("eraseMe.svg") # No matter the format
>
>xyplot(v ~ a | d, x, aspect = 5, type = "o", xlab = "a", ylab = "v")
>
>update(trellis.last.object(),
>
>   strip = strip.custom(strip.names = FALSE, strip.levels = i),
>
>   par.strip.text = list(cex = 1.1))
>
>dev.off()
>
>
>
>Any suggestion? Thanks a lot!!!!
>
>
>Paolo
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From justiceaheto at yahoo.com  Sat Jun 20 21:24:18 2015
From: justiceaheto at yahoo.com (Justice Moses K. Aheto)
Date: Sat, 20 Jun 2015 19:24:18 +0000 (UTC)
Subject: [R-sig-Geo] Space-Time models for Time Series Cross-Sectional data
Message-ID: <596808423.2477832.1434828258467.JavaMail.yahoo@mail.yahoo.com>

Dear Geo-R List members,I have a survey data which is cross-sectional in nature collected on different sampled individuals for each survey period over 4 time periods with 5-year time interval between each survey. Information about the location of the resident were collected (geographical coordinates) and these coordinates are unique for each time period.The sampled individuals in each survey period are different from one survey time period to another, meaning different samples were used for each of the 4 surveys.?My outcome variable (Y) is continuous, I have covariates such age and sex of child among others to be included in the model.?The survey is conducted by same organization with same statistical methodologies over time for same age group and study settings and data collected on similar variables.?Below are the codes I have put together in order to construct a fictitious data similar to my data structure:
N=10000# Number of the total observation for all the survey years
Y=rnorm(N,0,1)# my outcome variable on continuous scaleyear=c(1990,1995,2000,2005)# survey yearsyear=rep(c(1990,1995,2000,2005),times=c(2000,3100,2000,2900)) # different number of observations per survey years? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ??lon=sample(N)# longitude
lat=sample(N+1000,10000)# latitude
age=sample(0:4.9)# ?age of child as covariateage=rep(age,2000)
sex=as.factor(c(rep(1,2,each=5000)))
ID=1:length(Y)# ID for individual observations
data=as.data.frame(cbind(ID,Y,year,lon,lat,age,sex))# creating data frame
head(data,10) # for the first 10 observationstail(data,10) # for the last 10 observations
Below is the first 10 observations of the data frame:
?head(data,10)? ? ID ? ? ? ? ?Y ? ? ? year ? lon ? ?lat ? age sex1 ? 1 ?1.3526490 1990 4202 ? 868 ? 1 ? 12 ? 2 -0.3210689 1990 8515 ?6549 ? 0 ? 13 ? 3 -0.4126906 1990 1420 ?5218 ? 4 ? 14 ? 4 ?1.7399052 1990 1100 ?5129 ? 3 ? 15 ? 5 -1.6019068 1990 4488 ? 294 ? 2 ? 16 ? 6 -1.4383548 1990 2099 ?9543 ? 1 ? 17 ? 7 ?1.2600215 1990 2518 ? ?34 ? 0 ? 18 ? 8 -1.2001605 1990 6546 10809 ? 4 ? 19 ? 9 -0.3020261 1990 3833 ?8585 ? 3 ? 110 10 -0.5805120 1990 5815 ? ?76 ? 2 ? 1?Below is the last 10 observations of the data frame:
tail(data,10)? ? ? ? ? ? ? ID ? ? ? ? ? Y ? ? ? ? ? year ?lon ? ? lat ? ?age sex9991 ? 9991 -0.44229435 2005 7884 ?9670 ? 1 ? 19992 ? 9992 -0.74089670 2005 6824 10406 ? 0 ? 19993 ? 9993 ?0.39667898 2005 4601 ?8118 ? 4 ? 19994 ? 9994 -1.22391266 2005 4361 ?8747 ? 3 ? 19995 ? 9995 -1.86094028 2005 3055 ?8429 ? 2 ? 19996 ? 9996 -1.32859732 2005 3225 10872 ? 1 ? 19997 ? 9997 -0.04749873 2005 9325 ?1730 ? 0 ? 19998 ? 9998 -0.33076432 2005 9045 ?6663 ? 4 ? 19999 ? 9999 -0.83026815 2005 4642 ?6149 ? 3 ? 110000 10000 ?0.87211988 2005 4995 ?8253 ? 2 ? 1

Now, here is my task:I wish to conduct spatio-temporal analysis on this data and possibly forecast for future observations.?I have read the literature on space-time models, dynamic linear models and Kalman Filter but I am not sure if any of these could apply to my situation.?
The model I have in mind is:
St|St-1 = AtSt-1 + {sqrt(1-A^2)}Wt, ? (1) where ?Wt ~ MVN(0, ?). A is a weight which guarantees stationarity, St-1 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? represent the state at time t-1 before time t and St is the state at time t ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? conditional on the state at time t-1. ? is the covariance matrix ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? associated with the Gaussian noise WtYt|St = X_t^'? + DtSt + Vt, ? ? ? ? ? ? ? ? (2) ?where Vt ~ N(0,??_vt^2), X_t is the vector of covariates, ? are the regression ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?coefficients,?Dt is a matrix of 1?s if a child issampled from location j in time t ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?and zero (0) otherwise.??_vt^2 is the variance associated with the Gaussian ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?noise VtFrom above, Equation (1) is my state (unobserved) equation and Equation (2) is the observed (measurement) Equation.
Please,?(1) is there any available package(s) in R that could allow me to fit the above model considering the nature of my data?(2) Are there other possible space-time models that I can fit to the data above? If yes, what type of model and which R package can this be implemented in with references.
Any help is highly appreciated in advance.
Thanks?

Kind regards

*****************************************
Justice Moses K. Aheto
PhD Candidate in Medicine (Statistics,?Biostatistics,?Public Health and Epidemiology).?
MSc Medical Statistics.?
BSc Statistics.?
HND Statistics?

Chief Executive Officer
Statistics and Analytics Consultancy Services Ltd.

Skype: jascall12
Mobile: +447417589148.
	[[alternative HTML version deleted]]


From Alexander.Herr at csiro.au  Tue Jun 23 08:23:30 2015
From: Alexander.Herr at csiro.au (Alexander.Herr at csiro.au)
Date: Tue, 23 Jun 2015 06:23:30 +0000
Subject: [R-sig-Geo] grts design call ends in "c function areaIntersection"
	error
Message-ID: <DE9431576890DA46BC57EA03BC10449B9BED2BD9@exmbx06-cdc.nexus.csiro.au>

Hi List,
I am running into the following error using grts {spsurvey} using a multipolygon shapefile (34 strata) with the following call

stratsites<-grts(design=theList, 
 shift.grid=TRUE,
 DesignID="STRATIFIED",
 type.frame="area", 
 #src.frame="sp.object", 
 #sp.object=pl5, 
 src.frame="shapefile",
 in.shape=fname,
 att.frame=att,
 stratum="layer", 
 shapefile=TRUE, 
 out.shape='Rec_stratified_v03'
)

After some strata information output, I get:

Error: Allocating memory in C function areaIntersection.
Error: In C function areaIntersection.
Error in grtsarea(in.shape, sframe, sum(n.desired), SiteBegin, shift.grid,  : 
  
An error occured while determining the number of levels for hierarchical 
randomization.

If I run with shift.grid=FALSE, I get results. Happy to provide detailed data and script individually...

Using R 3.1.1 on hpc linux with 128gig Ram

Any suggetions? 
Thanks
Herry


From rotundo.jose at gmail.com  Tue Jun 23 16:24:53 2015
From: rotundo.jose at gmail.com (=?UTF-8?Q?Jos=C3=A9_Luis_Rotundo?=)
Date: Tue, 23 Jun 2015 11:24:53 -0300
Subject: [R-sig-Geo] Ordinary Kriging vs Kriging with external drift
Message-ID: <CADBY2pr39Ow3VShAJH9+SnZow8zLzx_Kt=u3+hOeBYzdk3jBOw@mail.gmail.com>

Dear All,

I have kind of a conceptual question.

Have been working on a data set of a continuous variable across the
US. I managed to model the spatial dependency by fitting different
model variograms and did ordinary kriging to extrapolate the values. I
find out that for some years there is a significant relationship
between latitude and the variable I am interested in model. However,
in no case the R2 was higher that 0.10. My thinking was that the drift
was low enough in terms of predictive value, so the drift could be
overlooked. Do you agree with this?

Thanks for any hint on this questions.

Best,
Jose

-- 

Jos? L. Rotundo
CONICET
Facultad de Ciencias Agrarias
Univ. Nacional de Rosario
Zavalla, Santa Fe
Argentina


From nerijusuza at yahoo.com  Tue Jun 23 20:47:39 2015
From: nerijusuza at yahoo.com (Nerijus Uza)
Date: Tue, 23 Jun 2015 18:47:39 +0000 (UTC)
Subject: [R-sig-Geo] Half degree gridded data using rworldmap library -
 SpatialPixelsDataFrame
Message-ID: <499882434.4196741.1435085259453.JavaMail.yahoo@mail.yahoo.com>

Hello,
I'm very new when it comes to R. I recently started looking into geographical data and mapping. I was using?this?pdf (and many more) as an example for my analysis. It's pretty straight forward if I want a country?map?(country map code)
| ? |
| ? |  | ? | ? | ? | ? | ? |
| country map.txtShared with Dropbox |
|  |
| View on www.dropbox.com | Preview by Yahoo |
|  |
| ? |



Half degree gridded data map is what I'm really interested in. I limited my source to coordinates in Unites States only. I need SpatialGridDataFrame to plot the map. Unfortunately, I can't get it to work. I get an error:?> pixelDF <- pointsDF
> gridded(pixelDF) <- TRUE ?#fullgrid
suggested tolerance minimum: 8.72547e-06?Error in points2grid(points, tolerance, round) :?dimension 1 : coordinate intervals are not constant

Is the code correct? Are there any other methods to convert source data to?SpatialGridDataFrame? Source can be found?here.
# Librarylibrary(rworldmap)library(sp)library(RColorBrewer)
# Read source data filerdf <- read.csv("sample.csv", header = T, sep = ",")colnames(rdf) <- c("Latitude", "Longitude", "Count")
# promote to SpatialPointsDataFrame?pointsDF <- rdf?coordinates(pointsDF) = c("Latitude", "Longitude")
# promote to SpatialPixelsDataFramepixelDF <- pointsDF?gridded(pixelDF) <- TRUE ?#fullgrid
# promote to SpatialGridDataFramesGDF = as(pixelDF, "SpatialGridDataFrame")
# set plot marginspar(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")
# set scalenumCats <- 9
# set colorcolourPalette <- brewer.pal(numCats, "YlOrRd")
# plot the map using rworldmap?mapParams <- mapGriddedData(sGDF, nameColumnToPlot = "Count", colourPalette=colourPalette, numCats=numCats, addLegend = "FALSE")
# call legenddo.call( addMapLegend, c( mapParams, legendLabels="all", legendWidth=0.5, legendMar = 2))

I appreciate your help.
Regards,Nerijus
?
	[[alternative HTML version deleted]]


From juta.kawalerowicz at nuffield.ox.ac.uk  Wed Jun 24 00:55:27 2015
From: juta.kawalerowicz at nuffield.ox.ac.uk (Juta Kawalerowicz)
Date: Tue, 23 Jun 2015 23:55:27 +0100
Subject: [R-sig-Geo] Coordinates of the closest point
Message-ID: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>

Hi, I know how to get the closest distance from a spatial point to a
polyline, but I was wondering if there is any easy way to also get
coordinates of the closest point on the polyline?

A longer way to go around this would be to build a buffer around spatial
point with radius equal to whatever is returned by gDistance() and then
look for intersections but there must be an easier way?

Cheers,
Juta

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Jun 24 02:06:22 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 24 Jun 2015 00:06:22 +0000
Subject: [R-sig-Geo] Coordinates of the closest point
In-Reply-To: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
References: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
Message-ID: <CAAcGz9_GdPiW8X6KNFxdKojMNS=vPoikdooErrhg958ppdcmMg@mail.gmail.com>

Use spDistsN1 to calculate the distances from the line coordinates to your
point and find the shortest distance, then use that index back into the
coordinates.

You can get all coordinates from a line with something like this, but it
depends on your object - is it a simple 1-line object etc so you might need
to subset it or delve.

coordinates(as(x, "SpatialPoints"))



On Wed, 24 Jun 2015 at 08:55 Juta Kawalerowicz <
juta.kawalerowicz at nuffield.ox.ac.uk> wrote:

> Hi, I know how to get the closest distance from a spatial point to a
> polyline, but I was wondering if there is any easy way to also get
> coordinates of the closest point on the polyline?
>
> A longer way to go around this would be to build a buffer around spatial
> point with radius equal to whatever is returned by gDistance() and then
> look for intersections but there must be an easier way?
>
> Cheers,
> Juta
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From geotux_tuxman at linuxmail.org  Wed Jun 24 05:13:56 2015
From: geotux_tuxman at linuxmail.org (GeoTux Tuxman)
Date: Wed, 24 Jun 2015 05:13:56 +0200
Subject: [R-sig-Geo] Coordinates of the closest point
In-Reply-To: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
References: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
Message-ID: <trinity-1c3c30ab-4a82-4208-878a-f1df9cb84ce5-1435115636527@3capp-mailcom-lxa01>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150624/1296188d/attachment.html>

From r.hijmans at gmail.com  Wed Jun 24 06:07:56 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 23 Jun 2015 21:07:56 -0700
Subject: [R-sig-Geo] Coordinates of the closest point
In-Reply-To: <trinity-1c3c30ab-4a82-4208-878a-f1df9cb84ce5-1435115636527@3capp-mailcom-lxa01>
References: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
	<trinity-1c3c30ab-4a82-4208-878a-f1df9cb84ce5-1435115636527@3capp-mailcom-lxa01>
Message-ID: <CANtt_hxsJ6qq6awn34R2zDxHsSUkxAiCttCJWgn0unPhVipbFQ@mail.gmail.com>

And for longitude/latitude data you can use geosphere::dist2Line
Robert

On Tue, Jun 23, 2015 at 8:13 PM, GeoTux Tuxman
<geotux_tuxman at linuxmail.org> wrote:
> Hi Juta, you can do this (only with planar coordinates):
>
> require("maptools")
> coordsLine = cbind(c(1,2,3),c(3,2,2))
> coordsPoint = c(1.2,1.5)
> nearestPointOnLine(coordsLine, coordsPoint)
>
> If you have a SpatialLinesDataFrame get the coordinates this way:
> coordsLine = coordinates(line)
>
> Note that coordsLine should contain coordinates of a single line.
>
> See [1] for details.
>
> Regards,
>
> Germ?n Carrillo
> ---------
> [1]
> http://geotux.tuxfamily.org/index.php/en/component/k2/item/296-snapping-points-to-lines-in-r
> --
> -----------
>    \__
> (:>__)(
>    /
> Soluciones Geoinform?ticas Libres
> http://geotux.tuxfamily.org
> http://twitter.com/GeoTux2
>
>
> Sent: Tuesday, June 23, 2015 at 5:55 PM
> From: "Juta Kawalerowicz" <juta.kawalerowicz at nuffield.ox.ac.uk>
> To: r-sig-geo <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Coordinates of the closest point
> Hi, I know how to get the closest distance from a spatial point to a
> polyline, but I was wondering if there is any easy way to also get
> coordinates of the closest point on the polyline?
>
> A longer way to go around this would be to build a buffer around spatial
> point with radius equal to whatever is returned by gDistance() and then
> look for intersections but there must be an easier way?
>
> Cheers,
> Juta
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Wed Jun 24 11:50:05 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 24 Jun 2015 11:50:05 +0200
Subject: [R-sig-Geo] spacetime stConstruct gives wrong dimensions for
	long table
In-Reply-To: <D1B036F4.16570%d.bebber@exeter.ac.uk>
References: <D1B036F4.16570%d.bebber@exeter.ac.uk>
Message-ID: <558A7D4D.2040502@uni-muenster.de>

Dan, I'm moving this from r-help to r-sig-geo:

On 06/24/2015 11:29 AM, Bebber, Dan wrote:
> I have a large spatiotemporal database (131 spatial locations, 9 years of
> daily weather data) in long table format which I would like to convert to
> an ST object.
> 
>> head(tempmean)
>            site  lat    lon  alt                              var year mth
> day value       date doy numdate
> 518941 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   1  16.9 2006-01-01 001   13149
> 518942 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   2  16.4 2006-01-02 002   13150
> 518943 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   3  16.9 2006-01-03 003   13151
> 518944 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   4  16.1 2006-01-04 004   13152
> 518945 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   5  16.6 2006-01-05 005   13153
> 518946 27015260 6.02 -75.37 1680 AVERAGE DAILY TEMPERATURE VALUES 2006   1
>   6  16.7 2006-01-06 006   13154
> 
> 
> The data.frame is ?ragged?, i.e. not all sites are represented by all
> dates, and there are some NA values in the data.
> 
> I took a subset of the data (4 sites, 31 days in January 2006, for which
> all site/date combinations are present) and tried
> 
>> st <- stConstruct(tempmean, 3:2, 10)
>> summary(st)
> Object of class STIDF
>  with Dimensions (s, t, attr): (124, 124, 9)
> [[Spatial:]]
> Object of class SpatialPoints
> Coordinates:
>        min    max
> lon -76.45 -73.11
> lat   2.11   7.07
> Is projected: NA 
> proj4string : [NA]
> Number of points: 124
> [[Temporal:]]
>      Index              timeIndex
>  Min.   :2006-01-01   Min.   :  1.00
>  1st Qu.:2006-01-08   1st Qu.: 31.75
>  Median :2006-01-16   Median : 62.50
>  Mean   :2006-01-16   Mean   : 62.50
>  3rd Qu.:2006-01-24   3rd Qu.: 93.25
>  Max.   :2006-01-31   Max.   :124.00
> 
> 
> This is incorrect: There should be 4 spatial dimensions and 31 timepoints.

STIDF is essentially the long table form, it does not identify identical
space/time values.

Try:

dim(as(st, "STSDF"))

and

dim(as(st, "STFDF"))

after you figure out what these classes try to represent from the
package vignette / JSS paper.

> 
> What am I doing wrong?
> 
> Thanks,
> Dan
> 
> Dr Dan Bebber
> Senior Research Fellow
> Biosciences
> University of Exeter
> 
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150624/a620eb14/attachment.bin>

From justiceaheto at yahoo.com  Wed Jun 24 13:55:27 2015
From: justiceaheto at yahoo.com (Justice Moses K. Aheto)
Date: Wed, 24 Jun 2015 11:55:27 +0000 (UTC)
Subject: [R-sig-Geo] Ordinary Kriging vs Kriging with external drift
Message-ID: <1381374929.224527.1435146927843.JavaMail.yahoo@mail.yahoo.com>

Hi Jose,Thanks for the question.First of all, the R-square value of?0.10?does suggests that some amount of variation is been explained in your external drift model by the inclusion of latitude. Also the R-square value alone is not sufficient to use in deciding whether or not to overlook the drift as some covariates could serve as a potential control variables in your model depending on your problem even if they did not affect your predictive power remarkably.?If you plot the variogram for both the ordinary kriging (kriging with no covariates) and the external drift/universal kriging (including latitude as covariates), you will observe that the variance from the ordinary kriging will be higher than the variance in the universal kriging, suggesting that at least, inclusion of latitude has helped explained some spatial variations in your model,?I think you need to do some consideration regarding the objective of your study, the outcome you are using in your modelling, and what are some potential/significant factors (covariates) associated with the outcome. The later information could be obtained from the literature on your study outcome.?You may or may not be making any error by overlooking the drift depending on the problem you wish to solve. As a result, I will suggest that first of all, fit linear regression model (not spatial model) to your data and include the latitude as a covariate and find out if this covariate is statistically significant in your model. If it is significant, go ahead and include it in your spatial model. In case it is not significant, you have further considerations to make as suggested above (objective of your study, the outcome variable and its associated significant covariates from literature).?Unfortunately, there is no exact answer to your problem in the absence of the data you are working with, your outcome variable under consideration, your study objectives and what the potential covariates associated with your outcome are from the literature. ??However, my suggestions above could help you get this sorted.Hope this helps.Cheers?
??Kind regards

*****************************************
Justice Moses K. Aheto
PhD Candidate in Medicine (Statistics,?Biostatistics,?Public Health and Epidemiology).?
MSc Medical Statistics.?
BSc Statistics.?
HND Statistics?

Chief Executive Officer
Statistics and Analytics Consultancy Services Ltd.

Skype: jascall12
Mobile: +447417589148.
	[[alternative HTML version deleted]]


From adeela.uaf at gmail.com  Wed Jun 24 15:23:21 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Wed, 24 Jun 2015 18:23:21 +0500
Subject: [R-sig-Geo] variogram problem
Message-ID: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>

Hi,
Can anybody help me in fitting variogram in gstat package in R. I am trying
but having this problem. Where Cd15 is the amount of Cadmium in soil at 15
cm depth.
v<-variogram(Cd15~1,data)
v.fit<-fit.variogram(v,vgm(1,"Sph",5,1))
Warning message:
In fit.variogram(v, vgm(1, "Sph", 5, 1)) :
Warning: singular model in variogram fit
******************************
Adeela
University of Agriculture Faisalabad
Department of Math & Stat.

	[[alternative HTML version deleted]]


From HAROLD at il.ibm.com  Wed Jun 24 15:39:06 2015
From: HAROLD at il.ibm.com (Harold-Jeffrey Ship)
Date: Wed, 24 Jun 2015 16:39:06 +0300
Subject: [R-sig-Geo] library fails to load in linux
Message-ID: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>

I have Ubuntu 12.04 Precise. I just installed R and want to install 
spatstat. This is the R information:

R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

When I try to install spatstat things look fine at first until it tries to 
verify the installation by loading the library. It crashes, with the below 
error message (snipped).
Any help would be greatly appreciated!

installing to /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
** R
** data
*** moving datasets to lazyload DB
** demo
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded
*** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
======= Backtrace: =========
/lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
/lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
/usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
	[[alternative HTML version deleted]]


From Navinder.Singh at slu.se  Wed Jun 24 15:40:58 2015
From: Navinder.Singh at slu.se (Navinder Singh)
Date: Wed, 24 Jun 2015 13:40:58 +0000
Subject: [R-sig-Geo] intersect function: how to retain an id for each
 intersect between spatialpolygon and spatiaLineDataFrame: rgeos
Message-ID: <D05EFCEA-1752-4AF3-859B-C63B8A110315@slu.se>

I have a slightly complex problem.

First, i would like to get some help on how to generate spatial line object from spatial points data frame. The complexity here is to be able to retain some of the attributes when generating a spatial line object. For e.g. i have height information associated with each point and i would like to find out if it is possible to generate some sort of a average height of each line that joins the points. I used a function written by Kyle Walker from the following link to do so, but couldn't retain any attributes in the spatial lines. See https://rpubs.com/walkerke/points_to_line

vlines<-    points_to_line(data=stora.df,long="x",lat="y",id_field="id",sort_field="date")

The result is:

vlines
class       : SpatialLines
features    : 4
extent      : 1562946, 1649621, 7074782, 7194770  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:2400 +proj=tmerc +lat_0=0 +lon_0=15.80827777777778  +k=1 +x_0=1500000 +y_0=0 +ellps=bessel +towgs84=414.1,41.3,603.1,-0.855,2.141,-7.023,0 +units=m +no_defs

Second, I am trying to intersect a gbuffer generated object with above spatial line object.

buffer<-gBuffer(wfSp,byid=TRUE,width=150)
buffer at data$id<-1:length(wfSp)
buffer
Object of class "SpatialPolygonsDataFrame" (package sp):

Number of SpatialPolygons:  40

Variables measured:
  id
1  1
2  2
3  3
4  4
5  5
6  6
...

So this creates 40 buffers that i need. All seems to be okay at this step. Except the first issue above.

Now when i do the intersect, between buffer and vlines, i get

Int.1<-intersect(buffer, vlines[1,])
Int.1
class       : SpatialLinesDataFrame
features    : 25
extent      : 1622933, 1625909, 7124940, 7128742  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:2400 +proj=tmerc +lat_0=0 +lon_0=15.80827777777778   +k=1 +x_0=1500000 +y_0=0 +ellps=bessel   +towgs84=414.1,41.3,603.1,-0.855,2.141,-7.023,0 +units=m +no_defs
variables   : 1
names       : id
min values  :  2
max values  : 40
+towgs84=414.1,41.3,603.1,-0.855,2.141,-7.023,0 +units=m +no_defs

Int.1.df<-as.data.frame(Int.1)
Int.1.df
   id
1   2
2  15
3  18
4  19
5  20
6  21
7  22
8  23
9  24
10 25
11 26
12 27
13 28
14 29
15 30
16 31
17 32
18 33
19 34
20 35
21 36
22 37
23 38
24 39
25 40

This basically gives me a list of id's of the buffers my line intersects. Now what i want is to be able to generate a separate id for each intersection. In short, how many lines intersect each buffer separately. Right now, it is mainly a list of buffers intersected by a line. So from above, it is clear that my line passed 25 buffers but not an estimate of how many times, each buffer was passed.

Basically a count of intersections per buffer.

Please ask, if something is not clear here.

Thanks,

Navi




	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Wed Jun 24 15:42:41 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Wed, 24 Jun 2015 15:42:41 +0200
Subject: [R-sig-Geo] variogram problem
In-Reply-To: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>
References: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>
Message-ID: <CAJuCY5zUr1aH0zCm5VRpBKsifZMXYhmYdP=fhJZAMuD=6-+gfw@mail.gmail.com>

You'll need to provide a reproducible example. Your code is not
reproducible without the data.

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2015-06-24 15:23 GMT+02:00 adeela uaf <adeela.uaf at gmail.com>:

> Hi,
> Can anybody help me in fitting variogram in gstat package in R. I am trying
> but having this problem. Where Cd15 is the amount of Cadmium in soil at 15
> cm depth.
> v<-variogram(Cd15~1,data)
> v.fit<-fit.variogram(v,vgm(1,"Sph",5,1))
> Warning message:
> In fit.variogram(v, vgm(1, "Sph", 5, 1)) :
> Warning: singular model in variogram fit
> ******************************
> Adeela
> University of Agriculture Faisalabad
> Department of Math & Stat.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Jun 24 16:08:05 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 24 Jun 2015 16:08:05 +0200
Subject: [R-sig-Geo] variogram problem
In-Reply-To: <CAJuCY5zUr1aH0zCm5VRpBKsifZMXYhmYdP=fhJZAMuD=6-+gfw@mail.gmail.com>
References: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>
	<CAJuCY5zUr1aH0zCm5VRpBKsifZMXYhmYdP=fhJZAMuD=6-+gfw@mail.gmail.com>
Message-ID: <558AB9C5.3030503@uni-muenster.de>

Thierry is right about that; without that we can only guess, which is
what I will do now.

fit.variogram does a non-linear fit using some steepest descent method,
and needs initial values for that. The initial values you provide are 1
(partial sill), 5 (range), and 1 (nugget). In case v does not provide
good information on how to improve these initial values, e.g. because 5
is smaller than the smallest distance in it, it can't figure out where
to go in order to improve. This means it got stuck, and gives this
warning. The plot

plot(v, vgm(1, "Sph", 5, 1))

will reveal the problem to you (and to us, if you'd share it).

On 06/24/2015 03:42 PM, Thierry Onkelinx wrote:
> You'll need to provide a reproducible example. Your code is not
> reproducible without the data.
> 
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
> Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
> 
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
> 
> 2015-06-24 15:23 GMT+02:00 adeela uaf <adeela.uaf at gmail.com>:
> 
>> Hi,
>> Can anybody help me in fitting variogram in gstat package in R. I am trying
>> but having this problem. Where Cd15 is the amount of Cadmium in soil at 15
>> cm depth.
>> v<-variogram(Cd15~1,data)
>> v.fit<-fit.variogram(v,vgm(1,"Sph",5,1))
>> Warning message:
>> In fit.variogram(v, vgm(1, "Sph", 5, 1)) :
>> Warning: singular model in variogram fit
>> ******************************
>> Adeela
>> University of Agriculture Faisalabad
>> Department of Math & Stat.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150624/71fb4584/attachment.bin>

From adeela.uaf at gmail.com  Wed Jun 24 17:22:12 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Wed, 24 Jun 2015 20:22:12 +0500
Subject: [R-sig-Geo] variogram problem
In-Reply-To: <558AB9C5.3030503@uni-muenster.de>
References: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>
	<CAJuCY5zUr1aH0zCm5VRpBKsifZMXYhmYdP=fhJZAMuD=6-+gfw@mail.gmail.com>
	<558AB9C5.3030503@uni-muenster.de>
Message-ID: <CABGg3O5--91DGHxoZDtFD-PaM5K4TBQJ+=pCW3Fer+w-3HSbuA@mail.gmail.com>

This is the the data set and want to make variogram for Cd15. The distance
between each sample location was 4 cross 4 km. Please suggest me how to
allocate initial guess about nugget, sill and range parametrs. Moreover, I
have used log transformation for my variable Cd15. Is it appropriate? Or
there is any other transformation for this.
Thanks,
Regards
Adeela

On Wed, Jun 24, 2015 at 7:08 PM, Edzer Pebesma <
edzer.pebesma at uni-muenster.de> wrote:

> Thierry is right about that; without that we can only guess, which is
> what I will do now.
>
> fit.variogram does a non-linear fit using some steepest descent method,
> and needs initial values for that. The initial values you provide are 1
> (partial sill), 5 (range), and 1 (nugget). In case v does not provide
> good information on how to improve these initial values, e.g. because 5
> is smaller than the smallest distance in it, it can't figure out where
> to go in order to improve. This means it got stuck, and gives this
> warning. The plot
>
> plot(v, vgm(1, "Sph", 5, 1))
>
> will reveal the problem to you (and to us, if you'd share it).
>
> On 06/24/2015 03:42 PM, Thierry Onkelinx wrote:
> > You'll need to provide a reproducible example. Your code is not
> > reproducible without the data.
> >
> > ir. Thierry Onkelinx
> > Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> and
> > Forest
> > team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> > Kliniekstraat 25
> > 1070 Anderlecht
> > Belgium
> >
> > To call in the statistician after the experiment is done may be no more
> > than asking him to perform a post-mortem examination: he may be able to
> say
> > what the experiment died of. ~ Sir Ronald Aylmer Fisher
> > The plural of anecdote is not data. ~ Roger Brinner
> > The combination of some data and an aching desire for an answer does not
> > ensure that a reasonable answer can be extracted from a given body of
> data.
> > ~ John Tukey
> >
> > 2015-06-24 15:23 GMT+02:00 adeela uaf <adeela.uaf at gmail.com>:
> >
> >> Hi,
> >> Can anybody help me in fitting variogram in gstat package in R. I am
> trying
> >> but having this problem. Where Cd15 is the amount of Cadmium in soil at
> 15
> >> cm depth.
> >> v<-variogram(Cd15~1,data)
> >> v.fit<-fit.variogram(v,vgm(1,"Sph",5,1))
> >> Warning message:
> >> In fit.variogram(v, vgm(1, "Sph", 5, 1)) :
> >> Warning: singular model in variogram fit
> >> ******************************
> >> Adeela
> >> University of Agriculture Faisalabad
> >> Department of Math & Stat.
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150624/4962f3a6/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: lyallpur.csv
Type: text/csv
Size: 2526 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150624/4962f3a6/attachment.bin>

From r.turner at auckland.ac.nz  Thu Jun 25 00:23:18 2015
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 25 Jun 2015 10:23:18 +1200
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
Message-ID: <558B2DD6.1060409@auckland.ac.nz>


How did you effect the installation command?  Did you use

     install.packages(.....)

from the R command line?  Or did you use a precompiled Ubuntu binary? Or 
....?

When I do

     install.packages("spatstat", <etc.>)

from the R command line, under my antiquated Fedora system, it installs 
with no problems.

Have you tried downloading the tarball and installing from source, i.e.

     R CMD INSTALL spatstat_1.42-1.tar.gz

???

We need more detail.  If there really is a problem, we need to get to 
the bottom of it.

You might possibly get more help on the R-sig-Debian list; please keep 
us informed of developments.

cheers,

Rolf Turner

On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
> I have Ubuntu 12.04 Precise. I just installed R and want to install
> spatstat. This is the R information:
>
> R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
> Copyright (C) 2015 The R Foundation for Statistical Computing
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> When I try to install spatstat things look fine at first until it tries to
> verify the installation by loading the library. It crashes, with the below
> error message (snipped).
> Any help would be greatly appreciated!
>
> installing to /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
> ** R
> ** data
> *** moving datasets to lazyload DB
> ** demo
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded
> *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
> ======= Backtrace: =========
> /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
> /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
> /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
> 	[[alternative HTML version deleted]]


From HAROLD at il.ibm.com  Thu Jun 25 08:49:00 2015
From: HAROLD at il.ibm.com (Harold-Jeffrey Ship)
Date: Thu, 25 Jun 2015 09:49:00 +0300
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <558B2DD6.1060409@auckland.ac.nz>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
	<558B2DD6.1060409@auckland.ac.nz>
Message-ID: <OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>

Hi Rolf. Thank you for your quick response!

I had tried using install.packages, and just now tried the method you 
suggested (R CMD INSTALL spatstat_1.42-1.tar.gz) with the same results.

By the way, we have the same problem when we try on RHEL 6.4 on a 
different machine with R 3.2.0. I should mention that both of these are 
VM's.

I can send you the entire stack trace if it will help.
--Harold


Rolf Turner <r.turner at auckland.ac.nz> wrote on 06/25/2015 01:23:18 AM:

> From: Rolf Turner <r.turner at auckland.ac.nz>
> To: Harold-Jeffrey Ship/Haifa/IBM at IBMIL
> Cc: r-sig-geo at r-project.org, Adrian Baddeley 
<adrian.baddeley at uwa.edu.au>
> Date: 06/25/2015 01:23 AM
> Subject: Re: [R-sig-Geo] library fails to load in linux
> 
> 
> How did you effect the installation command?  Did you use
> 
>      install.packages(.....)
> 
> from the R command line?  Or did you use a precompiled Ubuntu binary? Or 

> ....?
> 
> When I do
> 
>      install.packages("spatstat", <etc.>)
> 
> from the R command line, under my antiquated Fedora system, it installs 
> with no problems.
> 
> Have you tried downloading the tarball and installing from source, i.e.
> 
>      R CMD INSTALL spatstat_1.42-1.tar.gz
> 
> ???
> 
> We need more detail.  If there really is a problem, we need to get to 
> the bottom of it.
> 
> You might possibly get more help on the R-sig-Debian list; please keep 
> us informed of developments.
> 
> cheers,
> 
> Rolf Turner
> 
> On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
> > I have Ubuntu 12.04 Precise. I just installed R and want to install
> > spatstat. This is the R information:
> >
> > R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
> > Copyright (C) 2015 The R Foundation for Statistical Computing
> > Platform: x86_64-pc-linux-gnu (64-bit)
> >
> > When I try to install spatstat things look fine at first until it 
tries to
> > verify the installation by loading the library. It crashes, with the 
below
> > error message (snipped).
> > Any help would be greatly appreciated!
> >
> > installing to 
/home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
> > ** R
> > ** data
> > *** moving datasets to lazyload DB
> > ** demo
> > ** inst
> > ** byte-compile and prepare package for lazy loading
> > ** help
> > *** installing help indices
> > ** building package indices
> > ** installing vignettes
> > ** testing if installed package can be loaded
> > *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
> > ======= Backtrace: =========
> > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
> > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
> > /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
> >    [[alternative HTML version deleted]]
> 

	[[alternative HTML version deleted]]


From Angelika.Gummert at gmx.de  Thu Jun 25 09:37:55 2015
From: Angelika.Gummert at gmx.de (Angelika Gummert)
Date: Thu, 25 Jun 2015 09:37:55 +0200
Subject: [R-sig-Geo] Polygon area in a grid cell/ Progress bar
Message-ID: <000001d0af19$da336970$8e9a3c50$@gmx.de>

Hi,

I want to calculate the area of my polygons in each grid cell. I tried to
follow this example
https://stat.ethz.ch/pipermail/r-sig-geo/2014-December/022096.html  (I don't
know if this is the right method),but I am unable to intersect my polygons
because it is always running for hours and when I want to stop the
calculation its crashing. I don't know if it is actually working or not
(perhaps it is always crashing right at the beginning) : is there a way to
see if R is working? Something like a progress bar? I tried to look into it
and found something like this: txtProgressBar(min = 0, max = numberSteps,
style = 3) but I am not able to include this in the function. Perhaps you
can tell me how to do it? I am afraid that my polygons are too big for this
calculation or that there are too many polygons (http://data.unep-wcmc.org/
the magroves in the Caribbean). I tried to "simplify" the polygon using
gSimplify() but it is not working either way. Here is what I did. 

 

#creating grid

 

bb <- bbox(Caribbean)   #shapefile of the Caribbean

cs <- c(1, 1)*2 # cell size 

 

cc <- bb[, 1] + (cs/2)  # cell offset

cd <- ceiling(diff(t(bb))/cs)  # number of cells per direction

grd <- GridTopology(cellcentre.offset=cc, cellsize=cs, cells.dim=cd)

grd

 

sp_grd <- SpatialGridDataFrame(grd,

                               data=data.frame(id=1:prod(cd)),

                              proj4string=CRS(proj4string(Caribbean)))

 

 

#transform the grid into a Polygon

 

sp_grdSP <-as(sp_grd,"SpatialPolygons") 

 

 

#Simplify SpatialPolygonsDataFrame

 

Simple <- gSimplify(Data,tol = 0.0001,)    # the output Simple is a
SpatialPolygon

 

 

#intersect both polygons

 

crs(sp_grdSP)<-crs(Simple)

 

Intersection<-intersect(sp_grdSP,Simple)

 

.working.working...working.

 

Is there something wrong with the calculation or with my data? I will try to
run the calculation again over the weekend, but I don't think it will work.

It would be great if someone could help me with this problem.

 

With best regards,

A.G.

 

 

 

 

 

 


	[[alternative HTML version deleted]]


From rubenfcasal at gmail.com  Thu Jun 25 10:05:04 2015
From: rubenfcasal at gmail.com (rubenfcasal)
Date: Thu, 25 Jun 2015 10:05:04 +0200
Subject: [R-sig-Geo] variogram problem
In-Reply-To: <CABGg3O5--91DGHxoZDtFD-PaM5K4TBQJ+=pCW3Fer+w-3HSbuA@mail.gmail.com>
References: <CABGg3O54CO52SB7EgcpzXcz+hJ0hA-ktAm1_3HGP_KMJQ=EZoA@mail.gmail.com>
	<CAJuCY5zUr1aH0zCm5VRpBKsifZMXYhmYdP=fhJZAMuD=6-+gfw@mail.gmail.com>
	<558AB9C5.3030503@uni-muenster.de>
	<CABGg3O5--91DGHxoZDtFD-PaM5K4TBQJ+=pCW3Fer+w-3HSbuA@mail.gmail.com>
Message-ID: <558BB630.6060803@gmail.com>

Hi Adeela,

> This is the the data set and want to make variogram for Cd15.
Start with an exploratory analysis of the data. For example, using the 
geoR package:
lyallpur <- read.csv('lyallpur.csv')

library(geoR)
datgeo <- as.geodata(lyallpur, coords.col = 2:3, data.col = lyallpur$Cd15)
# as.geodata: 2 replicated data locations found.
#WARNING: there are data at coincident or very closed locations, some of 
the geoR's functions may not work.
# Use function dup.coords() to locate duplicated coordinates.
# Consider using jitterDupCoords() for jittering replicated locations

summary(datgeo)
#$duplicated.coords
#   dup    long     lat SrNo  Cd15  Cd30
#15   1 72.9229 31.5025   15 0.087 0.015
#16   2 72.9229 31.5025   16 0.021 0.012
#11   3 72.9810 31.5052   11 0.034 0.008
#12   4 72.9810 31.5052   12 0.020 0.011

plot(datgeo)

There are replicated measurements (not 'standard' in geostatistics...). 
Consider combining them  (easy way...) or introducing a measurement error...

> The distance between each sample location was 4 cross 4 km.

This does not seem to be true...

There are also two locations farapart from the others,I would recommend 
to leave them out in the initial analysis.

lyallpur <- lyallpur[lyallpur$lat > 31.35,]
datgeo <- as.geodata(lyallpur, coords.col = 2:3, data.col = 
log(lyallpur$Cd15))
plot(datgeo)

The log transform seems appropriate, the distribution of the transformed 
values is almost symmetric.

> Please suggest me how to allocate initial guess about nugget, sill and 
> range parametrs.

It seems that you have to fit a spatial trend first...

If the results obtained with the traditional procedures are 
unsatisfactory (e.g misspecification of the parametric model),you could 
try the npsp package (e.g. Fernandez-Casal R. and Francisco-Fernandez 
M., 2014, Nonparametric bias-corrected variogram estimation under 
non-constant trend, Stoch. Environ. Res. Ris. Assess, 28, 1247-1259).

 >WARNING: self-advertising detected...

Best regards, Ruben Fernandez.


From adrian.baddeley at uwa.edu.au  Thu Jun 25 10:12:39 2015
From: adrian.baddeley at uwa.edu.au (Adrian Baddeley)
Date: Thu, 25 Jun 2015 16:12:39 +0800
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
	<558B2DD6.1060409@auckland.ac.nz>,
	<OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>
Message-ID: <CF5661163F77A44781208D9AC4FDEA7201646EAD073A@IS-WIN-376.staffad.uwa.edu.au>

We will continue this conversation offline 
and report the results to R-Sig-Geo when done.

Adrian

Prof Adrian Baddeley FAA
Curtin University

> On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
> > I have Ubuntu 12.04 Precise. I just installed R and want to install
> > spatstat. This is the R information:
> >
> > R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
> > Copyright (C) 2015 The R Foundation for Statistical Computing
> > Platform: x86_64-pc-linux-gnu (64-bit)
> >
> > When I try to install spatstat things look fine at first until it tries to
> > verify the installation by loading the library. It crashes, with the below
> > error message (snipped).
> > Any help would be greatly appreciated!
> >
> > installing to /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
> > ** R
> > ** data
> > *** moving datasets to lazyload DB
> > ** demo
> > ** inst
> > ** byte-compile and prepare package for lazy loading
> > ** help
> > *** installing help indices
> > ** building package indices
> > ** installing vignettes
> > ** testing if installed package can be loaded
> > *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
> > ======= Backtrace: =========
> > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
> > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
> > /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
> >    [[alternative HTML version deleted]]
>


From r.turner at auckland.ac.nz  Thu Jun 25 10:20:10 2015
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 25 Jun 2015 20:20:10 +1200
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
	<558B2DD6.1060409@auckland.ac.nz>
	<OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>
Message-ID: <558BB9BA.6020103@auckland.ac.nz>


On 25/06/15 18:49, Harold-Jeffrey Ship wrote:

> Hi Rolf. Thank you for your quick response!
>
> I had tried using install.packages, and just now tried the method you
> suggested (R CMD INSTALL spatstat_1.42-1.tar.gz) with the same results.
>
> By the way, we have the same problem when we try on RHEL 6.4 on a
> different machine with R 3.2.0. I should mention that both of these are
> VM's.

But was this on the same *physical* machine?  There *might* be some 
hardware (???) induced problem.  I'm clutching at straws here.

> I can send you the entire stack trace if it will help.

Hmm.  Dunno if it will *help* --- I'm puzzled at the moment --- but I 
guess it can't hurt, so yes, please do send the stack trace.

Is there anyone out there on the R-sig-Geo list running Ubuntu 12.4 
"Precise"?  If so could you try downloading the spatstat tarball and 
installing from source, and let me know what happens?

Has anyone ever seen an error message about "stack smashing" (?!?!?!) 
before?  Anyone have any idea what this *means*?

cheers,

Rolf Turner

> Rolf Turner <r.turner at auckland.ac.nz> wrote on 06/25/2015 01:23:18 AM:
>
>  > From: Rolf Turner <r.turner at auckland.ac.nz>
>  > To: Harold-Jeffrey Ship/Haifa/IBM at IBMIL
>  > Cc: r-sig-geo at r-project.org, Adrian Baddeley
> <adrian.baddeley at uwa.edu.au>
>  > Date: 06/25/2015 01:23 AM
>  > Subject: Re: [R-sig-Geo] library fails to load in linux
>  >
>  >
>  > How did you effect the installation command?  Did you use
>  >
>  >      install.packages(.....)
>  >
>  > from the R command line?  Or did you use a precompiled Ubuntu binary? Or
>  > ....?
>  >
>  > When I do
>  >
>  >      install.packages("spatstat", <etc.>)
>  >
>  > from the R command line, under my antiquated Fedora system, it installs
>  > with no problems.
>  >
>  > Have you tried downloading the tarball and installing from source, i.e.
>  >
>  >      R CMD INSTALL spatstat_1.42-1.tar.gz
>  >
>  > ???
>  >
>  > We need more detail.  If there really is a problem, we need to get to
>  > the bottom of it.
>  >
>  > You might possibly get more help on the R-sig-Debian list; please keep
>  > us informed of developments.
>  >
>  > cheers,
>  >
>  > Rolf Turner
>  >
>  > On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
>  > > I have Ubuntu 12.04 Precise. I just installed R and want to install
>  > > spatstat. This is the R information:
>  > >
>  > > R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
>  > > Copyright (C) 2015 The R Foundation for Statistical Computing
>  > > Platform: x86_64-pc-linux-gnu (64-bit)
>  > >
>  > > When I try to install spatstat things look fine at first until it
> tries to
>  > > verify the installation by loading the library. It crashes, with
> the below
>  > > error message (snipped).
>  > > Any help would be greatly appreciated!
>  > >
>  > > installing to
> /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
>  > > ** R
>  > > ** data
>  > > *** moving datasets to lazyload DB
>  > > ** demo
>  > > ** inst
>  > > ** byte-compile and prepare package for lazy loading
>  > > ** help
>  > > *** installing help indices
>  > > ** building package indices
>  > > ** installing vignettes
>  > > ** testing if installed package can be loaded
>  > > *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
>  > > ======= Backtrace: =========
>  > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
>  > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
>  > > /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
>  > >    [[alternative HTML version deleted]]


From englishchristophera at gmail.com  Thu Jun 25 11:16:47 2015
From: englishchristophera at gmail.com (chris english)
Date: Thu, 25 Jun 2015 05:16:47 -0400
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <558BB9BA.6020103@auckland.ac.nz>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>
	<558B2DD6.1060409@auckland.ac.nz>
	<OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>
	<558BB9BA.6020103@auckland.ac.nz>
Message-ID: <CAASFQpSdqy2jUFm=Bnjw1Q=Pe-6D+_eS8wsfenotPEV8eOCYVQ@mail.gmail.com>

http://r.789695.n4.nabble.com/Re-RGtk2-on-linux-quot-stack-smashing-detected-quot-td920903.html

googling the error message suggests pointers to external resources and
since these instances are VM's,
it is likely either the VM or underlying hardware if these are linux guest
on windows/iOS host.

HTH-
chris

On Thu, Jun 25, 2015 at 4:20 AM, Rolf Turner <r.turner at auckland.ac.nz>
wrote:

>
> On 25/06/15 18:49, Harold-Jeffrey Ship wrote:
>
>  Hi Rolf. Thank you for your quick response!
>>
>> I had tried using install.packages, and just now tried the method you
>> suggested (R CMD INSTALL spatstat_1.42-1.tar.gz) with the same results.
>>
>> By the way, we have the same problem when we try on RHEL 6.4 on a
>> different machine with R 3.2.0. I should mention that both of these are
>> VM's.
>>
>
> But was this on the same *physical* machine?  There *might* be some
> hardware (???) induced problem.  I'm clutching at straws here.
>
>  I can send you the entire stack trace if it will help.
>>
>
> Hmm.  Dunno if it will *help* --- I'm puzzled at the moment --- but I
> guess it can't hurt, so yes, please do send the stack trace.
>
> Is there anyone out there on the R-sig-Geo list running Ubuntu 12.4
> "Precise"?  If so could you try downloading the spatstat tarball and
> installing from source, and let me know what happens?
>
> Has anyone ever seen an error message about "stack smashing" (?!?!?!)
> before?  Anyone have any idea what this *means*?
>
> cheers,
>
> Rolf Turner
>
>
>  Rolf Turner <r.turner at auckland.ac.nz> wrote on 06/25/2015 01:23:18 AM:
>>
>>  > From: Rolf Turner <r.turner at auckland.ac.nz>
>>  > To: Harold-Jeffrey Ship/Haifa/IBM at IBMIL
>>  > Cc: r-sig-geo at r-project.org, Adrian Baddeley
>> <adrian.baddeley at uwa.edu.au>
>>  > Date: 06/25/2015 01:23 AM
>>  > Subject: Re: [R-sig-Geo] library fails to load in linux
>>  >
>>  >
>>  > How did you effect the installation command?  Did you use
>>  >
>>  >      install.packages(.....)
>>  >
>>  > from the R command line?  Or did you use a precompiled Ubuntu binary?
>> Or
>>  > ....?
>>  >
>>  > When I do
>>  >
>>  >      install.packages("spatstat", <etc.>)
>>  >
>>  > from the R command line, under my antiquated Fedora system, it installs
>>  > with no problems.
>>  >
>>  > Have you tried downloading the tarball and installing from source, i.e.
>>  >
>>  >      R CMD INSTALL spatstat_1.42-1.tar.gz
>>  >
>>  > ???
>>  >
>>  > We need more detail.  If there really is a problem, we need to get to
>>  > the bottom of it.
>>  >
>>  > You might possibly get more help on the R-sig-Debian list; please keep
>>  > us informed of developments.
>>  >
>>  > cheers,
>>  >
>>  > Rolf Turner
>>  >
>>  > On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
>>  > > I have Ubuntu 12.04 Precise. I just installed R and want to install
>>  > > spatstat. This is the R information:
>>  > >
>>  > > R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
>>  > > Copyright (C) 2015 The R Foundation for Statistical Computing
>>  > > Platform: x86_64-pc-linux-gnu (64-bit)
>>  > >
>>  > > When I try to install spatstat things look fine at first until it
>> tries to
>>  > > verify the installation by loading the library. It crashes, with
>> the below
>>  > > error message (snipped).
>>  > > Any help would be greatly appreciated!
>>  > >
>>  > > installing to
>> /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
>>  > > ** R
>>  > > ** data
>>  > > *** moving datasets to lazyload DB
>>  > > ** demo
>>  > > ** inst
>>  > > ** byte-compile and prepare package for lazy loading
>>  > > ** help
>>  > > *** installing help indices
>>  > > ** building package indices
>>  > > ** installing vignettes
>>  > > ** testing if installed package can be loaded
>>  > > *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
>>  > > ======= Backtrace: =========
>>  > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
>>  > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
>>  > > /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
>>  > >    [[alternative HTML version deleted]]
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From erich.subs at neuwirth.priv.at  Thu Jun 25 12:12:01 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Thu, 25 Jun 2015 12:12:01 +0200
Subject: [R-sig-Geo] GDAL 2.0 on OSX
Message-ID: <1F8EE37D-BCD2-405B-BFE9-EC9BCA8481F5@neuwirth.priv.at>

Does anybody have an idea when GDAL 2.0 will be available for OSX from http://www.kyngchaos.com/software/frameworks? <http://www.kyngchaos.com/software/frameworks?>
	[[alternative HTML version deleted]]


From esa.ostring at infotripla.fi  Thu Jun 25 15:35:11 2015
From: esa.ostring at infotripla.fi (=?windows-1252?Q?Esa_=D6string?=)
Date: Thu, 25 Jun 2015 16:35:11 +0300
Subject: [R-sig-Geo] library fails to load in linux
In-Reply-To: <CAASFQpSdqy2jUFm=Bnjw1Q=Pe-6D+_eS8wsfenotPEV8eOCYVQ@mail.gmail.com>
References: <OF6390FF4D.B759F6F7-ONC2257E6E.004A50D8-C2257E6E.004AFE99@il.ibm.com>	<558B2DD6.1060409@auckland.ac.nz>	<OF305CB949.672C0CBC-ONC2257E6F.002565E5-C2257E6F.002572EB@il.ibm.com>	<558BB9BA.6020103@auckland.ac.nz>
	<CAASFQpSdqy2jUFm=Bnjw1Q=Pe-6D+_eS8wsfenotPEV8eOCYVQ@mail.gmail.com>
Message-ID: <558C038F.1080704@infotripla.fi>

Hi,

Seems to me that this is a safety mechanism during compilation 
(FORTIFY_SOURCE) built into recent Fedora and Ubuntu distributions, to 
detect SW run time memory corruption.

See:
https://wiki.ubuntu.com/Security/Features
and https://idea.popcount.org/2013-08-15-fortify_source/

I suspect that this problem has nothing to do with VM:s, but I have no 
facts to support that claim.

br, Esa ?string, Data Scientist

On 25/06/15 12:16, chris english wrote:
> http://r.789695.n4.nabble.com/Re-RGtk2-on-linux-quot-stack-smashing-detected-quot-td920903.html
>
> googling the error message suggests pointers to external resources and
> since these instances are VM's,
> it is likely either the VM or underlying hardware if these are linux guest
> on windows/iOS host.
>
> HTH-
> chris
>
> On Thu, Jun 25, 2015 at 4:20 AM, Rolf Turner <r.turner at auckland.ac.nz>
> wrote:
>
>> On 25/06/15 18:49, Harold-Jeffrey Ship wrote:
>>
>>   Hi Rolf. Thank you for your quick response!
>>> I had tried using install.packages, and just now tried the method you
>>> suggested (R CMD INSTALL spatstat_1.42-1.tar.gz) with the same results.
>>>
>>> By the way, we have the same problem when we try on RHEL 6.4 on a
>>> different machine with R 3.2.0. I should mention that both of these are
>>> VM's.
>>>
>> But was this on the same *physical* machine?  There *might* be some
>> hardware (???) induced problem.  I'm clutching at straws here.
>>
>>   I can send you the entire stack trace if it will help.
>> Hmm.  Dunno if it will *help* --- I'm puzzled at the moment --- but I
>> guess it can't hurt, so yes, please do send the stack trace.
>>
>> Is there anyone out there on the R-sig-Geo list running Ubuntu 12.4
>> "Precise"?  If so could you try downloading the spatstat tarball and
>> installing from source, and let me know what happens?
>>
>> Has anyone ever seen an error message about "stack smashing" (?!?!?!)
>> before?  Anyone have any idea what this *means*?
>>
>> cheers,
>>
>> Rolf Turner
>>
>>
>>   Rolf Turner <r.turner at auckland.ac.nz> wrote on 06/25/2015 01:23:18 AM:
>>>   > From: Rolf Turner <r.turner at auckland.ac.nz>
>>>   > To: Harold-Jeffrey Ship/Haifa/IBM at IBMIL
>>>   > Cc: r-sig-geo at r-project.org, Adrian Baddeley
>>> <adrian.baddeley at uwa.edu.au>
>>>   > Date: 06/25/2015 01:23 AM
>>>   > Subject: Re: [R-sig-Geo] library fails to load in linux
>>>   >
>>>   >
>>>   > How did you effect the installation command?  Did you use
>>>   >
>>>   >      install.packages(.....)
>>>   >
>>>   > from the R command line?  Or did you use a precompiled Ubuntu binary?
>>> Or
>>>   > ....?
>>>   >
>>>   > When I do
>>>   >
>>>   >      install.packages("spatstat", <etc.>)
>>>   >
>>>   > from the R command line, under my antiquated Fedora system, it installs
>>>   > with no problems.
>>>   >
>>>   > Have you tried downloading the tarball and installing from source, i.e.
>>>   >
>>>   >      R CMD INSTALL spatstat_1.42-1.tar.gz
>>>   >
>>>   > ???
>>>   >
>>>   > We need more detail.  If there really is a problem, we need to get to
>>>   > the bottom of it.
>>>   >
>>>   > You might possibly get more help on the R-sig-Debian list; please keep
>>>   > us informed of developments.
>>>   >
>>>   > cheers,
>>>   >
>>>   > Rolf Turner
>>>   >
>>>   > On 25/06/15 01:39, Harold-Jeffrey Ship wrote:
>>>   > > I have Ubuntu 12.04 Precise. I just installed R and want to install
>>>   > > spatstat. This is the R information:
>>>   > >
>>>   > > R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
>>>   > > Copyright (C) 2015 The R Foundation for Statistical Computing
>>>   > > Platform: x86_64-pc-linux-gnu (64-bit)
>>>   > >
>>>   > > When I try to install spatstat things look fine at first until it
>>> tries to
>>>   > > verify the installation by loading the library. It crashes, with
>>> the below
>>>   > > error message (snipped).
>>>   > > Any help would be greatly appreciated!
>>>   > >
>>>   > > installing to
>>> /home/harold/R/x86_64-pc-linux-gnu-library/3.2/spatstat/libs
>>>   > > ** R
>>>   > > ** data
>>>   > > *** moving datasets to lazyload DB
>>>   > > ** demo
>>>   > > ** inst
>>>   > > ** byte-compile and prepare package for lazy loading
>>>   > > ** help
>>>   > > *** installing help indices
>>>   > > ** building package indices
>>>   > > ** installing vignettes
>>>   > > ** testing if installed package can be loaded
>>>   > > *** stack smashing detected ***: /usr/lib/R/bin/exec/R terminated
>>>   > > ======= Backtrace: =========
>>>   > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x37)[0x7f3895976e57]
>>>   > > /lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x0)[0x7f3895976e20]
>>>   > > /usr/lib/R/lib/libR.so(+0xc9825)[0x7f3895f11825]
>>>   > >    [[alternative HTML version deleted]]
>>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Angelika.Gummert at gmx.de  Thu Jun 25 16:23:39 2015
From: Angelika.Gummert at gmx.de (Angelika Gummert)
Date: Thu, 25 Jun 2015 16:23:39 +0200
Subject: [R-sig-Geo] Intersection of grid and polygon
Message-ID: <000001d0af52$897fd660$9c7f8320$@gmx.de>

Hi,

I am trying to intersect a grid with a polygon, since I want to calculate
the polygon area in each grid cell. Before I did the intersection, I
transformed my grid into a SpatialPolygon. In total it has 2242 features
(cells). My other polygon has 39746 features, since it consists of many tiny
parts. When I try to intersect them with intersect(), I am getting a
SpatialPolygon with 40439 features and not with 2242 or less . I tried the
same analysis with the 2242 cell grid and a Polygon with only 1 feature and
it worked. Is there a way to reduce the features to 1 ? Or do I have to use
another intersect function? I need 2242 grid cells or less as result since I
want to calculate the polygon area in each grid cell. I don't know how I can
solve this problem. Do you have any suggestions?

 

With best regards,

Angelika Gummert


	[[alternative HTML version deleted]]


From juta.kawalerowicz at nuffield.ox.ac.uk  Thu Jun 25 16:40:55 2015
From: juta.kawalerowicz at nuffield.ox.ac.uk (Juta Kawalerowicz)
Date: Thu, 25 Jun 2015 15:40:55 +0100
Subject: [R-sig-Geo] Coordinates of the closest point
In-Reply-To: <50f58c0c-f0b6-40d8-80a5-07b7903163a5@HUB04.ad.oak.ox.ac.uk>
References: <CAHMizkOjbFxYcCTTb+8+KyUgV802CWRW0SQcdMqBvd0my5odWQ@mail.gmail.com>
	<trinity-1c3c30ab-4a82-4208-878a-f1df9cb84ce5-1435115636527@3capp-mailcom-lxa01>
	<50f58c0c-f0b6-40d8-80a5-07b7903163a5@HUB04.ad.oak.ox.ac.uk>
Message-ID: <CAHMizkO8HduwYEN0PJREnk82fG43fWChwj9-MuCnOpg32TtwSg@mail.gmail.com>

Many thanks for your kind suggestions, they provided a sufficient solution
to the problem.

Juta

On Wed, Jun 24, 2015 at 5:07 AM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> And for longitude/latitude data you can use geosphere::dist2Line
> Robert
>
> On Tue, Jun 23, 2015 at 8:13 PM, GeoTux Tuxman
> <geotux_tuxman at linuxmail.org> wrote:
> > Hi Juta, you can do this (only with planar coordinates):
> >
> > require("maptools")
> > coordsLine = cbind(c(1,2,3),c(3,2,2))
> > coordsPoint = c(1.2,1.5)
> > nearestPointOnLine(coordsLine, coordsPoint)
> >
> > If you have a SpatialLinesDataFrame get the coordinates this way:
> > coordsLine = coordinates(line)
> >
> > Note that coordsLine should contain coordinates of a single line.
> >
> > See [1] for details.
> >
> > Regards,
> >
> > Germ?n Carrillo
> > ---------
> > [1]
> >
> http://geotux.tuxfamily.org/index.php/en/component/k2/item/296-snapping-points-to-lines-in-r
> > --
> > -----------
> >    \__
> > (:>__)(
> >    /
> > Soluciones Geoinform?ticas Libres
> > http://geotux.tuxfamily.org
> > http://twitter.com/GeoTux2
> >
> >
> > Sent: Tuesday, June 23, 2015 at 5:55 PM
> > From: "Juta Kawalerowicz" <juta.kawalerowicz at nuffield.ox.ac.uk>
> > To: r-sig-geo <r-sig-geo at r-project.org>
> > Subject: [R-sig-Geo] Coordinates of the closest point
> > Hi, I know how to get the closest distance from a spatial point to a
> > polyline, but I was wondering if there is any easy way to also get
> > coordinates of the closest point on the polyline?
> >
> > A longer way to go around this would be to build a buffer around spatial
> > point with radius equal to whatever is returned by gDistance() and then
> > look for intersections but there must be an easier way?
> >
> > Cheers,
> > Juta
> >
> > [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>

	[[alternative HTML version deleted]]


From Dominik.Schneider at colorado.edu  Thu Jun 25 16:52:39 2015
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Thu, 25 Jun 2015 08:52:39 -0600
Subject: [R-sig-Geo] imprecise location extraction
Message-ID: <CAHYDKLYbf4kaqOmb+h8OQiLVrFrnWd8+D0Y-gLJxMfaLaAfUtg@mail.gmail.com>

Hi,
I'm working on interpolating spatial point data to a grid and as I was
troubleshooting I found that the gridded locations I am predicting to are
not what I expected. In particularly, when I extracted the locations from
the raster grid to get the cell coordinates in which the locations lay, the
latitudes differed by more than 1/2 the cell resolution.
>From some visual inspection, it appears that the station points are at the
edge of two cells (although visually definitely in neighboring cells).  So
is this difference a function of floating point precision? or is something
else going?
Thanks for reading!


library(raster)
library(ggplot2)

res=15/3600
lat=seq(43.75-res/2,33+res/2,-15/3600)
long=seq(-112.25+res/2,-104.125-res/2,15/3600)
ll=expand.grid(long,lat)
rlong=raster(matrix(ll$Var1,byrow=T,nrow=2580))
rlat=raster(matrix(ll$Var2,byrow=T,nrow=2580))
coords=stack(rlong,rlat)
projection(coords)='+init=epsg:4326'
extent(coords)=c(-112.25,-104.125,33,43.75)
coords


> dput(snotellocs.sub)
new("SpatialPointsDataFrame"
    , data = structure(list(network = c("SNTL", "SNTL"), State = c("AZ",
"AZ"
), Station_ID = c("11P08S", "10S01S"), Site_ID = c(927L, 877L
), Site_Name = c("SNOWSLIDE CANYON", "WORKMAN CREEK"), Elevation_ft =
c(9730L,
6900L), Elevation_m = c(2966L, 2103L)), .Names = c("network",
"State", "Station_ID", "Site_ID", "Site_Name", "Elevation_ft",
"Elevation_m"), row.names = c(80L, 83L), class = "data.frame")
    , coords.nrs = c(7L, 6L)
    , coords = structure(c(-111.65058, -110.91773, 35.3416, 33.81242), .Dim
= c(2L,
2L), .Dimnames = list(NULL, c("Longitude", "Latitude")))
    , bbox = structure(c(-111.65058, 33.81242, -110.91773, 35.3416), .Dim =
c(2L,
2L), .Dimnames = list(c("Longitude", "Latitude"), c("min", "max"
)))
    , proj4string = new("CRS"
    , projargs = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
)
)

tmp=data.frame(coordinates(snotellocs.sub),extract(coords,snotellocs.sub))

ggplot()+
geom_raster(data=coord.df,aes(x=Long,y=Lat,fill=rnorm(nrow(coord.df))))+
geom_point(data=tmp,aes(x=Longitude,y=Latitude),shape=1)+
geom_point(data=tmp,aes(x=layer.1,y=layer.2),shape=3)+
# coord_cartesian(ylim=c(35.32,35.35),xlim=c(-111.6490,-111.653))
coord_cartesian(ylim=c(33.8,33.82),xlim=c(-110.925,-110.91))
## each coord_cartesian is for a different point


> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.9.5 (Mavericks)

locale:
[1] en_US/en_US/en_US/C/en_US/en_US

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] ggplot2_1.0.1 raster_2.3-40 sp_1.1-0

loaded via a namespace (and not attached):
 [1] Rcpp_0.11.6      lattice_0.20-31  digest_0.6.8     MASS_7.3-40
 [5] grid_3.2.0       plyr_1.8.2       gtable_0.1.2     magrittr_1.5
 [9] scales_0.2.4     stringi_0.4-1    reshape2_1.4.1   proto_0.3-10
[13] tools_3.2.0      stringr_1.0.0    munsell_0.4.2    colorspace_1.2-6

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Thu Jun 25 18:46:04 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 25 Jun 2015 09:46:04 -0700
Subject: [R-sig-Geo] imprecise location extraction
In-Reply-To: <CAHYDKLYbf4kaqOmb+h8OQiLVrFrnWd8+D0Y-gLJxMfaLaAfUtg@mail.gmail.com>
References: <CAHYDKLYbf4kaqOmb+h8OQiLVrFrnWd8+D0Y-gLJxMfaLaAfUtg@mail.gmail.com>
Message-ID: <CANtt_hzt37kqKPpyO7xwfV8aC+m6u+mQnmnL5sBaHfAj9NzXuA@mail.gmail.com>

Dominik,

The last part of your example does not run. If I understand you well,
this is what you are after (but it all looks good to me):

library(raster)
# raster data with long and lat values
r <- raster(xmn=-112.25, xmx=-104.125, ymn=33, ymx=43.75, res=1/240)
lat <- init(r, v='y')
lon <- init(r, v='x')
s <- stack(lon, lat)

# two points
pt <- rbind(c(-111.6506, 35.34160), c(-110.9177, 33.81242))

# extract the lon/lat for the points
e <- extract(s, pt)

# test if the coordinates of pt indeed are over the cell with those values
mn <- e - (0.5 * res(r) )
mx <- e + (0.5 * res(r))

pt > mn & pt < mx
#      layer.1 layer.2
# [1,]    TRUE    TRUE
# [2,]    TRUE    TRUE

# or look at it this way:

cbind(min=as.vector(mn), p=as.vector(e), max=as.vector(mx))

Robert

On Thu, Jun 25, 2015 at 7:52 AM, Dominik Schneider
<Dominik.Schneider at colorado.edu> wrote:
> Hi,
> I'm working on interpolating spatial point data to a grid and as I was
> troubleshooting I found that the gridded locations I am predicting to are
> not what I expected. In particularly, when I extracted the locations from
> the raster grid to get the cell coordinates in which the locations lay, the
> latitudes differed by more than 1/2 the cell resolution.
> >From some visual inspection, it appears that the station points are at the
> edge of two cells (although visually definitely in neighboring cells).  So
> is this difference a function of floating point precision? or is something
> else going?
> Thanks for reading!
>
>
> library(raster)
> library(ggplot2)
>
> res=15/3600
> lat=seq(43.75-res/2,33+res/2,-15/3600)
> long=seq(-112.25+res/2,-104.125-res/2,15/3600)
> ll=expand.grid(long,lat)
> rlong=raster(matrix(ll$Var1,byrow=T,nrow=2580))
> rlat=raster(matrix(ll$Var2,byrow=T,nrow=2580))
> coords=stack(rlong,rlat)
> projection(coords)='+init=epsg:4326'
> extent(coords)=c(-112.25,-104.125,33,43.75)
> coords
>
>
>> dput(snotellocs.sub)
> new("SpatialPointsDataFrame"
>     , data = structure(list(network = c("SNTL", "SNTL"), State = c("AZ",
> "AZ"
> ), Station_ID = c("11P08S", "10S01S"), Site_ID = c(927L, 877L
> ), Site_Name = c("SNOWSLIDE CANYON", "WORKMAN CREEK"), Elevation_ft =
> c(9730L,
> 6900L), Elevation_m = c(2966L, 2103L)), .Names = c("network",
> "State", "Station_ID", "Site_ID", "Site_Name", "Elevation_ft",
> "Elevation_m"), row.names = c(80L, 83L), class = "data.frame")
>     , coords.nrs = c(7L, 6L)
>     , coords = structure(c(-111.65058, -110.91773, 35.3416, 33.81242), .Dim
> = c(2L,
> 2L), .Dimnames = list(NULL, c("Longitude", "Latitude")))
>     , bbox = structure(c(-111.65058, 33.81242, -110.91773, 35.3416), .Dim =
> c(2L,
> 2L), .Dimnames = list(c("Longitude", "Latitude"), c("min", "max"
> )))
>     , proj4string = new("CRS"
>     , projargs = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
> )
> )
>
> tmp=data.frame(coordinates(snotellocs.sub),extract(coords,snotellocs.sub))
>
> ggplot()+
> geom_raster(data=coord.df,aes(x=Long,y=Lat,fill=rnorm(nrow(coord.df))))+
> geom_point(data=tmp,aes(x=Longitude,y=Latitude),shape=1)+
> geom_point(data=tmp,aes(x=layer.1,y=layer.2),shape=3)+
> # coord_cartesian(ylim=c(35.32,35.35),xlim=c(-111.6490,-111.653))
> coord_cartesian(ylim=c(33.8,33.82),xlim=c(-110.925,-110.91))
> ## each coord_cartesian is for a different point
>
>
>> sessionInfo()
> R version 3.2.0 (2015-04-16)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
>
> locale:
> [1] en_US/en_US/en_US/C/en_US/en_US
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] ggplot2_1.0.1 raster_2.3-40 sp_1.1-0
>
> loaded via a namespace (and not attached):
>  [1] Rcpp_0.11.6      lattice_0.20-31  digest_0.6.8     MASS_7.3-40
>  [5] grid_3.2.0       plyr_1.8.2       gtable_0.1.2     magrittr_1.5
>  [9] scales_0.2.4     stringi_0.4-1    reshape2_1.4.1   proto_0.3-10
> [13] tools_3.2.0      stringr_1.0.0    munsell_0.4.2    colorspace_1.2-6
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From nickmatzke.ncse at gmail.com  Fri Jun 26 06:16:11 2015
From: nickmatzke.ncse at gmail.com (Nick Matzke)
Date: Fri, 26 Jun 2015 01:16:11 -0300
Subject: [R-sig-Geo] Plot Great Circle path on e.g. wrld_simpl?
Message-ID: <CAJdu7BAAPHNtU0bPJPaByGkaD2EQoNAs9HH6r9ekeYBPNksXwQ@mail.gmail.com>

Hi,

Is there an easy way to plot a Great Circle path between two points on a
world map, e.g. wrld_simpl?

E.g., something like this, but Great Circle instead of the flat-map
straight path:

===================================
library(maptools) # for e.g. wrld_simpl

data(wrld_simpl)
plot(wrld_simpl)

# This plots the flat-map straight line, but
# I would like a plot of the Great Circle path
segments(x0=-120, y0=45, x1=0, y1=55, lwd=2)
===================================


I googled around some but didn't find anything super-obvious.

Cheers!
Nick

	[[alternative HTML version deleted]]


From johnbaums at gmail.com  Fri Jun 26 06:24:59 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Fri, 26 Jun 2015 14:24:59 +1000
Subject: [R-sig-Geo] Plot Great Circle path on e.g. wrld_simpl?
In-Reply-To: <CAJdu7BAAPHNtU0bPJPaByGkaD2EQoNAs9HH6r9ekeYBPNksXwQ@mail.gmail.com>
References: <CAJdu7BAAPHNtU0bPJPaByGkaD2EQoNAs9HH6r9ekeYBPNksXwQ@mail.gmail.com>
Message-ID: <CACpmSOs7pP3Oz66AHVYmhQp4Fx8sVCt=q-d=XPyXBjmYRtD11g@mail.gmail.com>

Take a look at
http://flowingdata.com/2011/05/11/how-to-map-connections-with-great-circles/

At its simplest, I think you want to add:

library(geosphere)
path <- gcIntermediate(c(-120, 45), c(0, 55), n=50, addStartEnd=TRUE)
lines(path)

Cheers,
John


On Fri, Jun 26, 2015 at 2:16 PM, Nick Matzke <nickmatzke.ncse at gmail.com>
wrote:

> Hi,
>
> Is there an easy way to plot a Great Circle path between two points on a
> world map, e.g. wrld_simpl?
>
> E.g., something like this, but Great Circle instead of the flat-map
> straight path:
>
> ===================================
> library(maptools) # for e.g. wrld_simpl
>
> data(wrld_simpl)
> plot(wrld_simpl)
>
> # This plots the flat-map straight line, but
> # I would like a plot of the Great Circle path
> segments(x0=-120, y0=45, x1=0, y1=55, lwd=2)
> ===================================
>
>
> I googled around some but didn't find anything super-obvious.
>
> Cheers!
> Nick
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From matzke at nimbios.org  Fri Jun 26 06:47:23 2015
From: matzke at nimbios.org (Nick Matzke)
Date: Fri, 26 Jun 2015 01:47:23 -0300
Subject: [R-sig-Geo] Plot Great Circle path on e.g. wrld_simpl?
In-Reply-To: <CACpmSOs7pP3Oz66AHVYmhQp4Fx8sVCt=q-d=XPyXBjmYRtD11g@mail.gmail.com>
References: <CAJdu7BAAPHNtU0bPJPaByGkaD2EQoNAs9HH6r9ekeYBPNksXwQ@mail.gmail.com>
	<CACpmSOs7pP3Oz66AHVYmhQp4Fx8sVCt=q-d=XPyXBjmYRtD11g@mail.gmail.com>
Message-ID: <CAJdu7BDN2RD=ZRRGdj+pRMhB+hORkX-iUs+iTZi1LVuY_foK4w@mail.gmail.com>

Wow, super-cool, thanks!
Nick

On Fri, Jun 26, 2015 at 1:24 AM, John Baumgartner <johnbaums at gmail.com>
wrote:

> Take a look at
> http://flowingdata.com/2011/05/11/how-to-map-connections-with-great-circles/
>
> At its simplest, I think you want to add:
>
> library(geosphere)
> path <- gcIntermediate(c(-120, 45), c(0, 55), n=50, addStartEnd=TRUE)
> lines(path)
>
> Cheers,
> John
>
>
> On Fri, Jun 26, 2015 at 2:16 PM, Nick Matzke <nickmatzke.ncse at gmail.com>
> wrote:
>
>> Hi,
>>
>> Is there an easy way to plot a Great Circle path between two points on a
>> world map, e.g. wrld_simpl?
>>
>> E.g., something like this, but Great Circle instead of the flat-map
>> straight path:
>>
>> ===================================
>> library(maptools) # for e.g. wrld_simpl
>>
>> data(wrld_simpl)
>> plot(wrld_simpl)
>>
>> # This plots the flat-map straight line, but
>> # I would like a plot of the Great Circle path
>> segments(x0=-120, y0=45, x1=0, y1=55, lwd=2)
>> ===================================
>>
>>
>> I googled around some but didn't find anything super-obvious.
>>
>> Cheers!
>> Nick
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From endri81 at gmail.com  Fri Jun 26 16:11:34 2015
From: endri81 at gmail.com (Endri Raco)
Date: Fri, 26 Jun 2015 16:11:34 +0200
Subject: [R-sig-Geo] Reshape data frame for choropleths plotting
Message-ID: <CACje6_b_mBgQ2E0S=duipdY+fJKgpXgoC3+=Xu=f4i97zEAzSA@mail.gmail.com>

Dear All,

I have a dataframe as below:

*name surname    year      sex    city1      city2     city3 *

*AA        AAA       2011    male     10        20         30*

*BB        BBB       2011    female   25        15         25*

*CC       CCC        2012    male      16      54          32*

*DD       DDD        2012    female    65      41          35*



I have in my* ui. R* two selectInput controls:

*  sidebarPanel(*

*    selectInput('year', 'Year, choices= data$year),*
*    selectInput('gender', 'Gender', choices= data$sex)*
*  )*


where I want to put my selected values



In my *server. R* I have a reactive function :



*  data <- reactive({*
*    a <- subset(data, data$year %in% input$year)*
*    a <- subset(data, data$gender %in% input$gender)*
*    return(a)*
*  })*


and what I want is dataframe* a* to be of form :


*name   city       freq*

*AA       city1       10*

*AA      city2         20*

AA      city3          30


and this data to connect with  existing .shp file with three columns:

*city    long     lat*

*city1   ....       ....*

*city2   ...          ...*

*city3  ....     ......*


in order to plot map with frequencies

Can you please help

	[[alternative HTML version deleted]]


From thi_veloso at yahoo.com.br  Mon Jun 29 01:25:09 2015
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Sun, 28 Jun 2015 23:25:09 +0000 (UTC)
Subject: [R-sig-Geo] =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
	=?utf-8?q?p?=
Message-ID: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>

Dear all,

I am trying to create a map from raster data. The file came from a crop model, with resolution of 0.5 degree. Even when I disaggregate it (i.e. increase spatial resolution), the map looks really pixelated. I am trying to make it look better.
My current code produces this image: http://i.stack.imgur.com/WssPy.png

where I would like to "smooth" the data, by supressing the pixelated look. Some other visualization programs do this automatically, so I guess it should not be hard to reproduce using R. 

For example, this is the same file plotted using Panoply: http://i.stack.imgur.com/jXYI7.png

It doesn't look absolutely smooth, but at least it doesn't have the pixelated look neither. How to achieve a similar result in R? 

This is the code to reproduce my problem:

--------------------------------------------------------------------------
library(RCurl) 
library(rasterVis)

# Go to temp dir and download file - approx. 1.7M
old <- setwd(tempdir())

# download raster and shapefile
download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc', 'yield.nc', method='curl')
download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip', 'southern.zip', method='curl')
unzip('southern.zip', exdir='.')

# load southern Brazil shapefile
mapaSHP <- shapefile('southern.shp')

# load brick
b <- brick('yield.nc', level=16)

# create color scheme
mycols <- rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))

# use second brick layer to plot map
levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha", par.settings = mycols) +
layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))

# return to your old dir
setwd(old)

--------------------------------------------------------------------------
Thanks in advance for any input,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898


From julian at hafro.is  Mon Jun 29 01:52:23 2015
From: julian at hafro.is (Julian Burgos)
Date: Sun, 28 Jun 2015 23:52:23 -0000
Subject: [R-sig-Geo]
 =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
 =?utf-8?q?p?=
In-Reply-To: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
References: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <975634409222eaf1b286ef2dc44fc1d9.squirrel@webmail.hafro.is>

Hi Thiago,
If the output of your model has a resolution of 0.5 degrees, you will have
to do some kind of interpolation to get the "smooth" look that you are
looking for.  If you are only doing this for visualization purposes, you
can use the resample function and do a simple bilinear interpolation.  The
function goes something like this:

new.raster <- b[[2]] # Create a new raster (with same extent, etc. as your
original raster)
res(new.raster) <- 0.25 # Change the resolution.. select whatever value
you want... small values require more time
resample(b[[2]], new.raster, method="bilinear")
levelplot(new.raster)

Now, remember that when you do this you are in a way cheating.  You are
showing a model output at much higher resolution that the output really
is.  But again, if it is only to have a pretty picture then it is fine. 
On the other hand, if you are going to use the new.raster for other
analysis or as input for other models, then things get complicated.

All the best,

Julian
-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnun/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is

> Dear all,
>
> I am trying to create a map from raster data. The file came from a crop
> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
> increase spatial resolution), the map looks really pixelated. I am trying
> to make it look better.
> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>
> where I would like to "smooth" the data, by supressing the pixelated look.
> Some other visualization programs do this automatically, so I guess it
> should not be hard to reproduce using R.
>
> For example, this is the same file plotted using Panoply:
> http://i.stack.imgur.com/jXYI7.png
>
> It doesn't look absolutely smooth, but at least it doesn't have the
> pixelated look neither. How to achieve a similar result in R?
>
> This is the code to reproduce my problem:
>
> --------------------------------------------------------------------------
> library(RCurl)
> library(rasterVis)
>
> # Go to temp dir and download file - approx. 1.7M
> old <- setwd(tempdir())
>
> # download raster and shapefile
> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
> 'yield.nc', method='curl')
> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip',
> 'southern.zip', method='curl')
> unzip('southern.zip', exdir='.')
>
> # load southern Brazil shapefile
> mapaSHP <- shapefile('southern.shp')
>
> # load brick
> b <- brick('yield.nc', level=16)
>
> # create color scheme
> mycols <-
> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>
> # use second brick layer to plot map
> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
> par.settings = mycols) +
> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>
> # return to your old dir
> setwd(old)
>
> --------------------------------------------------------------------------
> Thanks in advance for any input,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From andrewaduff at gmail.com  Mon Jun 29 01:57:19 2015
From: andrewaduff at gmail.com (Andrew Duff)
Date: Sun, 28 Jun 2015 16:57:19 -0700
Subject: [R-sig-Geo]
 =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
 =?utf-8?q?p?=
In-Reply-To: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
References: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <4FF5B6E1-8D83-4A04-ADAF-126EFD738DAD@gmail.com>

You mean re sample?



> On Jun 28, 2015, at 4:25 PM, Thiago V. dos Santos <thi_veloso at yahoo.com.br> wrote:
> 
> Dear all,
> 
> I am trying to create a map from raster data. The file came from a crop model, with resolution of 0.5 degree. Even when I disaggregate it (i.e. increase spatial resolution), the map looks really pixelated. I am trying to make it look better.
> My current code produces this image: http://i.stack.imgur.com/WssPy.png
> 
> where I would like to "smooth" the data, by supressing the pixelated look. Some other visualization programs do this automatically, so I guess it should not be hard to reproduce using R. 
> 
> For example, this is the same file plotted using Panoply: http://i.stack.imgur.com/jXYI7.png
> 
> It doesn't look absolutely smooth, but at least it doesn't have the pixelated look neither. How to achieve a similar result in R? 
> 
> This is the code to reproduce my problem:
> 
> --------------------------------------------------------------------------
> library(RCurl) 
> library(rasterVis)
> 
> # Go to temp dir and download file - approx. 1.7M
> old <- setwd(tempdir())
> 
> # download raster and shapefile
> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc', 'yield.nc', method='curl')
> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip', 'southern.zip', method='curl')
> unzip('southern.zip', exdir='.')
> 
> # load southern Brazil shapefile
> mapaSHP <- shapefile('southern.shp')
> 
> # load brick
> b <- brick('yield.nc', level=16)
> 
> # create color scheme
> mycols <- rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
> 
> # use second brick layer to plot map
> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha", par.settings = mycols) +
> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
> 
> # return to your old dir
> setwd(old)
> 
> --------------------------------------------------------------------------
> Thanks in advance for any input,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Jun 29 07:48:45 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 29 Jun 2015 07:48:45 +0200
Subject: [R-sig-Geo]
	=?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
	=?utf-8?q?p?=
In-Reply-To: <975634409222eaf1b286ef2dc44fc1d9.squirrel@webmail.hafro.is>
References: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
	<975634409222eaf1b286ef2dc44fc1d9.squirrel@webmail.hafro.is>
Message-ID: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>

Julian,

A measured response, with an answer but crucially your comments further 
down. I really hope Thiago reads them, as they are of central importance.

Even for display, nobody should ever hide the actual resolution of the 
information being displayed (even if others do this in error). Of course 
the authors of spatial packages in R will never provide default displays 
that intentionally deceive the viewer.

If the half degree output for the model was what it was designed to 
provide, nobody can know the fitted values at higher resolution without 
re-running the model itself at higher resolution. The input data to the 
model may not be available at this resolution.

More important, the model output almost certainly is accompanied by 
measures of the prediction uncertainly, so that each half-degree cell 
value is actually a summary of the predicted distribution.

Trying to smooth only a central tendency measure of these distributions 
deterministically is creating complete chaos - you will not know what the 
resampled cell distributions are. That is why creating a "nice map" is a 
really bad idea, see also:

http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm

The pixelation is actually your friend, because it is communicating the 
support of the model fitted values visually.

Again, thanks to Julian for a measured and very rapid response.

Roger

On Mon, 29 Jun 2015, Julian Burgos wrote:

> Hi Thiago,
> If the output of your model has a resolution of 0.5 degrees, you will have
> to do some kind of interpolation to get the "smooth" look that you are
> looking for.  If you are only doing this for visualization purposes, you
> can use the resample function and do a simple bilinear interpolation.  The
> function goes something like this:
>
> new.raster <- b[[2]] # Create a new raster (with same extent, etc. as your
> original raster)
> res(new.raster) <- 0.25 # Change the resolution.. select whatever value
> you want... small values require more time
> resample(b[[2]], new.raster, method="bilinear")
> levelplot(new.raster)
>
> Now, remember that when you do this you are in a way cheating.  You are
> showing a model output at much higher resolution that the output really
> is.  But again, if it is only to have a pretty picture then it is fine. 
> On the other hand, if you are going to use the new.raster for other
> analysis or as input for other models, then things get complicated.
>
> All the best,
>
> Julian
> -- 
> Julian Mariano Burgos, PhD
> Hafranns?knastofnun/Marine Research Institute
> Sk?lagata 4, 121 Reykjav?k, Iceland
> S?mi/Telephone : +354-5752037
> Br?fs?mi/Telefax:  +354-5752001
> Netfang/Email: julian at hafro.is
>
>> Dear all,
>>
>> I am trying to create a map from raster data. The file came from a crop
>> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
>> increase spatial resolution), the map looks really pixelated. I am trying
>> to make it look better.
>> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>>
>> where I would like to "smooth" the data, by supressing the pixelated look.
>> Some other visualization programs do this automatically, so I guess it
>> should not be hard to reproduce using R.
>>
>> For example, this is the same file plotted using Panoply:
>> http://i.stack.imgur.com/jXYI7.png
>>
>> It doesn't look absolutely smooth, but at least it doesn't have the
>> pixelated look neither. How to achieve a similar result in R?
>>
>> This is the code to reproduce my problem:
>>
>> --------------------------------------------------------------------------
>> library(RCurl)
>> library(rasterVis)
>>
>> # Go to temp dir and download file - approx. 1.7M
>> old <- setwd(tempdir())
>>
>> # download raster and shapefile
>> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
>> 'yield.nc', method='curl')
>> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip',
>> 'southern.zip', method='curl')
>> unzip('southern.zip', exdir='.')
>>
>> # load southern Brazil shapefile
>> mapaSHP <- shapefile('southern.shp')
>>
>> # load brick
>> b <- brick('yield.nc', level=16)
>>
>> # create color scheme
>> mycols <-
>> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>>
>> # use second brick layer to plot map
>> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
>> par.settings = mycols) +
>> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>>
>> # return to your old dir
>> setwd(old)
>>
>> --------------------------------------------------------------------------
>> Thanks in advance for any input,
>> --
>> Thiago V. dos Santos
>> PhD student
>> Land and Atmospheric Science
>> University of Minnesota
>> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
>> Phone: (612) 323 9898
>>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From julian at hafro.is  Mon Jun 29 12:05:46 2015
From: julian at hafro.is (Julian Burgos)
Date: Mon, 29 Jun 2015 10:05:46 -0000
Subject: [R-sig-Geo]
 =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
 =?utf-8?q?p?=
In-Reply-To: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
References: <400645402.1337619.1435533909759.JavaMail.yahoo@mail.yahoo.com>
	<975634409222eaf1b286ef2dc44fc1d9.squirrel@webmail.hafro.is>
	<alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
Message-ID: <dbde31c3cde28ed2ba95b630d2c06da2.squirrel@webmail.hafro.is>

You are right Robert.  In addition to the statistical reasons you mention,
Thiago should also consider that interpolating at higher resolutions the
output resolution of the model introduces assumptions about the nature of
small-scale processes.  In the case of bilinear interpolation for example,
that the target variable (rice yield) varies linearly in space at scales
below 0.5 degrees.  This assumption it is likely completely wrong (as it
is the case for most types of ecological data).  As you said, the model
may only be designed to capture large scale processes, or the input data
may not be available at higher resolutions and therefore we cannot know
what happens at smaller scales.

Julian
--
Julian Mariano Burgos, PhD
Hafranns?knastofnun/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is

> Julian,
>
> A measured response, with an answer but crucially your comments further
> down. I really hope Thiago reads them, as they are of central importance.
>
> Even for display, nobody should ever hide the actual resolution of the
> information being displayed (even if others do this in error). Of course
> the authors of spatial packages in R will never provide default displays
> that intentionally deceive the viewer.
>
> If the half degree output for the model was what it was designed to
> provide, nobody can know the fitted values at higher resolution without
> re-running the model itself at higher resolution. The input data to the
> model may not be available at this resolution.
>
> More important, the model output almost certainly is accompanied by
> measures of the prediction uncertainly, so that each half-degree cell
> value is actually a summary of the predicted distribution.
>
> Trying to smooth only a central tendency measure of these distributions
> deterministically is creating complete chaos - you will not know what the
> resampled cell distributions are. That is why creating a "nice map" is a
> really bad idea, see also:
>
> http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm
>
> The pixelation is actually your friend, because it is communicating the
> support of the model fitted values visually.
>
> Again, thanks to Julian for a measured and very rapid response.
>
> Roger
>
> On Mon, 29 Jun 2015, Julian Burgos wrote:
>
>> Hi Thiago,
>> If the output of your model has a resolution of 0.5 degrees, you will
>> have
>> to do some kind of interpolation to get the "smooth" look that you are
>> looking for.  If you are only doing this for visualization purposes, you
>> can use the resample function and do a simple bilinear interpolation.
>> The
>> function goes something like this:
>>
>> new.raster <- b[[2]] # Create a new raster (with same extent, etc. as
>> your
>> original raster)
>> res(new.raster) <- 0.25 # Change the resolution.. select whatever value
>> you want... small values require more time
>> resample(b[[2]], new.raster, method="bilinear")
>> levelplot(new.raster)
>>
>> Now, remember that when you do this you are in a way cheating.  You are
>> showing a model output at much higher resolution that the output really
>> is.  But again, if it is only to have a pretty picture then it is fine.
>> On the other hand, if you are going to use the new.raster for other
>> analysis or as input for other models, then things get complicated.
>>
>> All the best,
>>
>> Julian
>> --
>> Julian Mariano Burgos, PhD
>> Hafranns?knastofnun/Marine Research Institute
>> Sk?lagata 4, 121 Reykjav?k, Iceland
>> S?mi/Telephone : +354-5752037
>> Br?fs?mi/Telefax:  +354-5752001
>> Netfang/Email: julian at hafro.is
>>
>>> Dear all,
>>>
>>> I am trying to create a map from raster data. The file came from a crop
>>> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
>>> increase spatial resolution), the map looks really pixelated. I am
>>> trying
>>> to make it look better.
>>> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>>>
>>> where I would like to "smooth" the data, by supressing the pixelated
>>> look.
>>> Some other visualization programs do this automatically, so I guess it
>>> should not be hard to reproduce using R.
>>>
>>> For example, this is the same file plotted using Panoply:
>>> http://i.stack.imgur.com/jXYI7.png
>>>
>>> It doesn't look absolutely smooth, but at least it doesn't have the
>>> pixelated look neither. How to achieve a similar result in R?
>>>
>>> This is the code to reproduce my problem:
>>>
>>> --------------------------------------------------------------------------
>>> library(RCurl)
>>> library(rasterVis)
>>>
>>> # Go to temp dir and download file - approx. 1.7M
>>> old <- setwd(tempdir())
>>>
>>> # download raster and shapefile
>>> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
>>> 'yield.nc', method='curl')
>>> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip',
>>> 'southern.zip', method='curl')
>>> unzip('southern.zip', exdir='.')
>>>
>>> # load southern Brazil shapefile
>>> mapaSHP <- shapefile('southern.shp')
>>>
>>> # load brick
>>> b <- brick('yield.nc', level=16)
>>>
>>> # create color scheme
>>> mycols <-
>>> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>>>
>>> # use second brick layer to plot map
>>> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
>>> par.settings = mycols) +
>>> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>>>
>>> # return to your old dir
>>> setwd(old)
>>>
>>> --------------------------------------------------------------------------
>>> Thanks in advance for any input,
>>> --
>>> Thiago V. dos Santos
>>> PhD student
>>> Land and Atmospheric Science
>>> University of Minnesota
>>> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
>>> Phone: (612) 323 9898
>>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


From thi_veloso at yahoo.com.br  Mon Jun 29 12:21:25 2015
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 29 Jun 2015 10:21:25 +0000 (UTC)
Subject: [R-sig-Geo]
	=?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
	=?utf-8?q?p?=
In-Reply-To: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
References: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
Message-ID: <1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>

Thank you all for the comments; I really appreciate them.

Julian, interpolation was what I was looking for. Instead of 'resample', I ended up using 'disaggregate' with the argument 'method', which I was not using on my code and made a complete difference.

Roger (and Julian too), I guess this is not the case of hiding the actual resolution or cheating. Had I thought about the repercussion of this ethical issue before, I would have made the final purpose clear from the beginning. For that, I am sorry.

The crop model I am using employs mainly climate data as input to solve the equations. There is no information on the spatial distribution of crops. Therefore, the output data (maps) assume that crops are present everywhere on the simulation domain.

A next step on my code (which I omitted in my question for simplification purposes and was not a good idea) is to mask the model output using another map [1], that shows a finer distribution of the studied crop.

Therefore, instead of for example having a southern Brazil completely covered with rice (over water bodies too? - remember this is derived from climate date) like this: http://i.imgur.com/3pPpRXp.png

we can have a more realistic spatial distribution like this, taking into account a high-resolution, satellite-derived map of rice distribution and showing only the areas where rice is actually grown: http://i.imgur.com/HiKqCQW.png

I should reinforce that, for now, no analysis is being conducted on this map: it is for visualization only. Also, all the information on the input dataset (resolution included) will be provided on the supportive text. However, for future works, I still think that the second map would be more suitable for any kind of quantitative analysis. I wonder if some lies are for good?

Thank you guys for bringing up this issue. I would like to hear feedback from other people.

[1] from Monfreda et al. (2008), "Farming the planet: 2. Geographic distribution of crop areas, yields, physiological types, and net primary production in the year 2000", Global Biogeochemical Cycles, Vol.22
 
Greetings,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898



On Monday, June 29, 2015 12:49 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
Julian,

A measured response, with an answer but crucially your comments further 
down. I really hope Thiago reads them, as they are of central importance.

Even for display, nobody should ever hide the actual resolution of the 
information being displayed (even if others do this in error). Of course 
the authors of spatial packages in R will never provide default displays 
that intentionally deceive the viewer.

If the half degree output for the model was what it was designed to 
provide, nobody can know the fitted values at higher resolution without 
re-running the model itself at higher resolution. The input data to the 
model may not be available at this resolution.

More important, the model output almost certainly is accompanied by 
measures of the prediction uncertainly, so that each half-degree cell 
value is actually a summary of the predicted distribution.

Trying to smooth only a central tendency measure of these distributions 
deterministically is creating complete chaos - you will not know what the 
resampled cell distributions are. That is why creating a "nice map" is a 
really bad idea, see also:

http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm

The pixelation is actually your friend, because it is communicating the 
support of the model fitted values visually.

Again, thanks to Julian for a measured and very rapid response.

Roger


On Mon, 29 Jun 2015, Julian Burgos wrote:

> Hi Thiago,
> If the output of your model has a resolution of 0.5 degrees, you will have
> to do some kind of interpolation to get the "smooth" look that you are
> looking for.  If you are only doing this for visualization purposes, you
> can use the resample function and do a simple bilinear interpolation.  The
> function goes something like this:
>
> new.raster <- b[[2]] # Create a new raster (with same extent, etc. as your
> original raster)
> res(new.raster) <- 0.25 # Change the resolution.. select whatever value
> you want... small values require more time
> resample(b[[2]], new.raster, method="bilinear")
> levelplot(new.raster)
>
> Now, remember that when you do this you are in a way cheating.  You are
> showing a model output at much higher resolution that the output really
> is.  But again, if it is only to have a pretty picture then it is fine. 
> On the other hand, if you are going to use the new.raster for other
> analysis or as input for other models, then things get complicated.
>
> All the best,
>
> Julian
> -- 
> Julian Mariano Burgos, PhD
> Hafranns?knastofnun/Marine Research Institute
> Sk?lagata 4, 121 Reykjav?k, Iceland
> S?mi/Telephone : +354-5752037
> Br?fs?mi/Telefax:  +354-5752001
> Netfang/Email: julian at hafro.is
>
>> Dear all,
>>
>> I am trying to create a map from raster data. The file came from a crop
>> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
>> increase spatial resolution), the map looks really pixelated. I am trying
>> to make it look better.
>> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>>
>> where I would like to "smooth" the data, by supressing the pixelated look.
>> Some other visualization programs do this automatically, so I guess it
>> should not be hard to reproduce using R.
>>
>> For example, this is the same file plotted using Panoply:
>> http://i.stack.imgur.com/jXYI7.png
>>
>> It doesn't look absolutely smooth, but at least it doesn't have the
>> pixelated look neither. How to achieve a similar result in R?
>>
>> This is the code to reproduce my problem:
>>
>> --------------------------------------------------------------------------
>> library(RCurl)
>> library(rasterVis)
>>
>> # Go to temp dir and download file - approx. 1.7M
>> old <- setwd(tempdir())
>>
>> # download raster and shapefile
>> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
>> 'yield.nc', method='curl')
>> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip',
>> 'southern.zip', method='curl')
>> unzip('southern.zip', exdir='.')
>>
>> # load southern Brazil shapefile
>> mapaSHP <- shapefile('southern.shp')
>>
>> # load brick
>> b <- brick('yield.nc', level=16)
>>
>> # create color scheme
>> mycols <-
>> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>>
>> # use second brick layer to plot map
>> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
>> par.settings = mycols) +
>> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>>
>> # return to your old dir
>> setwd(old)
>>
>> --------------------------------------------------------------------------
>> Thanks in advance for any input,
>> --
>> Thiago V. dos Santos
>> PhD student
>> Land and Atmospheric Science
>> University of Minnesota
>> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
>> Phone: (612) 323 9898
>>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From julian at hafro.is  Mon Jun 29 12:43:50 2015
From: julian at hafro.is (Julian Burgos)
Date: Mon, 29 Jun 2015 10:43:50 -0000
Subject: [R-sig-Geo]
 =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
 =?utf-8?q?p?=
In-Reply-To: <1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
References: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
	<1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <cc4518bb2b1f614a5c58c5da2b4ab334.squirrel@webmail.hafro.is>

Thago, of course I used the word "cheating" in a colloquial way.  I was
just concerned that you were blindly increasing the resolution without
other considerations, which is clearly not the case. :)

> Thank you all for the comments; I really appreciate them.
>
> Julian, interpolation was what I was looking for. Instead of 'resample', I
> ended up using 'disaggregate' with the argument 'method', which I was not
> using on my code and made a complete difference.
>
> Roger (and Julian too), I guess this is not the case of hiding the actual
> resolution or cheating. Had I thought about the repercussion of this
> ethical issue before, I would have made the final purpose clear from the
> beginning. For that, I am sorry.
>
> The crop model I am using employs mainly climate data as input to solve
> the equations. There is no information on the spatial distribution of
> crops. Therefore, the output data (maps) assume that crops are present
> everywhere on the simulation domain.
>
> A next step on my code (which I omitted in my question for simplification
> purposes and was not a good idea) is to mask the model output using
> another map [1], that shows a finer distribution of the studied crop.
>
> Therefore, instead of for example having a southern Brazil completely
> covered with rice (over water bodies too? - remember this is derived from
> climate date) like this: http://i.imgur.com/3pPpRXp.png
>
> we can have a more realistic spatial distribution like this, taking into
> account a high-resolution, satellite-derived map of rice distribution and
> showing only the areas where rice is actually grown:
> http://i.imgur.com/HiKqCQW.png
>
> I should reinforce that, for now, no analysis is being conducted on this
> map: it is for visualization only. Also, all the information on the input
> dataset (resolution included) will be provided on the supportive text.
> However, for future works, I still think that the second map would be more
> suitable for any kind of quantitative analysis. I wonder if some lies are
> for good?
>
> Thank you guys for bringing up this issue. I would like to hear feedback
> from other people.
>
> [1] from Monfreda et al. (2008), "Farming the planet: 2. Geographic
> distribution of crop areas, yields, physiological types, and net primary
> production in the year 2000", Global Biogeochemical Cycles, Vol.22
>
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>
>
>
> On Monday, June 29, 2015 12:49 AM, Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> Julian,
>
> A measured response, with an answer but crucially your comments further
> down. I really hope Thiago reads them, as they are of central importance.
>
> Even for display, nobody should ever hide the actual resolution of the
> information being displayed (even if others do this in error). Of course
> the authors of spatial packages in R will never provide default displays
> that intentionally deceive the viewer.
>
> If the half degree output for the model was what it was designed to
> provide, nobody can know the fitted values at higher resolution without
> re-running the model itself at higher resolution. The input data to the
> model may not be available at this resolution.
>
> More important, the model output almost certainly is accompanied by
> measures of the prediction uncertainly, so that each half-degree cell
> value is actually a summary of the predicted distribution.
>
> Trying to smooth only a central tendency measure of these distributions
> deterministically is creating complete chaos - you will not know what the
> resampled cell distributions are. That is why creating a "nice map" is a
> really bad idea, see also:
>
> http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm
>
> The pixelation is actually your friend, because it is communicating the
> support of the model fitted values visually.
>
> Again, thanks to Julian for a measured and very rapid response.
>
> Roger
>
>
> On Mon, 29 Jun 2015, Julian Burgos wrote:
>
>> Hi Thiago,
>> If the output of your model has a resolution of 0.5 degrees, you will
>> have
>> to do some kind of interpolation to get the "smooth" look that you are
>> looking for.  If you are only doing this for visualization purposes, you
>> can use the resample function and do a simple bilinear interpolation.
>> The
>> function goes something like this:
>>
>> new.raster <- b[[2]] # Create a new raster (with same extent, etc. as
>> your
>> original raster)
>> res(new.raster) <- 0.25 # Change the resolution.. select whatever value
>> you want... small values require more time
>> resample(b[[2]], new.raster, method="bilinear")
>> levelplot(new.raster)
>>
>> Now, remember that when you do this you are in a way cheating.  You are
>> showing a model output at much higher resolution that the output really
>> is.  But again, if it is only to have a pretty picture then it is fine.
>> On the other hand, if you are going to use the new.raster for other
>> analysis or as input for other models, then things get complicated.
>>
>> All the best,
>>
>> Julian
>> --
>> Julian Mariano Burgos, PhD
>> Hafranns?knastofnun/Marine Research Institute
>> Sk?lagata 4, 121 Reykjav?k, Iceland
>> S?mi/Telephone : +354-5752037
>> Br?fs?mi/Telefax:  +354-5752001
>> Netfang/Email: julian at hafro.is
>>
>>> Dear all,
>>>
>>> I am trying to create a map from raster data. The file came from a crop
>>> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
>>> increase spatial resolution), the map looks really pixelated. I am
>>> trying
>>> to make it look better.
>>> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>>>
>>> where I would like to "smooth" the data, by supressing the pixelated
>>> look.
>>> Some other visualization programs do this automatically, so I guess it
>>> should not be hard to reproduce using R.
>>>
>>> For example, this is the same file plotted using Panoply:
>>> http://i.stack.imgur.com/jXYI7.png
>>>
>>> It doesn't look absolutely smooth, but at least it doesn't have the
>>> pixelated look neither. How to achieve a similar result in R?
>>>
>>> This is the code to reproduce my problem:
>>>
>>> --------------------------------------------------------------------------
>>> library(RCurl)
>>> library(rasterVis)
>>>
>>> # Go to temp dir and download file - approx. 1.7M
>>> old <- setwd(tempdir())
>>>
>>> # download raster and shapefile
>>> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
>>> 'yield.nc', method='curl')
>>> download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip',
>>> 'southern.zip', method='curl')
>>> unzip('southern.zip', exdir='.')
>>>
>>> # load southern Brazil shapefile
>>> mapaSHP <- shapefile('southern.shp')
>>>
>>> # load brick
>>> b <- brick('yield.nc', level=16)
>>>
>>> # create color scheme
>>> mycols <-
>>> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>>>
>>> # use second brick layer to plot map
>>> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
>>> par.settings = mycols) +
>>> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>>>
>>> # return to your old dir
>>> setwd(old)
>>>
>>> --------------------------------------------------------------------------
>>> Thanks in advance for any input,
>>> --
>>> Thiago V. dos Santos
>>> PhD student
>>> Land and Atmospheric Science
>>> University of Minnesota
>>> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
>>> Phone: (612) 323 9898
>>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>


From stephen.stewart85 at gmail.com  Mon Jun 29 12:58:10 2015
From: stephen.stewart85 at gmail.com (Stephen Stewart)
Date: Mon, 29 Jun 2015 20:58:10 +1000
Subject: [R-sig-Geo]
	=?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
	=?utf-8?q?p?=
In-Reply-To: <1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
References: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
	<1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAJefdj4XDMmxSQuVU4Fa2N0ar=YUszhM_mBAbCrtoNXH7X4gGQ@mail.gmail.com>

Hi Thiago,

Just to add...

Binlinear interpolation of the coarse climate surfaces will not pick up the
finer scale elevation gradients, so unless your study area is flat you may
run into issues.

If you want to increase the spatial resolution of the climate data from 5 x
5 km cells, you will want to apply an elevation lapse rate at a minimum
(which you could calculate from the coarse cells and a resampled DEM). Have
a look at ClimateWNA in Wang et al. (2012), looks like it may be relatively
straight forward to implement in R. Regression kriging/thin plate splines
would also be options.

Cheers,

Steve



On Mon, Jun 29, 2015 at 8:21 PM, Thiago V. dos Santos <
thi_veloso at yahoo.com.br> wrote:

> Thank you all for the comments; I really appreciate them.
>
> Julian, interpolation was what I was looking for. Instead of 'resample', I
> ended up using 'disaggregate' with the argument 'method', which I was not
> using on my code and made a complete difference.
>
> Roger (and Julian too), I guess this is not the case of hiding the actual
> resolution or cheating. Had I thought about the repercussion of this
> ethical issue before, I would have made the final purpose clear from the
> beginning. For that, I am sorry.
>
> The crop model I am using employs mainly climate data as input to solve
> the equations. There is no information on the spatial distribution of
> crops. Therefore, the output data (maps) assume that crops are present
> everywhere on the simulation domain.
>
> A next step on my code (which I omitted in my question for simplification
> purposes and was not a good idea) is to mask the model output using another
> map [1], that shows a finer distribution of the studied crop.
>
> Therefore, instead of for example having a southern Brazil completely
> covered with rice (over water bodies too? - remember this is derived from
> climate date) like this: http://i.imgur.com/3pPpRXp.png
>
> we can have a more realistic spatial distribution like this, taking into
> account a high-resolution, satellite-derived map of rice distribution and
> showing only the areas where rice is actually grown:
> http://i.imgur.com/HiKqCQW.png
>
> I should reinforce that, for now, no analysis is being conducted on this
> map: it is for visualization only. Also, all the information on the input
> dataset (resolution included) will be provided on the supportive text.
> However, for future works, I still think that the second map would be more
> suitable for any kind of quantitative analysis. I wonder if some lies are
> for good?
>
> Thank you guys for bringing up this issue. I would like to hear feedback
> from other people.
>
> [1] from Monfreda et al. (2008), "Farming the planet: 2. Geographic
> distribution of crop areas, yields, physiological types, and net primary
> production in the year 2000", Global Biogeochemical Cycles, Vol.22
>
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
>
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>
>
>
> On Monday, June 29, 2015 12:49 AM, Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> Julian,
>
> A measured response, with an answer but crucially your comments further
> down. I really hope Thiago reads them, as they are of central importance.
>
> Even for display, nobody should ever hide the actual resolution of the
> information being displayed (even if others do this in error). Of course
> the authors of spatial packages in R will never provide default displays
> that intentionally deceive the viewer.
>
> If the half degree output for the model was what it was designed to
> provide, nobody can know the fitted values at higher resolution without
> re-running the model itself at higher resolution. The input data to the
> model may not be available at this resolution.
>
> More important, the model output almost certainly is accompanied by
> measures of the prediction uncertainly, so that each half-degree cell
> value is actually a summary of the predicted distribution.
>
> Trying to smooth only a central tendency measure of these distributions
> deterministically is creating complete chaos - you will not know what the
> resampled cell distributions are. That is why creating a "nice map" is a
> really bad idea, see also:
>
> http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm
>
> The pixelation is actually your friend, because it is communicating the
> support of the model fitted values visually.
>
> Again, thanks to Julian for a measured and very rapid response.
>
> Roger
>
>
> On Mon, 29 Jun 2015, Julian Burgos wrote:
>
> > Hi Thiago,
> > If the output of your model has a resolution of 0.5 degrees, you will
> have
> > to do some kind of interpolation to get the "smooth" look that you are
> > looking for.  If you are only doing this for visualization purposes, you
> > can use the resample function and do a simple bilinear interpolation.
> The
> > function goes something like this:
> >
> > new.raster <- b[[2]] # Create a new raster (with same extent, etc. as
> your
> > original raster)
> > res(new.raster) <- 0.25 # Change the resolution.. select whatever value
> > you want... small values require more time
> > resample(b[[2]], new.raster, method="bilinear")
> > levelplot(new.raster)
> >
> > Now, remember that when you do this you are in a way cheating.  You are
> > showing a model output at much higher resolution that the output really
> > is.  But again, if it is only to have a pretty picture then it is fine.
> > On the other hand, if you are going to use the new.raster for other
> > analysis or as input for other models, then things get complicated.
> >
> > All the best,
> >
> > Julian
> > --
> > Julian Mariano Burgos, PhD
> > Hafranns?knastofnun/Marine Research Institute
> > Sk?lagata 4, 121 Reykjav?k, Iceland
> > S?mi/Telephone : +354-5752037
> > Br?fs?mi/Telefax:  +354-5752001
> > Netfang/Email: julian at hafro.is
> >
> >> Dear all,
> >>
> >> I am trying to create a map from raster data. The file came from a crop
> >> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
> >> increase spatial resolution), the map looks really pixelated. I am
> trying
> >> to make it look better.
> >> My current code produces this image: http://i.stack.imgur.com/WssPy.png
> >>
> >> where I would like to "smooth" the data, by supressing the pixelated
> look.
> >> Some other visualization programs do this automatically, so I guess it
> >> should not be hard to reproduce using R.
> >>
> >> For example, this is the same file plotted using Panoply:
> >> http://i.stack.imgur.com/jXYI7.png
> >>
> >> It doesn't look absolutely smooth, but at least it doesn't have the
> >> pixelated look neither. How to achieve a similar result in R?
> >>
> >> This is the code to reproduce my problem:
> >>
> >>
> --------------------------------------------------------------------------
> >> library(RCurl)
> >> library(rasterVis)
> >>
> >> # Go to temp dir and download file - approx. 1.7M
> >> old <- setwd(tempdir())
> >>
> >> # download raster and shapefile
> >> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
> >> 'yield.nc', method='curl')
> >> download.file('
> https://dl.dropboxusercontent.com/u/27700634/southern.zip',
> >> 'southern.zip', method='curl')
> >> unzip('southern.zip', exdir='.')
> >>
> >> # load southern Brazil shapefile
> >> mapaSHP <- shapefile('southern.shp')
> >>
> >> # load brick
> >> b <- brick('yield.nc', level=16)
> >>
> >> # create color scheme
> >> mycols <-
> >> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
> >>
> >> # use second brick layer to plot map
> >> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
> >> par.settings = mycols) +
> >> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
> >>
> >> # return to your old dir
> >> setwd(old)
> >>
> >>
> --------------------------------------------------------------------------
> >> Thanks in advance for any input,
> >> --
> >> Thiago V. dos Santos
> >> PhD student
> >> Land and Atmospheric Science
> >> University of Minnesota
> >>
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> >> Phone: (612) 323 9898
> >>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From dmarcelino at live.com  Mon Jun 29 15:11:29 2015
From: dmarcelino at live.com (Daniel Marcelino)
Date: Mon, 29 Jun 2015 11:11:29 -0200
Subject: [R-sig-Geo] Error in CRS("+init=epsg:4326")
Message-ID: <SNT146-W954144699F9373FEBDDC1BBAA0@phx.gbl>

I'm having the following issue. It's been quite a while I do not play with this program, but it seems that something is not where it should be. Is there any thing I can do to fix it??

# packages:?
library(ggmap)
library(sp)
library(rgdal)
library(rgeos)
?
?# get the city coordinates
go <- geocode("Chicago")
# create spatialPoint object
coordinates(go) <- ~ lon + lat
proj4string(go) <- CRS("+init=epsg:4326")
Error in CRS("+init=epsg:4326") : no system list, errno: 2
?
EPSG <- make_EPSG()
Error in make_EPSG() : Error opening epsg file


> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.10.3 (Yosemite)

locale:
[1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

attached base packages:
[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??

other attached packages:
[1] rgeos_0.3-8 ? rgdal_0.9-2 ? sp_1.1-0 ? ? ?ggmap_2.4 ? ? ggplot2_1.0.1

loaded via a namespace (and not attached):
?[1] Rcpp_0.11.5 ? ? ? ? magrittr_1.5 ? ? ? ?maps_2.3-9 ? ? ? ??
?[4] MASS_7.3-40 ? ? ? ? munsell_0.4.2 ? ? ? colorspace_1.2-6 ??
?[7] geosphere_1.3-13 ? ?lattice_0.20-31 ? ? rjson_0.2.15 ? ? ??
[10] jpeg_0.1-8 ? ? ? ? ?stringr_1.0.0 ? ? ? plyr_1.8.2 ? ? ? ??
[13] tools_3.2.0 ? ? ? ? grid_3.2.0 ? ? ? ? ?gtable_0.1.2 ? ? ??
[16] png_0.1-7 ? ? ? ? ? digest_0.6.8 ? ? ? ?RJSONIO_1.3-0 ? ? ?
[19] reshape2_1.4.1 ? ? ?mapproj_1.2-2 ? ? ? stringi_0.4-1 ? ? ?
[22] RgoogleMaps_1.2.0.7 scales_0.2.4 ? ? ? ?proto_0.3-10 ? ?




\begin{signature}
Daniel Marcelino
??dm.silva at umontreal.ca?
? (514) 343 6111 #3799
Skype: d.marcelino?
? 3200 Jean Brillant, ?Office C5071
Montreal, QC; H3T 1N8
Canada
\end{signature}

"Small steps toward a much better world" 		 	   		  

From Roger.Bivand at nhh.no  Mon Jun 29 15:54:43 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 29 Jun 2015 15:54:43 +0200
Subject: [R-sig-Geo] Error in CRS("+init=epsg:4326")
In-Reply-To: <SNT146-W954144699F9373FEBDDC1BBAA0@phx.gbl>
References: <SNT146-W954144699F9373FEBDDC1BBAA0@phx.gbl>
Message-ID: <alpine.LFD.2.11.1506291552310.28382@reclus.nhh.no>

On Mon, 29 Jun 2015, Daniel Marcelino wrote:

> I'm having the following issue. It's been quite a while I do not play with this program, but it seems that something is not where it should be. Is there any thing I can do to fix it??
>
> # packages:?
> library(ggmap)
> library(sp)
> library(rgdal)
> library(rgeos)
> ?
> ?# get the city coordinates
> go <- geocode("Chicago")
> # create spatialPoint object
> coordinates(go) <- ~ lon + lat
> proj4string(go) <- CRS("+init=epsg:4326")
> Error in CRS("+init=epsg:4326") : no system list, errno: 2
> ?
> EPSG <- make_EPSG()
> Error in make_EPSG() : Error opening epsg file

Reinstall rgdal, for a short period the OSX Mavericks+ binary lacked the 
/proj and /gdal metadata folders. If that isn't possible, copy those 
folders from a Snow Leopard rgdal OSX binary.

Roger

>
>
>> sessionInfo()
> R version 3.2.0 (2015-04-16)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.10.3 (Yosemite)
>
> locale:
> [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??
>
> other attached packages:
> [1] rgeos_0.3-8 ? rgdal_0.9-2 ? sp_1.1-0 ? ? ?ggmap_2.4 ? ? ggplot2_1.0.1
>
> loaded via a namespace (and not attached):
> ?[1] Rcpp_0.11.5 ? ? ? ? magrittr_1.5 ? ? ? ?maps_2.3-9 ? ? ? ??
> ?[4] MASS_7.3-40 ? ? ? ? munsell_0.4.2 ? ? ? colorspace_1.2-6 ??
> ?[7] geosphere_1.3-13 ? ?lattice_0.20-31 ? ? rjson_0.2.15 ? ? ??
> [10] jpeg_0.1-8 ? ? ? ? ?stringr_1.0.0 ? ? ? plyr_1.8.2 ? ? ? ??
> [13] tools_3.2.0 ? ? ? ? grid_3.2.0 ? ? ? ? ?gtable_0.1.2 ? ? ??
> [16] png_0.1-7 ? ? ? ? ? digest_0.6.8 ? ? ? ?RJSONIO_1.3-0 ? ? ?
> [19] reshape2_1.4.1 ? ? ?mapproj_1.2-2 ? ? ? stringi_0.4-1 ? ? ?
> [22] RgoogleMaps_1.2.0.7 scales_0.2.4 ? ? ? ?proto_0.3-10 ? ?
>
>
>
>
> \begin{signature}
> Daniel Marcelino
> ??dm.silva at umontreal.ca?
> ? (514) 343 6111 #3799
> Skype: d.marcelino?
> ? 3200 Jean Brillant, ?Office C5071
> Montreal, QC; H3T 1N8
> Canada
> \end{signature}
>
> "Small steps toward a much better world" 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From SWalbridge at esri.com  Mon Jun 29 17:57:12 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Mon, 29 Jun 2015 15:57:12 +0000
Subject: [R-sig-Geo]
 =?utf-8?q?How_to_=E2=80=9Csmooth=E2=80=9D_a_raster_ma?=
 =?utf-8?q?p?=
In-Reply-To: <1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
References: <alpine.LFD.2.11.1506290722400.26576@reclus.nhh.no>
	<1506118557.1506553.1435573285421.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <D1B6E168.2A6B6%swalbridge@esri.com>

One area that may be worth looking into for this kind of spatial
disaggregation is dasymetric mapping. The technique originated out of
census data, where the provided scale rarely matches the scale of
interest. I've used this technique in the past to disaggregate crop
production totals onto a surface containing viable crop locations.

As a starting point, I'd recommend the Mennis and Hultgren paper [1] on
intelligent dasymetric mapping.

1. 
https://scholar.google.com/citations?view_op=view_citation&citation_for_vie
w=tyqlZucAAAAJ:2osOgNQ5qMEC

-- 
Shaun Walbridge
GIS Developer


On 6/29/15, 6:21 AM, "R-sig-Geo on behalf of Thiago V. dos Santos"
<r-sig-geo-bounces at r-project.org on behalf of thi_veloso at yahoo.com.br>
wrote:


>Thank you all for the comments; I really appreciate them.
>
>Julian, interpolation was what I was looking for. Instead of 'resample',
>I ended up using 'disaggregate' with the argument 'method', which I was
>not using on my code and made a complete difference.
>
>Roger (and Julian too), I guess this is not the case of hiding the actual
>resolution or cheating. Had I thought about the repercussion of this
>ethical issue before, I would have made the final purpose clear from the
>beginning. For that, I am sorry.
>
>The crop model I am using employs mainly climate data as input to solve
>the equations. There is no information on the spatial distribution of
>crops. Therefore, the output data (maps) assume that crops are present
>everywhere on the simulation domain.
>
>A next step on my code (which I omitted in my question for simplification
>purposes and was not a good idea) is to mask the model output using
>another map [1], that shows a finer distribution of the studied crop.
>
>Therefore, instead of for example having a southern Brazil completely
>covered with rice (over water bodies too? - remember this is derived from
>climate date) like this: http://i.imgur.com/3pPpRXp.png
>
>we can have a more realistic spatial distribution like this, taking into
>account a high-resolution, satellite-derived map of rice distribution and
>showing only the areas where rice is actually grown:
>http://i.imgur.com/HiKqCQW.png
>
>I should reinforce that, for now, no analysis is being conducted on this
>map: it is for visualization only. Also, all the information on the input
>dataset (resolution included) will be provided on the supportive text.
>However, for future works, I still think that the second map would be
>more suitable for any kind of quantitative analysis. I wonder if some
>lies are for good?
>
>Thank you guys for bringing up this issue. I would like to hear feedback
>from other people.
>
>[1] from Monfreda et al. (2008), "Farming the planet: 2. Geographic
>distribution of crop areas, yields, physiological types, and net primary
>production in the year 2000", Global Biogeochemical Cycles, Vol.22
> 
>Greetings,
>--
>Thiago V. dos Santos
>PhD student
>Land and Atmospheric Science
>University of Minnesota
>http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/in
>dex.htm
>Phone: (612) 323 9898
>
>
>
>On Monday, June 29, 2015 12:49 AM, Roger Bivand <Roger.Bivand at nhh.no>
>wrote:
>Julian,
>
>A measured response, with an answer but crucially your comments further
>down. I really hope Thiago reads them, as they are of central importance.
>
>Even for display, nobody should ever hide the actual resolution of the
>information being displayed (even if others do this in error). Of course
>the authors of spatial packages in R will never provide default displays
>that intentionally deceive the viewer.
>
>If the half degree output for the model was what it was designed to
>provide, nobody can know the fitted values at higher resolution without
>re-running the model itself at higher resolution. The input data to the
>model may not be available at this resolution.
>
>More important, the model output almost certainly is accompanied by
>measures of the prediction uncertainly, so that each half-degree cell
>value is actually a summary of the predicted distribution.
>
>Trying to smooth only a central tendency measure of these distributions
>deterministically is creating complete chaos - you will not know what the
>resampled cell distributions are. That is why creating a "nice map" is a
>really bad idea, see also:
>
>http://www.markmonmonier.com/how_to_lie_with_maps_14880.htm
>
>The pixelation is actually your friend, because it is communicating the
>support of the model fitted values visually.
>
>Again, thanks to Julian for a measured and very rapid response.
>
>Roger
>
>
>On Mon, 29 Jun 2015, Julian Burgos wrote:
>
>> Hi Thiago,
>> If the output of your model has a resolution of 0.5 degrees, you will
>>have
>> to do some kind of interpolation to get the "smooth" look that you are
>> looking for.  If you are only doing this for visualization purposes, you
>> can use the resample function and do a simple bilinear interpolation.
>>The
>> function goes something like this:
>>
>> new.raster <- b[[2]] # Create a new raster (with same extent, etc. as
>>your
>> original raster)
>> res(new.raster) <- 0.25 # Change the resolution.. select whatever value
>> you want... small values require more time
>> resample(b[[2]], new.raster, method="bilinear")
>> levelplot(new.raster)
>>
>> Now, remember that when you do this you are in a way cheating.  You are
>> showing a model output at much higher resolution that the output really
>> is.  But again, if it is only to have a pretty picture then it is fine.
>> On the other hand, if you are going to use the new.raster for other
>> analysis or as input for other models, then things get complicated.
>>
>> All the best,
>>
>> Julian
>> -- 
>> Julian Mariano Burgos, PhD
>> Hafranns?knastofnun/Marine Research Institute
>> Sk?lagata 4, 121 Reykjav?k, Iceland
>> S?mi/Telephone : +354-5752037
>> Br?fs?mi/Telefax:  +354-5752001
>> Netfang/Email: julian at hafro.is
>>
>>> Dear all,
>>>
>>> I am trying to create a map from raster data. The file came from a crop
>>> model, with resolution of 0.5 degree. Even when I disaggregate it (i.e.
>>> increase spatial resolution), the map looks really pixelated. I am
>>>trying
>>> to make it look better.
>>> My current code produces this image: http://i.stack.imgur.com/WssPy.png
>>>
>>> where I would like to "smooth" the data, by supressing the pixelated
>>>look.
>>> Some other visualization programs do this automatically, so I guess it
>>> should not be hard to reproduce using R.
>>>
>>> For example, this is the same file plotted using Panoply:
>>> http://i.stack.imgur.com/jXYI7.png
>>>
>>> It doesn't look absolutely smooth, but at least it doesn't have the
>>> pixelated look neither. How to achieve a similar result in R?
>>>
>>> This is the code to reproduce my problem:
>>>
>>> 
>>>------------------------------------------------------------------------
>>>--
>>> library(RCurl)
>>> library(rasterVis)
>>>
>>> # Go to temp dir and download file - approx. 1.7M
>>> old <- setwd(tempdir())
>>>
>>> # download raster and shapefile
>>> download.file('https://dl.dropboxusercontent.com/u/27700634/yield.nc',
>>> 'yield.nc', method='curl')
>>> 
>>>download.file('https://dl.dropboxusercontent.com/u/27700634/southern.zip
>>>',
>>> 'southern.zip', method='curl')
>>> unzip('southern.zip', exdir='.')
>>>
>>> # load southern Brazil shapefile
>>> mapaSHP <- shapefile('southern.shp')
>>>
>>> # load brick
>>> b <- brick('yield.nc', level=16)
>>>
>>> # create color scheme
>>> mycols <-
>>> rasterTheme(region=colorRampPalette(brewer.pal(9,'Greens'))(100))
>>>
>>> # use second brick layer to plot map
>>> levelplot(b[[2]], margin = FALSE, main = "Rice yield in tons/ha",
>>> par.settings = mycols) +
>>> layer(sp.lines(mapaSHP, lwd=0.8, col='darkgray'))
>>>
>>> # return to your old dir
>>> setwd(old)
>>>
>>> 
>>>------------------------------------------------------------------------
>>>--
>>> Thanks in advance for any input,
>>> --
>>> Thiago V. dos Santos
>>> PhD student
>>> Land and Atmospheric Science
>>> University of Minnesota
>>> 
>>>http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/
>>>index.htm
>>> Phone: (612) 323 9898
>>>
>
>-- 
>Roger Bivand
>Department of Economics, Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 91 00
>e-mail: Roger.Bivand at nhh.no
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Dominik.Schneider at colorado.edu  Tue Jun 30 23:02:29 2015
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Tue, 30 Jun 2015 15:02:29 -0600
Subject: [R-sig-Geo] imprecise location extraction
In-Reply-To: <CANtt_hzt37kqKPpyO7xwfV8aC+m6u+mQnmnL5sBaHfAj9NzXuA@mail.gmail.com>
References: <CAHYDKLYbf4kaqOmb+h8OQiLVrFrnWd8+D0Y-gLJxMfaLaAfUtg@mail.gmail.com>
	<CANtt_hzt37kqKPpyO7xwfV8aC+m6u+mQnmnL5sBaHfAj9NzXuA@mail.gmail.com>
Message-ID: <CAHYDKLbu=FuQ2N12LX0ai8e7ofSr5hqyzhqAv=4M2cPPu+FtUA@mail.gmail.com>

Sorry Robert, the following two lines (just before ggplot() ) got lost
somewhere along the way:
coord.df=as.data.frame(coords)
names(coord.df)=c('Long','Lat')

However, you are correct that the data I posted isn't giving the same
issue. I suspect it has to do with how the coordinates are being pasted
into email because I still get the issue with my original dataset if I do
as below (where snotellocs is the original version of snotellocs.sub). I
haven't managed to recreate the issue by typing in the coordinates manually.

tmp=data.frame(coordinates(snotellocs),extract(coordstack,snotellocs))
tmp=mutate(tmp,
    latdiff=Latitude-layer.2,
    longdiff=Longitude-layer.1)
tmp$latflag2=ifelse(tmp$latdiff>15/3600/2,1,0)
tmp$longflag2=ifelse(tmp$longdiff>15/3600/2,1,0)
ind=which(tmp$latflag2==1)
tmp[ind,]

> tmp[ind,]
    Longitude Latitude   layer.1  layer.2     latdiff      longdiff latflag2
6   -112.0623 35.26247 -112.0604 35.26028 0.002192222 -1.893333e-03        1
18  -111.6506 35.34160 -111.6521 35.33944 0.002155556  1.503333e-03        1
21  -110.9177 33.81242 -110.9188 33.81028 0.002142222  1.020000e-03        1
62  -105.6307 40.57913 -105.6312 40.57694 0.002185556  5.700000e-04        1
83  -108.0584 39.05831 -108.0604 39.05611 0.002198889  2.066667e-03        1
89  -106.5584 37.96661 -106.5604 37.96444 0.002165556  2.046667e-03        1
91  -105.9558 40.40405 -105.9562 40.40194 0.002105556  4.200000e-04        1
104 -106.0833 39.03333 -106.0812 39.03111 0.002218889 -2.080000e-03        1
116 -106.6768 40.53743 -106.6771 40.53528 0.002152222  2.833333e-04        1
139 -111.9564 42.52497 -111.9562 42.52278 0.002192222 -1.000000e-04        1
141 -111.2980 42.56248 -111.2979 42.56028 0.002202222 -5.333333e-05        1
156 -108.2667 35.23333 -108.2687 35.23111 0.002218889  2.080000e-03        1
164 -105.1947 36.47493 -105.1937 36.47278 0.002152222 -9.300000e-04        1
170 -111.0978 40.61238 -111.0979 40.61028 0.002102222  9.666667e-05        1
174 -110.5825 40.95833 -110.5812 40.95611 0.002218889 -1.300000e-03        1
214 -110.7462 39.89165 -110.7479 39.88944 0.002205556  1.766667e-03        1
223 -109.2896 38.48323 -109.2896 38.48111 0.002118889 -1.666667e-05        1
230 -111.3182 39.68333 -111.3187 39.68111 0.002218889  5.700000e-04        1
262 -107.2661 41.05413 -107.2646 41.05194 0.002185556 -1.506667e-03        1
281 -109.8782 43.38332 -109.8771 43.38111 0.002208889 -1.066667e-03        1
    longflag2
6           0
18          0
21          0
62          0
83          0
89          0
91          0
104         0
116         0
139         0
141         0
156         0
164         0
170         0
174         0
214         0
223         0
230         0
262         0
281         0

Dominik Schneider
o 303.735.6296 | c 518.956.3978


On Thu, Jun 25, 2015 at 10:46 AM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> Dominik,
>
> The last part of your example does not run. If I understand you well,
> this is what you are after (but it all looks good to me):
>
> library(raster)
> # raster data with long and lat values
> r <- raster(xmn=-112.25, xmx=-104.125, ymn=33, ymx=43.75, res=1/240)
> lat <- init(r, v='y')
> lon <- init(r, v='x')
> s <- stack(lon, lat)
>
> # two points
> pt <- rbind(c(-111.6506, 35.34160), c(-110.9177, 33.81242))
>
> # extract the lon/lat for the points
> e <- extract(s, pt)
>
> # test if the coordinates of pt indeed are over the cell with those values
> mn <- e - (0.5 * res(r) )
> mx <- e + (0.5 * res(r))
>
> pt > mn & pt < mx
> #      layer.1 layer.2
> # [1,]    TRUE    TRUE
> # [2,]    TRUE    TRUE
>
> # or look at it this way:
>
> cbind(min=as.vector(mn), p=as.vector(e), max=as.vector(mx))
>
> Robert
>
> On Thu, Jun 25, 2015 at 7:52 AM, Dominik Schneider
> <Dominik.Schneider at colorado.edu> wrote:
> > Hi,
> > I'm working on interpolating spatial point data to a grid and as I was
> > troubleshooting I found that the gridded locations I am predicting to are
> > not what I expected. In particularly, when I extracted the locations from
> > the raster grid to get the cell coordinates in which the locations lay,
> the
> > latitudes differed by more than 1/2 the cell resolution.
> > >From some visual inspection, it appears that the station points are at
> the
> > edge of two cells (although visually definitely in neighboring cells).
> So
> > is this difference a function of floating point precision? or is
> something
> > else going?
> > Thanks for reading!
> >
> >
> > library(raster)
> > library(ggplot2)
> >
> > res=15/3600
> > lat=seq(43.75-res/2,33+res/2,-15/3600)
> > long=seq(-112.25+res/2,-104.125-res/2,15/3600)
> > ll=expand.grid(long,lat)
> > rlong=raster(matrix(ll$Var1,byrow=T,nrow=2580))
> > rlat=raster(matrix(ll$Var2,byrow=T,nrow=2580))
> > coords=stack(rlong,rlat)
> > projection(coords)='+init=epsg:4326'
> > extent(coords)=c(-112.25,-104.125,33,43.75)
> > coords
> >
> >
> >> dput(snotellocs.sub)
> > new("SpatialPointsDataFrame"
> >     , data = structure(list(network = c("SNTL", "SNTL"), State = c("AZ",
> > "AZ"
> > ), Station_ID = c("11P08S", "10S01S"), Site_ID = c(927L, 877L
> > ), Site_Name = c("SNOWSLIDE CANYON", "WORKMAN CREEK"), Elevation_ft =
> > c(9730L,
> > 6900L), Elevation_m = c(2966L, 2103L)), .Names = c("network",
> > "State", "Station_ID", "Site_ID", "Site_Name", "Elevation_ft",
> > "Elevation_m"), row.names = c(80L, 83L), class = "data.frame")
> >     , coords.nrs = c(7L, 6L)
> >     , coords = structure(c(-111.65058, -110.91773, 35.3416, 33.81242),
> .Dim
> > = c(2L,
> > 2L), .Dimnames = list(NULL, c("Longitude", "Latitude")))
> >     , bbox = structure(c(-111.65058, 33.81242, -110.91773, 35.3416),
> .Dim =
> > c(2L,
> > 2L), .Dimnames = list(c("Longitude", "Latitude"), c("min", "max"
> > )))
> >     , proj4string = new("CRS"
> >     , projargs = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
> > )
> > )
> >
> >
> tmp=data.frame(coordinates(snotellocs.sub),extract(coords,snotellocs.sub))
> >
> > ggplot()+
> > geom_raster(data=coord.df,aes(x=Long,y=Lat,fill=rnorm(nrow(coord.df))))+
> > geom_point(data=tmp,aes(x=Longitude,y=Latitude),shape=1)+
> > geom_point(data=tmp,aes(x=layer.1,y=layer.2),shape=3)+
> > # coord_cartesian(ylim=c(35.32,35.35),xlim=c(-111.6490,-111.653))
> > coord_cartesian(ylim=c(33.8,33.82),xlim=c(-110.925,-110.91))
> > ## each coord_cartesian is for a different point
> >
> >
> >> sessionInfo()
> > R version 3.2.0 (2015-04-16)
> > Platform: x86_64-apple-darwin13.4.0 (64-bit)
> > Running under: OS X 10.9.5 (Mavericks)
> >
> > locale:
> > [1] en_US/en_US/en_US/C/en_US/en_US
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] ggplot2_1.0.1 raster_2.3-40 sp_1.1-0
> >
> > loaded via a namespace (and not attached):
> >  [1] Rcpp_0.11.6      lattice_0.20-31  digest_0.6.8     MASS_7.3-40
> >  [5] grid_3.2.0       plyr_1.8.2       gtable_0.1.2     magrittr_1.5
> >  [9] scales_0.2.4     stringi_0.4-1    reshape2_1.4.1   proto_0.3-10
> > [13] tools_3.2.0      stringr_1.0.0    munsell_0.4.2    colorspace_1.2-6
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


