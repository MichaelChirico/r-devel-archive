From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Nov  3 02:08:00 2020
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 2 Nov 2020 20:08:00 -0500
Subject: [R-SIG-Mac] Recommended version of Xcode?
Message-ID: <0bf01efc-af82-6bc8-3e8f-f607f7912726@gmail.com>

The https://mac.r-project.org/ page says that R is now built with Xcode 
11.4.  Is this still correct?  There are several newer versions 
available (11.5, 11.6, 11.7, 12, 12.0.1, 12.1).

Duncan Murdoch


From du@@@@dr|@n @end|ng |rom un|buc@ro  Tue Nov  3 08:08:49 2020
From: du@@@@dr|@n @end|ng |rom un|buc@ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Tue, 3 Nov 2020 09:08:49 +0200
Subject: [R-SIG-Mac] Recommended version of Xcode?
In-Reply-To: <0bf01efc-af82-6bc8-3e8f-f607f7912726@gmail.com>
References: <0bf01efc-af82-6bc8-3e8f-f607f7912726@gmail.com>
Message-ID: <CAJ=0CtAEVtVX3EDPEAed2y0fAp+D=+47HS+tpzhhG=uN8xLt3g@mail.gmail.com>

For some reason, I was recently unable to update my Xcode and digged a
little bit.
One solution was to completely uninstall it and do a fresh install, a
process in which I found that:
- Xcode take more than 10GB of my harddrive
- not sure about building R, but I was able to build packages _without_
Xcode altogether, since it is possible to download and install only the
Command Line Tools.

Since the CLT takes about 500MB, I thought this might be worth sharing.
Adrian

On Tue, Nov 3, 2020 at 3:08 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> The https://mac.r-project.org/ page says that R is now built with Xcode
> 11.4.  Is this still correct?  There are several newer versions
> available (11.5, 11.6, 11.7, 12, 12.0.1, 12.1).
>
> Duncan Murdoch
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr. 90-92
050663 Bucharest sector 5
Romania
https://adriandusa.eu

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Tue Nov  3 10:20:03 2020
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Tue, 3 Nov 2020 04:20:03 -0500
Subject: [R-SIG-Mac] Recommended version of Xcode?
In-Reply-To: <CAJ=0CtAEVtVX3EDPEAed2y0fAp+D=+47HS+tpzhhG=uN8xLt3g@mail.gmail.com>
References: <0bf01efc-af82-6bc8-3e8f-f607f7912726@gmail.com>
 <CAJ=0CtAEVtVX3EDPEAed2y0fAp+D=+47HS+tpzhhG=uN8xLt3g@mail.gmail.com>
Message-ID: <3e398c8b-c0d4-30b3-f90c-ab6572aab8c1@gmail.com>

Thanks for pointing that out.  Which version are you using?

Duncan Murdoch

On 03/11/2020 2:08 a.m., Adrian Du?a wrote:
> For some reason, I was?recently unable to update my Xcode and digged a 
> little?bit.
> One solution was to completely uninstall it and do a fresh install, a 
> process in which I found that:
> - Xcode take more than 10GB of my harddrive
> - not sure about building R, but I was able to build packages _without_ 
> Xcode altogether, since it is possible to download and install only the 
> Command Line Tools.
> 
> Since the CLT takes about 500MB, I thought this might be worth?sharing.
> Adrian
> 
> On Tue, Nov 3, 2020 at 3:08 AM Duncan Murdoch <murdoch.duncan at gmail.com 
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     The https://mac.r-project.org/ page says that R is now built with Xcode
>     11.4.? Is this still correct?? There are several newer versions
>     available (11.5, 11.6, 11.7, 12, 12.0.1, 12.1).
> 
>     Duncan Murdoch
> 
>     _______________________________________________
>     R-SIG-Mac mailing list
>     R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> 
> -- 
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr. 90-92
> 050663 Bucharest sector 5
> Romania
> https://adriandusa.eu


From du@@@@dr|@n @end|ng |rom un|buc@ro  Tue Nov  3 10:49:48 2020
From: du@@@@dr|@n @end|ng |rom un|buc@ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Tue, 3 Nov 2020 11:49:48 +0200
Subject: [R-SIG-Mac] Recommended version of Xcode?
In-Reply-To: <3e398c8b-c0d4-30b3-f90c-ab6572aab8c1@gmail.com>
References: <0bf01efc-af82-6bc8-3e8f-f607f7912726@gmail.com>
 <CAJ=0CtAEVtVX3EDPEAed2y0fAp+D=+47HS+tpzhhG=uN8xLt3g@mail.gmail.com>
 <3e398c8b-c0d4-30b3-f90c-ab6572aab8c1@gmail.com>
Message-ID: <CAJ=0CtDQNT3mxJNiK2LHFFmaQbedRhC-0L1QVed-1sJd-tz5zA@mail.gmail.com>

If I am not mistaken, I've downloaded CLT for Xcode 12 from
developer.apple.com.
There is a newer version 12.2 beta but I wanted the stable version.

Hope this helps,
Adrian


On Tue, Nov 3, 2020 at 11:20 AM Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> Thanks for pointing that out.  Which version are you using?
>
> Duncan Murdoch
>
> On 03/11/2020 2:08 a.m., Adrian Du?a wrote:
> > For some reason, I was recently unable to update my Xcode and digged a
> > little bit.
> > One solution was to completely uninstall it and do a fresh install, a
> > process in which I found that:
> > - Xcode take more than 10GB of my harddrive
> > - not sure about building R, but I was able to build packages _without_
> > Xcode altogether, since it is possible to download and install only the
> > Command Line Tools.
> >
> > Since the CLT takes about 500MB, I thought this might be worth sharing.
> > Adrian
> >
> > On Tue, Nov 3, 2020 at 3:08 AM Duncan Murdoch <murdoch.duncan at gmail.com
> > <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     The https://mac.r-project.org/ page says that R is now built with
> Xcode
> >     11.4.  Is this still correct?  There are several newer versions
> >     available (11.5, 11.6, 11.7, 12, 12.0.1, 12.1).
> >
> >     Duncan Murdoch
> >
> >     _______________________________________________
> >     R-SIG-Mac mailing list
> >     R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >
> >
> >
> > --
> > Adrian Dusa
> > University of Bucharest
> > Romanian Social Data Archive
> > Soseaua Panduri nr. 90-92
> > 050663 Bucharest sector 5
> > Romania
> > https://adriandusa.eu
>
>

-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr. 90-92
050663 Bucharest sector 5
Romania
https://adriandusa.eu

	[[alternative HTML version deleted]]


From roy@mende|@@ohn @end|ng |rom no@@@gov  Tue Nov  3 15:47:11 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 3 Nov 2020 06:47:11 -0800
Subject: [R-SIG-Mac] Thanks
Message-ID: <5CB502EB-00B5-4B25-B75C-C1590BE7866F@noaa.gov>

https://developer.r-project.org/Blog/public/2020/11/02/will-r-work-on-apple-silicon/

It reads like a lot of work.  Thanks for the efforts!

-Roy


**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From g|@pp|e @end|ng |rom m@c@com  Sun Nov  8 21:16:03 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Sun, 8 Nov 2020 17:16:03 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
Message-ID: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>

Hi, 

I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:

Warning messages:
1: In readLines(file, warn = TRUE) :
  incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
  system call failed: Result too large
3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
  error in running command

And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.

I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.

The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.

Anyone has a less radical recommendation?

Thank you,

Gon?alo
	[[alternative HTML version deleted]]


From roy@mende|@@ohn @end|ng |rom no@@@gov  Sun Nov  8 21:25:23 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Sun, 8 Nov 2020 12:25:23 -0800
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
Message-ID: <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>

Hi:

While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.

HTH,

-Roy

> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> Hi, 
> 
> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
> 
> Warning messages:
> 1: In readLines(file, warn = TRUE) :
>  incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>  system call failed: Result too large
> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>  error in running command
> 
> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
> 
> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
> 
> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
> 
> Anyone has a less radical recommendation?
> 
> Thank you,
> 
> Gon?alo
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From ken @end|ng |rom kjbe@th@com@@u  Mon Nov  9 00:04:39 2020
From: ken @end|ng |rom kjbe@th@com@@u (Ken Beath)
Date: Mon, 9 Nov 2020 10:04:39 +1100
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
Message-ID: <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>

Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.

Ken

> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> Hi:
> 
> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
> 
> HTH,
> 
> -Roy
> 
>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> 
>> Hi, 
>> 
>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>> 
>> Warning messages:
>> 1: In readLines(file, warn = TRUE) :
>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>> system call failed: Result too large
>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>> error in running command
>> 
>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>> 
>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>> 
>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>> 
>> Anyone has a less radical recommendation?
>> 
>> Thank you,
>> 
>> Gon?alo
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> 
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected" 
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From g|@pp|e @end|ng |rom m@c@com  Mon Nov  9 02:43:09 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Sun, 8 Nov 2020 22:43:09 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
Message-ID: <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>

Hi,

Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.

Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?

Thanks,

Gon?alo

> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
> 
> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
> 
> Ken
> 
>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> 
>> Hi:
>> 
>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>> 
>> HTH,
>> 
>> -Roy
>> 
>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>> 
>>> Hi, 
>>> 
>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>> 
>>> Warning messages:
>>> 1: In readLines(file, warn = TRUE) :
>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>> system call failed: Result too large
>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>> error in running command
>>> 
>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>> 
>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>> 
>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>> 
>>> Anyone has a less radical recommendation?
>>> 
>>> Thank you,
>>> 
>>> Gon?alo
>>> 	[[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> **********************
>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> **********************
>> Roy Mendelssohn
>> Supervisory Operations Research Analyst
>> NOAA/NMFS
>> Environmental Research Division
>> Southwest Fisheries Science Center
>> ***Note new street address***
>> 110 McAllister Way
>> Santa Cruz, CA 95060
>> Phone: (831)-420-3666
>> Fax: (831) 420-3980
>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>> 
>> "Old age and treachery will overcome youth and skill."
>> "From those who have been given much, much will be expected" 
>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From ken @end|ng |rom kjbe@th@com@@u  Mon Nov  9 03:24:41 2020
From: ken @end|ng |rom kjbe@th@com@@u (Ken Beath)
Date: Mon, 9 Nov 2020 13:24:41 +1100
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
Message-ID: <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>

It is actually Makevars. If it is there it will be in the .R directory of your home folder.

Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 

Ken

> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
> 
> Hi,
> 
> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
> 
> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
> 
> Thanks,
> 
> Gon?alo
> 
>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>> 
>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>> 
>> Ken
>> 
>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>> 
>>> Hi:
>>> 
>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>>> 
>>> HTH,
>>> 
>>> -Roy
>>> 
>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>> 
>>>> Hi, 
>>>> 
>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>>> 
>>>> Warning messages:
>>>> 1: In readLines(file, warn = TRUE) :
>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>> system call failed: Result too large
>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>> error in running command
>>>> 
>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>>> 
>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>>> 
>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>>> 
>>>> Anyone has a less radical recommendation?
>>>> 
>>>> Thank you,
>>>> 
>>>> Gon?alo
>>>> 	[[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> **********************
>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>> **********************
>>> Roy Mendelssohn
>>> Supervisory Operations Research Analyst
>>> NOAA/NMFS
>>> Environmental Research Division
>>> Southwest Fisheries Science Center
>>> ***Note new street address***
>>> 110 McAllister Way
>>> Santa Cruz, CA 95060
>>> Phone: (831)-420-3666
>>> Fax: (831) 420-3980
>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>> 
>>> "Old age and treachery will overcome youth and skill."
>>> "From those who have been given much, much will be expected" 
>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
> 


From g|@pp|e @end|ng |rom m@c@com  Mon Nov  9 04:57:06 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Mon, 9 Nov 2020 00:57:06 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
Message-ID: <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>

ok, found it! Makevars is where you said it would be and it contains only this line:

CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256

Does it seem to mean anything relevant?

> On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au> wrote:
> 
> It is actually Makevars. If it is there it will be in the .R directory of your home folder.
> 
> Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
> 
> Ken
> 
>> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
>> 
>> Hi,
>> 
>> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
>> 
>> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
>> 
>> Thanks,
>> 
>> Gon?alo
>> 
>>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>>> 
>>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>>> 
>>> Ken
>>> 
>>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>> 
>>>> Hi:
>>>> 
>>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>>>> 
>>>> HTH,
>>>> 
>>>> -Roy
>>>> 
>>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>> 
>>>>> Hi, 
>>>>> 
>>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>>>> 
>>>>> Warning messages:
>>>>> 1: In readLines(file, warn = TRUE) :
>>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>> system call failed: Result too large
>>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>> error in running command
>>>>> 
>>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>>>> 
>>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>>>> 
>>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>>>> 
>>>>> Anyone has a less radical recommendation?
>>>>> 
>>>>> Thank you,
>>>>> 
>>>>> Gon?alo
>>>>> 	[[alternative HTML version deleted]]
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> 
>>>> **********************
>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>> **********************
>>>> Roy Mendelssohn
>>>> Supervisory Operations Research Analyst
>>>> NOAA/NMFS
>>>> Environmental Research Division
>>>> Southwest Fisheries Science Center
>>>> ***Note new street address***
>>>> 110 McAllister Way
>>>> Santa Cruz, CA 95060
>>>> Phone: (831)-420-3666
>>>> Fax: (831) 420-3980
>>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>> 
>>>> "Old age and treachery will overcome youth and skill."
>>>> "From those who have been given much, much will be expected" 
>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>> 
> 


From ken @end|ng |rom kjbe@th@com@@u  Mon Nov  9 08:13:29 2020
From: ken @end|ng |rom kjbe@th@com@@u (Ken Beath)
Date: Mon, 9 Nov 2020 18:13:29 +1100
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
Message-ID: <801277CE-77FE-4988-8632-8F0ABB9922CB@kjbeath.com.au>

It looks like what used to be suggested for stan. Move it elsewhere and then see what happens.

Ken

> On 9 Nov 2020, at 2:57 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
> 
> ok, found it! Makevars is where you said it would be and it contains only this line:
> 
> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
> 
> Does it seem to mean anything relevant?
> 
>> On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>> 
>> It is actually Makevars. If it is there it will be in the .R directory of your home folder.
>> 
>> Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
>> 
>> Ken
>> 
>>> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
>>> 
>>> Hi,
>>> 
>>> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
>>> 
>>> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
>>> 
>>> Thanks,
>>> 
>>> Gon?alo
>>> 
>>>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>>>> 
>>>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>>>> 
>>>> Ken
>>>> 
>>>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>> 
>>>>> Hi:
>>>>> 
>>>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>>>>> 
>>>>> HTH,
>>>>> 
>>>>> -Roy
>>>>> 
>>>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>> 
>>>>>> Hi, 
>>>>>> 
>>>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>>>>> 
>>>>>> Warning messages:
>>>>>> 1: In readLines(file, warn = TRUE) :
>>>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>> system call failed: Result too large
>>>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>> error in running command
>>>>>> 
>>>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>>>>> 
>>>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>>>>> 
>>>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>>>>> 
>>>>>> Anyone has a less radical recommendation?
>>>>>> 
>>>>>> Thank you,
>>>>>> 
>>>>>> Gon?alo
>>>>>> 	[[alternative HTML version deleted]]
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-SIG-Mac mailing list
>>>>>> R-SIG-Mac at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>> 
>>>>> **********************
>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>> **********************
>>>>> Roy Mendelssohn
>>>>> Supervisory Operations Research Analyst
>>>>> NOAA/NMFS
>>>>> Environmental Research Division
>>>>> Southwest Fisheries Science Center
>>>>> ***Note new street address***
>>>>> 110 McAllister Way
>>>>> Santa Cruz, CA 95060
>>>>> Phone: (831)-420-3666
>>>>> Fax: (831) 420-3980
>>>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>>> 
>>>>> "Old age and treachery will overcome youth and skill."
>>>>> "From those who have been given much, much will be expected" 
>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> 
>>> 
>> 
> 


From k@@perd@n|e|h@n@en @end|ng |rom gm@||@com  Mon Nov  9 10:01:19 2020
From: k@@perd@n|e|h@n@en @end|ng |rom gm@||@com (Kasper Daniel Hansen)
Date: Mon, 9 Nov 2020 10:01:19 +0100
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
Message-ID: <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>

This line will essentially overwrite what RStan does for compilation. So
yes, this is potentially a bad thing.

On Mon, Nov 9, 2020 at 4:57 AM Goncalo Ferraz via R-SIG-Mac <
r-sig-mac at r-project.org> wrote:

> ok, found it! Makevars is where you said it would be and it contains only
> this line:
>
> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
>
> Does it seem to mean anything relevant?
>
> > On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au> wrote:
> >
> > It is actually Makevars. If it is there it will be in the .R directory
> of your home folder.
> >
> > Unless it has been set up for something else, like Rcpp, then it can
> probably be deleted.
> >
> > Ken
> >
> >> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
> >>
> >> Hi,
> >>
> >> Yes, at some point there was a problem with schools.stan, it needed an
> extra (empty) line added to the end. But that didn?t solve the problem. I
> tried at least three different tests, with different models, and the same
> thing happens.
> >>
> >> Tried to get rid of .MakeVars and as I remember it didn?t change
> anything. I wanted to try it again now, but I am not finding a .MakeVars
> file anywhere on my computer. Where should it be?
> >>
> >> Thanks,
> >>
> >> Gon?alo
> >>
> >>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
> >>>
> >>> Guessing here. Possibly schools.stan has a problem, that is what teh
> first error is suggesting. The remaining is a possible problem with
> .MakeVars which is no longer needed with R. I would also check that files
> aren?t being saved with a strange encoding.
> >>>
> >>> Ken
> >>>
> >>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via
> R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> >>>>
> >>>> Hi:
> >>>>
> >>>> While it is possible you will get the help you seek here,  I think
> you would likely to get more help,  and more knowledgeable help, on this
> more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.
> I remember seeing in the summaries I get some issues with different
> combinations of versions of R,  Stan and compilers.
> >>>>
> >>>> HTH,
> >>>>
> >>>> -Roy
> >>>>
> >>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <
> r-sig-mac at r-project.org> wrote:
> >>>>>
> >>>>> Hi,
> >>>>>
> >>>>> I?ve been struggling with an rstan problem for weeks. I installed R
> stan following instructions in
> https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan
> <
> https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan>
> to the letter, but when I try to compile any model R leaves me hanging
> indefinitely (I?ve waited up to 30 minutes with ridiculously short models).
> When I press esc R says:
> >>>>>
> >>>>> Warning messages:
> >>>>> 1: In readLines(file, warn = TRUE) :
> >>>>> incomplete final line found on
> '/Users/gferraz/Documents/MAF/R/schools.stan'
> >>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr =
> TRUE) :
> >>>>> system call failed: Result too large
> >>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr =
> TRUE) :
> >>>>> error in running command
> >>>>>
> >>>>> And then, R won?t quit. I can only close it by force quitting the
> software itself and some R process that is set in motion and appears in the
> Activity Monitor.
> >>>>>
> >>>>> I have tried everything that was suggested in the stan forum,
> including deleting all the contents of /usr/local, removing xcode, R and
> re-installing everything again.
> >>>>>
> >>>>> The only thing that I can think of now is to do a clean install of
> Mac OS on my machine and really start from scratch.
> >>>>>
> >>>>> Anyone has a less radical recommendation?
> >>>>>
> >>>>> Thank you,
> >>>>>
> >>>>> Gon?alo
> >>>>>   [[alternative HTML version deleted]]
> >>>>>
> >>>>> _______________________________________________
> >>>>> R-SIG-Mac mailing list
> >>>>> R-SIG-Mac at r-project.org
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >>>>
> >>>> **********************
> >>>> "The contents of this message do not reflect any position of the U.S.
> Government or NOAA."
> >>>> **********************
> >>>> Roy Mendelssohn
> >>>> Supervisory Operations Research Analyst
> >>>> NOAA/NMFS
> >>>> Environmental Research Division
> >>>> Southwest Fisheries Science Center
> >>>> ***Note new street address***
> >>>> 110 McAllister Way
> >>>> Santa Cruz, CA 95060
> >>>> Phone: (831)-420-3666
> >>>> Fax: (831) 420-3980
> >>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
> >>>>
> >>>> "Old age and treachery will overcome youth and skill."
> >>>> "From those who have been given much, much will be expected"
> >>>> "the arc of the moral universe is long, but it bends toward justice"
> -MLK Jr.
> >>>>
> >>>> _______________________________________________
> >>>> R-SIG-Mac mailing list
> >>>> R-SIG-Mac at r-project.org
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >>>
> >>
> >
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Best,
Kasper

	[[alternative HTML version deleted]]


From g|@pp|e @end|ng |rom m@c@com  Mon Nov  9 11:30:22 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Mon, 9 Nov 2020 07:30:22 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
Message-ID: <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>

Interesting. Thanks! Is it best to delete the line and keep an empty file, or should I just get rid of the file altogether?


> On Nov 9, 2020, at 6:01 AM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:
> 
> This line will essentially overwrite what RStan does for compilation. So yes, this is potentially a bad thing.
> 
> On Mon, Nov 9, 2020 at 4:57 AM Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
> ok, found it! Makevars is where you said it would be and it contains only this line:
> 
> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
> 
> Does it seem to mean anything relevant?
> 
> > On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au <mailto:ken at kjbeath.com.au>> wrote:
> > 
> > It is actually Makevars. If it is there it will be in the .R directory of your home folder.
> > 
> > Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
> > 
> > Ken
> > 
> >> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com <mailto:gfapple at mac.com>> wrote:
> >> 
> >> Hi,
> >> 
> >> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
> >> 
> >> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
> >> 
> >> Thanks,
> >> 
> >> Gon?alo
> >> 
> >>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au <mailto:ken at kjbeath.com.au>> wrote:
> >>> 
> >>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
> >>> 
> >>> Ken
> >>> 
> >>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
> >>>> 
> >>>> Hi:
> >>>> 
> >>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org <https://discourse.mc-stan.org/>.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
> >>>> 
> >>>> HTH,
> >>>> 
> >>>> -Roy
> >>>> 
> >>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
> >>>>> 
> >>>>> Hi, 
> >>>>> 
> >>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan>> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
> >>>>> 
> >>>>> Warning messages:
> >>>>> 1: In readLines(file, warn = TRUE) :
> >>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
> >>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
> >>>>> system call failed: Result too large
> >>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
> >>>>> error in running command
> >>>>> 
> >>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
> >>>>> 
> >>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
> >>>>> 
> >>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
> >>>>> 
> >>>>> Anyone has a less radical recommendation?
> >>>>> 
> >>>>> Thank you,
> >>>>> 
> >>>>> Gon?alo
> >>>>>   [[alternative HTML version deleted]]
> >>>>> 
> >>>>> _______________________________________________
> >>>>> R-SIG-Mac mailing list
> >>>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>
> >>>> 
> >>>> **********************
> >>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> >>>> **********************
> >>>> Roy Mendelssohn
> >>>> Supervisory Operations Research Analyst
> >>>> NOAA/NMFS
> >>>> Environmental Research Division
> >>>> Southwest Fisheries Science Center
> >>>> ***Note new street address***
> >>>> 110 McAllister Way
> >>>> Santa Cruz, CA 95060
> >>>> Phone: (831)-420-3666
> >>>> Fax: (831) 420-3980
> >>>> e-mail: Roy.Mendelssohn at noaa.gov <mailto:Roy.Mendelssohn at noaa.gov> www: https://www.pfeg.noaa.gov/ <https://www.pfeg.noaa.gov/>
> >>>> 
> >>>> "Old age and treachery will overcome youth and skill."
> >>>> "From those who have been given much, much will be expected" 
> >>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
> >>>> 
> >>>> _______________________________________________
> >>>> R-SIG-Mac mailing list
> >>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>
> >>> 
> >> 
> > 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>
> 
> 
> -- 
> Best,
> Kasper


	[[alternative HTML version deleted]]


From g|@pp|e @end|ng |rom m@c@com  Mon Nov  9 11:50:14 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Mon, 9 Nov 2020 07:50:14 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
 <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
Message-ID: <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>

deleting Makevars didn?t work. The command:

example(stan_model, package = ?rstan?, run.dontrun = TRUE)

left me hanging with this output:

stn_md> stancode <- ?data {real y_mean;} parameters {real y;} model {y ~ normal(y_mean,1);}?

stn_md> mod <- stan_model(model_code = stancode, verbose = TRUE)

TRANSLATING MODEL ?16a540c6086086816528e4524def24d9? FROM Stan CODE TO C++ CODE NOW.
successful in parsing the Stan model ?16a540c6086086816528e4524def24d9?.
indent preformatted text by 4 spaces

That?s what?s been happening with any attempt to compile.

 

> On Nov 9, 2020, at 7:30 AM, Goncalo Ferraz <gfapple at mac.com> wrote:
> 
> Interesting. Thanks! Is it best to delete the line and keep an empty file, or should I just get rid of the file altogether?
> 
> 
>> On Nov 9, 2020, at 6:01 AM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:
>> 
>> This line will essentially overwrite what RStan does for compilation. So yes, this is potentially a bad thing.
>> 
>> On Mon, Nov 9, 2020 at 4:57 AM Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> ok, found it! Makevars is where you said it would be and it contains only this line:
>> 
>> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
>> 
>> Does it seem to mean anything relevant?
>> 
>> > On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>> > 
>> > It is actually Makevars. If it is there it will be in the .R directory of your home folder.
>> > 
>> > Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
>> > 
>> > Ken
>> > 
>> >> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
>> >> 
>> >> Hi,
>> >> 
>> >> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
>> >> 
>> >> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
>> >> 
>> >> Thanks,
>> >> 
>> >> Gon?alo
>> >> 
>> >>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>> >>> 
>> >>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>> >>> 
>> >>> Ken
>> >>> 
>> >>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> >>>> 
>> >>>> Hi:
>> >>>> 
>> >>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>> >>>> 
>> >>>> HTH,
>> >>>> 
>> >>>> -Roy
>> >>>> 
>> >>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> >>>>> 
>> >>>>> Hi, 
>> >>>>> 
>> >>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>> >>>>> 
>> >>>>> Warning messages:
>> >>>>> 1: In readLines(file, warn = TRUE) :
>> >>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>> >>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>> >>>>> system call failed: Result too large
>> >>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>> >>>>> error in running command
>> >>>>> 
>> >>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>> >>>>> 
>> >>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>> >>>>> 
>> >>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>> >>>>> 
>> >>>>> Anyone has a less radical recommendation?
>> >>>>> 
>> >>>>> Thank you,
>> >>>>> 
>> >>>>> Gon?alo
>> >>>>>   [[alternative HTML version deleted]]
>> >>>>> 
>> >>>>> _______________________________________________
>> >>>>> R-SIG-Mac mailing list
>> >>>>> R-SIG-Mac at r-project.org
>> >>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> >>>> 
>> >>>> **********************
>> >>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>> >>>> **********************
>> >>>> Roy Mendelssohn
>> >>>> Supervisory Operations Research Analyst
>> >>>> NOAA/NMFS
>> >>>> Environmental Research Division
>> >>>> Southwest Fisheries Science Center
>> >>>> ***Note new street address***
>> >>>> 110 McAllister Way
>> >>>> Santa Cruz, CA 95060
>> >>>> Phone: (831)-420-3666
>> >>>> Fax: (831) 420-3980
>> >>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>> >>>> 
>> >>>> "Old age and treachery will overcome youth and skill."
>> >>>> "From those who have been given much, much will be expected" 
>> >>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>> >>>> 
>> >>>> _______________________________________________
>> >>>> R-SIG-Mac mailing list
>> >>>> R-SIG-Mac at r-project.org
>> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> >>> 
>> >> 
>> > 
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> 
>> -- 
>> Best,
>> Kasper
> 


From goedm@n @end|ng |rom |c|oud@com  Mon Nov  9 21:00:45 2020
From: goedm@n @end|ng |rom |c|oud@com (Robert Goedman)
Date: Mon, 9 Nov 2020 15:00:45 -0500
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
 <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
 <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>
Message-ID: <3DA9D7D0-8983-4BE0-9AE9-A36CDEF640E2@icloud.com>

Hi,

Not sure if this helps and/or is even related but since about 2 months I have not been able to get rstan to work inside the R-GUI. Like you describe, it hangs and never returns. I don?t use rstan directly but use ulam() in the `rethinking` package to very occasionally check the Stan language program generated by ulam() after running it.

After struggling for a few weeks I decided to try it in vanilla R and found below test script no longer hangs.

Again, not sure this is of any help, but just wanted to chime in.

Rob J Goedman
goedman at icloud.com

```
library(rethinking)
d <- sim_happiness( seed=1977 , N_years=1000 )
precis(d)

## R code 6.22
d2 <- d[ d$age>17 , ] # only adults
d2$A <- ( d2$age - 18 ) / ( 65 - 18 )

## R code 6.23
d2$mid <- d2$married + 1
m6.9 <- quap(
    alist(
        happiness ~ dnorm( mu , sigma ),
        mu <- a[mid] + bA*A,
        a[mid] ~ dnorm( 0 , 1 ),
        bA ~ dnorm( 0 , 2 ),
        sigma ~ dexp(1)
    ) , data=d2 )
precis(m6.9,depth=2)

m6.9u <- ulam(
    alist(
        happiness ~ dnorm( mu , sigma ),
        mu <- a[mid] + bA*A,
        a[mid] ~ dnorm( 0 , 1 ),
        bA ~ dnorm( 0 , 2 ),
        sigma ~ dexp(1)
    ) , data=d2 )
precis(m6.9u,depth=2)
```

> On Nov 9, 2020, at 05:50, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> deleting Makevars didn?t work. The command:
> 
> example(stan_model, package = ?rstan?, run.dontrun = TRUE)
> 
> left me hanging with this output:
> 
> stn_md> stancode <- ?data {real y_mean;} parameters {real y;} model {y ~ normal(y_mean,1);}?
> 
> stn_md> mod <- stan_model(model_code = stancode, verbose = TRUE)
> 
> TRANSLATING MODEL ?16a540c6086086816528e4524def24d9? FROM Stan CODE TO C++ CODE NOW.
> successful in parsing the Stan model ?16a540c6086086816528e4524def24d9?.
> indent preformatted text by 4 spaces
> 
> That?s what?s been happening with any attempt to compile.
> 
> 
> 
>> On Nov 9, 2020, at 7:30 AM, Goncalo Ferraz <gfapple at mac.com> wrote:
>> 
>> Interesting. Thanks! Is it best to delete the line and keep an empty file, or should I just get rid of the file altogether?
>> 
>> 
>>> On Nov 9, 2020, at 6:01 AM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:
>>> 
>>> This line will essentially overwrite what RStan does for compilation. So yes, this is potentially a bad thing.
>>> 
>>> On Mon, Nov 9, 2020 at 4:57 AM Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>> ok, found it! Makevars is where you said it would be and it contains only this line:
>>> 
>>> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
>>> 
>>> Does it seem to mean anything relevant?
>>> 
>>>> On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>>>> 
>>>> It is actually Makevars. If it is there it will be in the .R directory of your home folder.
>>>> 
>>>> Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
>>>> 
>>>> Ken
>>>> 
>>>>> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com> wrote:
>>>>> 
>>>>> Hi,
>>>>> 
>>>>> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
>>>>> 
>>>>> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
>>>>> 
>>>>> Thanks,
>>>>> 
>>>>> Gon?alo
>>>>> 
>>>>>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au> wrote:
>>>>>> 
>>>>>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>>>>>> 
>>>>>> Ken
>>>>>> 
>>>>>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>> 
>>>>>>> Hi:
>>>>>>> 
>>>>>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>>>>>>> 
>>>>>>> HTH,
>>>>>>> 
>>>>>>> -Roy
>>>>>>> 
>>>>>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>>> 
>>>>>>>> Hi, 
>>>>>>>> 
>>>>>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>>>>>>> 
>>>>>>>> Warning messages:
>>>>>>>> 1: In readLines(file, warn = TRUE) :
>>>>>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>>>>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>>>> system call failed: Result too large
>>>>>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>>>> error in running command
>>>>>>>> 
>>>>>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>>>>>>> 
>>>>>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>>>>>>> 
>>>>>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>>>>>>> 
>>>>>>>> Anyone has a less radical recommendation?
>>>>>>>> 
>>>>>>>> Thank you,
>>>>>>>> 
>>>>>>>> Gon?alo
>>>>>>>>  [[alternative HTML version deleted]]
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Mac mailing list
>>>>>>>> R-SIG-Mac at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>>> 
>>>>>>> **********************
>>>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>>>> **********************
>>>>>>> Roy Mendelssohn
>>>>>>> Supervisory Operations Research Analyst
>>>>>>> NOAA/NMFS
>>>>>>> Environmental Research Division
>>>>>>> Southwest Fisheries Science Center
>>>>>>> ***Note new street address***
>>>>>>> 110 McAllister Way
>>>>>>> Santa Cruz, CA 95060
>>>>>>> Phone: (831)-420-3666
>>>>>>> Fax: (831) 420-3980
>>>>>>> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>>>>>>> 
>>>>>>> "Old age and treachery will overcome youth and skill."
>>>>>>> "From those who have been given much, much will be expected" 
>>>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Mac mailing list
>>>>>>> R-SIG-Mac at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>> 
>>>>> 
>>>> 
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> 
>>> -- 
>>> Best,
>>> Kasper
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


	[[alternative HTML version deleted]]


From g|@pp|e @end|ng |rom m@c@com  Mon Nov  9 21:03:53 2020
From: g|@pp|e @end|ng |rom m@c@com (Goncalo Ferraz)
Date: Mon, 9 Nov 2020 17:03:53 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <3DA9D7D0-8983-4BE0-9AE9-A36CDEF640E2@icloud.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
 <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
 <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>
 <3DA9D7D0-8983-4BE0-9AE9-A36CDEF640E2@icloud.com>
Message-ID: <78795261-2A1F-4390-9D03-D6CE414097CB@mac.com>

Hi, This is helpful information. Thank you. Meanwhile, I tried reverting to version 2.19.3 of rstan and it does not hang on me. I couldn?t yet understand what is going on with the most recent version, but at least for now I can work.

Gon?alo

> On Nov 9, 2020, at 5:00 PM, Robert Goedman <goedman at icloud.com> wrote:
> 
> Hi,
> 
> Not sure if this helps and/or is even related but since about 2 months I have not been able to get rstan to work inside the R-GUI. Like you describe, it hangs and never returns. I don?t use rstan directly but use ulam() in the `rethinking` package to very occasionally check the Stan language program generated by ulam() after running it.
> 
> After struggling for a few weeks I decided to try it in vanilla R and found below test script no longer hangs.
> 
> Again, not sure this is of any help, but just wanted to chime in.
> 
> Rob J Goedman
> goedman at icloud.com <mailto:goedman at icloud.com>
> 
> ```
> library(rethinking)
> d <- sim_happiness( seed=1977 , N_years=1000 )
> precis(d)
> 
> ## R code 6.22
> d2 <- d[ d$age>17 , ] # only adults
> d2$A <- ( d2$age - 18 ) / ( 65 - 18 )
> 
> ## R code 6.23
> d2$mid <- d2$married + 1
> m6.9 <- quap(
>     alist(
>         happiness ~ dnorm( mu , sigma ),
>         mu <- a[mid] + bA*A,
>         a[mid] ~ dnorm( 0 , 1 ),
>         bA ~ dnorm( 0 , 2 ),
>         sigma ~ dexp(1)
>     ) , data=d2 )
> precis(m6.9,depth=2)
> 
> m6.9u <- ulam(
>     alist(
>         happiness ~ dnorm( mu , sigma ),
>         mu <- a[mid] + bA*A,
>         a[mid] ~ dnorm( 0 , 1 ),
>         bA ~ dnorm( 0 , 2 ),
>         sigma ~ dexp(1)
>     ) , data=d2 )
> precis(m6.9u,depth=2)
> ```
> 
>> On Nov 9, 2020, at 05:50, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
>> 
>> deleting Makevars didn?t work. The command:
>> 
>> example(stan_model, package = ?rstan?, run.dontrun = TRUE)
>> 
>> left me hanging with this output:
>> 
>> stn_md> stancode <- ?data {real y_mean;} parameters {real y;} model {y ~ normal(y_mean,1);}?
>> 
>> stn_md> mod <- stan_model(model_code = stancode, verbose = TRUE)
>> 
>> TRANSLATING MODEL ?16a540c6086086816528e4524def24d9? FROM Stan CODE TO C++ CODE NOW.
>> successful in parsing the Stan model ?16a540c6086086816528e4524def24d9?.
>> indent preformatted text by 4 spaces
>> 
>> That?s what?s been happening with any attempt to compile.
>> 
>> 
>> 
>>> On Nov 9, 2020, at 7:30 AM, Goncalo Ferraz <gfapple at mac.com <mailto:gfapple at mac.com>> wrote:
>>> 
>>> Interesting. Thanks! Is it best to delete the line and keep an empty file, or should I just get rid of the file altogether?
>>> 
>>> 
>>>> On Nov 9, 2020, at 6:01 AM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com <mailto:kasperdanielhansen at gmail.com>> wrote:
>>>> 
>>>> This line will essentially overwrite what RStan does for compilation. So yes, this is potentially a bad thing.
>>>> 
>>>> On Mon, Nov 9, 2020 at 4:57 AM Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
>>>> ok, found it! Makevars is where you said it would be and it contains only this line:
>>>> 
>>>> CXX14FLAGS += -O3 -mtune=native -arch x86_64 -ftemplate-depth-256
>>>> 
>>>> Does it seem to mean anything relevant?
>>>> 
>>>>> On Nov 8, 2020, at 11:24 PM, Ken Beath <ken at kjbeath.com.au <mailto:ken at kjbeath.com.au>> wrote:
>>>>> 
>>>>> It is actually Makevars. If it is there it will be in the .R directory of your home folder.
>>>>> 
>>>>> Unless it has been set up for something else, like Rcpp, then it can probably be deleted. 
>>>>> 
>>>>> Ken
>>>>> 
>>>>>> On 9 Nov 2020, at 12:43 pm, Goncalo Ferraz <gfapple at mac.com <mailto:gfapple at mac.com>> wrote:
>>>>>> 
>>>>>> Hi,
>>>>>> 
>>>>>> Yes, at some point there was a problem with schools.stan, it needed an extra (empty) line added to the end. But that didn?t solve the problem. I tried at least three different tests, with different models, and the same thing happens.
>>>>>> 
>>>>>> Tried to get rid of .MakeVars and as I remember it didn?t change anything. I wanted to try it again now, but I am not finding a .MakeVars file anywhere on my computer. Where should it be?
>>>>>> 
>>>>>> Thanks,
>>>>>> 
>>>>>> Gon?alo
>>>>>> 
>>>>>>> On Nov 8, 2020, at 8:04 PM, Ken Beath <ken at kjbeath.com.au <mailto:ken at kjbeath.com.au>> wrote:
>>>>>>> 
>>>>>>> Guessing here. Possibly schools.stan has a problem, that is what teh first error is suggesting. The remaining is a possible problem with .MakeVars which is no longer needed with R. I would also check that files aren?t being saved with a strange encoding.
>>>>>>> 
>>>>>>> Ken
>>>>>>> 
>>>>>>>> On 9 Nov 2020, at 7:25 am, Roy Mendelssohn - NOAA Federal via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
>>>>>>>> 
>>>>>>>> Hi:
>>>>>>>> 
>>>>>>>> While it is possible you will get the help you seek here,  I think you would likely to get more help,  and more knowledgeable help, on this more specialized issue,  at the Stan Forum.  https://discourse.mc-stan.org <https://discourse.mc-stan.org/>.  I remember seeing in the summaries I get some issues with different combinations of versions of R,  Stan and compilers.
>>>>>>>> 
>>>>>>>> HTH,
>>>>>>>> 
>>>>>>>> -Roy
>>>>>>>> 
>>>>>>>>> On Nov 8, 2020, at 12:16 PM, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
>>>>>>>>> 
>>>>>>>>> Hi, 
>>>>>>>>> 
>>>>>>>>> I?ve been struggling with an rstan problem for weeks. I installed R stan following instructions in https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan> <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan <https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#how-to-use-rstan>> to the letter, but when I try to compile any model R leaves me hanging indefinitely (I?ve waited up to 30 minutes with ridiculously short models). When I press esc R says:
>>>>>>>>> 
>>>>>>>>> Warning messages:
>>>>>>>>> 1: In readLines(file, warn = TRUE) :
>>>>>>>>> incomplete final line found on '/Users/gferraz/Documents/MAF/R/schools.stan'
>>>>>>>>> 2: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>>>>> system call failed: Result too large
>>>>>>>>> 3: In system(paste(CXX, ARGS), ignore.stdout = TRUE, ignore.stderr = TRUE) :
>>>>>>>>> error in running command
>>>>>>>>> 
>>>>>>>>> And then, R won?t quit. I can only close it by force quitting the software itself and some R process that is set in motion and appears in the Activity Monitor.
>>>>>>>>> 
>>>>>>>>> I have tried everything that was suggested in the stan forum, including deleting all the contents of /usr/local, removing xcode, R and re-installing everything again.
>>>>>>>>> 
>>>>>>>>> The only thing that I can think of now is to do a clean install of Mac OS on my machine and really start from scratch.
>>>>>>>>> 
>>>>>>>>> Anyone has a less radical recommendation?
>>>>>>>>> 
>>>>>>>>> Thank you,
>>>>>>>>> 
>>>>>>>>> Gon?alo
>>>>>>>>>  [[alternative HTML version deleted]]
>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> R-SIG-Mac mailing list
>>>>>>>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>>>> 
>>>>>>>> **********************
>>>>>>>> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
>>>>>>>> **********************
>>>>>>>> Roy Mendelssohn
>>>>>>>> Supervisory Operations Research Analyst
>>>>>>>> NOAA/NMFS
>>>>>>>> Environmental Research Division
>>>>>>>> Southwest Fisheries Science Center
>>>>>>>> ***Note new street address***
>>>>>>>> 110 McAllister Way
>>>>>>>> Santa Cruz, CA 95060
>>>>>>>> Phone: (831)-420-3666
>>>>>>>> Fax: (831) 420-3980
>>>>>>>> e-mail: Roy.Mendelssohn at noaa.gov <mailto:Roy.Mendelssohn at noaa.gov> www: https://www.pfeg.noaa.gov/ <https://www.pfeg.noaa.gov/>
>>>>>>>> 
>>>>>>>> "Old age and treachery will overcome youth and skill."
>>>>>>>> "From those who have been given much, much will be expected" 
>>>>>>>> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Mac mailing list
>>>>>>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>>> 
>>>>>> 
>>>>> 
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> 
>>>> 
>>>> -- 
>>>> Best,
>>>> Kasper
>>> 
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


	[[alternative HTML version deleted]]


From m@ch@|oupk@ @end|ng |rom uq@edu@@u  Mon Nov  9 23:05:15 2020
From: m@ch@|oupk@ @end|ng |rom uq@edu@@u (Milani Chaloupka)
Date: Mon, 9 Nov 2020 22:05:15 +0000
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <78795261-2A1F-4390-9D03-D6CE414097CB@mac.com>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
 <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
 <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>
 <3DA9D7D0-8983-4BE0-9AE9-A36CDEF640E2@icloud.com>
 <78795261-2A1F-4390-9D03-D6CE414097CB@mac.com>
Message-ID: <860DF348-44EC-409E-964C-56B8734686B0@uq.edu.au>

Hi Goncalo

The issue, as I pointed out to you yesterday on Stan Discourse, is rstan (the interface to Stan via R).

And hence my advice to you there was to downgrade to Stan 2.19.3

It was not your Makevars file - although that was an incomplete Makevars you had if there were in fact no typos in your previous email.

As others have pointed out, a Makevars file is no longer necessary to run Stan if using MACOS X Catalina onwards.

Nor is the Renviron file.

Do not upgrade to any rstan higher than 2.19.3 until the rstan issues on various platforms are resolved.

Meanwhile, you can use, as is my preference, the CmdStan and cmdstanr interface to Stan instead of rstan, which ?

(1) samples quite a bit faster than rstan

(2) is more up-to-date with Stan although with a few less features than rstan

http://mc-stan.org/cmdstanr/articles/cmdstanr.html

And if you are using the brms interface to Stan then it also has an option in the brm() function to use cmdstanr as the backend rather than rstan.

regards

Milani

____________________________________________________

Dr Milani Chaloupka
Ecological Modelling Services P/L
PO Box 6150, University of Queensland
St Lucia, Queensland, 4067, Australia

Honorary Associate Professor
School of Biological Sciences, University of Queensland
Brisbane, Queensland, 4072, Australia

Scientific Advisory Committee (Member)
Caribbean Conservation Corporation
Gainesville, Florida, USA

Science and Statistics Committee (Member)
Western Pacific Regional Fisheries Management Council
NOAA, US Dept of Commerce, Honolulu, Hawaii, USA

m.chaloupka at uq.edu.au<mailto:m.chaloupka at uq.edu.au>
mobile: (local) 0419180554  (international) + 61 419180554
skype: milani2005
____________________________________________________


On 10 Nov 2020, at 6:03 am, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org<mailto:r-sig-mac at r-project.org>> wrote:

Hi, This is helpful information. Thank you. Meanwhile, I tried reverting to version 2.19.3 of rstan and it does not hang on me. I couldn?t yet understand what is going on with the most recent version, but at least for now I can work.

Gon?alo

On Nov 9, 2020, at 5:00 PM, Robert Goedman <goedman at icloud.com<mailto:goedman at icloud.com>> wrote:

Hi,

Not sure if this helps and/or is even related but since about 2 months I have not been able to get rstan to work inside the R-GUI. Like you describe, it hangs and never returns. I don?t use rstan directly but use ulam() in the `rethinking` package to very occasionally check the Stan language program generated by ulam() after running it.



	[[alternative HTML version deleted]]


From gonc@|o@|err@z @end|ng |rom u|rg@@br  Wed Nov 11 03:10:06 2020
From: gonc@|o@|err@z @end|ng |rom u|rg@@br (=?utf-8?Q?Gon=C3=A7alo_Ferraz?=)
Date: Tue, 10 Nov 2020 23:10:06 -0300
Subject: [R-SIG-Mac] Rstan compilation hangs misterisouly
In-Reply-To: <860DF348-44EC-409E-964C-56B8734686B0@uq.edu.au>
References: <85E3768E-9BE7-41FB-98AD-45639E4E3EE1@mac.com>
 <B398986E-B769-42EB-99DD-631B075C2A89@noaa.gov>
 <CE419C7D-1C07-4377-BF51-7E5AF70D4F57@kjbeath.com.au>
 <2B949E09-0FB0-4107-9E47-F1E140D4A9D4@mac.com>
 <CD962905-2F9B-49AD-A0F6-A091C1BAFB44@kjbeath.com.au>
 <FBFD315E-E583-4802-8D97-3AABDDB5F6BD@mac.com>
 <CAC2h7utFcptjK1Dwyuzg9MDy3yK-deDODFN6XV=y4KkPYi=Tpw@mail.gmail.com>
 <C0C8FAA3-F331-4B32-96A1-FE72ED04E9AA@mac.com>
 <1E3024AC-0C87-41C1-98E4-BC2E3567AB1A@mac.com>
 <3DA9D7D0-8983-4BE0-9AE9-A36CDEF640E2@icloud.com>
 <78795261-2A1F-4390-9D03-D6CE414097CB@mac.com>
 <860DF348-44EC-409E-964C-56B8734686B0@uq.edu.au>
Message-ID: <DBB1E2C8-2777-48B0-B570-F91BFD1C4A5E@ufrgs.br>

Hello Milani,

Thank you very much for your e-mail. I was not aware of CmdStan and cmdstanr and will look into them. Meanwhile, I will continue using rstan 2.19.3.

Regarding Makevars, I am puzzled that now I have two Makevars files, both within the folder ~/Library/Frameworks/R.framework/Versions/4.0/Resources/library 

one sits in the folder RcppArmadillo/Skeleton and contains:

## With R 3.1.0 or later, you can uncomment the following line to tell R to 
## enable compilation with C++11 (where available)
##
## Also, OpenMP support in Armadillo prefers C++11 support. However, for wider
## availability of the package we do not yet enforce this here.  It is however
## recommended for client packages to set it.
##
## And with R 3.4.0, and RcppArmadillo 0.7.960.*, we turn C++11 on as OpenMP
## support within Armadillo prefers / requires it
CXX_STD = CXX11

PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS) 
PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS) $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

the other, in folder RcppEigen/skeleton, has every line commented out:

## With Rcpp 0.11.0 and later, we no longer need to set PKG_LIBS as there is
## no user-facing library. The include path to headers is already set by R.
#PKG_LIBS =

## With R 3.1.0 or later, you can uncomment the following line to tell R to
## enable compilation with C++11 (or even C++14) where available
## CXX_STD = CXX11

The Renviron file has a lot mor information.

Since you tell me that none of these files are relevant for my problem now, I am inclined to forget abou them, but I am still curious as to what is their purpose.

Best wishes,

Gon?alo




Gon?alo Ferraz
Departamento de Ecologia, Instituto de Bioci?ncias
Universidade Federal do Rio Grande do Sul
http://ferrazlab.org/ <http://ferrazlab.org/>




> On Nov 9, 2020, at 7:05 PM, Milani Chaloupka <m.chaloupka at uq.edu.au> wrote:
> 
> Hi Goncalo
> 
> The issue, as I pointed out to you yesterday on Stan Discourse, is rstan (the interface to Stan via R).
> 
> And hence my advice to you there was to downgrade to Stan 2.19.3
> 
> It was not your Makevars file - although that was an incomplete Makevars you had if there were in fact no typos in your previous email.
> 
> As others have pointed out, a Makevars file is no longer necessary to run Stan if using MACOS X Catalina onwards. 
> 
> Nor is the Renviron file.
> 
> Do not upgrade to any rstan higher than 2.19.3 until the rstan issues on various platforms are resolved.
> 
> Meanwhile, you can use, as is my preference, the CmdStan and cmdstanr interface to Stan instead of rstan, which ?
> 
> (1) samples quite a bit faster than rstan
> 
> (2) is more up-to-date with Stan although with a few less features than rstan
> 
> http://mc-stan.org/cmdstanr/articles/cmdstanr.html <http://mc-stan.org/cmdstanr/articles/cmdstanr.html>
> 
> And if you are using the brms interface to Stan then it also has an option in the brm() function to use cmdstanr as the backend rather than rstan.
> 
> regards
> 
> Milani
> 
> ____________________________________________________
> 
> Dr Milani Chaloupka
> Ecological Modelling Services P/L
> PO Box 6150, University of Queensland
> St Lucia, Queensland, 4067, Australia
> 
> Honorary Associate Professor
> School of Biological Sciences, University of Queensland
> Brisbane, Queensland, 4072, Australia
> 
> Scientific Advisory Committee (Member)
> Caribbean Conservation Corporation
> Gainesville, Florida, USA
> 
> Science and Statistics Committee (Member)
> Western Pacific Regional Fisheries Management Council
> NOAA, US Dept of Commerce, Honolulu, Hawaii, USA
> 
> m.chaloupka at uq.edu.au <mailto:m.chaloupka at uq.edu.au>
> mobile: (local) 0419180554  (international) + 61 419180554
> skype: milani2005
> ____________________________________________________
> 
> 
>> On 10 Nov 2020, at 6:03 am, Goncalo Ferraz via R-SIG-Mac <r-sig-mac at r-project.org <mailto:r-sig-mac at r-project.org>> wrote:
>> 
>> Hi, This is helpful information. Thank you. Meanwhile, I tried reverting to version 2.19.3 of rstan and it does not hang on me. I couldn?t yet understand what is going on with the most recent version, but at least for now I can work.
>> 
>> Gon?alo
>> 
>>> On Nov 9, 2020, at 5:00 PM, Robert Goedman <goedman at icloud.com <mailto:goedman at icloud.com>> wrote:
>>> 
>>> Hi,
>>> 
>>> Not sure if this helps and/or is even related but since about 2 months I have not been able to get rstan to work inside the R-GUI. Like you describe, it hangs and never returns. I don?t use rstan directly but use ulam() in the `rethinking` package to very occasionally check the Stan language program generated by ulam() after running it.
>>> 
> 


	[[alternative HTML version deleted]]


From @mber@|w@y@r@ck@ @end|ng |rom gm@||@com  Tue Nov 17 09:37:57 2020
From: @mber@|w@y@r@ck@ @end|ng |rom gm@||@com (Steph Boss)
Date: Tue, 17 Nov 2020 03:37:57 -0500
Subject: [R-SIG-Mac] (no subject)
Message-ID: <CAAXD5JYo9824_ozwXF8R+c+bFjkBoYP+C7Z7XQHt82N_JWXAbg@mail.gmail.com>

D

	[[alternative HTML version deleted]]


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Tue Nov 17 15:57:22 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Tue, 17 Nov 2020 14:57:22 +0000
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
Message-ID: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>

Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.

For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the 
installation with

pdf("tests.pdf") ## optional, but prevents flashing graphics windows
Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
tools::testInstalledBasic("both")
tools::testInstalledPackages(scope = "base")
tools::testInstalledPackages(scope = "recommended")

That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz 
i5): happily nothing untoward was reported (some recommended packages 
give differences from reference output on both systems).

You need to install XQuartz to provide the X11() devices and support for 
package Tcl/Tk: everything I tried using that worked as expected.

Having done that post-installation check I would happily use the Intel R 
on an M1 machine.

We plan to check many of the Intel-compiled packages under Rosetta.

There are many hours of work ahead to build/test a native toolchain: our 
goal is to have a native distribution for R 4.1.0 ca April 2021.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From roy@mende|@@ohn @end|ng |rom no@@@gov  Tue Nov 17 16:15:27 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Tue, 17 Nov 2020 07:15:27 -0800
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
Message-ID: <1761C83F-53F3-4CAD-BF30-71D11070A26C@noaa.gov>

Thank to all who are working on this.  Looks like a lot of work.  Also looks like when and if R can run in native mode on the M1 it will be very fast.

-Roy


> On Nov 17, 2020, at 6:57 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
> 
> For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the installation with
> 
> pdf("tests.pdf") ## optional, but prevents flashing graphics windows
> Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
> tools::testInstalledBasic("both")
> tools::testInstalledPackages(scope = "base")
> tools::testInstalledPackages(scope = "recommended")
> 
> That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz i5): happily nothing untoward was reported (some recommended packages give differences from reference output on both systems).
> 
> You need to install XQuartz to provide the X11() devices and support for package Tcl/Tk: everything I tried using that worked as expected.
> 
> Having done that post-installation check I would happily use the Intel R on an M1 machine.
> 
> We plan to check many of the Intel-compiled packages under Rosetta.
> 
> There are many hours of work ahead to build/test a native toolchain: our goal is to have a native distribution for R 4.1.0 ca April 2021.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From c@@rd|@g@bor @end|ng |rom gm@||@com  Tue Nov 17 16:47:19 2020
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 17 Nov 2020 15:47:19 +0000
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <1761C83F-53F3-4CAD-BF30-71D11070A26C@noaa.gov>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
 <1761C83F-53F3-4CAD-BF30-71D11070A26C@noaa.gov>
Message-ID: <CABtg=K=eP1RRRzc8xofB3LcqAKeg83inDTsVipwnPYzTwAh1SQ@mail.gmail.com>

One thing that I noticed both on Silicon and the intel macs at GitHub
Actions, is that the CRAN installer does not create the symlinks in
`/usr/local/bin`. Probably some permission or entitlement issue. So
you'll probably want to create them manually. E.g. on GHA it goes like
this:
https://github.com/r-lib/ps/blob/a24f2c4d1bdba63be14e7729b9ab81d0ed9f719e/.github/workflows/R-CMD-check.yaml#L42-L45

G.

On Tue, Nov 17, 2020 at 3:15 PM Roy Mendelssohn - NOAA Federal via
R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>
> Thank to all who are working on this.  Looks like a lot of work.  Also looks like when and if R can run in native mode on the M1 it will be very fast.
>
> -Roy
>
>
> > On Nov 17, 2020, at 6:57 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> >
> > Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
> >
> > For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the installation with
> >
> > pdf("tests.pdf") ## optional, but prevents flashing graphics windows
> > Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
> > tools::testInstalledBasic("both")
> > tools::testInstalledPackages(scope = "base")
> > tools::testInstalledPackages(scope = "recommended")
> >
> > That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz i5): happily nothing untoward was reported (some recommended packages give differences from reference output on both systems).
> >
> > You need to install XQuartz to provide the X11() devices and support for package Tcl/Tk: everything I tried using that worked as expected.
> >
> > Having done that post-installation check I would happily use the Intel R on an M1 machine.
> >
> > We plan to check many of the Intel-compiled packages under Rosetta.
> >
> > There are many hours of work ahead to build/test a native toolchain: our goal is to have a native distribution for R 4.1.0 ca April 2021.
> >
> > --
> > Brian D. Ripley,                  ripley at stats.ox.ac.uk
> > Emeritus Professor of Applied Statistics, University of Oxford
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> **********************
> "The contents of this message do not reflect any position of the U.S. Government or NOAA."
> **********************
> Roy Mendelssohn
> Supervisory Operations Research Analyst
> NOAA/NMFS
> Environmental Research Division
> Southwest Fisheries Science Center
> ***Note new street address***
> 110 McAllister Way
> Santa Cruz, CA 95060
> Phone: (831)-420-3666
> Fax: (831) 420-3980
> e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/
>
> "Old age and treachery will overcome youth and skill."
> "From those who have been given much, much will be expected"
> "the arc of the moral universe is long, but it bends toward justice" -MLK Jr.
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From m@rc_@chw@rtz @end|ng |rom me@com  Tue Nov 17 16:50:35 2020
From: m@rc_@chw@rtz @end|ng |rom me@com (Marc Schwartz)
Date: Tue, 17 Nov 2020 10:50:35 -0500
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
Message-ID: <7140C55B-CC8C-488C-B68E-F38514B099EE@me.com>

Prof. Ripley,

Thanks for these updates and for the efforts by all involved in this process.

I am holding off on moving to the M1 based Macs until next year, as besides waiting for a larger display variant, as I am also waiting on updates to other applications that will support that hardware in time.

You reference XQuartz below, and unless I am mis-reading the tea leaves, there seems to be an indication in their list archives that there is no plan to update their binary release to support the new hardware. That release has not been updated since 2016.

They seem to be suggesting a dependence upon MacPorts moving forward, possibly HomeBrew, for installing a native XQuartz on the new hardware. Either scenario introduces other issues idiosyncratic to those environments.

Not sure if that influences any decisions here, and presume that you may already be aware of those dynamics.

Regards,

Marc Schwartz


> On Nov 17, 2020, at 9:57 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
> 
> For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the installation with
> 
> pdf("tests.pdf") ## optional, but prevents flashing graphics windows
> Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
> tools::testInstalledBasic("both")
> tools::testInstalledPackages(scope = "base")
> tools::testInstalledPackages(scope = "recommended")
> 
> That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz i5): happily nothing untoward was reported (some recommended packages give differences from reference output on both systems).
> 
> You need to install XQuartz to provide the X11() devices and support for package Tcl/Tk: everything I tried using that worked as expected.
> 
> Having done that post-installation check I would happily use the Intel R on an M1 machine.
> 
> We plan to check many of the Intel-compiled packages under Rosetta.
> 
> There are many hours of work ahead to build/test a native toolchain: our goal is to have a native distribution for R 4.1.0 ca April 2021.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford


From t@r@@@z@kh@rko @end|ng |rom uzh@ch  Wed Nov 18 10:33:26 2020
From: t@r@@@z@kh@rko @end|ng |rom uzh@ch (Taras Zakharko)
Date: Wed, 18 Nov 2020 10:33:26 +0100
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
Message-ID: <D4AE4FE5-9436-48BC-9230-F6E5CAFD3521@uzh.ch>

Thank you for this update! I think that Apple Silicon has great potential for data science, the SPEC benchmarks reported by Anandtech look very encouraging. 

My M1 Mac should be arriving shortly, is there some way one could help out with the effort? 

? Taras

> On 17 Nov 2020, at 15:57, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
> 
> For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the installation with
> 
> pdf("tests.pdf") ## optional, but prevents flashing graphics windows
> Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
> tools::testInstalledBasic("both")
> tools::testInstalledPackages(scope = "base")
> tools::testInstalledPackages(scope = "recommended")
> 
> That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz i5): happily nothing untoward was reported (some recommended packages give differences from reference output on both systems).
> 
> You need to install XQuartz to provide the X11() devices and support for package Tcl/Tk: everything I tried using that worked as expected.
> 
> Having done that post-installation check I would happily use the Intel R on an M1 machine.
> 
> We plan to check many of the Intel-compiled packages under Rosetta.
> 
> There are many hours of work ahead to build/test a native toolchain: our goal is to have a native distribution for R 4.1.0 ca April 2021.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From gc@m@r@ @end|ng |rom geo@ec@org  Thu Nov 19 12:22:46 2020
From: gc@m@r@ @end|ng |rom geo@ec@org (GilbertoCamara)
Date: Thu, 19 Nov 2020 12:22:46 +0100
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
Message-ID: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>

Dear all, 

Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.

I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:

1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".

2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.

3. Install "wget" using brew:

"brew install wget".

4. Download the libraries below from their sources:

(a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
(b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
(c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
(d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
(e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
(f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"

5. In the order given above, unpack each library and then execute the following commands:
% ./configure
% make
% sudo make install

6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:

> install.packages("rgdal", type = "source?)
> install.packages("sf", type = "source")
	
7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.

Hope this helps Mac users.

Best 
Gilberto
	[[alternative HTML version deleted]]


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Nov 19 14:43:48 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 19 Nov 2020 13:43:48 +0000
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
Message-ID: <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>

On 19/11/2020 11:22, GilbertoCamara wrote:
> Dear all,
> 
> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.

What problems are those?  You report nothing, and make reference to no 
reports here nor on R-sig-geo.

I tried the binary package of sf on my Intel 'Big Sur' machine and got

 > library(sf)
Error: package or namespace load failed for ?sf? in dyn.load(file, 
DLLpath = DLLpath, ...):
  unable to load shared object '/Users/ripley/R/Library/sf/libs/sf.so':
   dlopen(/Users/ripley/R/Library/sf/libs/sf.so, 6): Library not loaded: 
/usr/lib/libpq.5.dylib
   Referenced from: /Users/ripley/R/Library/sf/libs/sf.so
   Reason: image not found

so it seem Apple has removed the PostgreSQL library.

> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
> 
> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
> 
> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
> 
> 3. Install "wget" using brew:
> 
> "brew install wget".
> 
> 4. Download the libraries below from their sources:
> 
> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"

At the bottom of https://mac.r-project.org/libs-4/ you will see a 
reference to 'recipes': you could simply have followed those to rebuild 
for macOS 11, probably only gdal.  You probably want to ensure that the 
libpq that libgdal links against is the one in the libpq recipe (or 
build without PostgreSQL support).  Please ask Simon to rebuild his gdal 
accordingly.

> 5. In the order given above, unpack each library and then execute the following commands:
> % ./configure
> % make
> % sudo make install
> 
> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
> 
>> install.packages("rgdal", type = "source?)
>> install.packages("sf", type = "source")
> 	
> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
> 
> Hope this helps Mac users.
> 
> Best
> Gilberto
> 	[[alternative HTML version deleted]]

Please don't send HTML.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From gc@m@r@ @end|ng |rom geo@ec@org  Thu Nov 19 14:46:25 2020
From: gc@m@r@ @end|ng |rom geo@ec@org (Gilberto Camara)
Date: Thu, 19 Nov 2020 14:46:25 +0100
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>
Message-ID: <CB923EBB-0540-4337-9B54-F332D08323AA@geosec.org>

Dear Prof Ripley

There have been reports as follows:

https://community.rstudio.com/t/rgdal-library-not-loading/88025 <https://community.rstudio.com/t/rgdal-library-not-loading/88025>

https://github.com/r-spatial/sf/issues/1542 <https://github.com/r-spatial/sf/issues/1542>

Best
Gilberto
===========================
Prof Dr Gilberto Camara
Secretariat Director
GEO - Group on Earth Observations
7 bis, Avenue de La Paix
CH-1211 Geneva - Switzerland
Tel: +41227308480
Web: www.earthobservations.org


> On 19 Nov 2020, at 14:43, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> On 19/11/2020 11:22, GilbertoCamara wrote:
>> Dear all,
>> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.
> 
> What problems are those?  You report nothing, and make reference to no reports here nor on R-sig-geo.
> 
> I tried the binary package of sf on my Intel 'Big Sur' machine and got
> 
> > library(sf)
> Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath = DLLpath, ...):
> unable to load shared object '/Users/ripley/R/Library/sf/libs/sf.so':
>  dlopen(/Users/ripley/R/Library/sf/libs/sf.so, 6): Library not loaded: /usr/lib/libpq.5.dylib
>  Referenced from: /Users/ripley/R/Library/sf/libs/sf.so
>  Reason: image not found
> 
> so it seem Apple has removed the PostgreSQL library.
> 
>> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
>> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
>> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
>> 3. Install "wget" using brew:
>> "brew install wget".
>> 4. Download the libraries below from their sources:
>> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
>> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
>> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
>> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
>> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
>> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"
> 
> At the bottom of https://mac.r-project.org/libs-4/ <https://mac.r-project.org/libs-4/> you will see a reference to 'recipes': you could simply have followed those to rebuild for macOS 11, probably only gdal.  You probably want to ensure that the libpq that libgdal links against is the one in the libpq recipe (or build without PostgreSQL support).  Please ask Simon to rebuild his gdal accordingly.
> 
>> 5. In the order given above, unpack each library and then execute the following commands:
>> % ./configure
>> % make
>> % sudo make install
>> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
>>> install.packages("rgdal", type = "source?)
>>> install.packages("sf", type = "source")
>> 	
>> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
>> Hope this helps Mac users.
>> Best
>> Gilberto
>> 	[[alternative HTML version deleted]]
> 
> Please don't send HTML.
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>
> Emeritus Professor of Applied Statistics, University of Oxford


	[[alternative HTML version deleted]]


From b@|@mut2 @end|ng |rom ||||no|@@edu  Thu Nov 19 15:34:25 2020
From: b@|@mut2 @end|ng |rom ||||no|@@edu (Balamuta, James Joseph)
Date: Thu, 19 Nov 2020 14:34:25 +0000
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <CB923EBB-0540-4337-9B54-F332D08323AA@geosec.org>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>
 <CB923EBB-0540-4337-9B54-F332D08323AA@geosec.org>
Message-ID: <DCAF9BDB-2DAB-4F1E-9BAF-94568A010327@illinois.edu>

Prof. Ripley,

Hope all is well. 

The issue was raised by Jeroen on GitHub on Oct 30th regarding libpq.5.dylib being missing:

https://github.com/R-macos/recipes/issues/14 

To date, Simon hasn't responded to it. Not sure re-building with the recipe as-is will yield the correct outcome as the pgsql is at: /usr/local/pgsql/lib instead of /usr/local/{include,lib}.

Best,

JJB

?On 11/19/20, 7:46 AM, "R-SIG-Mac on behalf of Gilberto Camara" <r-sig-mac-bounces at r-project.org on behalf of gcamara at geosec.org> wrote:

    Dear Prof Ripley

    There have been reports as follows:

    https://community.rstudio.com/t/rgdal-library-not-loading/88025 <https://community.rstudio.com/t/rgdal-library-not-loading/88025>

    https://github.com/r-spatial/sf/issues/1542 <https://github.com/r-spatial/sf/issues/1542>

    Best
    Gilberto
    ===========================
    Prof Dr Gilberto Camara
    Secretariat Director
    GEO - Group on Earth Observations
    7 bis, Avenue de La Paix
    CH-1211 Geneva - Switzerland
    Tel: +41227308480
    Web: www.earthobservations.org


    > On 19 Nov 2020, at 14:43, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
    > 
    > On 19/11/2020 11:22, GilbertoCamara wrote:
    >> Dear all,
    >> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.
    > 
    > What problems are those?  You report nothing, and make reference to no reports here nor on R-sig-geo.
    > 
    > I tried the binary package of sf on my Intel 'Big Sur' machine and got
    > 
    > > library(sf)
    > Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath = DLLpath, ...):
    > unable to load shared object '/Users/ripley/R/Library/sf/libs/sf.so':
    >  dlopen(/Users/ripley/R/Library/sf/libs/sf.so, 6): Library not loaded: /usr/lib/libpq.5.dylib
    >  Referenced from: /Users/ripley/R/Library/sf/libs/sf.so
    >  Reason: image not found
    > 
    > so it seem Apple has removed the PostgreSQL library.
    > 
    >> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
    >> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
    >> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
    >> 3. Install "wget" using brew:
    >> "brew install wget".
    >> 4. Download the libraries below from their sources:
    >> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
    >> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
    >> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
    >> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
    >> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
    >> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"
    > 
    > At the bottom of https://mac.r-project.org/libs-4/ <https://mac.r-project.org/libs-4/> you will see a reference to 'recipes': you could simply have followed those to rebuild for macOS 11, probably only gdal.  You probably want to ensure that the libpq that libgdal links against is the one in the libpq recipe (or build without PostgreSQL support).  Please ask Simon to rebuild his gdal accordingly.
    > 
    >> 5. In the order given above, unpack each library and then execute the following commands:
    >> % ./configure
    >> % make
    >> % sudo make install
    >> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
    >>> install.packages("rgdal", type = "source?)
    >>> install.packages("sf", type = "source")
    >> 	
    >> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
    >> Hope this helps Mac users.
    >> Best
    >> Gilberto
    >> 	[[alternative HTML version deleted]]
    > 
    > Please don't send HTML.
    > 
    > -- 
    > Brian D. Ripley,                  ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>
    > Emeritus Professor of Applied Statistics, University of Oxford


    	[[alternative HTML version deleted]]

    _______________________________________________
    R-SIG-Mac mailing list
    R-SIG-Mac at r-project.org
    https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Nov 19 21:06:34 2020
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 20 Nov 2020 09:06:34 +1300
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
Message-ID: <F410C1DA-A490-4395-A481-FF7466961250@R-project.org>

Just for posterity, please do NOT follow those instructions unless you really want to build packages from sources and maintain them. Building GDAL can be tricky since the feature set depends on the libraries you have available, so use at your own risk.

CRAN libraries have been updated to be compatible with Big Sur which removed some system libraries, so just re-install rgdal and sf from CRAN (thanks to Jeroen). To make sure you get the latest versions use
install.packages(c("rgdal","sf"),,"https://mac.R-project.org")

Cheers,
Simon


> On Nov 20, 2020, at 12:22 AM, GilbertoCamara <gcamara at geosec.org> wrote:
> 
> Dear all, 
> 
> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.
> 
> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
> 
> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
> 
> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
> 
> 3. Install "wget" using brew:
> 
> "brew install wget".
> 
> 4. Download the libraries below from their sources:
> 
> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"
> 
> 5. In the order given above, unpack each library and then execute the following commands:
> % ./configure
> % make
> % sudo make install
> 
> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
> 
>> install.packages("rgdal", type = "source?)
>> install.packages("sf", type = "source")
> 	
> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
> 
> Hope this helps Mac users.
> 
> Best 
> Gilberto
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Nov 19 21:14:28 2020
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 20 Nov 2020 09:14:28 +1300
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <DCAF9BDB-2DAB-4F1E-9BAF-94568A010327@illinois.edu>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>
 <CB923EBB-0540-4337-9B54-F332D08323AA@geosec.org>
 <DCAF9BDB-2DAB-4F1E-9BAF-94568A010327@illinois.edu>
Message-ID: <5AB46E01-AD6B-4630-B945-36471107AE7B@R-project.org>

JJB,

FWIW if you have an issue that is related to macOS R please report it here. GH is fine for PRs, but I am only batch-processing GH notifications once in a while (with close to 100 repos it's not possible to do it continuously), so I only act on things flagged here as important.

Cheers,
Simon



> On Nov 20, 2020, at 3:34 AM, Balamuta, James Joseph <balamut2 at illinois.edu> wrote:
> 
> Prof. Ripley,
> 
> Hope all is well. 
> 
> The issue was raised by Jeroen on GitHub on Oct 30th regarding libpq.5.dylib being missing:
> 
> https://github.com/R-macos/recipes/issues/14 
> 
> To date, Simon hasn't responded to it. Not sure re-building with the recipe as-is will yield the correct outcome as the pgsql is at: /usr/local/pgsql/lib instead of /usr/local/{include,lib}.
> 
> Best,
> 
> JJB
> 
> ?On 11/19/20, 7:46 AM, "R-SIG-Mac on behalf of Gilberto Camara" <r-sig-mac-bounces at r-project.org on behalf of gcamara at geosec.org> wrote:
> 
>    Dear Prof Ripley
> 
>    There have been reports as follows:
> 
>    https://community.rstudio.com/t/rgdal-library-not-loading/88025 <https://community.rstudio.com/t/rgdal-library-not-loading/88025>
> 
>    https://github.com/r-spatial/sf/issues/1542 <https://github.com/r-spatial/sf/issues/1542>
> 
>    Best
>    Gilberto
>    ===========================
>    Prof Dr Gilberto Camara
>    Secretariat Director
>    GEO - Group on Earth Observations
>    7 bis, Avenue de La Paix
>    CH-1211 Geneva - Switzerland
>    Tel: +41227308480
>    Web: www.earthobservations.org
> 
> 
>> On 19 Nov 2020, at 14:43, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>> 
>> On 19/11/2020 11:22, GilbertoCamara wrote:
>>> Dear all,
>>> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.
>> 
>> What problems are those?  You report nothing, and make reference to no reports here nor on R-sig-geo.
>> 
>> I tried the binary package of sf on my Intel 'Big Sur' machine and got
>> 
>>> library(sf)
>> Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath = DLLpath, ...):
>> unable to load shared object '/Users/ripley/R/Library/sf/libs/sf.so':
>> dlopen(/Users/ripley/R/Library/sf/libs/sf.so, 6): Library not loaded: /usr/lib/libpq.5.dylib
>> Referenced from: /Users/ripley/R/Library/sf/libs/sf.so
>> Reason: image not found
>> 
>> so it seem Apple has removed the PostgreSQL library.
>> 
>>> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
>>> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
>>> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
>>> 3. Install "wget" using brew:
>>> "brew install wget".
>>> 4. Download the libraries below from their sources:
>>> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
>>> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
>>> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
>>> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
>>> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
>>> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"
>> 
>> At the bottom of https://mac.r-project.org/libs-4/ <https://mac.r-project.org/libs-4/> you will see a reference to 'recipes': you could simply have followed those to rebuild for macOS 11, probably only gdal.  You probably want to ensure that the libpq that libgdal links against is the one in the libpq recipe (or build without PostgreSQL support).  Please ask Simon to rebuild his gdal accordingly.
>> 
>>> 5. In the order given above, unpack each library and then execute the following commands:
>>> % ./configure
>>> % make
>>> % sudo make install
>>> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
>>>> install.packages("rgdal", type = "source?)
>>>> install.packages("sf", type = "source")
>>> 	
>>> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
>>> Hope this helps Mac users.
>>> Best
>>> Gilberto
>>> 	[[alternative HTML version deleted]]
>> 
>> Please don't send HTML.
>> 
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>
>> Emeritus Professor of Applied Statistics, University of Oxford
> 
> 
>    	[[alternative HTML version deleted]]
> 
>    _______________________________________________
>    R-SIG-Mac mailing list
>    R-SIG-Mac at r-project.org
>    https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From b@|@mut2 @end|ng |rom ||||no|@@edu  Thu Nov 19 23:11:13 2020
From: b@|@mut2 @end|ng |rom ||||no|@@edu (Balamuta, James Joseph)
Date: Thu, 19 Nov 2020 22:11:13 +0000
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <5AB46E01-AD6B-4630-B945-36471107AE7B@R-project.org>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <7cef1afe-0ba2-6efe-14b3-d8e418f88e28@stats.ox.ac.uk>
 <CB923EBB-0540-4337-9B54-F332D08323AA@geosec.org>
 <DCAF9BDB-2DAB-4F1E-9BAF-94568A010327@illinois.edu>
 <5AB46E01-AD6B-4630-B945-36471107AE7B@R-project.org>
Message-ID: <FFF8A076-B2B8-4412-A121-D1B0D8547A89@illinois.edu>

Simon,

Okay, thanks for the note!

Would you be okay if I add a line to the READMEs on https://github.com/R-macos projects about how issues should be raised?
I think there was confusion as to how to best raise an issue. 

Best,

JJB

?On 11/19/20, 2:14 PM, "Simon Urbanek" <simon.urbanek at R-project.org> wrote:

    JJB,

    FWIW if you have an issue that is related to macOS R please report it here. GH is fine for PRs, but I am only batch-processing GH notifications once in a while (with close to 100 repos it's not possible to do it continuously), so I only act on things flagged here as important.

    Cheers,
    Simon



    > On Nov 20, 2020, at 3:34 AM, Balamuta, James Joseph <balamut2 at illinois.edu> wrote:
    > 
    > Prof. Ripley,
    > 
    > Hope all is well. 
    > 
    > The issue was raised by Jeroen on GitHub on Oct 30th regarding libpq.5.dylib being missing:
    > 
    > https://github.com/R-macos/recipes/issues/14 
    > 
    > To date, Simon hasn't responded to it. Not sure re-building with the recipe as-is will yield the correct outcome as the pgsql is at: /usr/local/pgsql/lib instead of /usr/local/{include,lib}.
    > 
    > Best,
    > 
    > JJB
    > 
    > On 11/19/20, 7:46 AM, "R-SIG-Mac on behalf of Gilberto Camara" <r-sig-mac-bounces at r-project.org on behalf of gcamara at geosec.org> wrote:
    > 
    >    Dear Prof Ripley
    > 
    >    There have been reports as follows:
    > 
    >    https://community.rstudio.com/t/rgdal-library-not-loading/88025 <https://community.rstudio.com/t/rgdal-library-not-loading/88025>
    > 
    >    https://github.com/r-spatial/sf/issues/1542 <https://github.com/r-spatial/sf/issues/1542>
    > 
    >    Best
    >    Gilberto
    >    ===========================
    >    Prof Dr Gilberto Camara
    >    Secretariat Director
    >    GEO - Group on Earth Observations
    >    7 bis, Avenue de La Paix
    >    CH-1211 Geneva - Switzerland
    >    Tel: +41227308480
    >    Web: www.earthobservations.org
    > 
    > 
    >> On 19 Nov 2020, at 14:43, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
    >> 
    >> On 19/11/2020 11:22, GilbertoCamara wrote:
    >>> Dear all,
    >>> Mac users that have upgraded to Mac OS 11 BigSur have reported having problems with ?rgdal? and ?sf?. The same happened to me when I upgraded my Mac.
    >> 
    >> What problems are those?  You report nothing, and make reference to no reports here nor on R-sig-geo.
    >> 
    >> I tried the binary package of sf on my Intel 'Big Sur' machine and got
    >> 
    >>> library(sf)
    >> Error: package or namespace load failed for ?sf? in dyn.load(file, DLLpath = DLLpath, ...):
    >> unable to load shared object '/Users/ripley/R/Library/sf/libs/sf.so':
    >> dlopen(/Users/ripley/R/Library/sf/libs/sf.so, 6): Library not loaded: /usr/lib/libpq.5.dylib
    >> Referenced from: /Users/ripley/R/Library/sf/libs/sf.so
    >> Reason: image not found
    >> 
    >> so it seem Apple has removed the PostgreSQL library.
    >> 
    >>> I managed to get "sf" to run on MacOS 11.0.1 by recompiling most of the required packages. Here's the recipe:
    >>> 1. Remove all spatial software from brew (if you installed it). Rgdal does not like "brewed" stuff (I believe Roger prefers wine). Seriously, it appears that rgdal looks for libraries in their default places and not in the "Cellar" libraries used by "brew".
    >>> 2. Install Xcode 12.3beta (downloaded from Apple Developers). This is the latest version of XCode which is compatible with MacOS BigSur.
    >>> 3. Install "wget" using brew:
    >>> "brew install wget".
    >>> 4. Download the libraries below from their sources:
    >>> (a) sqlite-autoconf-3330000.tar.gz from "https://www.sqlite.org/download.html <https://www.sqlite.org/download.html>".
    >>> (b) tiff-4.1.0.tar.gz from "https://download.osgeo.org/libtiff/ <https://download.osgeo.org/libtiff/>"
    >>> (c) proj-7.2.0.tar.gz from "https://proj.org/download.html#current-release <https://proj.org/download.html#current-release>"
    >>> (d) libgeotiff-1.6.0.tar.gz from "https://download.osgeo.org/geotiff/libgeotiff/ <https://download.osgeo.org/geotiff/libgeotiff/>"
    >>> (e) geos-3.8.1.tar.bz2 from "https://trac.osgeo.org/geos <https://trac.osgeo.org/geos>"
    >>> (f) gdal-3.2.0.tar.gz from "https://gdal.org/download.html <https://gdal.org/download.html>"
    >> 
    >> At the bottom of https://mac.r-project.org/libs-4/ <https://mac.r-project.org/libs-4/> you will see a reference to 'recipes': you could simply have followed those to rebuild for macOS 11, probably only gdal.  You probably want to ensure that the libpq that libgdal links against is the one in the libpq recipe (or build without PostgreSQL support).  Please ask Simon to rebuild his gdal accordingly.
    >> 
    >>> 5. In the order given above, unpack each library and then execute the following commands:
    >>> % ./configure
    >>> % make
    >>> % sudo make install
    >>> 6. Now you are ready to compile "rgdal" and "sf" from source. Using the R console,do:
    >>>> install.packages("rgdal", type = "source?)
    >>>> install.packages("sf", type = "source")
    >>> 	
    >>> 7. After those steps, both "rgdal" and "sf" are working on MacOS BigSur.
    >>> Hope this helps Mac users.
    >>> Best
    >>> Gilberto
    >>> 	[[alternative HTML version deleted]]
    >> 
    >> Please don't send HTML.
    >> 
    >> -- 
    >> Brian D. Ripley,                  ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>
    >> Emeritus Professor of Applied Statistics, University of Oxford
    > 
    > 
    >    	[[alternative HTML version deleted]]
    > 
    >    _______________________________________________
    >    R-SIG-Mac mailing list
    >    R-SIG-Mac at r-project.org
    >    https://stat.ethz.ch/mailman/listinfo/r-sig-mac
    > 
    > _______________________________________________
    > R-SIG-Mac mailing list
    > R-SIG-Mac at r-project.org
    > https://stat.ethz.ch/mailman/listinfo/r-sig-mac



From m@ch@|oupk@ @end|ng |rom uq@edu@@u  Fri Nov 20 01:07:07 2020
From: m@ch@|oupk@ @end|ng |rom uq@edu@@u (Milani Chaloupka)
Date: Fri, 20 Nov 2020 00:07:07 +0000
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <F410C1DA-A490-4395-A481-FF7466961250@R-project.org>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <F410C1DA-A490-4395-A481-FF7466961250@R-project.org>
Message-ID: <3D6109C0-BBDC-4BEF-8426-11775199FA4C@uq.edu.au>

Thank you Simon.

That worked exactly as you said for macOS Big Sur with rgdal, sf etc.

Simple. Sensible. No fuss. No nonsense.

I can also verify that after reinstall that cmdstanr and the Stan ecosystem work as well on Big Sur including using sf for maps results,

So grateful for the work you do here.

Milani








> On 20 Nov 2020, at 6:06 am, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
> Just for posterity, please do NOT follow those instructions unless you really want to build packages from sources and maintain them. Building GDAL can be tricky since the feature set depends on the libraries you have available, so use at your own risk.
> 
> CRAN libraries have been updated to be compatible with Big Sur which removed some system libraries, so just re-install rgdal and sf from CRAN (thanks to Jeroen). To make sure you get the latest versions use
> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
> 
> Cheers,
> Simon
> 


From roy@mende|@@ohn @end|ng |rom no@@@gov  Fri Nov 20 01:20:01 2020
From: roy@mende|@@ohn @end|ng |rom no@@@gov (Roy Mendelssohn - NOAA Federal)
Date: Thu, 19 Nov 2020 16:20:01 -0800
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <3D6109C0-BBDC-4BEF-8426-11775199FA4C@uq.edu.au>
References: <CF42CCDD-5834-4D92-99FE-5BC256B784C1@inpe.br>
 <F410C1DA-A490-4395-A481-FF7466961250@R-project.org>
 <3D6109C0-BBDC-4BEF-8426-11775199FA4C@uq.edu.au>
Message-ID: <46230C82-A4F0-4D39-AA53-1470E6E760D7@noaa.gov>

Ditto on the thanks.  Will also remind people that there were warnings that folks might want to hold off on upgrading to Big Sur because there might be hiccups, and to wait till it looked like most things were resolved.  

I imagine this is a huge amount of work.  Graeful to all who are working on it.

-Roy


> On Nov 19, 2020, at 4:07 PM, Milani Chaloupka <m.chaloupka at uq.edu.au> wrote:
> 
> Thank you Simon.
> 
> That worked exactly as you said for macOS Big Sur with rgdal, sf etc.
> 
> Simple. Sensible. No fuss. No nonsense.
> 
> I can also verify that after reinstall that cmdstanr and the Stan ecosystem work as well on Big Sur including using sf for maps results,
> 
> So grateful for the work you do here.
> 
> Milani
> 
> 
> 
> 
> 
> 
> 
> 
>> On 20 Nov 2020, at 6:06 am, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>> 
>> Just for posterity, please do NOT follow those instructions unless you really want to build packages from sources and maintain them. Building GDAL can be tricky since the feature set depends on the libraries you have available, so use at your own risk.
>> 
>> CRAN libraries have been updated to be compatible with Big Sur which removed some system libraries, so just re-install rgdal and sf from CRAN (thanks to Jeroen). To make sure you get the latest versions use
>> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
>> 
>> Cheers,
>> Simon
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

**********************
"The contents of this message do not reflect any position of the U.S. Government or NOAA."
**********************
Roy Mendelssohn
Supervisory Operations Research Analyst
NOAA/NMFS
Environmental Research Division
Southwest Fisheries Science Center
***Note new street address***
110 McAllister Way
Santa Cruz, CA 95060
Phone: (831)-420-3666
Fax: (831) 420-3980
e-mail: Roy.Mendelssohn at noaa.gov www: https://www.pfeg.noaa.gov/

"Old age and treachery will overcome youth and skill."
"From those who have been given much, much will be expected" 
"the arc of the moral universe is long, but it bends toward justice" -MLK Jr.


From @n|rb@n@mukherjee @end|ng |rom gm@||@com  Sun Nov 22 18:33:02 2020
From: @n|rb@n@mukherjee @end|ng |rom gm@||@com (Anirban Mukherjee)
Date: Sun, 22 Nov 2020 12:33:02 -0500
Subject: [R-SIG-Mac] Unable to use vecLib BLAS and LAPACK in Mac OS 11.0.1
Message-ID: <B82D9505-6C11-400B-A39A-DEF615A267F4@gmail.com>

Hi,

I am having trouble configuring R to use the vecLib BLAS and LAPACK libraries. I am on Mac OS 11.0.1 and Xcode 12.2. I tried the following options:

1. I downloaded the R binary from CRAN. I tried to follow the instructions at https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f to switch the BLAS library. I do not see libRblas.vecLib.dylib in the folder so I cannot switch the BLAS library as given in the FAQ. I also cannot locate libRblas.vecLib.dylib on my system.

2. I tried to compile R from source. I used the following configuration options: --with-blas="-framework Accelerate?  and --with-lapack. I should have all requisite libraries. The compiled R does not use the vecLib BLAS and LAPACK (sessionInfo below signature). During configure, I noticed configure outputted:

checking for dgemm_ in -framework Accelerate? no

Is that perhaps why configure does not configure the compiled R to use the Accelerate (vecLib) framework? Any suggestions would be very welcome.

Thanks,
Anirban

sessionInfo()
R version 4.0.3 Patched (2020-11-20 r79454)
Platform: x86_64-apple-darwin20.1.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.0.3 tools_4.0.3

From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Sun Nov 22 20:24:46 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Sun, 22 Nov 2020 19:24:46 +0000
Subject: [R-SIG-Mac] 
 Unable to use vecLib BLAS and LAPACK in Mac OS 11.0.1
In-Reply-To: <B82D9505-6C11-400B-A39A-DEF615A267F4@gmail.com>
References: <B82D9505-6C11-400B-A39A-DEF615A267F4@gmail.com>
Message-ID: <c6f02254-2d1d-11e8-d562-27baaf632399@stats.ox.ac.uk>

Which version of Xcode/Command Line Tools are you using?  If >= 12 (and 
perhaps earlier) Apple have set default C options which violate the 
C99/C11 standard, so you need -Wno-implicit-function-declaration.

If you have a configure issue, do read and report the relevant parts of 
config.log file: it probably told you what the problem was (it did for me):

conftest.c:227:1: error: implicit declaration of function 'dgemm_' is 
invalid in
  C99 [-Werror,-Wimplicit-function-declaration]

We will add a further comment to the R-admin manual, but Big Sur has 
been released for less than a week and a hint was already there ....


On 22/11/2020 17:33, Anirban Mukherjee wrote:
> Hi,
> 
> I am having trouble configuring R to use the vecLib BLAS and LAPACK libraries. I am on Mac OS 11.0.1 and Xcode 12.2. I tried the following options:
> 
> 1. I downloaded the R binary from CRAN. I tried to follow the instructions at https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f to switch the BLAS library. I do not see libRblas.vecLib.dylib in the folder so I cannot switch the BLAS library as given in the FAQ. I also cannot locate libRblas.vecLib.dylib on my system.
> 
> 2. I tried to compile R from source. I used the following configuration options: --with-blas="-framework Accelerate?  and --with-lapack. I should have all requisite libraries. The compiled R does not use the vecLib BLAS and LAPACK (sessionInfo below signature). During configure, I noticed configure outputted:
> 
> checking for dgemm_ in -framework Accelerate? no
> 
> Is that perhaps why configure does not configure the compiled R to use the Accelerate (vecLib) framework? Any suggestions would be very welcome.
> 
> Thanks,
> Anirban
> 
> sessionInfo()
> R version 4.0.3 Patched (2020-11-20 r79454)
> Platform: x86_64-apple-darwin20.1.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> Matrix products: default
> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.0.3 tools_4.0.3
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From @n|rb@n@mukherjee @end|ng |rom gm@||@com  Sun Nov 22 20:50:57 2020
From: @n|rb@n@mukherjee @end|ng |rom gm@||@com (Anirban Mukherjee)
Date: Sun, 22 Nov 2020 14:50:57 -0500
Subject: [R-SIG-Mac] 
 Unable to use vecLib BLAS and LAPACK in Mac OS 11.0.1
In-Reply-To: <c6f02254-2d1d-11e8-d562-27baaf632399@stats.ox.ac.uk>
References: <B82D9505-6C11-400B-A39A-DEF615A267F4@gmail.com>
 <c6f02254-2d1d-11e8-d562-27baaf632399@stats.ox.ac.uk>
Message-ID: <AF7293A7-DF70-4891-A9BD-D284F7CD87AC@gmail.com>

Dear Prof. Ripley,

You are correct. I am using Xcode 12.2. Adding -Wno-implicit-function-declaration enabled the use of the Accelerate (vecLib) BLAS library. The issue is now resolved on on my system. Thank you!

Best,
Anirban

> On 22 Nov 2020, at 2:24 PM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> Which version of Xcode/Command Line Tools are you using?  If >= 12 (and perhaps earlier) Apple have set default C options which violate the C99/C11 standard, so you need -Wno-implicit-function-declaration.
> 
> If you have a configure issue, do read and report the relevant parts of config.log file: it probably told you what the problem was (it did for me):
> 
> conftest.c:227:1: error: implicit declaration of function 'dgemm_' is invalid in
> C99 [-Werror,-Wimplicit-function-declaration]
> 
> We will add a further comment to the R-admin manual, but Big Sur has been released for less than a week and a hint was already there ....
> 
> 
> On 22/11/2020 17:33, Anirban Mukherjee wrote:
>> Hi,
>> I am having trouble configuring R to use the vecLib BLAS and LAPACK libraries. I am on Mac OS 11.0.1 and Xcode 12.2. I tried the following options:
>> 1. I downloaded the R binary from CRAN. I tried to follow the instructions at https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f to switch the BLAS library. I do not see libRblas.vecLib.dylib in the folder so I cannot switch the BLAS library as given in the FAQ. I also cannot locate libRblas.vecLib.dylib on my system.
>> 2. I tried to compile R from source. I used the following configuration options: --with-blas="-framework Accelerate?  and --with-lapack. I should have all requisite libraries. The compiled R does not use the vecLib BLAS and LAPACK (sessionInfo below signature). During configure, I noticed configure outputted:
>> checking for dgemm_ in -framework Accelerate? no
>> Is that perhaps why configure does not configure the compiled R to use the Accelerate (vecLib) framework? Any suggestions would be very welcome.
>> Thanks,
>> Anirban
>> sessionInfo()
>> R version 4.0.3 Patched (2020-11-20 r79454)
>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>> Matrix products: default
>> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> loaded via a namespace (and not attached):
>> [1] compiler_4.0.3 tools_4.0.3
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Mon Nov 23 11:14:49 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Mon, 23 Nov 2020 10:14:49 +0000
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
Message-ID: <bd508255-9d56-438d-137c-4ea8bcff1c45@stats.ox.ac.uk>

As a follow-up, I now have a preliminary native build of R (using a 
gfortran compiled from sources forked from GCC and using minor 
modifications of Tomas Kalibera's instructions).

The check timing was 148s, with Aqua (not X11) Tcl/Tk built from the 
sources and no X11 support, so not quite 100% comparable.

Building the compiler took 45m elapsed with 100% CPU most of the time: 
the machine (which has no fan) remained cool (unlike my MBP which has a 
fan but rarely runs it and does get warm to the touch).

There is a preliminary write-up on 'arm64' Macs in R-devel's R-admin 
manual (the version on CRAN is as usual a few days behind).

On 17/11/2020 14:57, Prof Brian Ripley wrote:
> Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
> 
> For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the 
> installation with
> 
> pdf("tests.pdf") ## optional, but prevents flashing graphics windows
> Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
> tools::testInstalledBasic("both")
> tools::testInstalledPackages(scope = "base")
> tools::testInstalledPackages(scope = "recommended")
> 
> That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz 
> i5): happily nothing untoward was reported (some recommended packages 
> give differences from reference output on both systems).
> 
> You need to install XQuartz to provide the X11() devices and support for 
> package Tcl/Tk: everything I tried using that worked as expected.
> 
> Having done that post-installation check I would happily use the Intel R 
> on an M1 machine.
> 
> We plan to check many of the Intel-compiled packages under Rosetta.
> 
> There are many hours of work ahead to build/test a native toolchain: our 
> goal is to have a native distribution for R 4.1.0 ca April 2021.
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From t@r@@@z@kh@rko @end|ng |rom uzh@ch  Wed Nov 25 10:40:36 2020
From: t@r@@@z@kh@rko @end|ng |rom uzh@ch (Taras Zakharko)
Date: Wed, 25 Nov 2020 10:40:36 +0100
Subject: [R-SIG-Mac] Apple Silicon aka M1 Macs
In-Reply-To: <bd508255-9d56-438d-137c-4ea8bcff1c45@stats.ox.ac.uk>
References: <28a0c590-3622-d713-644f-1f3181580670@stats.ox.ac.uk>
 <bd508255-9d56-438d-137c-4ea8bcff1c45@stats.ox.ac.uk>
Message-ID: <FA37BB06-C694-485A-A93F-CF3E1B376ADF@uzh.ch>

Creating a native Aarch64 build of R on my M1 machine was surprisingly straightforward. Here is a step-by-step instruction of what I did in case someone wants to replicate it:

1. Install native homebrew as described in this blog post under ?Multiple Homebrews? (https://soffes.blog/homebrew-on-apple-silicon). You will need to manually chown a bunch of directories, keep an eye on brew output

2. Install the following brew packages

  brew install jpeg libpng libtiff pcre2 pkg-config tcl-tk xz zlib

  Again, pay attention to brew output, it is possible that you will have to manually reset ownership on some directories

3. Make sure that zlib can be discovered by pkg-config by making it?s pc file discoverable

     ln -s /opt/homebrew/Cellar/zlib/1.2.11/lib/pkgconfig/zlib.pc /opt/homebrew/lib/pkgconfig/

4. Install patched gfortran, I used the precompiled package from here: 

     https://github.com/fxcoudert/gfortran-for-macOS/releases/tag/11-arm-alpha1

5. In  config.site, add the paths to homebrew libraries:

     CPPFLAGS=-I/opt/homebrew/include
     LDFLAGS=-L/opt/homebrew/lib

Note: the R-admin manual tells to set CC, CXX, FC in config.sites, but it?s not strictly necessary, the build will work without them

5. Run the configure script, I used

      ./configure --enable-R-shlib --without-x  --enable-memory-profiling --with-blas="-framework Accelerate?

  Check that the summary makes sense. If PNG is disabled, it?s probably because you forgot step 3

6. Build R

      make -j4

7. Check that everything runs

      bin/R

   You should see something like "Platform: arm-apple-darwin20.2.0 (64-bit)? in the startup message. 
  
All core tests seems to pass and the performance is excellent. 

I have tried building tidyverse and it blocked on testthat. It seems that testthat uses a fairly old version of Catch which doesn?t detect platform correctly and tries to use some x86 inline assembly during the arm build? 


> On 23 Nov 2020, at 11:14, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> As a follow-up, I now have a preliminary native build of R (using a gfortran compiled from sources forked from GCC and using minor modifications of Tomas Kalibera's instructions).
> 
> The check timing was 148s, with Aqua (not X11) Tcl/Tk built from the sources and no X11 support, so not quite 100% comparable.
> 
> Building the compiler took 45m elapsed with 100% CPU most of the time: the machine (which has no fan) remained cool (unlike my MBP which has a fan but rarely runs it and does get warm to the touch).
> 
> There is a preliminary write-up on 'arm64' Macs in R-devel's R-admin manual (the version on CRAN is as usual a few days behind).
> 
> On 17/11/2020 14:57, Prof Brian Ripley wrote:
>> Mine (a 8GB MBA) arrived today, so I have started doing some comparisons.
>> For the CRAN build of R 4.0.3, ?2.8 of R-admin recommends checking the installation with
>> pdf("tests.pdf") ## optional, but prevents flashing graphics windows
>> Sys.setenv(LC_COLLATE = "C", LC_TIME = "C", LANGUAGE = "en")
>> tools::testInstalledBasic("both")
>> tools::testInstalledPackages(scope = "base")
>> tools::testInstalledPackages(scope = "recommended")
>> That took 454s (using Rosetta) against 895s for my late-2016 MBP (2.9GHz i5): happily nothing untoward was reported (some recommended packages give differences from reference output on both systems).
>> You need to install XQuartz to provide the X11() devices and support for package Tcl/Tk: everything I tried using that worked as expected.
>> Having done that post-installation check I would happily use the Intel R on an M1 machine.
>> We plan to check many of the Intel-compiled packages under Rosetta.
>> There are many hours of work ahead to build/test a native toolchain: our goal is to have a native distribution for R 4.1.0 ca April 2021.
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From @n|rb@n@mukherjee @end|ng |rom gm@||@com  Sun Nov 22 10:15:17 2020
From: @n|rb@n@mukherjee @end|ng |rom gm@||@com (Anirban Mukherjee)
Date: Sun, 22 Nov 2020 04:15:17 -0500
Subject: [R-SIG-Mac] vecLib BLAS and LAPACK on Mac OS 11.01 and Xcode 12.2
Message-ID: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>

Hi,

I am having trouble using vecLib BLAS and LAPACK libraries in R 4.0.3 Patched (2020-11-20 r79454) on Mac OS 11.0.1 and Xcode 12.2. 

For several years, I have been compiling R from source on the same computer. Most recently, I compiled R from source on Mac OS 10.15.7 and Xcode 11.5. As given in the R installation and administration manual, I specified the following configuration options:

1. --with-blas="-framework Accelerate? 
2. --with-lapack 

As expected, those two configurations options led to R using the vecLib libraries. 

After upgrading from Mac OS 10.15.7 to Mac OS 11.01, I find that my new compilations of R no longer use vecLib BLAS and LAPACK libraries (sessionInfo below message). I poked around in /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/. I do not see libBLAS.dylib and libLAPACK.dylib. 

May I enquire:

a. Should I see libBLAS.dylib and libLAPACK.dylib in the vecLib framework folder (on Mac OS 11.01 and Xcode 12.2). As I remember it, that is where those libraries were located in prior versions of Mac OS and Xcode. Is the fact that they are missing unique to my machine? If so, then they likely were deleted in the upgrade as they must have been present when I compiled R a few weeks ago.

b. Has anyone compiled R from source on Mac OS 11.0.1 and Xcode 12.2? Does your R use the vecLib libaries (if that is what you prefer)?

Any help would be very welcome.

Thanks,
Anirban

> sessionInfo()
R version 4.0.3 Patched (2020-11-20 r79454)
Platform: x86_64-apple-darwin20.1.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.0.3 tools_4.0.3 

From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Nov 26 10:22:59 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 26 Nov 2020 09:22:59 +0000
Subject: [R-SIG-Mac] 
 vecLib BLAS and LAPACK on Mac OS 11.01 and Xcode 12.2
In-Reply-To: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>
References: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>
Message-ID: <6508f9e6-929d-0d42-fbf2-d4e68498c7e6@stats.ox.ac.uk>

A few comments:

1) Do you really want to be using an old and buggy LAPACK?  For that is 
what --with-lapack gives you, and the manual does warn you.

2) With Xcode 12.2 you will not see the .dylibs you are used to seeing: 
linking to system resources is done using .tbd files and although the 
dylibs are there, they (and much else) are hidden from casual view.

3) The instructions in the manual work for me with macOS 11.0.1 and CLT 
12.2, both on x86_64 and on arm64.  And Accelerate is being used, as the 
check output is slightly different and I have (without --with-lapack)

 > sessionInfo()
R Under development (unstable) (2020-11-25 r79505)
Platform: x86_64-apple-darwin20.1.0 (64-bit)
Running under: macOS Big Sur 11.0.1

Matrix products: default
LAPACK: /Users/ripley/R/R-accelerate/lib/libRlapack.dylib

with

otool -L .../libRlapack.dylib
	libRlapack.dylib (compatibility version 4.1.0, current version 4.1.0)
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate 
(compatibility version 1.0.0, current version 4.0.0)
...

as against a default build:

 > sessionInfo()
R Under development (unstable) (2020-11-25 r79505)
Platform: x86_64-apple-darwin20.1.0 (64-bit)
Running under: macOS Big Sur 11.0.1

Matrix products: default
BLAS:   /Users/ripley/R/R-devel/lib/libRblas.dylib
LAPACK: /Users/ripley/R/R-devel/lib/libRlapack.dylib



On 22/11/2020 09:15, Anirban Mukherjee wrote:
> Hi,
> 
> I am having trouble using vecLib BLAS and LAPACK libraries in R 4.0.3 Patched (2020-11-20 r79454) on Mac OS 11.0.1 and Xcode 12.2.
> 
> For several years, I have been compiling R from source on the same computer. Most recently, I compiled R from source on Mac OS 10.15.7 and Xcode 11.5. As given in the R installation and administration manual, I specified the following configuration options:
> 
> 1. --with-blas="-framework Accelerate?
> 2. --with-lapack
> 
> As expected, those two configurations options led to R using the vecLib libraries.
> 
> After upgrading from Mac OS 10.15.7 to Mac OS 11.01, I find that my new compilations of R no longer use vecLib BLAS and LAPACK libraries (sessionInfo below message). I poked around in /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/. I do not see libBLAS.dylib and libLAPACK.dylib.
> 
> May I enquire:
> 
> a. Should I see libBLAS.dylib and libLAPACK.dylib in the vecLib framework folder (on Mac OS 11.01 and Xcode 12.2). As I remember it, that is where those libraries were located in prior versions of Mac OS and Xcode. Is the fact that they are missing unique to my machine? If so, then they likely were deleted in the upgrade as they must have been present when I compiled R a few weeks ago.
> 
> b. Has anyone compiled R from source on Mac OS 11.0.1 and Xcode 12.2? Does your R use the vecLib libaries (if that is what you prefer)?
> 
> Any help would be very welcome.
> 
> Thanks,
> Anirban
> 
>> sessionInfo()
> R version 4.0.3 Patched (2020-11-20 r79454)
> Platform: x86_64-apple-darwin20.1.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> Matrix products: default
> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.0.3 tools_4.0.3
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From @n|rb@n@mukherjee @end|ng |rom gm@||@com  Thu Nov 26 22:19:06 2020
From: @n|rb@n@mukherjee @end|ng |rom gm@||@com (Anirban Mukherjee)
Date: Thu, 26 Nov 2020 16:19:06 -0500
Subject: [R-SIG-Mac] 
 vecLib BLAS and LAPACK on Mac OS 11.01 and Xcode 12.2
In-Reply-To: <6508f9e6-929d-0d42-fbf2-d4e68498c7e6@stats.ox.ac.uk>
References: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>
 <6508f9e6-929d-0d42-fbf2-d4e68498c7e6@stats.ox.ac.uk>
Message-ID: <509D434F-6EF3-42B5-820B-E6A691879A65@gmail.com>

Dear Prof Ripley,

1. Ok. I will not use LAPACK from the Accelerate library.

2. Ok. It would be great, when the CRAN team has the time, to update the FAQ.

3. I need to pass -Wno-implicit-function-declaration to have the compiled R use the Accelerate BLAS. Without the flag (even without --with-lapack) R compiles fine but uses the included stock BLAS.

Best,
Anirban

> On 26 Nov 2020, at 4:22 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> A few comments:
> 
> 1) Do you really want to be using an old and buggy LAPACK?  For that is what --with-lapack gives you, and the manual does warn you.
> 
> 2) With Xcode 12.2 you will not see the .dylibs you are used to seeing: linking to system resources is done using .tbd files and although the dylibs are there, they (and much else) are hidden from casual view.
> 
> 3) The instructions in the manual work for me with macOS 11.0.1 and CLT 12.2, both on x86_64 and on arm64.  And Accelerate is being used, as the check output is slightly different and I have (without --with-lapack)
> 
> > sessionInfo()
> R Under development (unstable) (2020-11-25 r79505)
> Platform: x86_64-apple-darwin20.1.0 (64-bit)
> Running under: macOS Big Sur 11.0.1
> 
> Matrix products: default
> LAPACK: /Users/ripley/R/R-accelerate/lib/libRlapack.dylib
> 
> with
> 
> otool -L .../libRlapack.dylib
> 	libRlapack.dylib (compatibility version 4.1.0, current version 4.1.0)
> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate (compatibility version 1.0.0, current version 4.0.0)
> ...
> 
> as against a default build:
> 
> > sessionInfo()
> R Under development (unstable) (2020-11-25 r79505)
> Platform: x86_64-apple-darwin20.1.0 (64-bit)
> Running under: macOS Big Sur 11.0.1
> 
> Matrix products: default
> BLAS:   /Users/ripley/R/R-devel/lib/libRblas.dylib
> LAPACK: /Users/ripley/R/R-devel/lib/libRlapack.dylib
> 
> 
> 
> On 22/11/2020 09:15, Anirban Mukherjee wrote:
>> Hi,
>> I am having trouble using vecLib BLAS and LAPACK libraries in R 4.0.3 Patched (2020-11-20 r79454) on Mac OS 11.0.1 and Xcode 12.2.
>> For several years, I have been compiling R from source on the same computer. Most recently, I compiled R from source on Mac OS 10.15.7 and Xcode 11.5. As given in the R installation and administration manual, I specified the following configuration options:
>> 1. --with-blas="-framework Accelerate?
>> 2. --with-lapack
>> As expected, those two configurations options led to R using the vecLib libraries.
>> After upgrading from Mac OS 10.15.7 to Mac OS 11.01, I find that my new compilations of R no longer use vecLib BLAS and LAPACK libraries (sessionInfo below message). I poked around in /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/. I do not see libBLAS.dylib and libLAPACK.dylib.
>> May I enquire:
>> a. Should I see libBLAS.dylib and libLAPACK.dylib in the vecLib framework folder (on Mac OS 11.01 and Xcode 12.2). As I remember it, that is where those libraries were located in prior versions of Mac OS and Xcode. Is the fact that they are missing unique to my machine? If so, then they likely were deleted in the upgrade as they must have been present when I compiled R a few weeks ago.
>> b. Has anyone compiled R from source on Mac OS 11.0.1 and Xcode 12.2? Does your R use the vecLib libaries (if that is what you prefer)?
>> Any help would be very welcome.
>> Thanks,
>> Anirban
>>> sessionInfo()
>> R version 4.0.3 Patched (2020-11-20 r79454)
>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>> Matrix products: default
>> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> loaded via a namespace (and not attached):
>> [1] compiler_4.0.3 tools_4.0.3
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Fri Nov 27 06:29:10 2020
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Fri, 27 Nov 2020 05:29:10 +0000
Subject: [R-SIG-Mac] 
 vecLib BLAS and LAPACK on Mac OS 11.01 and Xcode 12.2
In-Reply-To: <509D434F-6EF3-42B5-820B-E6A691879A65@gmail.com>
References: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>
 <6508f9e6-929d-0d42-fbf2-d4e68498c7e6@stats.ox.ac.uk>
 <509D434F-6EF3-42B5-820B-E6A691879A65@gmail.com>
Message-ID: <64647833-13cf-6423-2522-76a0e6ad8307@stats.ox.ac.uk>

On 26/11/2020 21:19, Anirban Mukherjee wrote:
> Dear Prof Ripley,
> 
> 1. Ok. I will not use LAPACK from the Accelerate library.
> 
> 2. Ok. It would be great, when the CRAN team has the time, to update the FAQ.]

Which FAQ?  The CRAN team is not responsible for the 'MacOSX FAQ' (nor 
any of the others): 'from CRAN' in that doc means 'mirrored by CRAN from 
Simon Urbanek'.

> 3. I need to pass -Wno-implicit-function-declaration to have the compiled R use the Accelerate BLAS. Without the flag (even without --with-lapack) R compiles fine but uses the included stock BLAS.

I believe that had already changed (in R-devel and R-patched): your R 
was not current.  (Please do re-read the R lists' posting guide and 
update before posting.)

> 
> Best,
> Anirban
> 
>> On 26 Nov 2020, at 4:22 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>
>> A few comments:
>>
>> 1) Do you really want to be using an old and buggy LAPACK?  For that is what --with-lapack gives you, and the manual does warn you.
>>
>> 2) With Xcode 12.2 you will not see the .dylibs you are used to seeing: linking to system resources is done using .tbd files and although the dylibs are there, they (and much else) are hidden from casual view.
>>
>> 3) The instructions in the manual work for me with macOS 11.0.1 and CLT 12.2, both on x86_64 and on arm64.  And Accelerate is being used, as the check output is slightly different and I have (without --with-lapack)
>>
>>> sessionInfo()
>> R Under development (unstable) (2020-11-25 r79505)
>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>> Running under: macOS Big Sur 11.0.1
>>
>> Matrix products: default
>> LAPACK: /Users/ripley/R/R-accelerate/lib/libRlapack.dylib
>>
>> with
>>
>> otool -L .../libRlapack.dylib
>> 	libRlapack.dylib (compatibility version 4.1.0, current version 4.1.0)
>> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate (compatibility version 1.0.0, current version 4.0.0)
>> ...
>>
>> as against a default build:
>>
>>> sessionInfo()
>> R Under development (unstable) (2020-11-25 r79505)
>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>> Running under: macOS Big Sur 11.0.1
>>
>> Matrix products: default
>> BLAS:   /Users/ripley/R/R-devel/lib/libRblas.dylib
>> LAPACK: /Users/ripley/R/R-devel/lib/libRlapack.dylib
>>
>>
>>
>> On 22/11/2020 09:15, Anirban Mukherjee wrote:
>>> Hi,
>>> I am having trouble using vecLib BLAS and LAPACK libraries in R 4.0.3 Patched (2020-11-20 r79454) on Mac OS 11.0.1 and Xcode 12.2.
>>> For several years, I have been compiling R from source on the same computer. Most recently, I compiled R from source on Mac OS 10.15.7 and Xcode 11.5. As given in the R installation and administration manual, I specified the following configuration options:
>>> 1. --with-blas="-framework Accelerate?
>>> 2. --with-lapack
>>> As expected, those two configurations options led to R using the vecLib libraries.
>>> After upgrading from Mac OS 10.15.7 to Mac OS 11.01, I find that my new compilations of R no longer use vecLib BLAS and LAPACK libraries (sessionInfo below message). I poked around in /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/. I do not see libBLAS.dylib and libLAPACK.dylib.
>>> May I enquire:
>>> a. Should I see libBLAS.dylib and libLAPACK.dylib in the vecLib framework folder (on Mac OS 11.01 and Xcode 12.2). As I remember it, that is where those libraries were located in prior versions of Mac OS and Xcode. Is the fact that they are missing unique to my machine? If so, then they likely were deleted in the upgrade as they must have been present when I compiled R a few weeks ago.
>>> b. Has anyone compiled R from source on Mac OS 11.0.1 and Xcode 12.2? Does your R use the vecLib libaries (if that is what you prefer)?
>>> Any help would be very welcome.
>>> Thanks,
>>> Anirban
>>>> sessionInfo()
>>> R version 4.0.3 Patched (2020-11-20 r79454)
>>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>>> Running under: macOS Big Sur 10.16
>>> Matrix products: default
>>> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> loaded via a namespace (and not attached):
>>> [1] compiler_4.0.3 tools_4.0.3
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>>
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From @n|rb@n@mukherjee @end|ng |rom gm@||@com  Fri Nov 27 07:31:08 2020
From: @n|rb@n@mukherjee @end|ng |rom gm@||@com (Anirban Mukherjee)
Date: Fri, 27 Nov 2020 01:31:08 -0500
Subject: [R-SIG-Mac] 
 vecLib BLAS and LAPACK on Mac OS 11.01 and Xcode 12.2
In-Reply-To: <64647833-13cf-6423-2522-76a0e6ad8307@stats.ox.ac.uk>
References: <20D46FEE-AA19-4A45-8E0E-16277235CB31@gmail.com>
 <6508f9e6-929d-0d42-fbf2-d4e68498c7e6@stats.ox.ac.uk>
 <509D434F-6EF3-42B5-820B-E6A691879A65@gmail.com>
 <64647833-13cf-6423-2522-76a0e6ad8307@stats.ox.ac.uk>
Message-ID: <6151B990-52AD-45C4-B2F7-2B95B9AA4D66@gmail.com>

I refer to https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html and specifically to https://cran.r-project.org/bin/macosx/RMacOSX-FAQ.html#Which-BLAS-is-used-and-how-can-it-be-changed_003f. I would request the FAQ author(s) to update the FAQ when they can.

> On 27 Nov 2020, at 12:29 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> On 26/11/2020 21:19, Anirban Mukherjee wrote:
>> Dear Prof Ripley,
>> 1. Ok. I will not use LAPACK from the Accelerate library.
>> 2. Ok. It would be great, when the CRAN team has the time, to update the FAQ.]
> 
> Which FAQ?  The CRAN team is not responsible for the 'MacOSX FAQ' (nor any of the others): 'from CRAN' in that doc means 'mirrored by CRAN from Simon Urbanek'.
> 
>> 3. I need to pass -Wno-implicit-function-declaration to have the compiled R use the Accelerate BLAS. Without the flag (even without --with-lapack) R compiles fine but uses the included stock BLAS.
> 
> I believe that had already changed (in R-devel and R-patched): your R was not current.  (Please do re-read the R lists' posting guide and update before posting.)
> 
>> Best,
>> Anirban
>>> On 26 Nov 2020, at 4:22 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>> 
>>> A few comments:
>>> 
>>> 1) Do you really want to be using an old and buggy LAPACK?  For that is what --with-lapack gives you, and the manual does warn you.
>>> 
>>> 2) With Xcode 12.2 you will not see the .dylibs you are used to seeing: linking to system resources is done using .tbd files and although the dylibs are there, they (and much else) are hidden from casual view.
>>> 
>>> 3) The instructions in the manual work for me with macOS 11.0.1 and CLT 12.2, both on x86_64 and on arm64.  And Accelerate is being used, as the check output is slightly different and I have (without --with-lapack)
>>> 
>>>> sessionInfo()
>>> R Under development (unstable) (2020-11-25 r79505)
>>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>>> Running under: macOS Big Sur 11.0.1
>>> 
>>> Matrix products: default
>>> LAPACK: /Users/ripley/R/R-accelerate/lib/libRlapack.dylib
>>> 
>>> with
>>> 
>>> otool -L .../libRlapack.dylib
>>> 	libRlapack.dylib (compatibility version 4.1.0, current version 4.1.0)
>>> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate (compatibility version 1.0.0, current version 4.0.0)
>>> ...
>>> 
>>> as against a default build:
>>> 
>>>> sessionInfo()
>>> R Under development (unstable) (2020-11-25 r79505)
>>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>>> Running under: macOS Big Sur 11.0.1
>>> 
>>> Matrix products: default
>>> BLAS:   /Users/ripley/R/R-devel/lib/libRblas.dylib
>>> LAPACK: /Users/ripley/R/R-devel/lib/libRlapack.dylib
>>> 
>>> 
>>> 
>>> On 22/11/2020 09:15, Anirban Mukherjee wrote:
>>>> Hi,
>>>> I am having trouble using vecLib BLAS and LAPACK libraries in R 4.0.3 Patched (2020-11-20 r79454) on Mac OS 11.0.1 and Xcode 12.2.
>>>> For several years, I have been compiling R from source on the same computer. Most recently, I compiled R from source on Mac OS 10.15.7 and Xcode 11.5. As given in the R installation and administration manual, I specified the following configuration options:
>>>> 1. --with-blas="-framework Accelerate?
>>>> 2. --with-lapack
>>>> As expected, those two configurations options led to R using the vecLib libraries.
>>>> After upgrading from Mac OS 10.15.7 to Mac OS 11.01, I find that my new compilations of R no longer use vecLib BLAS and LAPACK libraries (sessionInfo below message). I poked around in /System/Library/Frameworks/Accelerate.framework/Frameworks/vecLib.framework/Versions/Current/. I do not see libBLAS.dylib and libLAPACK.dylib.
>>>> May I enquire:
>>>> a. Should I see libBLAS.dylib and libLAPACK.dylib in the vecLib framework folder (on Mac OS 11.01 and Xcode 12.2). As I remember it, that is where those libraries were located in prior versions of Mac OS and Xcode. Is the fact that they are missing unique to my machine? If so, then they likely were deleted in the upgrade as they must have been present when I compiled R a few weeks ago.
>>>> b. Has anyone compiled R from source on Mac OS 11.0.1 and Xcode 12.2? Does your R use the vecLib libaries (if that is what you prefer)?
>>>> Any help would be very welcome.
>>>> Thanks,
>>>> Anirban
>>>>> sessionInfo()
>>>> R version 4.0.3 Patched (2020-11-20 r79454)
>>>> Platform: x86_64-apple-darwin20.1.0 (64-bit)
>>>> Running under: macOS Big Sur 10.16
>>>> Matrix products: default
>>>> LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
>>>> locale:
>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>> loaded via a namespace (and not attached):
>>>> [1] compiler_4.0.3 tools_4.0.3
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> 
>>> -- 
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Emeritus Professor of Applied Statistics, University of Oxford
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford


