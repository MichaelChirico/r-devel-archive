From jeroen.ooms at stat.ucla.edu  Fri Dec  4 17:23:07 2015
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Fri, 4 Dec 2015 17:23:07 +0100
Subject: [R-SIG-Mac] R 3.2.2 Hangs Reading Files in El Capitan
In-Reply-To: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
References: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
Message-ID: <CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>

Can you include a reproducible example? This seems to work for me as expected:

  x <- rnorm(1e8)
  saveRDS(x, tmp <- tempfile())
  file.info(tmp)$size
  y <- readRDS(tmp)
  identical(x,y)

Could be a hw issue with your disk.




On Sun, Nov 29, 2015 at 4:34 PM, Charles DiMaggio
<charles.dimaggio at gmail.com> wrote:
> Hi. After upgrading to el capitan R hangs on readRDS() and load()  for largish (say 500MB or larger) files, requiring a Force Quit of R.  I am working on a 64 GB Mac Pro machine and had no problem loading these size files prior to upgrade.  Reading and loading smaller files (1MB or less) seems to work fine. I re-installed R 3.2.2 GUI 1.66 Mavericks, XQuartz and CLT after the upgrade. Turned off SIP but experienced the same problem.
>
> I've looked over recent list posting about R behavior after upgrade to el capitan, and have not seen anything about this.  Am hoping soon-to-be-released R version 3.2.3 (Wooden Christmas-Tree) will address this weirdness, but wondering if anyone else has experienced anything similar?
>
> First few of lines of Mac Error Report below:
>
> Date/Time:       2015-11-28 15:45:00 -0500
> OS Version:      Mac OS X 10.11.1 (Build 15B42)
> Architecture:    x86_64
> Report Version:  22
>
> Command:         R
> Path:            /Applications/R.app/Contents/MacOS/R
> Version:         R 3.2.2 GUI 1.66 Mavericks build (6996)
> Parent:          launchd [1]
> PID:             563
>
> Event:           hang
> Duration:        1.70s (process was unresponsive for 25 seconds before sampling)
> Steps:           17 (100ms sampling interval)
>
> Hardware model:  MacPro6,1
> Active cpus:     8
>
> ...
>
> Heaviest stack for the main thread of the target process:
>   17  start + 1 (libdyld.dylib + 13741) [0x7fff88f2f5ad]
>   17  main + 815 (R + 5967) [0x1053e374f]
>   17  -[REngine runREPL] + 138 (R + 75578) [0x1053f473a]
>   17  run_REngineRmainloop + 295 (R + 123751) [0x105400367]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1243228) [0x10561d85c]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 675070) [0x105592cfe]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1044002) [0x1055ece22]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 674823) [0x105592c07]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1029000) [0x1055e9388]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 673910) [0x105592876]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 750621) [0x1055a541d]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1601435) [0x105674f9b]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592422) [0x105672c66]
>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1594038) [0x1056732b6]
>   14  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1596619) [0x105673ccb]
>   7   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1595584) [0x1056738c0]
>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592773) [0x105672dc5]
>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1600194) [0x105674ac2]
>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 383889) [0x10554bb91]
>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 316653) [0x10553b4ed]
>   1   inflate + 258 (libz.1.dylib + 20735) [0x7fff9e4e30ff] (running)
>
>
> Process:         R [563]
> Path:            /Applications/R.app/Contents/MacOS/R
> Architecture:    x86_64
> Parent:          launchd [1]
> UID:             501
> Task size:       350330 pages (+14553)
> CPU Time:        1.604s
> Note:            Unresponsive for 25 seconds before sampling
> Note:            2 idle work queue threads omitted
>
>
> Cheers
>
> Charles
>
>
> Charles DiMaggio, PhD, MPH
> Director of Injury Research
> Department of Surgery
> New York University School of Medicine
> Division of Trauma, Emergency Surgery and Critical Care Surgery
> Bellevue Hosptial Center
> 462 First Avenue, NBV 15
> New York, NY 10016-9196
> Charles.Dimaggio at nyumc.org
> Office: 212.263.3202
> Mobile: 516.308.6426
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From bob at rudis.net  Fri Dec  4 17:39:18 2015
From: bob at rudis.net (boB Rudis)
Date: Fri, 4 Dec 2015 11:39:18 -0500
Subject: [R-SIG-Mac] R 3.2.2 Hangs Reading Files in El Capitan
In-Reply-To: <CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>
References: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
	<CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>
Message-ID: <CAJ4QxaNr=wevUHis2rD4KTUasVe1N3Vzs-M+K736tiGCjn0Ywg@mail.gmail.com>

Agreed that I cannot reproduce with generated data sets on el capitan
either but would be glad to test with any real data you have.

On Fri, Dec 4, 2015 at 11:23 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:
> Can you include a reproducible example? This seems to work for me as expected:
>
>   x <- rnorm(1e8)
>   saveRDS(x, tmp <- tempfile())
>   file.info(tmp)$size
>   y <- readRDS(tmp)
>   identical(x,y)
>
> Could be a hw issue with your disk.
>
>
>
>
> On Sun, Nov 29, 2015 at 4:34 PM, Charles DiMaggio
> <charles.dimaggio at gmail.com> wrote:
>> Hi. After upgrading to el capitan R hangs on readRDS() and load()  for largish (say 500MB or larger) files, requiring a Force Quit of R.  I am working on a 64 GB Mac Pro machine and had no problem loading these size files prior to upgrade.  Reading and loading smaller files (1MB or less) seems to work fine. I re-installed R 3.2.2 GUI 1.66 Mavericks, XQuartz and CLT after the upgrade. Turned off SIP but experienced the same problem.
>>
>> I've looked over recent list posting about R behavior after upgrade to el capitan, and have not seen anything about this.  Am hoping soon-to-be-released R version 3.2.3 (Wooden Christmas-Tree) will address this weirdness, but wondering if anyone else has experienced anything similar?
>>
>> First few of lines of Mac Error Report below:
>>
>> Date/Time:       2015-11-28 15:45:00 -0500
>> OS Version:      Mac OS X 10.11.1 (Build 15B42)
>> Architecture:    x86_64
>> Report Version:  22
>>
>> Command:         R
>> Path:            /Applications/R.app/Contents/MacOS/R
>> Version:         R 3.2.2 GUI 1.66 Mavericks build (6996)
>> Parent:          launchd [1]
>> PID:             563
>>
>> Event:           hang
>> Duration:        1.70s (process was unresponsive for 25 seconds before sampling)
>> Steps:           17 (100ms sampling interval)
>>
>> Hardware model:  MacPro6,1
>> Active cpus:     8
>>
>> ...
>>
>> Heaviest stack for the main thread of the target process:
>>   17  start + 1 (libdyld.dylib + 13741) [0x7fff88f2f5ad]
>>   17  main + 815 (R + 5967) [0x1053e374f]
>>   17  -[REngine runREPL] + 138 (R + 75578) [0x1053f473a]
>>   17  run_REngineRmainloop + 295 (R + 123751) [0x105400367]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1243228) [0x10561d85c]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 675070) [0x105592cfe]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1044002) [0x1055ece22]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 674823) [0x105592c07]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1029000) [0x1055e9388]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 673910) [0x105592876]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 750621) [0x1055a541d]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1601435) [0x105674f9b]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592422) [0x105672c66]
>>   17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1594038) [0x1056732b6]
>>   14  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1596619) [0x105673ccb]
>>   7   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1595584) [0x1056738c0]
>>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592773) [0x105672dc5]
>>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1600194) [0x105674ac2]
>>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 383889) [0x10554bb91]
>>   6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 316653) [0x10553b4ed]
>>   1   inflate + 258 (libz.1.dylib + 20735) [0x7fff9e4e30ff] (running)
>>
>>
>> Process:         R [563]
>> Path:            /Applications/R.app/Contents/MacOS/R
>> Architecture:    x86_64
>> Parent:          launchd [1]
>> UID:             501
>> Task size:       350330 pages (+14553)
>> CPU Time:        1.604s
>> Note:            Unresponsive for 25 seconds before sampling
>> Note:            2 idle work queue threads omitted
>>
>>
>> Cheers
>>
>> Charles
>>
>>
>> Charles DiMaggio, PhD, MPH
>> Director of Injury Research
>> Department of Surgery
>> New York University School of Medicine
>> Division of Trauma, Emergency Surgery and Critical Care Surgery
>> Bellevue Hosptial Center
>> 462 First Avenue, NBV 15
>> New York, NY 10016-9196
>> Charles.Dimaggio at nyumc.org
>> Office: 212.263.3202
>> Mobile: 516.308.6426
>>
>>
>>
>>
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From charles.dimaggio at gmail.com  Sat Dec  5 17:24:15 2015
From: charles.dimaggio at gmail.com (Charles DiMaggio)
Date: Sat, 5 Dec 2015 11:24:15 -0500
Subject: [R-SIG-Mac] R 3.2.2 Hangs Reading Files in El Capitan
In-Reply-To: <CAJ4QxaNr=wevUHis2rD4KTUasVe1N3Vzs-M+K736tiGCjn0Ywg@mail.gmail.com>
References: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
	<CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>
	<CAJ4QxaNr=wevUHis2rD4KTUasVe1N3Vzs-M+K736tiGCjn0Ywg@mail.gmail.com>
Message-ID: <6C6D26E7-083F-4856-A62A-19471113E32C@gmail.com>

Bob and Jeroen, many thanks for your follow up. Unfortunately the files I was working with are under a data use agreement. But  I couldn?t find any reference to similar issues online, so agree it may be an idiosyncrasy of my system.  I ended up rolling back to Mavericks.  I?ll wait for the official release of 3.2.3 in a few days and try again.

Cheers

Charles


> On Dec 4, 2015, at 11:39 AM, boB Rudis <bob at rudis.net> wrote:
> 
> Agreed that I cannot reproduce with generated data sets on el capitan
> either but would be glad to test with any real data you have.
> 
> On Fri, Dec 4, 2015 at 11:23 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:
>> Can you include a reproducible example? This seems to work for me as expected:
>> 
>>  x <- rnorm(1e8)
>>  saveRDS(x, tmp <- tempfile())
>>  file.info(tmp)$size
>>  y <- readRDS(tmp)
>>  identical(x,y)
>> 
>> Could be a hw issue with your disk.
>> 
>> 
>> 
>> 
>> On Sun, Nov 29, 2015 at 4:34 PM, Charles DiMaggio
>> <charles.dimaggio at gmail.com> wrote:
>>> Hi. After upgrading to el capitan R hangs on readRDS() and load()  for largish (say 500MB or larger) files, requiring a Force Quit of R.  I am working on a 64 GB Mac Pro machine and had no problem loading these size files prior to upgrade.  Reading and loading smaller files (1MB or less) seems to work fine. I re-installed R 3.2.2 GUI 1.66 Mavericks, XQuartz and CLT after the upgrade. Turned off SIP but experienced the same problem.
>>> 
>>> I've looked over recent list posting about R behavior after upgrade to el capitan, and have not seen anything about this.  Am hoping soon-to-be-released R version 3.2.3 (Wooden Christmas-Tree) will address this weirdness, but wondering if anyone else has experienced anything similar?
>>> 
>>> First few of lines of Mac Error Report below:
>>> 
>>> Date/Time:       2015-11-28 15:45:00 -0500
>>> OS Version:      Mac OS X 10.11.1 (Build 15B42)
>>> Architecture:    x86_64
>>> Report Version:  22
>>> 
>>> Command:         R
>>> Path:            /Applications/R.app/Contents/MacOS/R
>>> Version:         R 3.2.2 GUI 1.66 Mavericks build (6996)
>>> Parent:          launchd [1]
>>> PID:             563
>>> 
>>> Event:           hang
>>> Duration:        1.70s (process was unresponsive for 25 seconds before sampling)
>>> Steps:           17 (100ms sampling interval)
>>> 
>>> Hardware model:  MacPro6,1
>>> Active cpus:     8
>>> 
>>> ...
>>> 
>>> Heaviest stack for the main thread of the target process:
>>>  17  start + 1 (libdyld.dylib + 13741) [0x7fff88f2f5ad]
>>>  17  main + 815 (R + 5967) [0x1053e374f]
>>>  17  -[REngine runREPL] + 138 (R + 75578) [0x1053f473a]
>>>  17  run_REngineRmainloop + 295 (R + 123751) [0x105400367]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1243228) [0x10561d85c]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 675070) [0x105592cfe]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1044002) [0x1055ece22]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 674823) [0x105592c07]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1029000) [0x1055e9388]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 673910) [0x105592876]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 750621) [0x1055a541d]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1601435) [0x105674f9b]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592422) [0x105672c66]
>>>  17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1594038) [0x1056732b6]
>>>  14  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1596619) [0x105673ccb]
>>>  7   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1595584) [0x1056738c0]
>>>  6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592773) [0x105672dc5]
>>>  6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1600194) [0x105674ac2]
>>>  6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 383889) [0x10554bb91]
>>>  6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 316653) [0x10553b4ed]
>>>  1   inflate + 258 (libz.1.dylib + 20735) [0x7fff9e4e30ff] (running)
>>> 
>>> 
>>> Process:         R [563]
>>> Path:            /Applications/R.app/Contents/MacOS/R
>>> Architecture:    x86_64
>>> Parent:          launchd [1]
>>> UID:             501
>>> Task size:       350330 pages (+14553)
>>> CPU Time:        1.604s
>>> Note:            Unresponsive for 25 seconds before sampling
>>> Note:            2 idle work queue threads omitted
>>> 
>>> 
>>> Cheers
>>> 
>>> Charles
>>> 
>>> 
>>> Charles DiMaggio, PhD, MPH
>>> Director of Injury Research
>>> Department of Surgery
>>> New York University School of Medicine
>>> Division of Trauma, Emergency Surgery and Critical Care Surgery
>>> Bellevue Hosptial Center
>>> 462 First Avenue, NBV 15
>>> New York, NY 10016-9196
>>> Charles.Dimaggio at nyumc.org
>>> Office: 212.263.3202
>>> Mobile: 516.308.6426
>>> 
>>> 
>>> 
>>> 
>>> 
>>> 
>>> 
>>>        [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

Charles DiMaggio, PhD, MPH
Director of Injury Research
Department of Surgery
New York University School of Medicine
Division of Trauma, Emergency Surgery and Surgical Critical Care
Bellevue Hospital Center
462 First Avenue, NBV 15
New York, NY 10016-9196
Charles.Dimaggio at nyumc.org
Office: 212.263.3202
Direct: 516.308.6426








	[[alternative HTML version deleted]]


From simon.urbanek at r-project.org  Sat Dec  5 22:51:28 2015
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 5 Dec 2015 16:51:28 -0500
Subject: [R-SIG-Mac] R 3.2.2 Hangs Reading Files in El Capitan
In-Reply-To: <6C6D26E7-083F-4856-A62A-19471113E32C@gmail.com>
References: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
	<CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>
	<CAJ4QxaNr=wevUHis2rD4KTUasVe1N3Vzs-M+K736tiGCjn0Ywg@mail.gmail.com>
	<6C6D26E7-083F-4856-A62A-19471113E32C@gmail.com>
Message-ID: <A19090D2-A311-46B2-B38F-7C3B3ED28603@r-project.org>


On Dec 5, 2015, at 11:24 AM, Charles DiMaggio <charles.dimaggio at gmail.com> wrote:

> Bob and Jeroen, many thanks for your follow up. Unfortunately the files I was working with are under a data use agreement. But  I couldn?t find any reference to similar issues online, so agree it may be an idiosyncrasy of my system.  I ended up rolling back to Mavericks.  I?ll wait for the official release of 3.2.3 in a few days and try again.
> 

You don't need to wait - you can always try the latest build from http://r.research.att.com but since there were no changes in the area it would be surprising if it behaved any differently. 

If you really want to dig into it, you could run R using
R -d lldb
then
r
and do whatever you need to replicate it. Once it seems stuck, hit <Ctrl><C> and then
bt
to list the back trace of where it got stuck. That would help us to find out if it's getting stuck in the system itself or if it may have something to do with R.

Thanks,
Simon


> Cheers
> 
> Charles
> 
> 
>> On Dec 4, 2015, at 11:39 AM, boB Rudis <bob at rudis.net> wrote:
>> 
>> Agreed that I cannot reproduce with generated data sets on el capitan
>> either but would be glad to test with any real data you have.
>> 
>> On Fri, Dec 4, 2015 at 11:23 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:
>>> Can you include a reproducible example? This seems to work for me as expected:
>>> 
>>> x <- rnorm(1e8)
>>> saveRDS(x, tmp <- tempfile())
>>> file.info(tmp)$size
>>> y <- readRDS(tmp)
>>> identical(x,y)
>>> 
>>> Could be a hw issue with your disk.
>>> 
>>> 
>>> 
>>> 
>>> On Sun, Nov 29, 2015 at 4:34 PM, Charles DiMaggio
>>> <charles.dimaggio at gmail.com> wrote:
>>>> Hi. After upgrading to el capitan R hangs on readRDS() and load()  for largish (say 500MB or larger) files, requiring a Force Quit of R.  I am working on a 64 GB Mac Pro machine and had no problem loading these size files prior to upgrade.  Reading and loading smaller files (1MB or less) seems to work fine. I re-installed R 3.2.2 GUI 1.66 Mavericks, XQuartz and CLT after the upgrade. Turned off SIP but experienced the same problem.
>>>> 
>>>> I've looked over recent list posting about R behavior after upgrade to el capitan, and have not seen anything about this.  Am hoping soon-to-be-released R version 3.2.3 (Wooden Christmas-Tree) will address this weirdness, but wondering if anyone else has experienced anything similar?
>>>> 
>>>> First few of lines of Mac Error Report below:
>>>> 
>>>> Date/Time:       2015-11-28 15:45:00 -0500
>>>> OS Version:      Mac OS X 10.11.1 (Build 15B42)
>>>> Architecture:    x86_64
>>>> Report Version:  22
>>>> 
>>>> Command:         R
>>>> Path:            /Applications/R.app/Contents/MacOS/R
>>>> Version:         R 3.2.2 GUI 1.66 Mavericks build (6996)
>>>> Parent:          launchd [1]
>>>> PID:             563
>>>> 
>>>> Event:           hang
>>>> Duration:        1.70s (process was unresponsive for 25 seconds before sampling)
>>>> Steps:           17 (100ms sampling interval)
>>>> 
>>>> Hardware model:  MacPro6,1
>>>> Active cpus:     8
>>>> 
>>>> ...
>>>> 
>>>> Heaviest stack for the main thread of the target process:
>>>> 17  start + 1 (libdyld.dylib + 13741) [0x7fff88f2f5ad]
>>>> 17  main + 815 (R + 5967) [0x1053e374f]
>>>> 17  -[REngine runREPL] + 138 (R + 75578) [0x1053f473a]
>>>> 17  run_REngineRmainloop + 295 (R + 123751) [0x105400367]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1243228) [0x10561d85c]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 675070) [0x105592cfe]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1044002) [0x1055ece22]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 674823) [0x105592c07]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1029000) [0x1055e9388]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 673910) [0x105592876]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 750621) [0x1055a541d]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1601435) [0x105674f9b]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592422) [0x105672c66]
>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1594038) [0x1056732b6]
>>>> 14  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1596619) [0x105673ccb]
>>>> 7   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1595584) [0x1056738c0]
>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592773) [0x105672dc5]
>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1600194) [0x105674ac2]
>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 383889) [0x10554bb91]
>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 316653) [0x10553b4ed]
>>>> 1   inflate + 258 (libz.1.dylib + 20735) [0x7fff9e4e30ff] (running)
>>>> 
>>>> 
>>>> Process:         R [563]
>>>> Path:            /Applications/R.app/Contents/MacOS/R
>>>> Architecture:    x86_64
>>>> Parent:          launchd [1]
>>>> UID:             501
>>>> Task size:       350330 pages (+14553)
>>>> CPU Time:        1.604s
>>>> Note:            Unresponsive for 25 seconds before sampling
>>>> Note:            2 idle work queue threads omitted
>>>> 
>>>> 
>>>> Cheers
>>>> 
>>>> Charles
>>>> 
>>>> 
>>>> Charles DiMaggio, PhD, MPH
>>>> Director of Injury Research
>>>> Department of Surgery
>>>> New York University School of Medicine
>>>> Division of Trauma, Emergency Surgery and Critical Care Surgery
>>>> Bellevue Hosptial Center
>>>> 462 First Avenue, NBV 15
>>>> New York, NY 10016-9196
>>>> Charles.Dimaggio at nyumc.org
>>>> Office: 212.263.3202
>>>> Mobile: 516.308.6426
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>>       [[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> Charles DiMaggio, PhD, MPH
> Director of Injury Research
> Department of Surgery
> New York University School of Medicine
> Division of Trauma, Emergency Surgery and Surgical Critical Care
> Bellevue Hospital Center
> 462 First Avenue, NBV 15
> New York, NY 10016-9196
> Charles.Dimaggio at nyumc.org
> Office: 212.263.3202
> Direct: 516.308.6426
> 
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From charles.dimaggio at gmail.com  Mon Dec  7 15:59:56 2015
From: charles.dimaggio at gmail.com (Charles DiMaggio)
Date: Mon, 7 Dec 2015 09:59:56 -0500
Subject: [R-SIG-Mac] R 3.2.2 Hangs Reading Files in El Capitan
In-Reply-To: <A19090D2-A311-46B2-B38F-7C3B3ED28603@r-project.org>
References: <C155FE58-D7FC-4C76-9FF6-45107EFDDBEF@gmail.com>
	<CABFfbXuambemrv9NV57RF5hqDi+XTas7hrMG9tPELyqEV3E7Cw@mail.gmail.com>
	<CAJ4QxaNr=wevUHis2rD4KTUasVe1N3Vzs-M+K736tiGCjn0Ywg@mail.gmail.com>
	<6C6D26E7-083F-4856-A62A-19471113E32C@gmail.com>
	<A19090D2-A311-46B2-B38F-7C3B3ED28603@r-project.org>
Message-ID: <0918503C-9C24-4A3F-A85B-5F977944C695@gmail.com>

Thanks very much for that, Simon. I will do that and get back to the group.

Charles


Charles DiMaggio, PhD, MPH
Director of Injury Research
Department of Surgery
New York University School of Medicine
550 First Avenue
New York, NY 10016
Direct Line: 1.516.308.6426
Office: 1.212.263.3202
charles.dimaggio at nyumc.org

> On Dec 5, 2015, at 4:51 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
> 
> On Dec 5, 2015, at 11:24 AM, Charles DiMaggio <charles.dimaggio at gmail.com <mailto:charles.dimaggio at gmail.com>> wrote:
> 
>> Bob and Jeroen, many thanks for your follow up. Unfortunately the files I was working with are under a data use agreement. But  I couldn?t find any reference to similar issues online, so agree it may be an idiosyncrasy of my system.  I ended up rolling back to Mavericks.  I?ll wait for the official release of 3.2.3 in a few days and try again.
>> 
> 
> You don't need to wait - you can always try the latest build from http://r.research.att.com <http://r.research.att.com/> but since there were no changes in the area it would be surprising if it behaved any differently. 
> 
> If you really want to dig into it, you could run R using
> R -d lldb
> then
> r
> and do whatever you need to replicate it. Once it seems stuck, hit <Ctrl><C> and then
> bt
> to list the back trace of where it got stuck. That would help us to find out if it's getting stuck in the system itself or if it may have something to do with R.
> 
> Thanks,
> Simon
> 
> 
>> Cheers
>> 
>> Charles
>> 
>> 
>>> On Dec 4, 2015, at 11:39 AM, boB Rudis <bob at rudis.net> wrote:
>>> 
>>> Agreed that I cannot reproduce with generated data sets on el capitan
>>> either but would be glad to test with any real data you have.
>>> 
>>> On Fri, Dec 4, 2015 at 11:23 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:
>>>> Can you include a reproducible example? This seems to work for me as expected:
>>>> 
>>>> x <- rnorm(1e8)
>>>> saveRDS(x, tmp <- tempfile())
>>>> file.info(tmp)$size
>>>> y <- readRDS(tmp)
>>>> identical(x,y)
>>>> 
>>>> Could be a hw issue with your disk.
>>>> 
>>>> 
>>>> 
>>>> 
>>>> On Sun, Nov 29, 2015 at 4:34 PM, Charles DiMaggio
>>>> <charles.dimaggio at gmail.com> wrote:
>>>>> Hi. After upgrading to el capitan R hangs on readRDS() and load()  for largish (say 500MB or larger) files, requiring a Force Quit of R.  I am working on a 64 GB Mac Pro machine and had no problem loading these size files prior to upgrade.  Reading and loading smaller files (1MB or less) seems to work fine. I re-installed R 3.2.2 GUI 1.66 Mavericks, XQuartz and CLT after the upgrade. Turned off SIP but experienced the same problem.
>>>>> 
>>>>> I've looked over recent list posting about R behavior after upgrade to el capitan, and have not seen anything about this.  Am hoping soon-to-be-released R version 3.2.3 (Wooden Christmas-Tree) will address this weirdness, but wondering if anyone else has experienced anything similar?
>>>>> 
>>>>> First few of lines of Mac Error Report below:
>>>>> 
>>>>> Date/Time:       2015-11-28 15:45:00 -0500
>>>>> OS Version:      Mac OS X 10.11.1 (Build 15B42)
>>>>> Architecture:    x86_64
>>>>> Report Version:  22
>>>>> 
>>>>> Command:         R
>>>>> Path:            /Applications/R.app/Contents/MacOS/R
>>>>> Version:         R 3.2.2 GUI 1.66 Mavericks build (6996)
>>>>> Parent:          launchd [1]
>>>>> PID:             563
>>>>> 
>>>>> Event:           hang
>>>>> Duration:        1.70s (process was unresponsive for 25 seconds before sampling)
>>>>> Steps:           17 (100ms sampling interval)
>>>>> 
>>>>> Hardware model:  MacPro6,1
>>>>> Active cpus:     8
>>>>> 
>>>>> ...
>>>>> 
>>>>> Heaviest stack for the main thread of the target process:
>>>>> 17  start + 1 (libdyld.dylib + 13741) [0x7fff88f2f5ad]
>>>>> 17  main + 815 (R + 5967) [0x1053e374f]
>>>>> 17  -[REngine runREPL] + 138 (R + 75578) [0x1053f473a]
>>>>> 17  run_REngineRmainloop + 295 (R + 123751) [0x105400367]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1243228) [0x10561d85c]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 675070) [0x105592cfe]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1044002) [0x1055ece22]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 674823) [0x105592c07]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1029000) [0x1055e9388]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 673910) [0x105592876]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 750621) [0x1055a541d]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1601435) [0x105674f9b]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592422) [0x105672c66]
>>>>> 17  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1594038) [0x1056732b6]
>>>>> 14  ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1596619) [0x105673ccb]
>>>>> 7   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1595584) [0x1056738c0]
>>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1592773) [0x105672dc5]
>>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 1600194) [0x105674ac2]
>>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 383889) [0x10554bb91]
>>>>> 6   ??? (<56AA7B12-7A0D-3F36-8116-218A93BC3CB3> + 316653) [0x10553b4ed]
>>>>> 1   inflate + 258 (libz.1.dylib + 20735) [0x7fff9e4e30ff] (running)
>>>>> 
>>>>> 
>>>>> Process:         R [563]
>>>>> Path:            /Applications/R.app/Contents/MacOS/R
>>>>> Architecture:    x86_64
>>>>> Parent:          launchd [1]
>>>>> UID:             501
>>>>> Task size:       350330 pages (+14553)
>>>>> CPU Time:        1.604s
>>>>> Note:            Unresponsive for 25 seconds before sampling
>>>>> Note:            2 idle work queue threads omitted
>>>>> 
>>>>> 
>>>>> Cheers
>>>>> 
>>>>> Charles
>>>>> 
>>>>> 
>>>>> Charles DiMaggio, PhD, MPH
>>>>> Director of Injury Research
>>>>> Department of Surgery
>>>>> New York University School of Medicine
>>>>> Division of Trauma, Emergency Surgery and Critical Care Surgery
>>>>> Bellevue Hosptial Center
>>>>> 462 First Avenue, NBV 15
>>>>> New York, NY 10016-9196
>>>>> Charles.Dimaggio at nyumc.org
>>>>> Office: 212.263.3202
>>>>> Mobile: 516.308.6426
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>>      [[alternative HTML version deleted]]
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> Charles DiMaggio, PhD, MPH
>> Director of Injury Research
>> Department of Surgery
>> New York University School of Medicine
>> Division of Trauma, Emergency Surgery and Surgical Critical Care
>> Bellevue Hospital Center
>> 462 First Avenue, NBV 15
>> New York, NY 10016-9196
>> Charles.Dimaggio at nyumc.org
>> Office: 212.263.3202
>> Direct: 516.308.6426
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>

	[[alternative HTML version deleted]]


From federico.calboli at helsinki.fi  Wed Dec  9 17:12:21 2015
From: federico.calboli at helsinki.fi (Federico Calboli)
Date: Wed, 9 Dec 2015 18:12:21 +0200
Subject: [R-SIG-Mac] Removing (completely) TCl/Tk
Message-ID: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>

Hi All,

I have TCL/Tk installed from the latest DMG image for R 3.2.2 I will upgrade to R 3.2.3 as soon as the DMG is available).  I?d like to *completely remove* Tcl/Tk as installed by the DMG image.  I can get a list of files from:

pkgutil --files org.r-project.x86_64.tcltk.x11

but the list is long it it looks like it is going to be tedious to remove all the files one by one (I could remove the directories but I could only do that once I am sure nothing else is there from another source).

Is there a smarter way of achieving my goal?

BW

Federico


--
Federico Calboli
Ecological Genetics Research Unit
Department of Biosciences
PO Box 65 (Biocenter 3, Viikinkaari 1)
FIN-00014 University of Helsinki
Finland

federico.calboli at helsinki.fi


From ripley at stats.ox.ac.uk  Wed Dec  9 17:40:10 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 9 Dec 2015 16:40:10 +0000
Subject: [R-SIG-Mac] Removing (completely) TCl/Tk
In-Reply-To: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>
References: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>
Message-ID: <5668596A.2000707@stats.ox.ac.uk>

On 09/12/2015 16:12, Federico Calboli wrote:
> Hi All,
>
> I have TCL/Tk installed from the latest DMG image for R 3.2.2 I will upgrade to R 3.2.3 as soon as the DMG is available).  I?d like to *completely remove* Tcl/Tk as installed by the DMG image.  I can get a list of files from:
>
> pkgutil --files org.r-project.x86_64.tcltk.x11
>
> but the list is long it it looks like it is going to be tedious to remove all the files one by one (I could remove the directories but I could only do that once I am sure nothing else is there from another source).
>
> Is there a smarter way of achieving my goal?

You could edit the list to remove directories such as

usr
usr/local
usr/local/bin
usr/local/include
usr/local/lib
usr/local/lib/pkgconfig
usr/local/man
usr/local/man/man1
usr/local/man/man3
usr/local/share
usr/local/share/man
usr/local/share/man/mann

then use a (shell? R?) script on the list.

Also, the R-devel manual sources contains the commented block:

@c Maybe too dangerous for naive users.
@c The second could be uninstalled by an @R{} script like

@c @example
@c lis <- system2("pkgutil", "--files org.r-project.x86_64.texinfo", 
stdout = TRUE)
@c setwd("/")
@c file.remove(rev(lis))
@c @end example

@c @noindent
@c run as the owner of @file{/usr/local}.

where file.remove will remove empty directories (and rev() ensures they 
are emptied first).


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From federico.calboli at helsinki.fi  Wed Dec  9 17:50:14 2015
From: federico.calboli at helsinki.fi (Federico Calboli)
Date: Wed, 9 Dec 2015 18:50:14 +0200
Subject: [R-SIG-Mac] Removing (completely) TCl/Tk
In-Reply-To: <5668596A.2000707@stats.ox.ac.uk>
References: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>
	<5668596A.2000707@stats.ox.ac.uk>
Message-ID: <4E9F952F-8199-4514-A5BD-B870CAC2D11B@helsinki.fi>


> On 9 Dec 2015, at 18:40, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> 
> On 09/12/2015 16:12, Federico Calboli wrote:
>> Hi All,
>> 
>> I have TCL/Tk installed from the latest DMG image for R 3.2.2 I will upgrade to R 3.2.3 as soon as the DMG is available).  I?d like to *completely remove* Tcl/Tk as installed by the DMG image.  I can get a list of files from:
>> 
>> pkgutil --files org.r-project.x86_64.tcltk.x11
>> 
>> but the list is long it it looks like it is going to be tedious to remove all the files one by one (I could remove the directories but I could only do that once I am sure nothing else is there from another source).
>> 
>> Is there a smarter way of achieving my goal?
> 
> You could edit the list to remove directories such as
> 
> usr
> usr/local
> usr/local/bin
> usr/local/include
> usr/local/lib
> usr/local/lib/pkgconfig
> usr/local/man
> usr/local/man/man1
> usr/local/man/man3
> usr/local/share
> usr/local/share/man
> usr/local/share/man/mann
> 
> then use a (shell? R?) script on the list.

Indeed.  My only concern is whether these directories have been created by the R DMG installer and have *never* been used by any other program to put some Tcl/Tk related file (or not just those, especially in the ?man? directories!).  Hence my desire to remove the files in the list, so I can ascertain post-hoc whether the directories are empty or not (and thus remove them).

BW

F





> 
> Also, the R-devel manual sources contains the commented block:
> 
> @c Maybe too dangerous for naive users.
> @c The second could be uninstalled by an @R{} script like
> 
> @c @example
> @c lis <- system2("pkgutil", "--files org.r-project.x86_64.texinfo", stdout = TRUE)
> @c setwd("/")
> @c file.remove(rev(lis))
> @c @end example
> 
> @c @noindent
> @c run as the owner of @file{/usr/local}.
> 
> where file.remove will remove empty directories (and rev() ensures they are emptied first).
> 
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford

--
Federico Calboli
Ecological Genetics Research Unit
Department of Biosciences
PO Box 65 (Biocenter 3, Viikinkaari 1)
FIN-00014 University of Helsinki
Finland

federico.calboli at helsinki.fi


From ripley at stats.ox.ac.uk  Wed Dec  9 20:02:43 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 9 Dec 2015 19:02:43 +0000
Subject: [R-SIG-Mac] Removing (completely) TCl/Tk
In-Reply-To: <4E9F952F-8199-4514-A5BD-B870CAC2D11B@helsinki.fi>
References: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>
	<5668596A.2000707@stats.ox.ac.uk>
	<4E9F952F-8199-4514-A5BD-B870CAC2D11B@helsinki.fi>
Message-ID: <56687AD3.1090205@stats.ox.ac.uk>

On 09/12/2015 16:50, Federico Calboli wrote:
>
>> On 9 Dec 2015, at 18:40, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>
>> On 09/12/2015 16:12, Federico Calboli wrote:
>>> Hi All,
>>>
>>> I have TCL/Tk installed from the latest DMG image for R 3.2.2 I will upgrade to R 3.2.3 as soon as the DMG is available).  I?d like to *completely remove* Tcl/Tk as installed by the DMG image.  I can get a list of files from:
>>>
>>> pkgutil --files org.r-project.x86_64.tcltk.x11
>>>
>>> but the list is long it it looks like it is going to be tedious to remove all the files one by one (I could remove the directories but I could only do that once I am sure nothing else is there from another source).
>>>
>>> Is there a smarter way of achieving my goal?
>>
>> You could edit the list to remove directories such as
>>
>> usr
>> usr/local
>> usr/local/bin
>> usr/local/include
>> usr/local/lib
>> usr/local/lib/pkgconfig
>> usr/local/man
>> usr/local/man/man1
>> usr/local/man/man3
>> usr/local/share
>> usr/local/share/man
>> usr/local/share/man/mann
>>
>> then use a (shell? R?) script on the list.
>
> Indeed.  My only concern is whether these directories have been created by the R DMG installer and have *never* been used by any other program to put some Tcl/Tk related file (or not just those, especially in the ?man? directories!).  Hence my desire to remove the files in the list, so I can ascertain post-hoc whether the directories are empty or not (and thus remove them).

So use unlink() below.

> BW
>
> F
>
>
>
>
>
>>
>> Also, the R-devel manual sources contains the commented block:
>>
>> @c Maybe too dangerous for naive users.
>> @c The second could be uninstalled by an @R{} script like
>>
>> @c @example
>> @c lis <- system2("pkgutil", "--files org.r-project.x86_64.texinfo", stdout = TRUE)
>> @c setwd("/")
>> @c file.remove(rev(lis))
>> @c @end example
>>
>> @c @noindent
>> @c run as the owner of @file{/usr/local}.
>>
>> where file.remove will remove empty directories (and rev() ensures they are emptied first).
>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford
>
> --
> Federico Calboli
> Ecological Genetics Research Unit
> Department of Biosciences
> PO Box 65 (Biocenter 3, Viikinkaari 1)
> FIN-00014 University of Helsinki
> Finland
>
> federico.calboli at helsinki.fi
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From Rainer at krugs.de  Wed Dec  9 20:51:42 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Wed, 09 Dec 2015 20:51:42 +0100
Subject: [R-SIG-Mac] Removing (completely) TCl/Tk
In-Reply-To: <4E9F952F-8199-4514-A5BD-B870CAC2D11B@helsinki.fi> (Federico
	Calboli's message of "Wed, 9 Dec 2015 18:50:14 +0200")
References: <A3F7B78A-3FC7-491B-BA94-C03E835610E8@helsinki.fi>
	<5668596A.2000707@stats.ox.ac.uk>
	<4E9F952F-8199-4514-A5BD-B870CAC2D11B@helsinki.fi>
Message-ID: <m2h9jrqu29.fsf@krugs.de>

Federico Calboli <federico.calboli at helsinki.fi> writes:

>> On 9 Dec 2015, at 18:40, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>> 
>> On 09/12/2015 16:12, Federico Calboli wrote:
>>> Hi All,
>>> 
>>> I have TCL/Tk installed from the latest DMG image for R 3.2.2 I
>>> will upgrade to R 3.2.3 as soon as the DMG is available).  I?d like
>>> to *completely remove* Tcl/Tk as installed by the DMG image.  I can
>>> get a list of files from:
>>> 
>>> pkgutil --files org.r-project.x86_64.tcltk.x11
>>> 
>>> but the list is long it it looks like it is going to be tedious to
>>> remove all the files one by one (I could remove the directories but
>>> I could only do that once I am sure nothing else is there from
>>> another source).
>>> 
>>> Is there a smarter way of achieving my goal?

There are tools to do exactly this: uninstall pkgs. One is
I=UninstallPKG [http://www.corecode.at/uninstallpkg/] which I am using -
no affiliation, just a user.

Cheers,

Rainer

>> 
>> You could edit the list to remove directories such as
>> 
>> usr
>> usr/local
>> usr/local/bin
>> usr/local/include
>> usr/local/lib
>> usr/local/lib/pkgconfig
>> usr/local/man
>> usr/local/man/man1
>> usr/local/man/man3
>> usr/local/share
>> usr/local/share/man
>> usr/local/share/man/mann
>> 
>> then use a (shell? R?) script on the list.
>
> Indeed.  My only concern is whether these directories have been
> created by the R DMG installer and have *never* been used by any other
> program to put some Tcl/Tk related file (or not just those, especially
> in the ?man? directories!).  Hence my desire to remove the files in
> the list, so I can ascertain post-hoc whether the directories are
> empty or not (and thus remove them).
>
> BW
>
> F
>
>
>
>
>
>> 
>> Also, the R-devel manual sources contains the commented block:
>> 
>> @c Maybe too dangerous for naive users.
>> @c The second could be uninstalled by an @R{} script like
>> 
>> @c @example
>> @c lis <- system2("pkgutil", "--files org.r-project.x86_64.texinfo", stdout = TRUE)
>> @c setwd("/")
>> @c file.remove(rev(lis))
>> @c @end example
>> 
>> @c @noindent
>> @c run as the owner of @file{/usr/local}.
>> 
>> where file.remove will remove empty directories (and rev() ensures they are emptied first).
>> 
>> 
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford
>
> --
> Federico Calboli
> Ecological Genetics Research Unit
> Department of Biosciences
> PO Box 65 (Biocenter 3, Viikinkaari 1)
> FIN-00014 University of Helsinki
> Finland
>
> federico.calboli at helsinki.fi
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20151209/34d068d6/attachment.bin>

From ALPEROVYCH at em-lyon.com  Fri Dec 11 11:00:59 2015
From: ALPEROVYCH at em-lyon.com (ALPEROVYCH Yan)
Date: Fri, 11 Dec 2015 11:00:59 +0100
Subject: [R-SIG-Mac] parLapply is not using all nodes
Message-ID: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>

Hello, 

I have a piece of code that needs parallelization and it used to work just fine before (about 6 months ago). However, I had to rerun it yesterday and found out that my code is now behaving in a weird way - not all worker processes are charged with the computation. I created a little code that allows reproducing the issue. Here is a snapshot of the top command:

PID  COMMAND    %CPU  	TIME     
872  R            		97.7  	00:02.45 
871  R            		0.0   	00:00.03 
870  R            		98.2  	00:02.93 
869  R            		0.0   	00:00.03 
868  R            		97.7  	00:02.46 
867  R           		0.0   	00:00.03 
866  R            		94.4 	00:02.36 
862  R            		1.0  		00:04.64 

Interestingly, the mclapply command seems to correctly charge all workers instantly. 

So is this an intended behavior?

Example that reproduces the issue on my machine:
#
rm(list = ls())
library(parallel)
set.seed(123)
# 
expr <- expression(pnorm(b0 + b1*x1 + b2*x2 + b3*x3))
G <- list(
	D(D(expr, "x2"), "b0"),
	D(D(expr, "x2"), "b1"),
	D(D(expr, "x2"), "b2"),
	D(D(expr, "x2"), "b3"))
# 
b0 <-  1.2
b1 <-  0.4
b2 <-  0.2
b3 <- -0.6
x1 <- rnorm(10^7)
x2 <- rnorm(10^7)
x3 <- rnorm(10^7)
# 
nc <- detectCores() - 1
cl <- makeCluster(nc, type = "FORK")
grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x) mean(eval(x))))
stopCluster(cl)
#
sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.2 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods   base     



-------------- next part --------------
----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confide...{{dropped:10}}

From john.magnotti at gmail.com  Fri Dec 11 13:51:52 2015
From: john.magnotti at gmail.com (John Magnotti)
Date: Fri, 11 Dec 2015 06:51:52 -0600
Subject: [R-SIG-Mac] parLapply is not using all nodes
In-Reply-To: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>
References: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>
Message-ID: <CAHT0qpRaSt==SVwfU03zV9eWkUKhB9220yBqGLGp7_AkCA9DQQ@mail.gmail.com>

Hello Yan,

I think parLapply is just assigning a core for every item in the list, G,
you supplied. Because you have more cores than items in the list, some of
the cores won't receive any work.


John

On Fri, Dec 11, 2015 at 4:00 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com>
wrote:

> Hello,
>
> I have a piece of code that needs parallelization and it used to work just
> fine before (about 6 months ago). However, I had to rerun it yesterday and
> found out that my code is now behaving in a weird way - not all worker
> processes are charged with the computation. I created a little code that
> allows reproducing the issue. Here is a snapshot of the top command:
>
> PID  COMMAND    %CPU    TIME
> 872  R                          97.7    00:02.45
> 871  R                          0.0     00:00.03
> 870  R                          98.2    00:02.93
> 869  R                          0.0     00:00.03
> 868  R                          97.7    00:02.46
> 867  R                          0.0     00:00.03
> 866  R                          94.4    00:02.36
> 862  R                          1.0             00:04.64
>
> Interestingly, the mclapply command seems to correctly charge all workers
> instantly.
>
> So is this an intended behavior?
>
> Example that reproduces the issue on my machine:
> #
> rm(list = ls())
> library(parallel)
> set.seed(123)
> #
> expr <- expression(pnorm(b0 + b1*x1 + b2*x2 + b3*x3))
> G <- list(
>         D(D(expr, "x2"), "b0"),
>         D(D(expr, "x2"), "b1"),
>         D(D(expr, "x2"), "b2"),
>         D(D(expr, "x2"), "b3"))
> #
> b0 <-  1.2
> b1 <-  0.4
> b2 <-  0.2
> b3 <- -0.6
> x1 <- rnorm(10^7)
> x2 <- rnorm(10^7)
> x3 <- rnorm(10^7)
> #
> nc <- detectCores() - 1
> cl <- makeCluster(nc, type = "FORK")
> grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x)
> mean(eval(x))))
> stopCluster(cl)
> #
> sessionInfo()
> R version 3.2.3 (2015-12-10)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.2 (El Capitan)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>  base
>
>
>
>
> ----
> Ce message electronique et tous les fichiers attaches qu'il contient sont
> confidentiels et destines exclusivement ? l'usage de la personne ? laquelle
> ils sont adresses. Si vous avez re?u ce message par erreur, merci de le
> retourner ? son metteur. Les idees et opinions presentees dans ce message
> sont celles de son auteur, et ne representent pas necessairement celles de
> l'institution ou entite affiliee dont l'auteur est l'employe. La
> publication, l'usage, la distribution, l'impression ou la copie non
> autorisee de ce message et des attachements qu'il contient sont strictement
> interdits.
>
> This email and any files transmitted with it are confide...{{dropped:10}}
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>

	[[alternative HTML version deleted]]


From ALPEROVYCH at em-lyon.com  Fri Dec 11 13:58:50 2015
From: ALPEROVYCH at em-lyon.com (ALPEROVYCH Yan)
Date: Fri, 11 Dec 2015 13:58:50 +0100
Subject: [R-SIG-Mac] parLapply is not using all nodes
In-Reply-To: <CAHT0qpRaSt==SVwfU03zV9eWkUKhB9220yBqGLGp7_AkCA9DQQ@mail.gmail.com>
References: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>
	<CAHT0qpRaSt==SVwfU03zV9eWkUKhB9220yBqGLGp7_AkCA9DQQ@mail.gmail.com>
Message-ID: <BA3FB88F-B84C-4EA6-8057-30E73800AA89@em-lyon.com>

Hi John,

Thank you for the reply. In fact my original list has 122^2 elements in it (I simplified the code here), and parLapply behaves in a similar way still. Can it be something else?

Yan

On Dec 11, 2015, at 1:51 PM, John Magnotti <john.magnotti at gmail.com<mailto:john.magnotti at gmail.com>> wrote:

Hello Yan,

I think parLapply is just assigning a core for every item in the list, G, you supplied. Because you have more cores than items in the list, some of the cores won't receive any work.


John

On Fri, Dec 11, 2015 at 4:00 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com<mailto:ALPEROVYCH at em-lyon.com>> wrote:
Hello,

I have a piece of code that needs parallelization and it used to work just fine before (about 6 months ago). However, I had to rerun it yesterday and found out that my code is now behaving in a weird way - not all worker processes are charged with the computation. I created a little code that allows reproducing the issue. Here is a snapshot of the top command:

PID  COMMAND    %CPU    TIME
872  R                          97.7    00:02.45
871  R                          0.0     00:00.03
870  R                          98.2    00:02.93
869  R                          0.0     00:00.03
868  R                          97.7    00:02.46
867  R                          0.0     00:00.03
866  R                          94.4    00:02.36
862  R                          1.0             00:04.64

Interestingly, the mclapply command seems to correctly charge all workers instantly.

So is this an intended behavior?

Example that reproduces the issue on my machine:
#
rm(list = ls())
library(parallel)
set.seed(123)
#
expr <- expression(pnorm(b0 + b1*x1 + b2*x2 + b3*x3))
G <- list(
        D(D(expr, "x2"), "b0"),
        D(D(expr, "x2"), "b1"),
        D(D(expr, "x2"), "b2"),
        D(D(expr, "x2"), "b3"))
#
b0 <-  1.2
b1 <-  0.4
b2 <-  0.2
b3 <- -0.6
x1 <- rnorm(10^7)
x2 <- rnorm(10^7)
x3 <- rnorm(10^7)
#
nc <- detectCores() - 1
cl <- makeCluster(nc, type = "FORK")
grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x) mean(eval(x))))
stopCluster(cl)
#
sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.2 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods   base




----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confide...{{dropped:10}}

_______________________________________________
R-SIG-Mac mailing list
R-SIG-Mac at r-project.org<mailto:R-SIG-Mac at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-mac


----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please return it to the sender. The ideas and views expressed in this email are solely those of its author, and do not necessarily represent the views of the institution or company of which the author is an employee. Unauthorized publication, use, distribution, printing or copying of this e-mail or any attached files is strictly forbidden.

From john.magnotti at gmail.com  Fri Dec 11 14:16:02 2015
From: john.magnotti at gmail.com (John Magnotti)
Date: Fri, 11 Dec 2015 07:16:02 -0600
Subject: [R-SIG-Mac] parLapply is not using all nodes
In-Reply-To: <BA3FB88F-B84C-4EA6-8057-30E73800AA89@em-lyon.com>
References: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>
	<CAHT0qpRaSt==SVwfU03zV9eWkUKhB9220yBqGLGp7_AkCA9DQQ@mail.gmail.com>
	<BA3FB88F-B84C-4EA6-8057-30E73800AA89@em-lyon.com>
Message-ID: <CAHT0qpQX7LpShbt2Ua1bbqT3uQT6mhvPm5ppk+i9V+vR2cSm2w@mail.gmail.com>

Hi Yan,

Sorry it wasn't the simple answer. On my machine, your code creates 3 R
processes (#cores -1) and they are all active.

If you have an even simpler example say

parLapply(cl, 1:8, function_that_takes_a_while)

does that get all the cores going?

John

On Fri, Dec 11, 2015 at 6:58 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com>
wrote:

> Hi John,
>
> Thank you for the reply. In fact my original list has 122^2 elements in it
> (I simplified the code here), and parLapply behaves in a similar way still.
> Can it be something else?
>
> Yan
>
> On Dec 11, 2015, at 1:51 PM, John Magnotti <john.magnotti at gmail.com
> <mailto:john.magnotti at gmail.com>> wrote:
>
> Hello Yan,
>
> I think parLapply is just assigning a core for every item in the list, G,
> you supplied. Because you have more cores than items in the list, some of
> the cores won't receive any work.
>
>
> John
>
> On Fri, Dec 11, 2015 at 4:00 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com
> <mailto:ALPEROVYCH at em-lyon.com>> wrote:
> Hello,
>
> I have a piece of code that needs parallelization and it used to work just
> fine before (about 6 months ago). However, I had to rerun it yesterday and
> found out that my code is now behaving in a weird way - not all worker
> processes are charged with the computation. I created a little code that
> allows reproducing the issue. Here is a snapshot of the top command:
>
> PID  COMMAND    %CPU    TIME
> 872  R                          97.7    00:02.45
> 871  R                          0.0     00:00.03
> 870  R                          98.2    00:02.93
> 869  R                          0.0     00:00.03
> 868  R                          97.7    00:02.46
> 867  R                          0.0     00:00.03
> 866  R                          94.4    00:02.36
> 862  R                          1.0             00:04.64
>
> Interestingly, the mclapply command seems to correctly charge all workers
> instantly.
>
> So is this an intended behavior?
>
> Example that reproduces the issue on my machine:
> #
> rm(list = ls())
> library(parallel)
> set.seed(123)
> #
> expr <- expression(pnorm(b0 + b1*x1 + b2*x2 + b3*x3))
> G <- list(
>         D(D(expr, "x2"), "b0"),
>         D(D(expr, "x2"), "b1"),
>         D(D(expr, "x2"), "b2"),
>         D(D(expr, "x2"), "b3"))
> #
> b0 <-  1.2
> b1 <-  0.4
> b2 <-  0.2
> b3 <- -0.6
> x1 <- rnorm(10^7)
> x2 <- rnorm(10^7)
> x3 <- rnorm(10^7)
> #
> nc <- detectCores() - 1
> cl <- makeCluster(nc, type = "FORK")
> grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x)
> mean(eval(x))))
> stopCluster(cl)
> #
> sessionInfo()
> R version 3.2.3 (2015-12-10)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.2 (El Capitan)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>  base
>
>
>
>
> ----
> Ce message electronique et tous les fichiers attaches qu'il contient sont
> confidentiels et destines exclusivement ? l'usage de la personne ? laquelle
> ils sont adresses. Si vous avez re?u ce message par erreur, merci de le
> retourner ? son metteur. Les idees et opinions presentees dans ce message
> sont celles de son auteur, et ne representent pas necessairement celles de
> l'institution ou entite affiliee dont l'auteur est l'employe. La
> publication, l'usage, la distribution, l'impression ou la copie non
> autorisee de ce message et des attachements qu'il contient sont strictement
> interdits.
>
> This email and any files transmitted with it are confide...{{dropped:10}}
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org<mailto:R-SIG-Mac at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>
> ----
> Ce message electronique et tous les fichiers attaches qu'il contient sont
> confidentiels et destines exclusivement ? l'usage de la personne ? laquelle
> ils sont adresses. Si vous avez re?u ce message par erreur, merci de le
> retourner ? son metteur. Les idees et opinions presentees dans ce message
> sont celles de son auteur, et ne representent pas necessairement celles de
> l'institution ou entite affiliee dont l'auteur est l'employe. La
> publication, l'usage, la distribution, l'impression ou la copie non
> autorisee de ce message et des attachements qu'il contient sont strictement
> interdits.
>
> This email and any files transmitted with it are confi...{{dropped:15}}


From ALPEROVYCH at em-lyon.com  Fri Dec 11 17:20:46 2015
From: ALPEROVYCH at em-lyon.com (ALPEROVYCH Yan)
Date: Fri, 11 Dec 2015 17:20:46 +0100
Subject: [R-SIG-Mac] parLapply is not using all nodes
In-Reply-To: <CAHT0qpQX7LpShbt2Ua1bbqT3uQT6mhvPm5ppk+i9V+vR2cSm2w@mail.gmail.com>
References: <55453140-DF07-4569-B060-5998AAC3A19E@em-lyon.com>
	<CAHT0qpRaSt==SVwfU03zV9eWkUKhB9220yBqGLGp7_AkCA9DQQ@mail.gmail.com>
	<BA3FB88F-B84C-4EA6-8057-30E73800AA89@em-lyon.com>
	<CAHT0qpQX7LpShbt2Ua1bbqT3uQT6mhvPm5ppk+i9V+vR2cSm2w@mail.gmail.com>
Message-ID: <5476F72C-E578-4B11-9FFA-EAA8382D3901@em-lyon.com>

Hi John,

I tried to complicate the example a bit so that it takes longer to evaluate (see below). All cores seem to be going, but it looks like the environment in which the evaluation goes matters. I run the code twice, once in the global env and second time in the separately created one and here are the timings:

Timing in global environment
user  system elapsed
0.359   0.153  44.263

Timing in a separate environment
user  system elapsed
0.528   0.386  65.376

My original objects are created within a function and are much bigger than in this example. I have 122^2 expressions to evaluate. The data matrix has more than 42k rows (10^6 in the example) and 123 columns (n in the example). Since this is performed within a function, and I have not yet figured out how to break the data matrix into individual objects to be stored in the function environment, I sent all to a newly created one (list2env) and performed the evaluation there. Could this be a reason for some cores not going?

Thank you again for your help.

Yan

#
rm(list = ls())
library(parallel)
set.seed(123)
#
n <- 20
expr <- parse(text = paste("pnorm(", paste(paste("b", 1:n, sep = ""), paste("x", 1:n, sep = ""), sep = "*", collapse = " + "), ")", sep = ""))
coefs <- paste("b", 1:n, sep = "")
vars <- paste("x", 1:n, sep = "")
G <- lapply(lapply(vars, function(x) D(expr, x)), function(x) lapply(coefs, function(arg) D(x, arg)))
#
b <- as.list(rnorm(n, 5, 12))
names(b) <- coefs
x <- matrix(rnorm(10^6*(n)), ncol = n)
colnames(x) <- vars
#
ev <- new.env()
list2env(setNames(split(x, col(x)), vars), envir = ev)
list2env(b, envir = ev)
#
nc <- detectCores() - 1
cl <- makeCluster(nc, type = "FORK")
system.time(grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x) mean(eval(x, envir = ev)))))
stopCluster(cl)
#
sapply(1:length(coefs), function(z) {assign(coefs[z], b[1, z], pos = 1)})
sapply(1:length(vars), function(z) {assign(vars[z], x[, z], pos = 1)})
nc <- detectCores() - 1
cl <- makeCluster(nc, type = "FORK")
system.time(grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x) mean(eval(x)))))
stopCluster(cl)
#
On Dec 11, 2015, at 2:16 PM, John Magnotti <john.magnotti at gmail.com<mailto:john.magnotti at gmail.com>> wrote:

Hi Yan,

Sorry it wasn't the simple answer. On my machine, your code creates 3 R processes (#cores -1) and they are all active.

If you have an even simpler example say

parLapply(cl, 1:8, function_that_takes_a_while)

does that get all the cores going?

John

On Fri, Dec 11, 2015 at 6:58 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com<mailto:ALPEROVYCH at em-lyon.com>> wrote:
Hi John,

Thank you for the reply. In fact my original list has 122^2 elements in it (I simplified the code here), and parLapply behaves in a similar way still. Can it be something else?

Yan

On Dec 11, 2015, at 1:51 PM, John Magnotti <john.magnotti at gmail.com<mailto:john.magnotti at gmail.com><mailto:john.magnotti at gmail.com<mailto:john.magnotti at gmail.com>>> wrote:

Hello Yan,

I think parLapply is just assigning a core for every item in the list, G, you supplied. Because you have more cores than items in the list, some of the cores won't receive any work.


John

On Fri, Dec 11, 2015 at 4:00 AM, ALPEROVYCH Yan <ALPEROVYCH at em-lyon.com<mailto:ALPEROVYCH at em-lyon.com><mailto:ALPEROVYCH at em-lyon.com<mailto:ALPEROVYCH at em-lyon.com>>> wrote:
Hello,

I have a piece of code that needs parallelization and it used to work just fine before (about 6 months ago). However, I had to rerun it yesterday and found out that my code is now behaving in a weird way - not all worker processes are charged with the computation. I created a little code that allows reproducing the issue. Here is a snapshot of the top command:

PID  COMMAND    %CPU    TIME
872  R                          97.7    00:02.45
871  R                          0.0     00:00.03
870  R                          98.2    00:02.93
869  R                          0.0     00:00.03
868  R                          97.7    00:02.46
867  R                          0.0     00:00.03
866  R                          94.4    00:02.36
862  R                          1.0             00:04.64

Interestingly, the mclapply command seems to correctly charge all workers instantly.

So is this an intended behavior?

Example that reproduces the issue on my machine:
#
rm(list = ls())
library(parallel)
set.seed(123)
#
expr <- expression(pnorm(b0 + b1*x1 + b2*x2 + b3*x3))
G <- list(
        D(D(expr, "x2"), "b0"),
        D(D(expr, "x2"), "b1"),
        D(D(expr, "x2"), "b2"),
        D(D(expr, "x2"), "b3"))
#
b0 <-  1.2
b1 <-  0.4
b2 <-  0.2
b3 <- -0.6
x1 <- rnorm(10^7)
x2 <- rnorm(10^7)
x3 <- rnorm(10^7)
#
nc <- detectCores() - 1
cl <- makeCluster(nc, type = "FORK")
grad_g <- parLapply(cl, G, function(Z) lapply(Z, function(x) mean(eval(x))))
stopCluster(cl)
#
sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.2 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods   base




----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confide...{{dropped:10}}

_______________________________________________
R-SIG-Mac mailing list
R-SIG-Mac at r-project.org<mailto:R-SIG-Mac at r-project.org><mailto:R-SIG-Mac at r-project.org<mailto:R-SIG-Mac at r-project.org>>
https://stat.ethz.ch/mailman/listinfo/r-sig-mac


----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please return it to the sender. The ideas and views expressed in this email are solely those of its author, and do not necessarily represent the views of the institution or company of which the author is an employee. Unauthorized publication, use, distribution, printing or copying of this e-mail or any attached files is strictly forbidden.


----
Ce message electronique et tous les fichiers attaches qu'il contient sont confidentiels et destines exclusivement ? l'usage de la personne ? laquelle ils sont adresses. Si vous avez re?u ce message par erreur, merci de le retourner ? son metteur. Les idees et opinions presentees dans ce message sont celles de son auteur, et ne representent pas necessairement celles de l'institution ou entite affiliee dont l'auteur est l'employe. La publication, l'usage, la distribution, l'impression ou la copie non autorisee de ce message et des attachements qu'il contient sont strictement interdits.

This email and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this email in error please return it to the sender. The ideas and views expressed in this email are solely those of its author, and do not necessarily represent the views of the institution or company of which the author is an employee. Unauthorized publication, use, distribution, printing or copying of this e-mail or any attached files is strictly forbidden.

From rmh at temple.edu  Thu Dec 17 21:44:42 2015
From: rmh at temple.edu (Richard M. Heiberger)
Date: Thu, 17 Dec 2015 15:44:42 -0500
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
Message-ID: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>

This has been reported before.  I am still seeing it with R-3.2.3.
It appears randomly.  It sounds scary.

Rich

>
Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
CGContextSetFont: invalid context 0x7fb698259080. This is a serious
error. This application, or a library it uses, is using an invalid
context  and is thereby contributing to an overall degradation of
system stability and reliability. This notice is a courtesy: please
fix this problem. It will become a fatal error in an upcoming update.
Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
CGContextSetFontSize: invalid context 0x7fb698259080. This is a
serious error. This application, or a library it uses, is using an
invalid context  and is thereby contributing to an overall degradation
of system stability and reliability. This notice is a courtesy: please
fix this problem. It will become a fatal error in an upcoming update.
Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
CGContextGetFont: invalid context 0x7fb698259080. This is a serious
error. This application, or a library it uses, is using an invalid
context  and is thereby contributing to an overall degradation of
system stability and reliability. This notice is a courtesy: please
fix this problem. It will become a fatal error in an upcoming update.
p


From erich.neuwirth at univie.ac.at  Thu Dec 17 22:23:54 2015
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Thu, 17 Dec 2015 22:23:54 +0100
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
In-Reply-To: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
References: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
Message-ID: <09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>

Do you have any idea under what circumstances this happens.


> On Dec 17, 2015, at 21:44, Richard M. Heiberger <rmh at temple.edu> wrote:
> 
> This has been reported before.  I am still seeing it with R-3.2.3.
> It appears randomly.  It sounds scary.
> 
> Rich
> 
>> 
> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
> CGContextSetFont: invalid context 0x7fb698259080. This is a serious
> error. This application, or a library it uses, is using an invalid
> context  and is thereby contributing to an overall degradation of
> system stability and reliability. This notice is a courtesy: please
> fix this problem. It will become a fatal error in an upcoming update.
> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
> CGContextSetFontSize: invalid context 0x7fb698259080. This is a
> serious error. This application, or a library it uses, is using an
> invalid context  and is thereby contributing to an overall degradation
> of system stability and reliability. This notice is a courtesy: please
> fix this problem. It will become a fatal error in an upcoming update.
> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
> CGContextGetFont: invalid context 0x7fb698259080. This is a serious
> error. This application, or a library it uses, is using an invalid
> context  and is thereby contributing to an overall degradation of
> system stability and reliability. This notice is a courtesy: please
> fix this problem. It will become a fatal error in an upcoming update.
> p
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 670 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20151217/7a3dad65/attachment.bin>

From rmh at temple.edu  Thu Dec 17 22:28:54 2015
From: rmh at temple.edu (Richard M. Heiberger)
Date: Thu, 17 Dec 2015 16:28:54 -0500
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
In-Reply-To: <09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
References: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
	<09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
Message-ID: <CAGx1TMDQd-5oq7b-YhVgK5donfZ4yWC+sz6xqMvt9Uq61Aegkw@mail.gmail.com>

No idea at all.  It happens randomly.  I have noticed it since June
2012 when I first started using the Macintosh.  This is the first time
I saw it with R-3.2.3 so I decided to
report it again.

My guess is that it is deep in the Macintosh device driver software.

Rich

On Thu, Dec 17, 2015 at 4:23 PM, Erich Neuwirth
<erich.neuwirth at univie.ac.at> wrote:
> Do you have any idea under what circumstances this happens.
>
>
>> On Dec 17, 2015, at 21:44, Richard M. Heiberger <rmh at temple.edu> wrote:
>>
>> This has been reported before.  I am still seeing it with R-3.2.3.
>> It appears randomly.  It sounds scary.
>>
>> Rich
>>
>>>
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextSetFont: invalid context 0x7fb698259080. This is a serious
>> error. This application, or a library it uses, is using an invalid
>> context  and is thereby contributing to an overall degradation of
>> system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextSetFontSize: invalid context 0x7fb698259080. This is a
>> serious error. This application, or a library it uses, is using an
>> invalid context  and is thereby contributing to an overall degradation
>> of system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextGetFont: invalid context 0x7fb698259080. This is a serious
>> error. This application, or a library it uses, is using an invalid
>> context  and is thereby contributing to an overall degradation of
>> system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> p
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From john.maindonald at anu.edu.au  Thu Dec 17 22:58:53 2015
From: john.maindonald at anu.edu.au (John Maindonald)
Date: Thu, 17 Dec 2015 21:58:53 +0000
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
In-Reply-To: <CAGx1TMDQd-5oq7b-YhVgK5donfZ4yWC+sz6xqMvt9Uq61Aegkw@mail.gmail.com>
References: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
	<09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
	<CAGx1TMDQd-5oq7b-YhVgK5donfZ4yWC+sz6xqMvt9Uq61Aegkw@mail.gmail.com>
Message-ID: <92EF9910-2F06-4C6A-88A0-06E86F5F3433@anu.edu.au>

I used to get this type of message from time to time when I was plotting
to the RStudio graphics device.  Enlarging the graphics panel seemed
to fix it.  I?ve not seen it recently, with R-3.2.2

John Maindonald             email: john.maindonald at anu.edu.au


> On 18/12/2015, at 10:28, Richard M. Heiberger <rmh at temple.edu> wrote:
> 
> No idea at all.  It happens randomly.  I have noticed it since June
> 2012 when I first started using the Macintosh.  This is the first time
> I saw it with R-3.2.3 so I decided to
> report it again.
> 
> My guess is that it is deep in the Macintosh device driver software.
> 
> Rich
> 
> On Thu, Dec 17, 2015 at 4:23 PM, Erich Neuwirth
> <erich.neuwirth at univie.ac.at> wrote:
>> Do you have any idea under what circumstances this happens.
>> 
>> 
>>> On Dec 17, 2015, at 21:44, Richard M. Heiberger <rmh at temple.edu> wrote:
>>> 
>>> This has been reported before.  I am still seeing it with R-3.2.3.
>>> It appears randomly.  It sounds scary.
>>> 
>>> Rich
>>> 
>>>> 
>>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>>> CGContextSetFont: invalid context 0x7fb698259080. This is a serious
>>> error. This application, or a library it uses, is using an invalid
>>> context  and is thereby contributing to an overall degradation of
>>> system stability and reliability. This notice is a courtesy: please
>>> fix this problem. It will become a fatal error in an upcoming update.
>>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>>> CGContextSetFontSize: invalid context 0x7fb698259080. This is a
>>> serious error. This application, or a library it uses, is using an
>>> invalid context  and is thereby contributing to an overall degradation
>>> of system stability and reliability. This notice is a courtesy: please
>>> fix this problem. It will become a fatal error in an upcoming update.
>>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>>> CGContextGetFont: invalid context 0x7fb698259080. This is a serious
>>> error. This application, or a library it uses, is using an invalid
>>> context  and is thereby contributing to an overall degradation of
>>> system stability and reliability. This notice is a courtesy: please
>>> fix this problem. It will become a fatal error in an upcoming update.
>>> p
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From ccberry at ucsd.edu  Sat Dec 19 19:30:43 2015
From: ccberry at ucsd.edu (Charles C. Berry)
Date: Sat, 19 Dec 2015 10:30:43 -0800
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
In-Reply-To: <09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
References: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
	<09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
Message-ID: <alpine.OSX.2.20.1512191018190.643@charles-berrys-macbook.local>

On Thu, 17 Dec 2015, Erich Neuwirth wrote:

> Do you have any idea under what circumstances this happens.
>

See below.

>
>> On Dec 17, 2015, at 21:44, Richard M. Heiberger <rmh at temple.edu> wrote:
>>
>> This has been reported before.  I am still seeing it with R-3.2.3.
>> It appears randomly.  It sounds scary.
>>
>> Rich
>>
>>>
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextSetFont: invalid context 0x7fb698259080. This is a serious
>> error. This application, or a library it uses, is using an invalid
>> context  and is thereby contributing to an overall degradation of
>> system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextSetFontSize: invalid context 0x7fb698259080. This is a
>> serious error. This application, or a library it uses, is using an
>> invalid context  and is thereby contributing to an overall degradation
>> of system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> Dec 17 15:14:01 rmhs-MacBook-Air.local R[3534] <Error>:
>> CGContextGetFont: invalid context 0x7fb698259080. This is a serious
>> error. This application, or a library it uses, is using an invalid
>> context  and is thereby contributing to an overall degradation of
>> system stability and reliability. This notice is a courtesy: please
>> fix this problem. It will become a fatal error in an upcoming update.
>> p
>>

FWIW, I can reproducibly get CGContext* errors by running R in a
terminal window, plotting something (for example `example(hclust)' and
answering RET to the prompts), then hitting the maximize (green)
button on the graphics window. However, these messages do not produce
the `fatal error' threats mentioned in Rich's email.

I can report the output from doing this under
`CG_CONTEXT_SHOW_BACKTRACE=yes R' if that helps.

Chuck


From dwinsemius at comcast.net  Thu Dec 31 03:40:33 2015
From: dwinsemius at comcast.net (David Winsemius)
Date: Wed, 30 Dec 2015 18:40:33 -0800
Subject: [R-SIG-Mac] (old) rgl package crashes MacGUI using R 3.2.3 in El
	Cap, new compiled one does not.
In-Reply-To: <43C5311C-3731-4770-8A05-32794896ACB4@r-project.org>
References: <CAM3-KjbTNwS35+RALNpUQ7=OdpgTU5n1OKJM1KfporY8y1pWpA@mail.gmail.com>
	<43C5311C-3731-4770-8A05-32794896ACB4@r-project.org>
Message-ID: <225DF765-71BB-49D3-BBFA-D503F9A8321C@comcast.net>

Earlier today I had been getting an warning message when loading pkg:rgl (and then failing to get any plotting to an X11 window),  so I decided to re-install the binary 0.95.1201 from a CRAN mirror:

XQuartz 2.7.8 has been installed and reinstalled multiple times including just a few minutes before this. Also have current XCode and CLT.

> library(rgl)
> sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.2 (El Capitan)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] grDevices utils     datasets  stats     graphics  grid      methods  
[8] base     

other attached packages:
[1] rgl_0.95.1201   rms_4.4-0       SparseM_1.7     Hmisc_3.17-0   
[5] ggplot2_2.0.0   Formula_1.2-1   survival_2.38-3 sos_1.3-8      
[9] brew_1.0-6      lattice_0.20-33

loaded via a namespace (and not attached):
[1] Rcpp_0.12.2         cluster_2.0.3       splines_3.2.3      
[4] munsell_0.4.2       colorspace_1.2-6    multcomp_1.4-1     
[7] plyr_1.8.3          tools_3.2.3         nnet_7.3-11        
[10] gtable_0.1.2        nlme_3.1-122        quantreg_5.19      
[13] TH.data_1.0-6       latticeExtra_0.6-26 MatrixModels_0.4-1 
[16] polspline_1.1.12    Matrix_1.2-3        gridExtra_2.0.0    
[19] RColorBrewer_1.1-2  codetools_0.2-14    acepack_1.3-3.3    
[22] rpart_4.1-10        sandwich_2.3-4      scales_0.3.0.9000  
[25] mvtnorm_1.0-3       foreign_0.8-66      zoo_1.7-12         
[28] proto_0.3-10       


This is( ... er was) the crash log when done from the macGUI. When running from a Terminal window I get no error and the XQuartz/X11 window displays everything without problem. 

I also tried renaming the .Rprofile file that loads all that other stuff to hide it from the GUI-launch process, and just loading with rgl and the base packages and it still crashes (i.e. the MacGUI window disappears and a crash report appears.) 

Last minute update: I then installed the source version: rgl_0.95.1435.tar.gz and it loaded without complaint and executes the code in either session type:

In a Terminal window session with nothing in the .Rprofile:

install.packages("/Users/davidwinsemius/Downloads/rgl_0.95.1435.tar.gz", repo=NULL, dependencies=TRUE, type="source") 


Then in MacGUI:

library(rgl)
spheres3d(0,0,0,front="lines",back="lines")
set.seed(101)
n <- 50
theta <- runif(n,0,2*pi)
u <- runif(n,-1,1)
x <- sqrt(1-u^2)*cos(theta)
y <- sqrt(1-u^2)*sin(theta)
z <- u
points3d(x,y,z,col="red")

I see that the compile process fails with a message:

----------------------
	? checking files in ?vignettes? ... OK
	? checking examples ... ERROR
Running examples in ?rgl-Ex.R? failed
The error most likely occurred in:

> ### Name: rgl.pixels
> ### Title: Extract pixel information from window
> ### Aliases: rgl.pixels
> ### Keywords: dynamic
> 
> ### ** Examples
> 
> example(surface3d)

srfc3d> #
srfc3d> # volcano example taken from "persp"
srfc3d> #
srfc3d> 
srfc3d> data(volcano)

srfc3d> z <- 2 * volcano # Exaggerate the relief
-------------------

I tried running the contents of test/demo.R and got 21 different rgl windows, but no error. I was eventually able to find the offending code of : 'rgl-Ex.R' in the rgl.pixels.Rd file and copied and that code in a  GUI session with no errors reported.

So I guess the question is ... why is the build process for the Mavericks/Yosemite/El Capitan machines still failing to produce a current (working) version of rgl?

--- 

snipped crash logs.


-- 
David Winsemius
Alameda, CA, USA

From murdoch.duncan at gmail.com  Thu Dec 31 12:43:01 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 31 Dec 2015 06:43:01 -0500
Subject: [R-SIG-Mac] (old) rgl package crashes MacGUI using R 3.2.3 in
 El Cap, new compiled one does not.
In-Reply-To: <225DF765-71BB-49D3-BBFA-D503F9A8321C@comcast.net>
References: <CAM3-KjbTNwS35+RALNpUQ7=OdpgTU5n1OKJM1KfporY8y1pWpA@mail.gmail.com>
	<43C5311C-3731-4770-8A05-32794896ACB4@r-project.org>
	<225DF765-71BB-49D3-BBFA-D503F9A8321C@comcast.net>
Message-ID: <568514C5.2020301@gmail.com>

On 30/12/2015 9:40 PM, David Winsemius wrote:
[lots deleted]
> So I guess the question is ... why is the build process for the Mavericks/Yosemite/El Capitan machines still failing to produce a current (working) version of rgl?

I think it does probably does produce a working version, but it fails 
the tests on that particular machine.

I believe the problem is that the CRAN test machine uses an unusual X 
server.  I've asked for details on a couple of occasions so I could 
reproduce the error, but received no response.  I don't know if the 
server is buggy or rgl just fails to do some checks that are unnecessary 
on other servers.

The latest error is occurring in rgl.pixels, and the underlying C++ code 
there is a little sloppy with type conversions (e.g. it assumes GL_FLOAT 
is float, which is not necessarily true), and is probably also sloppy 
with run-time checks.  I don't think the type sloppiness could be a 
cause of the error (I think it would fail for all servers if so), and I 
can't spot the run-time sloppiness.

Duncan Murdoch


From dwinsemius at comcast.net  Thu Dec 31 19:06:13 2015
From: dwinsemius at comcast.net (David Winsemius)
Date: Thu, 31 Dec 2015 10:06:13 -0800
Subject: [R-SIG-Mac] (old) rgl package crashes MacGUI using R 3.2.3 in
	El Cap, new compiled one does not.
In-Reply-To: <568514C5.2020301@gmail.com>
References: <CAM3-KjbTNwS35+RALNpUQ7=OdpgTU5n1OKJM1KfporY8y1pWpA@mail.gmail.com>
	<43C5311C-3731-4770-8A05-32794896ACB4@r-project.org>
	<225DF765-71BB-49D3-BBFA-D503F9A8321C@comcast.net>
	<568514C5.2020301@gmail.com>
Message-ID: <30094A5F-F8AB-42C0-B21B-E1AE434864E4@comcast.net>


> On Dec 31, 2015, at 3:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> On 30/12/2015 9:40 PM, David Winsemius wrote:
> [lots deleted]
>> So I guess the question is ... why is the build process for the Mavericks/Yosemite/El Capitan machines still failing to produce a current (working) version of rgl?
> 
> I think it does probably does produce a working version, but it fails the tests on that particular machine.
> 
> I believe the problem is that the CRAN test machine uses an unusual X server.  I've asked for details on a couple of occasions so I could reproduce the error, but received no response.  I don't know if the server is buggy or rgl just fails to do some checks that are unnecessary on other servers.
> 
> The latest error is occurring in rgl.pixels, and the underlying C++ code there is a little sloppy with type conversions (e.g. it assumes GL_FLOAT is float, which is not necessarily true), and is probably also sloppy with run-time checks.  I don't think the type sloppiness could be a cause of the error (I think it would fail for all servers if so), and I can't spot the run-time sloppiness.
> 

Is there any way to put a ##Not run ..... ### "bracket" around that code?


> Duncan Murdoch

David Winsemius
Alameda, CA, USA


From murdoch.duncan at gmail.com  Thu Dec 31 21:28:06 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 31 Dec 2015 15:28:06 -0500
Subject: [R-SIG-Mac] (old) rgl package crashes MacGUI using R 3.2.3 in
 El Cap, new compiled one does not.
In-Reply-To: <30094A5F-F8AB-42C0-B21B-E1AE434864E4@comcast.net>
References: <CAM3-KjbTNwS35+RALNpUQ7=OdpgTU5n1OKJM1KfporY8y1pWpA@mail.gmail.com>
	<43C5311C-3731-4770-8A05-32794896ACB4@r-project.org>
	<225DF765-71BB-49D3-BBFA-D503F9A8321C@comcast.net>
	<568514C5.2020301@gmail.com>
	<30094A5F-F8AB-42C0-B21B-E1AE434864E4@comcast.net>
Message-ID: <56858FD6.7070208@gmail.com>

On 31/12/2015 1:06 PM, David Winsemius wrote:
>
>> On Dec 31, 2015, at 3:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> On 30/12/2015 9:40 PM, David Winsemius wrote:
>> [lots deleted]
>>> So I guess the question is ... why is the build process for the Mavericks/Yosemite/El Capitan machines still failing to produce a current (working) version of rgl?
>>
>> I think it does probably does produce a working version, but it fails the tests on that particular machine.
>>
>> I believe the problem is that the CRAN test machine uses an unusual X server.  I've asked for details on a couple of occasions so I could reproduce the error, but received no response.  I don't know if the server is buggy or rgl just fails to do some checks that are unnecessary on other servers.
>>
>> The latest error is occurring in rgl.pixels, and the underlying C++ code there is a little sloppy with type conversions (e.g. it assumes GL_FLOAT is float, which is not necessarily true), and is probably also sloppy with run-time checks.  I don't think the type sloppiness could be a cause of the error (I think it would fail for all servers if so), and I can't spot the run-time sloppiness.
>>
>
> Is there any way to put a ##Not run ..... ### "bracket" around that code?
>

Sure, I could mark those examples with \donttest{} or \dontrun{}, but 
that only works around the bug in the case that it's a bug at CRAN, and 
in that case, it would be better for them to update their X server.  I'd 
say it's at least as likely to be a bug in the package, and removing the 
tests that are failing would then be a really bad idea.

Anyone who is willing to live with the error can build rgl themselves.

Duncan Murdoch


From vindoggy at hotmail.com  Mon Dec 21 05:59:38 2015
From: vindoggy at hotmail.com (Vinny Mo)
Date: Mon, 21 Dec 2015 04:59:38 -0000
Subject: [R-SIG-Mac] Use of "file.choose()" or "change working directory"
 tab causing stall on Mac
Message-ID: <BN3PR15MB080410DE83EA5393E4E6C2F4CCE40@BN3PR15MB0804.namprd15.prod.outlook.com>

Hello,

I used to use the "file.choose()" command quite a lot, as well as the "change working directory" drop down tab as part of my workflow with R, but for over 1 year both of these actions have caused the spinning-wheel to crash R (just R, not any other program).

The issue seems to happen when the window selection window pops up, and happens about 80% of the time I use either of these actions. This issue has remained constant across different computers (though all macs), different R builds, and different Mac OS's. I had asked about this issue before, and had hoped that this bug might be fixed at some point, but it has persisted.

I know I can work around this issue programmatically by typing these commands manually, but both of these features represent a nice function that R has that I'd like to continue to use as was intended. Does anyone have any idea how I might be able to get this functionality back, or if the R Gods have any thoughts about addressing this issue?

Due to the nature of this issue it's impossible to provide a reproducible example. But it really is as simple as either using:

myfile<-read.csv(file.choose())

or

Clicking on the "Misc" tab, and then "change working directory".

I've included the results from R.Version() below, but as I mentioned this issue has persisted through many R builds.

R.Version()
$platform
[1] "x86_64-apple-darwin13.4.0"

$arch
[1] "x86_64"

$os
[1] "darwin13.4.0"

$system
[1] "x86_64, darwin13.4.0"

$status
[1] ""

$major
[1] "3"

$minor
[1] "2.2"

$year
[1] "2015"

$month
[1] "08"

$day
[1] "14"

$`svn rev`
[1] "69053"

$language
[1] "R"

$version.string
[1] "R version 3.2.2 (2015-08-14)"

$nickname
[1] "Fire Safety"






	[[alternative HTML version deleted]]


From didier.leibovici at nottingham.ac.uk  Tue Dec 15 09:57:02 2015
From: didier.leibovici at nottingham.ac.uk (Dr Didier G. Leibovici)
Date: Tue, 15 Dec 2015 08:57:02 -0000
Subject: [R-SIG-Mac] error when editing
Message-ID: <566FD5CF.4020404@nottingham.ac.uk>

Hi all, I got this message this morning after installing the 3.2.3 on 
OSX El Capitan 10.11.1. This happened whilst on the editor (not that 
editing never produced an error in the console but this time this 
appears quite concise so I thought I would share it )

R version 3.2.3 (2015-12-10) -- "Wooden Christmas-Tree"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)


2015-12-15 08:47:20.530 R[68962:4689119] *** WARNING: Method 
convertPointFromBase: in class NSView is deprecated on 10.7 and later. 
It should not be used in new applications.
 >


-- 
Dr Didier G. Leibovici
    d-d'ye    ley-bow-v-c
Senior Research Fellow
Geocomputational Modelling & Geospatial Statistics
Nottingham Geospatial Institute
University of Nottingham, UK
+44 (0)115 84 13924
http://www.nottingham.ac.uk/ngi/people/didier.leibovici
Google+ didier.leibovici at gmail.com
Skype didierleibovici


	[[alternative HTML version deleted]]


From ccberry at ucsd.edu  Fri Dec 18 05:05:21 2015
From: ccberry at ucsd.edu (Charles Berry)
Date: Fri, 18 Dec 2015 04:05:21 -0000
Subject: [R-SIG-Mac] graphics problem from Macintosh system software
References: <CAGx1TMDnQTVtvbJOv6fWer-4exJrM0Xk1mcNDYGAUBaa+CtDiA@mail.gmail.com>
	<09B9E41E-0C7C-4A90-B6A8-8C9897D2EB78@univie.ac.at>
Message-ID: <loom.20151218T044709-661@post.gmane.org>

Erich Neuwirth <erich.neuwirth <at> univie.ac.at> writes:

> 
> Do you have any idea under what circumstances this happens.
> 

I am getting a bunch of CGContext* error messages, too. But not exactly 
those listed by Rich.

I can reproduce them by running R-3.2.3 from a terminal, typing 
`example(hclust)', hitting RET to display all the plots, then clicking on the 
green button on the graphics window once to enter full-screen, and once to 
resize.

I get the further message:

"If you want to see the backtrace, please set CG_CONTEXT_SHOW_BACKTRACE 
environmental variable."

and Googling it leads to https://forums.developer.apple.com/thread/13683, 
which has posts saying this is an Xcode issue and had a message as recently as 
yesterday saying that it is still a problem.

Chuck


From adhicena95 at gmail.com  Mon Dec 21 16:03:39 2015
From: adhicena95 at gmail.com (adithya viswanathan)
Date: Mon, 21 Dec 2015 15:03:39 -0000
Subject: [R-SIG-Mac] Error message while starting R
Message-ID: <1DF53FC5-617D-46F6-894C-02E8401C7883@gmail.com>

Good evening, My Mac runs on OS X 10.10.5 Yosemite and i recently installed R and R studio for my undergraduate project. While opening both R and R studios an warning message pops and the message is as follows;

During startup - Warning messages:
1: Setting LC_CTYPE failed, using "C" 
2: Setting LC_COLLATE failed, using "C" 
3: Setting LC_TIME failed, using "C" 
4: Setting LC_MESSAGES failed, using "C" 
5: Setting LC_MONETARY failed, using "C" 
[R.app GUI 1.66 (7060) x86_64-apple-darwin13.4.0]

WARNING: You're using a non-UTF8 locale, therefore only ASCII characters will work.
Please read R for Mac OS X FAQ (see Help) section 9 and adjust your system preferences accordingly.

I kindly request you to suggest me a solution for this so that the warnings may be avoided in the future. Waiting for your positive response.

Regards, 
Adithya.V


From jrp355 at drexel.edu  Wed Dec 23 16:15:24 2015
From: jrp355 at drexel.edu (Jake Price)
Date: Wed, 23 Dec 2015 15:15:24 -0000
Subject: [R-SIG-Mac] tcltk not loading and causes R-gui to become
	unresponsive or crash
Message-ID: <CAEV-xq0-L3UKdE8bch0djQeTQzAMuUmN9TRA8r=bq_cpzT9Agw@mail.gmail.com>

Hi,

I've run into a problem with getting tcltk to run properly on r-gui. It's a
required package for one of the packages I'd like to work with and I
thought it would be good to report the issue to you guys. Hopefully this is
something that's an easy fix or already known. I've outlined my
observations in the email below, trying to be as detailed as I can.

Best regards,

JP

------------------

Preliminary Stuff
13" Macbook Air
OSX Yosemite - Version 10.10.5
R Version 3.2.3
R.app GUI 1.66 (6956) x86_64-apple-darwin14.5.0

r and r-gui were installed via homebrew

------------------

I installed aplpack in order to use the bagplot function. Upon loading the
package I received the following output:

Loading required package: tcltk
2015-12-23 09:44:11.134 R[6529:31353] -[NSApplication _setup:]:
unrecognized selector sent to instance 0x60800011b3f0
2015-12-23 09:44:11.135 R[6529:31353] *** run_REngineRmainloop: exception
-[NSApplication _setup:]: unrecognized selector sent to instance
0x60800011b3f0 caught during REPL iteration. Update to the latest GUI
version and consider reporting this properly (see FAQ) if it persists and
is not known.
Consider saving your work soon in case this develops into a problem.

The session became unresponsive and I had to force quit.

To try and solve the problem, I checked to see if tcltk was installed:

> capabilities()["tcltk"]
tcltk
 TRUE

It was also available via the package manager but trying to load it, both
through the gui and using library("tcltk") caused R to become unresponsive
and resulted in an identical error:

2015-12-23 09:49:24.370 R[6571:33844] -[NSApplication _setup:]:
unrecognized selector sent to instance 0x608000108f70
2015-12-23 09:49:24.370 R[6571:33844] *** run_REngineRmainloop: exception
-[NSApplication _setup:]: unrecognized selector sent to instance
0x608000108f70 caught during REPL iteration. Update to the latest GUI
version and consider reporting this properly (see FAQ) if it persists and
is not known.
Consider saving your work soon in case this develops into a problem.

Some googling led me to do the following:

- uninstall r-gui via homebrew
- uninstall r via homebrew
- download and install the most recent version of xquartz
- installed homebrew/dupes/tcl-tk (which I thought was supposed to fix the
issue)
- ran brew update
- ran brew upgrade
- ran brew doctor
- installed r via homebrew
- installed r-gui via homebrew

After taking the above steps, I'm still running into the same issue as
before.
Here is the output of sessionInfo():

> sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin14.5.0 (64-bit)
Running under: OS X 10.10.5 (Yosemite)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Following the advice in the Mac OSX FAQ (to attempt to replicate the
issue), I opened the r in terminal and was able to not only load tcltk, but
also aplpack:

R version 3.2.3 (2015-12-10) -- "Wooden Christmas-Tree"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin14.5.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin14.5.0 (64-bit)
Running under: OS X 10.10.5 (Yosemite)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
> library("aplpack")
Loading required package: tcltk
> sessionInfo()
R version 3.2.3 (2015-12-10)
Platform: x86_64-apple-darwin14.5.0 (64-bit)
Running under: OS X 10.10.5 (Yosemite)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] tcltk     stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] aplpack_1.3.0


I believe that the issue with loading tcltk is interfering with loading
aplpack and that something in R.app/r-gui is not playing nicely with tcltk.

	[[alternative HTML version deleted]]


