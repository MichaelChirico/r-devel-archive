From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Fri Aug  6 23:12:24 2021
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Fri, 6 Aug 2021 16:12:24 -0500
Subject: [R-SIG-Mac] In svg("tst.svg") : failed to load cairo DLL
Message-ID: <fd73c8ee-e04b-4b46-b686-6ed199cdb5b9@prodsyse.com>

Hello:


	  In R 4.1.0 under macOS 11.4, 'svg("tst.svg")' says, "failed to load 
cairo DLL".


	  This works fine under Windows 10.  (I tested under RStudio 1.4.1106, 
R terminal and R Console all with the same results.)


	  The first time I try "svg('tst.svg')" in a new R session, I get a 
longer message;  see below for that and for sessionInfo().  When I 
repeat "svg('tst.svg')", I get only "failed to load cairo DLL".


	  Suggestions?
	  Thanks,
	  Spencer Graves


svg('tst.svg')
Warning messages:
1: In grSoftVersion() :
   unable to load shared object 
'/Library/Frameworks/R.framework/Resources/modules//R_X11.so':
   dlopen(/Library/Frameworks/R.framework/Resources/modules//R_X11.so, 
6): Library not loaded: /opt/X11/lib/libSM.6.dylib
   Referenced from: 
/Library/Frameworks/R.framework/Versions/4.1/Resources/modules/R_X11.so
   Reason: image not found
2: In cairoVersion() :
   unable to load shared object 
'/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so':
 
dlopen(/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so, 
6): Library not loaded: /opt/X11/lib/libXrender.1.dylib
   Referenced from: 
/Library/Frameworks/R.framework/Versions/4.1/Resources/library/grDevices/libs/cairo.so
   Reason: image not found
3: In svg("tst.svg") : failed to load cairo DLL
 > sessionInfo()
R version 4.1.0 (2021-05-18)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
LAPACK: 
/Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.0 tools_4.1.0
 >


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Sat Aug  7 07:05:14 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Sat, 7 Aug 2021 06:05:14 +0100
Subject: [R-SIG-Mac] In svg("tst.svg") : failed to load cairo DLL
In-Reply-To: <fd73c8ee-e04b-4b46-b686-6ed199cdb5b9@prodsyse.com>
References: <fd73c8ee-e04b-4b46-b686-6ed199cdb5b9@prodsyse.com>
Message-ID: <d227523a-1857-2db7-1678-041db5ac3e0a@stats.ox.ac.uk>

Install (or re-install) XQuartz.  As the R-admin manual ?4 says

Various parts of the build require XQuartz to be installed: see 
https://www.xquartz.org/releases.  These include the tcltk package and 
the X11 device: attempting to use these without XQuartz will if possible 
remind you. This is also needed for some builds of the 
cairographics-based devices (which are not often used on macOS) such as 
png(type = "cairo").

svg() is a cairographics-based device .



On 06/08/2021 22:12, Spencer Graves wrote:
> Hello:
> 
> 
>  ????? In R 4.1.0 under macOS 11.4, 'svg("tst.svg")' says, "failed to 
> load cairo DLL".
> 
> 
>  ????? This works fine under Windows 10.? (I tested under RStudio 
> 1.4.1106, R terminal and R Console all with the same results.)
> 
> 
>  ????? The first time I try "svg('tst.svg')" in a new R session, I get a 
> longer message;? see below for that and for sessionInfo().? When I 
> repeat "svg('tst.svg')", I get only "failed to load cairo DLL".
> 
> 
>  ????? Suggestions?
>  ????? Thanks,
>  ????? Spencer Graves
> 
> 
> svg('tst.svg')
> Warning messages:
> 1: In grSoftVersion() :
>  ? unable to load shared object 
> '/Library/Frameworks/R.framework/Resources/modules//R_X11.so':
>  ? dlopen(/Library/Frameworks/R.framework/Resources/modules//R_X11.so, 
> 6): Library not loaded: /opt/X11/lib/libSM.6.dylib
>  ? Referenced from: 
> /Library/Frameworks/R.framework/Versions/4.1/Resources/modules/R_X11.so
>  ? Reason: image not found
> 2: In cairoVersion() :
>  ? unable to load shared object 
> '/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so': 
> 
> 
> dlopen(/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so, 
> 6): Library not loaded: /opt/X11/lib/libXrender.1.dylib
>  ? Referenced from: 
> /Library/Frameworks/R.framework/Versions/4.1/Resources/library/grDevices/libs/cairo.so 
> 
>  ? Reason: image not found
> 3: In svg("tst.svg") : failed to load cairo DLL
>  > sessionInfo()
> R version 4.1.0 (2021-05-18)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> Matrix products: default
> LAPACK: 
> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.0 tools_4.1.0
>  >
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Aug  7 15:41:09 2021
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 7 Aug 2021 08:41:09 -0500
Subject: [R-SIG-Mac] In svg("tst.svg") : failed to load cairo DLL
In-Reply-To: <d227523a-1857-2db7-1678-041db5ac3e0a@stats.ox.ac.uk>
References: <fd73c8ee-e04b-4b46-b686-6ed199cdb5b9@prodsyse.com>
 <d227523a-1857-2db7-1678-041db5ac3e0a@stats.ox.ac.uk>
Message-ID: <1895c964-5e4e-f0dc-6eaa-8bc62482b92a@prodsyse.com>

This, Prof. Ripley.  That fixed the problem.  Spencer Graves


On 8/7/21 12:05 AM, Prof Brian Ripley wrote:
> Install (or re-install) XQuartz.? As the R-admin manual ?4 says
> 
> Various parts of the build require XQuartz to be installed: see 
> https://www.xquartz.org/releases.? These include the tcltk package and 
> the X11 device: attempting to use these without XQuartz will if possible 
> remind you. This is also needed for some builds of the 
> cairographics-based devices (which are not often used on macOS) such as 
> png(type = "cairo").
> 
> svg() is a cairographics-based device .
> 
> 
> 
> On 06/08/2021 22:12, Spencer Graves wrote:
>> Hello:
>>
>>
>> ?????? In R 4.1.0 under macOS 11.4, 'svg("tst.svg")' says, "failed to 
>> load cairo DLL".
>>
>>
>> ?????? This works fine under Windows 10.? (I tested under RStudio 
>> 1.4.1106, R terminal and R Console all with the same results.)
>>
>>
>> ?????? The first time I try "svg('tst.svg')" in a new R session, I get 
>> a longer message;? see below for that and for sessionInfo().? When I 
>> repeat "svg('tst.svg')", I get only "failed to load cairo DLL".
>>
>>
>> ?????? Suggestions?
>> ?????? Thanks,
>> ?????? Spencer Graves
>>
>>
>> svg('tst.svg')
>> Warning messages:
>> 1: In grSoftVersion() :
>> ?? unable to load shared object 
>> '/Library/Frameworks/R.framework/Resources/modules//R_X11.so':
>> ?? dlopen(/Library/Frameworks/R.framework/Resources/modules//R_X11.so, 
>> 6): Library not loaded: /opt/X11/lib/libSM.6.dylib
>> ?? Referenced from: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/modules/R_X11.so
>> ?? Reason: image not found
>> 2: In cairoVersion() :
>> ?? unable to load shared object 
>> '/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so': 
>>
>>
>> dlopen(/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so, 
>> 6): Library not loaded: /opt/X11/lib/libXrender.1.dylib
>> ?? Referenced from: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/library/grDevices/libs/cairo.so 
>>
>> ?? Reason: image not found
>> 3: In svg("tst.svg") : failed to load cairo DLL
>> ?> sessionInfo()
>> R version 4.1.0 (2021-05-18)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>>
>> Matrix products: default
>> LAPACK: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib 
>>
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.0 tools_4.1.0
>> ?>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
>


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Aug  7 15:43:56 2021
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 7 Aug 2021 08:43:56 -0500
Subject: [R-SIG-Mac] In svg("tst.svg") : failed to load cairo DLL
In-Reply-To: <d227523a-1857-2db7-1678-041db5ac3e0a@stats.ox.ac.uk>
References: <fd73c8ee-e04b-4b46-b686-6ed199cdb5b9@prodsyse.com>
 <d227523a-1857-2db7-1678-041db5ac3e0a@stats.ox.ac.uk>
Message-ID: <285edc56-83af-cbfc-1d46-6a1a8b893999@prodsyse.com>

THANKS, Prof. Ripley.  That fixed the problem.  Spencer Graves


[please excuse a problem with delayed detection of an error with 
autocomplete.]


On 8/7/21 12:05 AM, Prof Brian Ripley wrote:
> Install (or re-install) XQuartz.? As the R-admin manual ?4 says
> 
> Various parts of the build require XQuartz to be installed: see 
> https://www.xquartz.org/releases.? These include the tcltk package and 
> the X11 device: attempting to use these without XQuartz will if possible 
> remind you. This is also needed for some builds of the 
> cairographics-based devices (which are not often used on macOS) such as 
> png(type = "cairo").
> 
> svg() is a cairographics-based device .
> 
> 
> 
> On 06/08/2021 22:12, Spencer Graves wrote:
>> Hello:
>>
>>
>> ?????? In R 4.1.0 under macOS 11.4, 'svg("tst.svg")' says, "failed to 
>> load cairo DLL".
>>
>>
>> ?????? This works fine under Windows 10.? (I tested under RStudio 
>> 1.4.1106, R terminal and R Console all with the same results.)
>>
>>
>> ?????? The first time I try "svg('tst.svg')" in a new R session, I get 
>> a longer message;? see below for that and for sessionInfo().? When I 
>> repeat "svg('tst.svg')", I get only "failed to load cairo DLL".
>>
>>
>> ?????? Suggestions?
>> ?????? Thanks,
>> ?????? Spencer Graves
>>
>>
>> svg('tst.svg')
>> Warning messages:
>> 1: In grSoftVersion() :
>> ?? unable to load shared object 
>> '/Library/Frameworks/R.framework/Resources/modules//R_X11.so':
>> ?? dlopen(/Library/Frameworks/R.framework/Resources/modules//R_X11.so, 
>> 6): Library not loaded: /opt/X11/lib/libSM.6.dylib
>> ?? Referenced from: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/modules/R_X11.so
>> ?? Reason: image not found
>> 2: In cairoVersion() :
>> ?? unable to load shared object 
>> '/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so': 
>>
>>
>> dlopen(/Library/Frameworks/R.framework/Resources/library/grDevices/libs//cairo.so, 
>> 6): Library not loaded: /opt/X11/lib/libXrender.1.dylib
>> ?? Referenced from: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/library/grDevices/libs/cairo.so 
>>
>> ?? Reason: image not found
>> 3: In svg("tst.svg") : failed to load cairo DLL
>> ?> sessionInfo()
>> R version 4.1.0 (2021-05-18)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>>
>> Matrix products: default
>> LAPACK: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib 
>>
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.0 tools_4.1.0
>> ?>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
>


From @|mon@urb@nek @end|ng |rom R-project@org  Mon Aug  9 22:28:33 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Tue, 10 Aug 2021 08:28:33 +1200
Subject: [R-SIG-Mac] Problem with createDataPartition
In-Reply-To: <24849.23240.990585.50197@stat.math.ethz.ch>
References: <266E76D2-1E9D-4767-9CFE-E83B9F304F08@icloud.com>
 <24849.23240.990585.50197@stat.math.ethz.ch>
Message-ID: <91718503-A8AD-4D47-BBE8-2AD345D288B4@R-project.org>


Richard, 

Rcpp has made an ABI-breaking change in 1.0.7 so you need to re-install all packages that use Rcpp (i.e. not only Rcpp itself but all other packages).

One way to re-install all packages is to use something like

install.packages(rownames(installed.packages()), type='binary')

If you want to install only Rcpp dependencies then something like this should work:

deps = tools:::CRAN_package_reverse_dependencies_with_maintainers("Rcpp")[,"Package"]
have = rownames(installed.packages())
install.packages(have[have %in% deps], type='binary')

Cheers,
Simon



> On Aug 10, 2021, at 4:41 AM, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> 
>>>>>> RoqueRichard  
>>>>>>    on Thu, 5 Aug 2021 12:54:36 +0800 writes:
> 
> Dear Richard,
> you sent all this to   r-sig-mac-owner at r-project.org
> 
> but you really should re-send it to the mailing list, i.e.
> 
> r-sig-mac at r-project.org
> 
> Best,
> Martin
> 
>> Hi,
> 
>> Im currently using R4.1.0 version on Mac OS. I tried using
>> the createDataPartition function but got the following
>> reply:
> 
>>> test_index <- createDataPartition(y, times = 1, p = 0.5,
>>> list = FALSE)
> 
>> Error in split_indices(as.integer(splitv), attr(splitv,
>> "n")) : function 'Rcpp_precious_remove' not provided by
>> package ?Rcpp'
> 
>> Is the Rcpp outdated? If so, could you advise how to
>> update Rcpp?
> 
>> Thanks a lot for any assistance you can provide.  Richard
> 


From r@roque03 @end|ng |rom |c|oud@com  Tue Aug 10 05:57:53 2021
From: r@roque03 @end|ng |rom |c|oud@com (RoqueRichard)
Date: Tue, 10 Aug 2021 11:57:53 +0800
Subject: [R-SIG-Mac] Problem with createDataPartition
In-Reply-To: <91718503-A8AD-4D47-BBE8-2AD345D288B4@R-project.org>
References: <266E76D2-1E9D-4767-9CFE-E83B9F304F08@icloud.com>
 <24849.23240.990585.50197@stat.math.ethz.ch>
 <91718503-A8AD-4D47-BBE8-2AD345D288B4@R-project.org>
Message-ID: <B903A2C8-06A1-4B82-A471-712B6CECA5EE@icloud.com>

Hi Simon and Martin,

Many thanks for your assistance and much appreciate it. The system is now working well

Have a good day!

Kind regards,
Richard

> On 10 Aug 2021, at 4:28 AM, Simon Urbanek <simon.urbanek at R-project.org> wrote:
> 
> Richard, 
> 
> Rcpp has made an ABI-breaking change in 1.0.7 so you need to re-install all packages that use Rcpp (i.e. not only Rcpp itself but all other packages).
> 
> One way to re-install all packages is to use something like
> 
> install.packages(rownames(installed.packages()), type='binary')
> 
> If you want to install only Rcpp dependencies then something like this should work:
> 
> deps = tools:::CRAN_package_reverse_dependencies_with_maintainers("Rcpp")[,"Package"]
> have = rownames(installed.packages())
> install.packages(have[have %in% deps], type='binary')
> 
> Cheers,
> Simon
> 
> 
> 
>> On Aug 10, 2021, at 4:41 AM, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
>> 
>>>>>>> RoqueRichard  
>>>>>>>   on Thu, 5 Aug 2021 12:54:36 +0800 writes:
>> 
>> Dear Richard,
>> you sent all this to   r-sig-mac-owner at r-project.org
>> 
>> but you really should re-send it to the mailing list, i.e.
>> 
>> r-sig-mac at r-project.org
>> 
>> Best,
>> Martin
>> 
>>> Hi,
>> 
>>> Im currently using R4.1.0 version on Mac OS. I tried using
>>> the createDataPartition function but got the following
>>> reply:
>> 
>>>> test_index <- createDataPartition(y, times = 1, p = 0.5,
>>>> list = FALSE)
>> 
>>> Error in split_indices(as.integer(splitv), attr(splitv,
>>> "n")) : function 'Rcpp_precious_remove' not provided by
>>> package ?Rcpp'
>> 
>>> Is the Rcpp outdated? If so, could you advise how to
>>> update Rcpp?
>> 
>>> Thanks a lot for any assistance you can provide.  Richard
>> 
> 


From jpre|d @end|ng |rom m@c@com  Wed Aug 11 19:31:35 2021
From: jpre|d @end|ng |rom m@c@com (Joey Reid)
Date: Wed, 11 Aug 2021 12:31:35 -0500
Subject: [R-SIG-Mac] Can't make odbc FreeTDS connections in R.app,
 can with RStudio, /usr/local/bin/R, Rscript
Message-ID: <2C06C4AE-F0EF-47B8-A4FF-551DD8FF1790@mac.com>

I?m experiencing some weirdness with database connections using R 4.1 on macOS 11.5.1 and the `odbc` package with the FreeTDS driver. I can replicate the problem on my coworker?s Mac with R 4.0 (macOS 11, not sure which version). 

Running this code works fine on the command line (or with RStudio, /usr/local/bin/R), /usr/local/bin/Rscript -e ?library(odbc); con = dbConnect(odbc(), 'GISLibrary'); dbGetQuery(con, ?select 1 num?); dbDisconnect(con)?

But the connection fails with the exact same code in R.app (I?ve tried R.app rev 7976 and 7982). I often get a segfault, like "address 0x7f975f481cb0, cause 'memory not mapped??. The connection works fine with the ODBC Driver 17 for SQL Server in all execution environments.

The connection also fails in some environments (rmarkdown::render, Rscript -e) if I load the package sf before making the first connection attempt, e.g., Rscript -e "library(odbc); library(sf);  con = dbConnect(odbc(), 'GISLibrary'); dbGetQuery(con, 'select 1 num'); dbDisconnect(con);". If I delay loading sf until after I?ve successfully made a connection with the FreeTDS driver I can continue to make connections.

I saw the recent post about breaking ABI changes in the Rcpp package, so I followed the instructions to re-install all packages that depend on Rcpp. That did not solve the problem.

Thanks,

Joey Reid

From @|mon@urb@nek @end|ng |rom R-project@org  Wed Aug 11 22:55:06 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 12 Aug 2021 08:55:06 +1200
Subject: [R-SIG-Mac] Can't make odbc FreeTDS connections in R.app,
 can with RStudio, /usr/local/bin/R, Rscript
In-Reply-To: <2C06C4AE-F0EF-47B8-A4FF-551DD8FF1790@mac.com>
References: <2C06C4AE-F0EF-47B8-A4FF-551DD8FF1790@mac.com>
Message-ID: <2FA7B954-DB9C-4AE3-B0CC-518AEABE6055@R-project.org>


Joey,

it is hard to say - it could be a bug in the driver. I would recommend using lldb to find the trace so you know where it happens - it would be anywhere from the odbc package, odbc library or the driver. If there is a difference, also check if you are loading the same versions of packages in each (cf .libPaths()) and which libraries are used. You could use JDBC with jTDS instead to see if that works better (or a native driver if it exists).

Cheers,
Simon



> On 12/08/2021, at 5:31 AM, Joey Reid via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> I?m experiencing some weirdness with database connections using R 4.1 on macOS 11.5.1 and the `odbc` package with the FreeTDS driver. I can replicate the problem on my coworker?s Mac with R 4.0 (macOS 11, not sure which version). 
> 
> Running this code works fine on the command line (or with RStudio, /usr/local/bin/R), /usr/local/bin/Rscript -e ?library(odbc); con = dbConnect(odbc(), 'GISLibrary'); dbGetQuery(con, ?select 1 num?); dbDisconnect(con)?
> 
> But the connection fails with the exact same code in R.app (I?ve tried R.app rev 7976 and 7982). I often get a segfault, like "address 0x7f975f481cb0, cause 'memory not mapped??. The connection works fine with the ODBC Driver 17 for SQL Server in all execution environments.
> 
> The connection also fails in some environments (rmarkdown::render, Rscript -e) if I load the package sf before making the first connection attempt, e.g., Rscript -e "library(odbc); library(sf);  con = dbConnect(odbc(), 'GISLibrary'); dbGetQuery(con, 'select 1 num'); dbDisconnect(con);". If I delay loading sf until after I?ve successfully made a connection with the FreeTDS driver I can continue to make connections.
> 
> I saw the recent post about breaking ABI changes in the Rcpp package, so I followed the instructions to re-install all packages that depend on Rcpp. That did not solve the problem.
> 
> Thanks,
> 
> Joey Reid
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From e|th @end|ng |rom norcere@e@rch@no  Fri Aug 13 15:42:12 2021
From: e|th @end|ng |rom norcere@e@rch@no (Eirik Thorsnes)
Date: Fri, 13 Aug 2021 13:42:12 +0000
Subject: [R-SIG-Mac] R pkg 4.1.1 no longer accepted as notarized by Apple
References: <f6f0e88d-c12f-4631-98af-0f6d03be384e.fa6dfdc9-15a0-4f78-ade3-dcb0570b0c9e.03dba4bc-c8d5-457e-b3e2-9e37261521b9@emailsignatures365.codetwo.com>
Message-ID: <OS4P279MB0338C3488867BB3B3FB544CCA9FA9@OS4P279MB0338.NORP279.PROD.OUTLOOK.COM>

Hi,

The R-4.1.1.pkg is not notarized:

% spctl -a -vvv -t install R-4.1.1.pkg
R-4.1.1.pkg: rejected
source=Unnotarized Developer ID
origin=Developer ID Installer: Simon Urbanek (VZLD955F6P)

Whereas 4.1.0 looks good:

% spctl -a -vvv -t install R-4.1.0.pkg
R-4.1.0.pkg: accepted
source=Notarized Developer ID
origin=Developer ID Installer: Simon Urbanek (VZLD955F6P)

Regards,
Eirik

[cid:norce_426cc920-64ab-4893-95d0-c29d5dab670c.png]

NORCE Norwegian Research Centre AS
norceresearch.no<https://www.norceresearch.no/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20210813/d0f45e27/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: norce_426cc920-64ab-4893-95d0-c29d5dab670c.png
Type: image/png
Size: 2503 bytes
Desc: norce_426cc920-64ab-4893-95d0-c29d5dab670c.png
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20210813/d0f45e27/attachment.png>

From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Sat Aug 14 08:17:46 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Sat, 14 Aug 2021 07:17:46 +0100
Subject: [R-SIG-Mac] 
 R pkg 4.1.1 no longer accepted as notarized by Apple
In-Reply-To: <OS4P279MB0338C3488867BB3B3FB544CCA9FA9@OS4P279MB0338.NORP279.PROD.OUTLOOK.COM>
References: <f6f0e88d-c12f-4631-98af-0f6d03be384e.fa6dfdc9-15a0-4f78-ade3-dcb0570b0c9e.03dba4bc-c8d5-457e-b3e2-9e37261521b9@emailsignatures365.codetwo.com>
 <OS4P279MB0338C3488867BB3B3FB544CCA9FA9@OS4P279MB0338.NORP279.PROD.OUTLOOK.COM>
Message-ID: <752b77d9-3d15-72a5-a6f9-c4cf1a8eb965@stats.ox.ac.uk>

On 13/08/2021 14:42, Eirik Thorsnes wrote:
> Hi,
> 
> The R-4.1.1.pkg is not notarized:

And that has been reported and Simon has fixed it (online, and an 
updated .pkg is on its way to the CRAN main site for those without 
Internet access).  I was able to install the original .pkg on Thursday 
(but not Weds) and now get

% spctl -a -vvv -t install R-4.1.1.pkg
R-4.1.1.pkg: accepted
source=Notarized Developer ID


> 
> % spctl -a -vvv -t install R-4.1.1.pkg
> 
> R-4.1.1.pkg: rejected
> 
> source=Unnotarized Developer ID
> 
> origin=Developer ID Installer: Simon Urbanek (VZLD955F6P)
> 
> Whereas 4.1.0 looks good:
> 
> % spctl -a -vvv -t install R-4.1.0.pkg
> 
> R-4.1.0.pkg: accepted
> 
> source=Notarized Developer ID
> 
> origin=Developer ID Installer: Simon Urbanek (VZLD955F6P)
> 
> Regards,
> 
> Eirik
> 
> NORCE Norwegian Research Centre AS
> norceresearch.no <https://www.norceresearch.no/>



-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From @|mon@urb@nek @end|ng |rom R-project@org  Sat Aug 14 22:07:27 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Sun, 15 Aug 2021 08:07:27 +1200
Subject: [R-SIG-Mac] R 4.1.1 installer Apple notarization
Message-ID: <F051EFA1-A887-4C54-B7AE-0CD33E2DE4EF@R-project.org>


The R 4.1.1 package installers have not been notarized when first released, however, the notarization has been completed after the release. The notarization receipts have been then added to the packages, so the most current releases have the following hashes:

MD5:MD5(base/R-4.1.1.pkg)= 0e9684e8fc9c8a5eda675aef99c6a6ee
MD5:MD5(big-sur-arm64/base/R-4.1.1-arm64.pkg)= f7a249c9a4b5f32efbfd44b821a6a846

SHA1:SHA1(base/R-4.1.1.pkg)= d0eed7d0755bc80911acb616508d41e1396f810e
SHA1:SHA1(big-sur-arm64/base/R-4.1.1-arm64.pkg)= e58f4b78f9e4d347a12cc9160ee69d3d23e69f3b

You can check your download for the receipt by comparing the hash above. The actual contents of the released packages are identical, they only vary by the absence or presence of the notarization receipt which allows off-line notarization check. If in doubt, you can always download from http://mac.R-project.org/bin/macosx which has always the latest version.

If you use the files without receipts from Aug 10, they will install since the package itself was notarized, but you will need internet connection to allow installer to pull the notarization receipt from Apple.

Cheers,
Simon


From he||yj @end|ng |rom uc@d@edu  Sun Aug 15 04:43:51 2021
From: he||yj @end|ng |rom uc@d@edu (John Helly)
Date: Sat, 14 Aug 2021 16:43:51 -1000
Subject: [R-SIG-Mac] R.app spontaneously switching windows during editing
Message-ID: <0af0fb87-63ea-f5b3-e978-7a59f02f1c27@ucsd.edu>

Aloha.

Apparently since I switched to Big Sur, R has begun spontaneously 
switching the active window from console to editor back and forth for no 
obvious reason.? This disrupts editing and has almost destroyed whole 
editing files due to the deletion of highlighted lines (a different 
behavior that has always been dangerous but is exacerbated by the 
window-switching).

I've looked at the default settings in the Preferences and can't see or 
change anything that seems to affect this behavior. I've tried turning 
off everything that might be doing it (e.g., matching delimiters) and I 
can't find anything or anyone else that complains about this. Am I the 
only one?

Any suggestions for debugging this would be welcome.? sessionInfo below.

J. Helly.

-- John Helly, University of California, San Diego / San Diego 
Supercomputer Center / Scripps Institution of Oceanography / 760 840 
8660 mobile / http://www.sdsc.edu/~hellyj ORCID ID: 
orcid.org/0000-0002-3779-0603



 > sessionInfo()
R version 4.1.0 (2021-05-18)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 11.4

Matrix products: default
BLAS: 
/Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
LAPACK: 
/Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods base

other attached packages:
 ?[1] Hmisc_4.5-0????? Formula_1.2-4??? survival_3.2-11 lattice_0.20-44? 
runner_0.4.0???? GGally_2.1.2 rpart.plot_3.0.9
 ?[8] rpart_4.1-15???? stargazer_5.2.2? texreg_1.37.5 factoextra_1.0.7 
forcats_0.5.1??? stringr_1.4.0??? dplyr_1.0.6
[15] purrr_0.3.4????? readr_1.4.0????? tidyr_1.1.3 tibble_3.1.2???? 
tidyverse_1.3.1? tables_0.9.6???? reshape2_1.4.4
[22] plyr_1.8.6?????? ggplot2_3.3.5

loaded via a namespace (and not attached):
 ?[1] fs_1.5.0??????????? lubridate_1.7.10??? RColorBrewer_1.1-2 
httr_1.4.2????????? tools_4.1.0???????? backports_1.2.1
 ?[7] utf8_1.2.1????????? R6_2.5.0??????????? DBI_1.1.1 
colorspace_2.0-1??? nnet_7.3-16???????? withr_2.4.2
[13] tidyselect_1.1.1??? gridExtra_2.3?????? curl_4.3.1 
compiler_4.1.0????? cli_2.5.0?????????? rvest_1.0.0
[19] htmlTable_2.2.1???? xml2_1.3.2????????? labeling_0.4.2 
scales_1.1.1??????? checkmate_2.0.0???? digest_0.6.27
[25] foreign_0.8-81????? rio_0.5.27????????? base64enc_0.1-3 
jpeg_0.1-8.1??????? pkgconfig_2.0.3???? htmltools_0.5.1.1
[31] dbplyr_2.1.1??????? htmlwidgets_1.5.3?? rlang_0.4.11 
readxl_1.3.1??????? rstudioapi_0.13???? generics_0.1.0
[37] farver_2.1.0??????? jsonlite_1.7.2????? zip_2.2.0 
car_3.0-11????????? magrittr_2.0.1????? Matrix_1.3-3
[43] Rcpp_1.0.6????????? munsell_0.5.0?????? fansi_0.5.0 
abind_1.4-5???????? lifecycle_1.0.0???? stringi_1.6.2
[49] carData_3.0-4?????? grid_4.1.0????????? parallel_4.1.0 
ggrepel_0.9.1?????? crayon_1.4.1??????? haven_2.4.1
[55] splines_4.1.0?????? hms_1.1.0?????????? knitr_1.33 
ps_1.6.0??????????? pillar_1.6.1??????? ggpubr_0.4.0
[61] ggsignif_0.6.2????? reprex_2.0.0??????? glue_1.4.2 
latticeExtra_0.6-29 data.table_1.14.0?? modelr_0.1.8
[67] png_0.1-7?????????? vctrs_0.3.8???????? cellranger_1.1.0 
gtable_0.3.0??????? reshape_0.8.8?????? assertthat_0.2.1
[73] openxlsx_4.2.4????? xfun_0.23?????????? broom_0.7.6 
rstatix_0.7.0?????? cluster_2.1.2?????? ellipsis_0.3.2
 >

-- 
John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / http://www.sdsc.edu/~hellyj
ORCID ID: orcid.org/0000-0002-3779-0603


	[[alternative HTML version deleted]]


From phii m@iii@g oii phiiipsmith@c@  Sun Aug 15 16:04:28 2021
From: phii m@iii@g oii phiiipsmith@c@ (phii m@iii@g oii phiiipsmith@c@)
Date: Sun, 15 Aug 2021 10:04:28 -0400
Subject: [R-SIG-Mac] Difficulties with R-Studio
Message-ID: <cf15ada7d9581b91651e10ca460b49a7@philipsmith.ca>

I use the R-Studio app, Version 1.4.1103, for my R programming work on 
macOS Big Sur version 11.5. I find that the app switches from one window 
to another (within the app) sometimes, without a request that it do so. 
Sometimes I work for a long session and this does not occur, but at 
other times it does, yet I cannot find an explanation.  I had the same 
problem with previous versions of R. The problem is annoying, but the 
app is so good I have been putting up with it.

Do others face the same problem? I suppose it is likely an issue within 
R-Studio, since it does not occur with any other app. But is there 
anything I can do in my macOS configuration to solve the problem?

Philip


From c@@rd|@g@bor @end|ng |rom gm@||@com  Sun Aug 15 16:54:03 2021
From: c@@rd|@g@bor @end|ng |rom gm@||@com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Sun, 15 Aug 2021 16:54:03 +0200
Subject: [R-SIG-Mac] Difficulties with R-Studio
In-Reply-To: <cf15ada7d9581b91651e10ca460b49a7@philipsmith.ca>
References: <cf15ada7d9581b91651e10ca460b49a7@philipsmith.ca>
Message-ID: <CABtg=KkPJJVB3-dbP9h=VbTjy-xKnmLYhWNd5=c_M6vbewMiqw@mail.gmail.com>

This has never happened to me (except when I touch the touchpad
accidentally :), so unfortunately I don't have an answer, just some
tips.

RStudio has an online forum. If you don't get an answer here in a
couple of days, you might want to try to ask your question there:
https://community.rstudio.com/

You can try the latest daily build from https://dailies.rstudio.com/

RStudio has an API that R code (including R packages) can use to
switch panels. Is it possible that you are using some R package that
does that?

Gabor

On Sun, Aug 15, 2021 at 4:04 PM <phil at philipsmith.ca> wrote:
>
> I use the R-Studio app, Version 1.4.1103, for my R programming work on
> macOS Big Sur version 11.5. I find that the app switches from one window
> to another (within the app) sometimes, without a request that it do so.
> Sometimes I work for a long session and this does not occur, but at
> other times it does, yet I cannot find an explanation.  I had the same
> problem with previous versions of R. The problem is annoying, but the
> app is so good I have been putting up with it.
>
> Do others face the same problem? I suppose it is likely an issue within
> R-Studio, since it does not occur with any other app. But is there
> anything I can do in my macOS configuration to solve the problem?
>
> Philip
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From @|mon@urb@nek @end|ng |rom R-project@org  Sun Aug 15 21:45:52 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 16 Aug 2021 07:45:52 +1200
Subject: [R-SIG-Mac] 
 R.app spontaneously switching windows during editing
In-Reply-To: <0af0fb87-63ea-f5b3-e978-7a59f02f1c27@ucsd.edu>
References: <0af0fb87-63ea-f5b3-e978-7a59f02f1c27@ucsd.edu>
Message-ID: <9940179D-16F2-4523-9F5A-EA5B7B23A3DE@R-project.org>


John,

Thank you for the report. We have not changed anything recently so it's likely some odd behaviour by the macOS. I'll try to reproduce and will get back to you.

Cheers,
Simon



> On Aug 15, 2021, at 14:43, John Helly via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> Aloha.
> 
> Apparently since I switched to Big Sur, R has begun spontaneously 
> switching the active window from console to editor back and forth for no 
> obvious reason.  This disrupts editing and has almost destroyed whole 
> editing files due to the deletion of highlighted lines (a different 
> behavior that has always been dangerous but is exacerbated by the 
> window-switching).
> 
> I've looked at the default settings in the Preferences and can't see or 
> change anything that seems to affect this behavior. I've tried turning 
> off everything that might be doing it (e.g., matching delimiters) and I 
> can't find anything or anyone else that complains about this. Am I the 
> only one?
> 
> Any suggestions for debugging this would be welcome.  sessionInfo below.
> 
> J. Helly.
> 
> -- John Helly, University of California, San Diego / San Diego 
> Supercomputer Center / Scripps Institution of Oceanography / 760 840 
> 8660 mobile / http://www.sdsc.edu/~hellyj ORCID ID: 
> orcid.org/0000-0002-3779-0603
> 
> 
> 
>> sessionInfo()
> R version 4.1.0 (2021-05-18)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 11.4
> 
> Matrix products: default
> BLAS: 
> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
> LAPACK: 
> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods base
> 
> other attached packages:
>  [1] Hmisc_4.5-0      Formula_1.2-4    survival_3.2-11 lattice_0.20-44  
> runner_0.4.0     GGally_2.1.2 rpart.plot_3.0.9
>  [8] rpart_4.1-15     stargazer_5.2.2  texreg_1.37.5 factoextra_1.0.7 
> forcats_0.5.1    stringr_1.4.0    dplyr_1.0.6
> [15] purrr_0.3.4      readr_1.4.0      tidyr_1.1.3 tibble_3.1.2     
> tidyverse_1.3.1  tables_0.9.6     reshape2_1.4.4
> [22] plyr_1.8.6       ggplot2_3.3.5
> 
> loaded via a namespace (and not attached):
>  [1] fs_1.5.0            lubridate_1.7.10    RColorBrewer_1.1-2 
> httr_1.4.2          tools_4.1.0         backports_1.2.1
>  [7] utf8_1.2.1          R6_2.5.0            DBI_1.1.1 
> colorspace_2.0-1    nnet_7.3-16         withr_2.4.2
> [13] tidyselect_1.1.1    gridExtra_2.3       curl_4.3.1 
> compiler_4.1.0      cli_2.5.0           rvest_1.0.0
> [19] htmlTable_2.2.1     xml2_1.3.2          labeling_0.4.2 
> scales_1.1.1        checkmate_2.0.0     digest_0.6.27
> [25] foreign_0.8-81      rio_0.5.27          base64enc_0.1-3 
> jpeg_0.1-8.1        pkgconfig_2.0.3     htmltools_0.5.1.1
> [31] dbplyr_2.1.1        htmlwidgets_1.5.3   rlang_0.4.11 
> readxl_1.3.1        rstudioapi_0.13     generics_0.1.0
> [37] farver_2.1.0        jsonlite_1.7.2      zip_2.2.0 
> car_3.0-11          magrittr_2.0.1      Matrix_1.3-3
> [43] Rcpp_1.0.6          munsell_0.5.0       fansi_0.5.0 
> abind_1.4-5         lifecycle_1.0.0     stringi_1.6.2
> [49] carData_3.0-4       grid_4.1.0          parallel_4.1.0 
> ggrepel_0.9.1       crayon_1.4.1        haven_2.4.1
> [55] splines_4.1.0       hms_1.1.0           knitr_1.33 
> ps_1.6.0            pillar_1.6.1        ggpubr_0.4.0
> [61] ggsignif_0.6.2      reprex_2.0.0        glue_1.4.2 
> latticeExtra_0.6-29 data.table_1.14.0   modelr_0.1.8
> [67] png_0.1-7           vctrs_0.3.8         cellranger_1.1.0 
> gtable_0.3.0        reshape_0.8.8       assertthat_0.2.1
> [73] openxlsx_4.2.4      xfun_0.23           broom_0.7.6 
> rstatix_0.7.0       cluster_2.1.2       ellipsis_0.3.2
>> 
> 
> -- 
> John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / http://www.sdsc.edu/~hellyj
> ORCID ID: orcid.org/0000-0002-3779-0603
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From @|mon@urb@nek @end|ng |rom R-project@org  Mon Aug 16 03:49:34 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 16 Aug 2021 13:49:34 +1200
Subject: [R-SIG-Mac] 
 R.app spontaneously switching windows during editing
In-Reply-To: <9940179D-16F2-4523-9F5A-EA5B7B23A3DE@R-project.org>
References: <0af0fb87-63ea-f5b3-e978-7a59f02f1c27@ucsd.edu>
 <9940179D-16F2-4523-9F5A-EA5B7B23A3DE@R-project.org>
Message-ID: <4EAFB80E-E363-4D16-B2B7-2DB43744B891@R-project.org>


John,

I tried to reproduce on macOS 11.4, but failed to so far. Can you send us the details on your setup, e.g., is this a MacBook or a mini etc? Also what exactly is the sequence - i.e. what were you doing and what happened?

One thing I noted, however, is that if you use a trackpad have tap-to-click enabled, it's amazingly easy to accidentally click on another windows while you're typing on MacBooks since your hands are hovering very close to the touch pad. To see if that makes a difference, disable the tap-to-click in the trackpad system preferences.

FWIW the behavior in the text editing is defined by Apple and the OS, so things like replacing the selection are UI standards by Apple. You can always use Undo in case you select and replace something inadvertently.

Thanks,
Simon



> On 16/08/2021, at 7:45 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
> 
> John,
> 
> Thank you for the report. We have not changed anything recently so it's likely some odd behaviour by the macOS. I'll try to reproduce and will get back to you.
> 
> Cheers,
> Simon
> 
> 
> 
>> On Aug 15, 2021, at 14:43, John Helly via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> 
>> Aloha.
>> 
>> Apparently since I switched to Big Sur, R has begun spontaneously 
>> switching the active window from console to editor back and forth for no 
>> obvious reason.  This disrupts editing and has almost destroyed whole 
>> editing files due to the deletion of highlighted lines (a different 
>> behavior that has always been dangerous but is exacerbated by the 
>> window-switching).
>> 
>> I've looked at the default settings in the Preferences and can't see or 
>> change anything that seems to affect this behavior. I've tried turning 
>> off everything that might be doing it (e.g., matching delimiters) and I 
>> can't find anything or anyone else that complains about this. Am I the 
>> only one?
>> 
>> Any suggestions for debugging this would be welcome.  sessionInfo below.
>> 
>> J. Helly.
>> 
>> -- John Helly, University of California, San Diego / San Diego 
>> Supercomputer Center / Scripps Institution of Oceanography / 760 840 
>> 8660 mobile / http://www.sdsc.edu/~hellyj ORCID ID: 
>> orcid.org/0000-0002-3779-0603
>> 
>> 
>> 
>>> sessionInfo()
>> R version 4.1.0 (2021-05-18)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Big Sur 11.4
>> 
>> Matrix products: default
>> BLAS: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
>> LAPACK: 
>> /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods base
>> 
>> other attached packages:
>> [1] Hmisc_4.5-0      Formula_1.2-4    survival_3.2-11 lattice_0.20-44  
>> runner_0.4.0     GGally_2.1.2 rpart.plot_3.0.9
>> [8] rpart_4.1-15     stargazer_5.2.2  texreg_1.37.5 factoextra_1.0.7 
>> forcats_0.5.1    stringr_1.4.0    dplyr_1.0.6
>> [15] purrr_0.3.4      readr_1.4.0      tidyr_1.1.3 tibble_3.1.2     
>> tidyverse_1.3.1  tables_0.9.6     reshape2_1.4.4
>> [22] plyr_1.8.6       ggplot2_3.3.5
>> 
>> loaded via a namespace (and not attached):
>> [1] fs_1.5.0            lubridate_1.7.10    RColorBrewer_1.1-2 
>> httr_1.4.2          tools_4.1.0         backports_1.2.1
>> [7] utf8_1.2.1          R6_2.5.0            DBI_1.1.1 
>> colorspace_2.0-1    nnet_7.3-16         withr_2.4.2
>> [13] tidyselect_1.1.1    gridExtra_2.3       curl_4.3.1 
>> compiler_4.1.0      cli_2.5.0           rvest_1.0.0
>> [19] htmlTable_2.2.1     xml2_1.3.2          labeling_0.4.2 
>> scales_1.1.1        checkmate_2.0.0     digest_0.6.27
>> [25] foreign_0.8-81      rio_0.5.27          base64enc_0.1-3 
>> jpeg_0.1-8.1        pkgconfig_2.0.3     htmltools_0.5.1.1
>> [31] dbplyr_2.1.1        htmlwidgets_1.5.3   rlang_0.4.11 
>> readxl_1.3.1        rstudioapi_0.13     generics_0.1.0
>> [37] farver_2.1.0        jsonlite_1.7.2      zip_2.2.0 
>> car_3.0-11          magrittr_2.0.1      Matrix_1.3-3
>> [43] Rcpp_1.0.6          munsell_0.5.0       fansi_0.5.0 
>> abind_1.4-5         lifecycle_1.0.0     stringi_1.6.2
>> [49] carData_3.0-4       grid_4.1.0          parallel_4.1.0 
>> ggrepel_0.9.1       crayon_1.4.1        haven_2.4.1
>> [55] splines_4.1.0       hms_1.1.0           knitr_1.33 
>> ps_1.6.0            pillar_1.6.1        ggpubr_0.4.0
>> [61] ggsignif_0.6.2      reprex_2.0.0        glue_1.4.2 
>> latticeExtra_0.6-29 data.table_1.14.0   modelr_0.1.8
>> [67] png_0.1-7           vctrs_0.3.8         cellranger_1.1.0 
>> gtable_0.3.0        reshape_0.8.8       assertthat_0.2.1
>> [73] openxlsx_4.2.4      xfun_0.23           broom_0.7.6 
>> rstatix_0.7.0       cluster_2.1.2       ellipsis_0.3.2
>>> 
>> 
>> -- 
>> John Helly, University of California, San Diego / San Diego Supercomputer Center / Scripps Institution of Oceanography / 760 840 8660 mobile / http://www.sdsc.edu/~hellyj
>> ORCID ID: orcid.org/0000-0002-3779-0603
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From dw|n@em|u@ @end|ng |rom comc@@t@net  Mon Aug 16 07:19:56 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Sun, 15 Aug 2021 22:19:56 -0700
Subject: [R-SIG-Mac] Difficulties with R-Studio
In-Reply-To: <CABtg=KkPJJVB3-dbP9h=VbTjy-xKnmLYhWNd5=c_M6vbewMiqw@mail.gmail.com>
References: <CABtg=KkPJJVB3-dbP9h=VbTjy-xKnmLYhWNd5=c_M6vbewMiqw@mail.gmail.com>
Message-ID: <E3F4D6DA-C4E0-429E-8929-92875C727F44@comcast.net>

Happens to me all the time on a Linux installation using Rstudio.   There?s some sort of mouse action that pulls up a screen to do something with the xml or http substrate of the IDE. The R.app IDE is much less unpredictable. 

? 
David. 

Sent from my iPhone

> On Aug 15, 2021, at 7:54 AM, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> 
> ?This has never happened to me (except when I touch the touchpad
> accidentally :), so unfortunately I don't have an answer, just some
> tips.
> 
> RStudio has an online forum. If you don't get an answer here in a
> couple of days, you might want to try to ask your question there:
> https://community.rstudio.com/
> 
> You can try the latest daily build from https://dailies.rstudio.com/
> 
> RStudio has an API that R code (including R packages) can use to
> switch panels. Is it possible that you are using some R package that
> does that?
> 
> Gabor
> 
>> On Sun, Aug 15, 2021 at 4:04 PM <phil at philipsmith.ca> wrote:
>> 
>> I use the R-Studio app, Version 1.4.1103, for my R programming work on
>> macOS Big Sur version 11.5. I find that the app switches from one window
>> to another (within the app) sometimes, without a request that it do so.
>> Sometimes I work for a long session and this does not occur, but at
>> other times it does, yet I cannot find an explanation.  I had the same
>> problem with previous versions of R. The problem is annoying, but the
>> app is so good I have been putting up with it.
>> 
>> Do others face the same problem? I suppose it is likely an issue within
>> R-Studio, since it does not occur with any other app. But is there
>> anything I can do in my macOS configuration to solve the problem?
>> 
>> Philip
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From c|ement|kent @end|ng |rom gm@||@com  Sat Aug 14 20:22:43 2021
From: c|ement|kent @end|ng |rom gm@||@com (Clement Kent)
Date: Sat, 14 Aug 2021 14:22:43 -0400
Subject: [R-SIG-Mac] R-4.1.1-arm64.pkg (notarized and signed) not recognized
 as notarized
Message-ID: <CAK8G+nArKYLcc9UAb8pFdqGg2hBPF0UM1=igy2Wx5K5LdsO6SQ@mail.gmail.com>

Probably same cause as previously reported "[R-SIG-Mac] R pkg 4.1.1 no
longer accepted as notarized by Apple
<https://stat.ethz.ch/pipermail/r-sig-mac/2021-August/014139.html>".

I'm on Big Sur 11.4, MacBook Pro 13" with M1 chip. The arm64.pkg sha-1 was
ok after download today, XQuartz is newly installed, but got
"*?R-4.1.1-arm64.pkg?
can?t be opened because Apple cannot check it for malicious software."*

*Cheers,*
*Clement Kent*



*Clement Kent, Ph.D.*
*Adjunct Professor, Dept. of Biology*
*York University, Canada*

*https://biology.gradstudies.yorku.ca/faculty/clement-kent/
<https://biology.gradstudies.yorku.ca/faculty/clement-kent/>*

	[[alternative HTML version deleted]]


From rmh @end|ng |rom temp|e@edu  Thu Aug 19 05:56:56 2021
From: rmh @end|ng |rom temp|e@edu (Richard M. Heiberger)
Date: Thu, 19 Aug 2021 03:56:56 +0000
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
Message-ID: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>

 R version 4.1.1 Patched (2021-08-13 r80752)
 aarch64-apple-darwin20        

> library(rgl)
Error in dyn.load(dynlib <- getDynlib(dir)) : 
  unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
  dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
  Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
  Expected in: flat namespace
 in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so


From mbennun @end|ng |rom pred@c|@com  Thu Aug 19 00:52:49 2021
From: mbennun @end|ng |rom pred@c|@com (Michal Ben-Nun)
Date: Wed, 18 Aug 2021 15:52:49 -0700
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
Message-ID: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>

Hi,

I installed R 4.10 on my Mac OS 11.3.1

I am trying to install 'sf' and 'rgdal'

From the mailing list I understood that this command should work:

install.packages(c("rgdal","sf"),,"https://mac.R-project.org
<https://mac.r-project.org/>")

However I am still getting an error, see below.

Any suggestions would be welcome.

Thanks,
Michal

p.s. I am using macports NOT brew

> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
Installing packages into ?/Users/michal/Library/R/x86_64/4.1/library?
(as ?lib? is unspecified)
trying URL 'https://mac.R-project.org/src/contrib/rgdal_1.5-23.tar.gz'
Content type 'application/octet-stream' length 4393536 bytes (4.2 MB)
==================================================
downloaded 4.2 MB

trying URL 'https://mac.R-project.org/src/contrib/sf_1.0-2.tar.gz'
Content type 'application/octet-stream' length 3645982 bytes (3.5 MB)
==================================================
downloaded 3.5 MB

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
** using staged installation
configure: R_HOME: /opt/local/Library/Frameworks/R.framework/Resources
configure: CC: /opt/local/bin/clang-mp-12
configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++14
configure: CFLAGS: -pipe -Os
-isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
configure: CPPFLAGS: -I/opt/local/include
-isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
configure: CXXFLAGS: -pipe -Os -stdlib=libc++
-isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
-Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
x86_64
configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
-Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
x86_64
configure: CXX11 is: /opt/local/bin/clang++-mp-12, CXX11STD is: -std=gnu++11
configure: CXX is: /opt/local/bin/clang++-mp-12 -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.5-23
checking for /usr/bin/svnversion... no
configure: svn revision: 1121
checking for gdal-config... /opt/local/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.3.0
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking GDAL: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /opt/local/share/gdal/stateplane.csv readable... yes
configure: pkg-config proj not available
  set PKG_CONFIG_PATH to the directory containing proj.pc
configure: PROJ version not determined using pkg-config proj
configure: PROJ CPP flags:  -I/opt/local/include
configure: PROJ LIBS:  -lproj
checking PROJ header API:... yes
configure: API to be used as yet undetermined, searching ...
configure: error: API to be used not found
ERROR: configuration failed for package ?rgdal?
* removing ?/Users/michal/Library/R/x86_64/4.1/library/rgdal?
* installing *source* package ?sf? ...
** package ?sf? successfully unpacked and MD5 sums checked
** using staged installation
configure: CC: /opt/local/bin/clang-mp-12
configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++11
checking for gdal-config... /opt/local/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.3.0
checking GDAL version >= 2.0.1... yes
checking for gcc... /opt/local/bin/clang-mp-12
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether /opt/local/bin/clang-mp-12 accepts -g... yes
checking for /opt/local/bin/clang-mp-12 option to accept ISO C89... none
needed
checking how to run the C preprocessor... /opt/local/bin/clang-mp-12 -E
checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking gdal.h usability... yes
checking gdal.h presence... yes
checking for gdal.h... yes
checking GDAL: linking with --libs only... yes
checking GDAL: /opt/local/share/gdal/pcs.csv readable... no
checking GDAL: checking whether PROJ is available for linking:... yes
checking GDAL: checking whether PROJ is available fur running:... yes
configure: GDAL: 3.3.0
checking proj.h usability... no
checking proj.h presence... no
checking for proj.h... no
checking proj_api.h usability... no
checking proj_api.h presence... no
checking for proj_api.h... no
configure: error: proj_api.h not found in standard or given locations.
ERROR: configuration failed for package ?sf?
* removing ?/Users/michal/Library/R/x86_64/4.1/library/sf?

The downloaded source packages are in
?/private/var/folders/07/47hs0f_j187393z5drwshbm00000gn/T/RtmpsD9V5a/downloaded_packages?
Warning messages:
1: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
  installation of package ?rgdal? had non-zero exit status
2: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
  installation of package ?sf? had non-zero exit status

	[[alternative HTML version deleted]]


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Aug 19 08:19:59 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 19 Aug 2021 18:19:59 +1200
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>
References: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>
Message-ID: <4E76C39B-7FCA-467D-B8BF-7D62866144AB@R-project.org>


Michal,

those instructions work for released CRAN R. Apparently, that's not what you are using - if you want to compile sf and gdal from sources, that is more challenging and you have to install all its dependencies first. In the output below you're missing at the very least the PROJ4/6 library - it may not be the only thing you're missing, so make sure you read the errors and install all necessary dependencies.

Cheers,
Simon



> On Aug 19, 2021, at 10:52 AM, Michal Ben-Nun <mbennun at predsci.com> wrote:
> 
> Hi,
> 
> I installed R 4.10 on my Mac OS 11.3.1
> 
> I am trying to install 'sf' and 'rgdal'
> 
> From the mailing list I understood that this command should work:
> 
> install.packages(c("rgdal","sf"),,"https://mac.R-project.org
> <https://mac.r-project.org/>")
> 
> However I am still getting an error, see below.
> 
> Any suggestions would be welcome.
> 
> Thanks,
> Michal
> 
> p.s. I am using macports NOT brew
> 
>> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
> Installing packages into ?/Users/michal/Library/R/x86_64/4.1/library?
> (as ?lib? is unspecified)
> trying URL 'https://mac.R-project.org/src/contrib/rgdal_1.5-23.tar.gz'
> Content type 'application/octet-stream' length 4393536 bytes (4.2 MB)
> ==================================================
> downloaded 4.2 MB
> 
> trying URL 'https://mac.R-project.org/src/contrib/sf_1.0-2.tar.gz'
> Content type 'application/octet-stream' length 3645982 bytes (3.5 MB)
> ==================================================
> downloaded 3.5 MB
> 
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /opt/local/Library/Frameworks/R.framework/Resources
> configure: CC: /opt/local/bin/clang-mp-12
> configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++14
> configure: CFLAGS: -pipe -Os
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
> configure: CPPFLAGS: -I/opt/local/include
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
> configure: CXXFLAGS: -pipe -Os -stdlib=libc++
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
> configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> configure: CXX11 is: /opt/local/bin/clang++-mp-12, CXX11STD is: -std=gnu++11
> configure: CXX is: /opt/local/bin/clang++-mp-12 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-23
> checking for /usr/bin/svnversion... no
> configure: svn revision: 1121
> checking for gdal-config... /opt/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.3.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /opt/local/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj not available
>  set PKG_CONFIG_PATH to the directory containing proj.pc
> configure: PROJ version not determined using pkg-config proj
> configure: PROJ CPP flags:  -I/opt/local/include
> configure: PROJ LIBS:  -lproj
> checking PROJ header API:... yes
> configure: API to be used as yet undetermined, searching ...
> configure: error: API to be used not found
> ERROR: configuration failed for package ?rgdal?
> * removing ?/Users/michal/Library/R/x86_64/4.1/library/rgdal?
> * installing *source* package ?sf? ...
> ** package ?sf? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: CC: /opt/local/bin/clang-mp-12
> configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++11
> checking for gdal-config... /opt/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.3.0
> checking GDAL version >= 2.0.1... yes
> checking for gcc... /opt/local/bin/clang-mp-12
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether /opt/local/bin/clang-mp-12 accepts -g... yes
> checking for /opt/local/bin/clang-mp-12 option to accept ISO C89... none
> needed
> checking how to run the C preprocessor... /opt/local/bin/clang-mp-12 -E
> checking for grep that handles long lines and -e... /usr/bin/grep
> checking for egrep... /usr/bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking gdal.h usability... yes
> checking gdal.h presence... yes
> checking for gdal.h... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: /opt/local/share/gdal/pcs.csv readable... no
> checking GDAL: checking whether PROJ is available for linking:... yes
> checking GDAL: checking whether PROJ is available fur running:... yes
> configure: GDAL: 3.3.0
> checking proj.h usability... no
> checking proj.h presence... no
> checking for proj.h... no
> checking proj_api.h usability... no
> checking proj_api.h presence... no
> checking for proj_api.h... no
> configure: error: proj_api.h not found in standard or given locations.
> ERROR: configuration failed for package ?sf?
> * removing ?/Users/michal/Library/R/x86_64/4.1/library/sf?
> 
> The downloaded source packages are in
> ?/private/var/folders/07/47hs0f_j187393z5drwshbm00000gn/T/RtmpsD9V5a/downloaded_packages?
> Warning messages:
> 1: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
>  installation of package ?rgdal? had non-zero exit status
> 2: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
>  installation of package ?sf? had non-zero exit status
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Aug 19 08:28:40 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 19 Aug 2021 07:28:40 +0100
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>
References: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>
Message-ID: <048c9bd2-445f-3dee-324b-11c1a6ac27a0@stats.ox.ac.uk>

On 18/08/2021 23:52, Michal Ben-Nun wrote:
> Hi,
> 
> I installed R 4.10 on my Mac OS 11.3.1

Presumably R 4.1.0.
> 
> I am trying to install 'sf' and 'rgdal'
> 
>>From the mailing list I understood that this command should work:
> 
> install.packages(c("rgdal","sf"),,"https://mac.R-project.org
> <https://mac.r-project.org/>")
> 
> However I am still getting an error, see below.
> 
> Any suggestions would be welcome.
> 
> Thanks,
> Michal
> 
> p.s. I am using macports NOT brew

Asking on R-sig-geo would be appropriate as macports/Homebrew are 
generic Unix-alike systems.

Hint: rgdal has

SystemRequirements: PROJ (>= 4.8.0, https://proj.org/download.html) and 
GDAL (>= 1.11.4, https://gdal.org/download.html), with versions either 
(A) PROJ < 6 and GDAL < 3 or (B) PROJ >= 6 and GDAL >= 3.

and it seems you have not installed PROJ



> 
>> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
> Installing packages into ?/Users/michal/Library/R/x86_64/4.1/library?
> (as ?lib? is unspecified)
> trying URL 'https://mac.R-project.org/src/contrib/rgdal_1.5-23.tar.gz'
> Content type 'application/octet-stream' length 4393536 bytes (4.2 MB)
> ==================================================
> downloaded 4.2 MB
> 
> trying URL 'https://mac.R-project.org/src/contrib/sf_1.0-2.tar.gz'
> Content type 'application/octet-stream' length 3645982 bytes (3.5 MB)
> ==================================================
> downloaded 3.5 MB
> 
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /opt/local/Library/Frameworks/R.framework/Resources
> configure: CC: /opt/local/bin/clang-mp-12
> configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++14
> configure: CFLAGS: -pipe -Os
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
> configure: CPPFLAGS: -I/opt/local/include
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
> configure: CXXFLAGS: -pipe -Os -stdlib=libc++
> -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch x86_64
> configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> configure: CXX11 is: /opt/local/bin/clang++-mp-12, CXX11STD is: -std=gnu++11
> configure: CXX is: /opt/local/bin/clang++-mp-12 -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-23
> checking for /usr/bin/svnversion... no
> configure: svn revision: 1121
> checking for gdal-config... /opt/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.3.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /opt/local/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj not available
>    set PKG_CONFIG_PATH to the directory containing proj.pc
> configure: PROJ version not determined using pkg-config proj
> configure: PROJ CPP flags:  -I/opt/local/include
> configure: PROJ LIBS:  -lproj
> checking PROJ header API:... yes
> configure: API to be used as yet undetermined, searching ...
> configure: error: API to be used not found
> ERROR: configuration failed for package ?rgdal?
> * removing ?/Users/michal/Library/R/x86_64/4.1/library/rgdal?
> * installing *source* package ?sf? ...
> ** package ?sf? successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: CC: /opt/local/bin/clang-mp-12
> configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++11
> checking for gdal-config... /opt/local/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.3.0
> checking GDAL version >= 2.0.1... yes
> checking for gcc... /opt/local/bin/clang-mp-12
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether /opt/local/bin/clang-mp-12 accepts -g... yes
> checking for /opt/local/bin/clang-mp-12 option to accept ISO C89... none
> needed
> checking how to run the C preprocessor... /opt/local/bin/clang-mp-12 -E
> checking for grep that handles long lines and -e... /usr/bin/grep
> checking for egrep... /usr/bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking gdal.h usability... yes
> checking gdal.h presence... yes
> checking for gdal.h... yes
> checking GDAL: linking with --libs only... yes
> checking GDAL: /opt/local/share/gdal/pcs.csv readable... no
> checking GDAL: checking whether PROJ is available for linking:... yes
> checking GDAL: checking whether PROJ is available fur running:... yes
> configure: GDAL: 3.3.0
> checking proj.h usability... no
> checking proj.h presence... no
> checking for proj.h... no
> checking proj_api.h usability... no
> checking proj_api.h presence... no
> checking for proj_api.h... no
> configure: error: proj_api.h not found in standard or given locations.
> ERROR: configuration failed for package ?sf?
> * removing ?/Users/michal/Library/R/x86_64/4.1/library/sf?
> 
> The downloaded source packages are in
> ?/private/var/folders/07/47hs0f_j187393z5drwshbm00000gn/T/RtmpsD9V5a/downloaded_packages?
> Warning messages:
> 1: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
>    installation of package ?rgdal? had non-zero exit status
> 2: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org") :
>    installation of package ?sf? had non-zero exit status
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Aug 19 10:36:18 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 19 Aug 2021 09:36:18 +0100
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
Message-ID: <4d8c37cf-42b3-2dda-b3de-9dc7aa3dda5f@stats.ox.ac.uk>

On 19/08/2021 04:56, Richard M. Heiberger wrote:
>   R version 4.1.1 Patched (2021-08-13 r80752)
>   aarch64-apple-darwin20
> 
>> library(rgl)
> Error in dyn.load(dynlib <- getDynlib(dir)) :
>    unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>    dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>    Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>    Expected in: flat namespace
>   in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so

This is short of details: where did you get that R from and how did you 
install rgl?

My best guess is that that the CRAN binary package needs rebuilding (and 
maybe others that use freetype2).  It seems that rgl does not itself 
link to libfreetype2, and in recent builds that depends on libharfbuzz 
(my guess being that 4.1.0 was not using such a build. 4.1.1 is).

A source-package install would probably work if you get the libs needed 
from https://mac.r-project.org/libs-arm64/.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Aug 19 10:40:44 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 19 Aug 2021 04:40:44 -0400
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
Message-ID: <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>

s
On 18/08/2021 11:56 p.m., Richard M. Heiberger wrote:
>   R version 4.1.1 Patched (2021-08-13 r80752)
>   aarch64-apple-darwin20
> 
>> library(rgl)
> Error in dyn.load(dynlib <- getDynlib(dir)) :
>    unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>    dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>    Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>    Expected in: flat namespace
>   in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so

That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it 
directly, I think FreeType does.  I don't know what you need to do to 
fix this, but maybe that's enough of a hint.

Duncan Murdoch


From @te|@nML @end|ng |rom co||oc@t|on@@de  Thu Aug 19 11:54:47 2021
From: @te|@nML @end|ng |rom co||oc@t|on@@de (Stefan Evert)
Date: Thu, 19 Aug 2021 11:54:47 +0200
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
Message-ID: <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>



> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>   unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>   dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>   Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>   Expected in: flat namespace
>>  in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
> 
> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.

I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz. 

XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?

Best,
Stefan

From @|mon@urb@nek @end|ng |rom R-project@org  Fri Aug 20 00:08:34 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 20 Aug 2021 10:08:34 +1200
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
Message-ID: <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>


R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.

The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html

pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:

$ pkg-config freetype2 --libs
-L/opt/R/arm64/lib -lfreetype 

$ pkg-config freetype2 --static --libs
-L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre 

The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
It looks line rgl does the right thing for libpng but not for freetype.

Cheers,
Simon



> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
> 
> 
> 
>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> 
>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>  unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>  dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>  Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>  Expected in: flat namespace
>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>> 
>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
> 
> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz. 
> 
> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
> 
> Best,
> Stefan
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Aug 20 01:43:46 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 19 Aug 2021 19:43:46 -0400
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
 <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
Message-ID: <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>

Thanks Simon (and Prof Ripley, offline).  The --static modifier needs to 
be added in two places in configure.ac, which leads to it being added in 
two places in configure.

If anyone wants to build from source, you could get the CRAN release 
plus this modification using

   remotes::install_github("dmurdoch/rgl at configpatch")

Duncan Murdoch


On 19/08/2021 6:08 p.m., Simon Urbanek wrote:
> R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.
> 
> The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
> https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html
> 
> pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:
> 
> $ pkg-config freetype2 --libs
> -L/opt/R/arm64/lib -lfreetype
> 
> $ pkg-config freetype2 --static --libs
> -L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre
> 
> The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
> It looks line rgl does the right thing for libpng but not for freetype.
> 
> Cheers,
> Simon
> 
> 
> 
>> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
>>
>>
>>
>>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>
>>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>>   unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>>   dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>>   Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>   Expected in: flat namespace
>>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>
>>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
>>
>> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz.
>>
>> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
>>
>> Best,
>> Stefan
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>


From @|mon@urb@nek @end|ng |rom R-project@org  Fri Aug 20 02:57:32 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 20 Aug 2021 12:57:32 +1200
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
 <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
 <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>
Message-ID: <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>


Duncan,

using that checkout I get

* checking package dependencies ... ERROR
Package suggested but not available: ?webshot2?

but otherwise it works as advertised.

However, I just found out that there is another problem in R that rgl exposed. Using non-session terminal:

> png("/tmp/1.png", type="quartz")
> plot(1)
Warning in axis(side = side, at = at, labels = labels, ...) :
  no font could be found for family "Arial"

so requests for fonts using Quartz-back-end without an UI session fail. It works fine inside a session, but since checks are normally run without a session that explains the check failures. I can run checks in a session, so I think that's what I'll do for now.

Now, back to rgl - so checks can be run in a session, but oddly, rgl manages to segfault XQuartz in the checks. I don't think it's rgl's fault - more likely something in XQuartz (a TCP connection shouldn't be able to segfault the other end...).

Anyway, so if you can post the fixed release I'd be happy the recompile and publish manually.

Cheers,
Simon

PS: I found yet another problem - XQuartz has moved the location of fonts from X11/lib to X11/shared so our fontconfig configuration in R needs to add that directory as well. So all is all this has highlighted quite a few related issues ;)



> On Aug 20, 2021, at 11:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> Thanks Simon (and Prof Ripley, offline).  The --static modifier needs to be added in two places in configure.ac, which leads to it being added in two places in configure.
> 
> If anyone wants to build from source, you could get the CRAN release plus this modification using
> 
>  remotes::install_github("dmurdoch/rgl at configpatch")
> 
> Duncan Murdoch
> 
> 
> On 19/08/2021 6:08 p.m., Simon Urbanek wrote:
>> R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.
>> The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
>> https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html
>> pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:
>> $ pkg-config freetype2 --libs
>> -L/opt/R/arm64/lib -lfreetype
>> $ pkg-config freetype2 --static --libs
>> -L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre
>> The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
>> It looks line rgl does the right thing for libpng but not for freetype.
>> Cheers,
>> Simon
>>> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
>>> 
>>> 
>>> 
>>>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>> 
>>>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>>>  unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>>>  dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>>>  Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>  Expected in: flat namespace
>>>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>> 
>>>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
>>> 
>>> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz.
>>> 
>>> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
>>> 
>>> Best,
>>> Stefan
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
> 


From murdoch@dunc@n @end|ng |rom gm@||@com  Fri Aug 20 14:05:17 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Fri, 20 Aug 2021 08:05:17 -0400
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
 <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
 <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>
 <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>
Message-ID: <8d3c4daf-0fa7-632c-b24c-1d248c4cb7cd@gmail.com>

On 19/08/2021 8:57 p.m., Simon Urbanek wrote:
> Duncan,
> 
> using that checkout I get
> 
> * checking package dependencies ... ERROR
> Package suggested but not available: ?webshot2?

webshot2 still hasn't been sent to CRAN, so I've been putting tarballs 
on a Drat repos, and the DESCRIPTION has this:

   Additional_repositories:  https://dmurdoch.github.io/drat

Do you know if your check looked in that repos and didn't see it, or did 
it not look there?

BTW, the reason I am including a non-CRAN package is because it has 
several advantages over the internal rgl.snapshot.  rgl.snapshot 
requires that the scene be displayed on a local screen so it can't run 
on a headless machine; it also uses the very old rendering built in to 
rgl's in-R display, so typically produces poorer quality screenshots 
than webshot2 produces.  The main disadvantages of webshot2 are that 
it's not on CRAN and it's typically quite a bit slower than rgl.snapshot.

> 
> but otherwise it works as advertised.
> 
> However, I just found out that there is another problem in R that rgl exposed. Using non-session terminal:
> 
>> png("/tmp/1.png", type="quartz")
>> plot(1)
> Warning in axis(side = side, at = at, labels = labels, ...) :
>    no font could be found for family "Arial"
> 
> so requests for fonts using Quartz-back-end without an UI session fail. It works fine inside a session, but since checks are normally run without a session that explains the check failures. I can run checks in a session, so I think that's what I'll do for now.
> 
> Now, back to rgl - so checks can be run in a session, but oddly, rgl manages to segfault XQuartz in the checks. I don't think it's rgl's fault - more likely something in XQuartz (a TCP connection shouldn't be able to segfault the other end...).

I don't have an ARM machine to test on, but on my machine when running 
in lldb I see messages like these on startup:

2021-08-20 08:00:26.791865-0400 R[79608:1971631] flock failed to lock 
maps file: errno = 35
2021-08-20 08:00:26.796823-0400 R[79608:1971631] flock failed to lock 
maps file: errno = 35

and when I actually do some plotting I see lots like these:

2021-08-20 08:00:47.459884-0400 R[79608:1971542] 
apple_glx_create_context: ac 0x100a99830 ac->context_obj 0x106f4ea00
2021-08-20 08:00:47.460043-0400 R[79608:1971542] 
apple_glx_drawable_create: new drawable 0x103363e00
2021-08-20 08:00:47.461620-0400 R[79608:1971542] create_surface: created 
a surface for drawable 0x600067 with uid 49
2021-08-20 08:00:47.461657-0400 R[79608:1971542] surface_make_current: 
ac->context_obj 0x106f4ea00 s->surface_id 9
2021-08-20 08:00:47.462172-0400 R[79608:1971542] surface_make_current: 
drawable 0x600067
2021-08-20 08:00:47.462203-0400 R[79608:1971542] applegl_bind_context: 
error NO
2021-08-20 08:00:47.469827-0400 R[79608:1971542] caller is the same 
thread for uid 49
2021-08-20 08:00:47.470001-0400 R[79608:1971542] surface notify updated 0
2021-08-20 08:00:47.470340-0400 R[79608:1971542] caller is the same 
thread for uid 49

They don't seem to lead to any problems, but maybe on an ARM they're 
more serious.



> 
> Anyway, so if you can post the fixed release I'd be happy the recompile and publish manually.

Okay, I'll package it up and send it to CRAN.

Duncan Murdoch

> 
> Cheers,
> Simon
> 
> PS: I found yet another problem - XQuartz has moved the location of fonts from X11/lib to X11/shared so our fontconfig configuration in R needs to add that directory as well. So all is all this has highlighted quite a few related issues ;)
> 
> 
> 
>> On Aug 20, 2021, at 11:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> Thanks Simon (and Prof Ripley, offline).  The --static modifier needs to be added in two places in configure.ac, which leads to it being added in two places in configure.
>>
>> If anyone wants to build from source, you could get the CRAN release plus this modification using
>>
>>   remotes::install_github("dmurdoch/rgl at configpatch")
>>
>> Duncan Murdoch
>>
>>
>> On 19/08/2021 6:08 p.m., Simon Urbanek wrote:
>>> R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.
>>> The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
>>> https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html
>>> pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:
>>> $ pkg-config freetype2 --libs
>>> -L/opt/R/arm64/lib -lfreetype
>>> $ pkg-config freetype2 --static --libs
>>> -L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre
>>> The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
>>> It looks line rgl does the right thing for libpng but not for freetype.
>>> Cheers,
>>> Simon
>>>> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
>>>>
>>>>
>>>>
>>>>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>
>>>>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>>>>   unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>>>>   dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>>>>   Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>>   Expected in: flat namespace
>>>>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>
>>>>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
>>>>
>>>> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz.
>>>>
>>>> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
>>>>
>>>> Best,
>>>> Stefan
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>
>>
>


From mbennun @end|ng |rom pred@c|@com  Thu Aug 19 18:32:29 2021
From: mbennun @end|ng |rom pred@c|@com (Michal Ben-Nun)
Date: Thu, 19 Aug 2021 09:32:29 -0700
Subject: [R-SIG-Mac] sf installation problem under Mac OS 11 - Big Sur
In-Reply-To: <4E76C39B-7FCA-467D-B8BF-7D62866144AB@R-project.org>
References: <CAMY0nH5vH6LEfP3FF56BTHbjkNTXtbKqK2308jTw2CZ+DEUy=w@mail.gmail.com>
 <4E76C39B-7FCA-467D-B8BF-7D62866144AB@R-project.org>
Message-ID: <CAMY0nH534+u_V3G=CmFr0neDOSPz39uLY_pnNR7vb9=TpKncuw@mail.gmail.com>

I was able to install the packages after setting the environment
variable PKG_CONFIG_PATH to the location of proj.pc


On Wed, Aug 18, 2021 at 11:20 PM Simon Urbanek <simon.urbanek at r-project.org>
wrote:

> Michal,
>
> those instructions work for released CRAN R. Apparently, that's not what
> you are using - if you want to compile sf and gdal from sources, that is
> more challenging and you have to install all its dependencies first. In the
> output below you're missing at the very least the PROJ4/6 library - it may
> not be the only thing you're missing, so make sure you read the errors and
> install all necessary dependencies.
>
> Cheers,
> Simon
>
>
>
> > On Aug 19, 2021, at 10:52 AM, Michal Ben-Nun <mbennun at predsci.com>
> wrote:
> >
> > Hi,
> >
> > I installed R 4.10 on my Mac OS 11.3.1
> >
> > I am trying to install 'sf' and 'rgdal'
> >
> > From the mailing list I understood that this command should work:
> >
> > install.packages(c("rgdal","sf"),,"https://mac.R-project.org
> > <https://mac.r-project.org/>")
> >
> > However I am still getting an error, see below.
> >
> > Any suggestions would be welcome.
> >
> > Thanks,
> > Michal
> >
> > p.s. I am using macports NOT brew
> >
> >> install.packages(c("rgdal","sf"),,"https://mac.R-project.org")
> > Installing packages into ?/Users/michal/Library/R/x86_64/4.1/library?
> > (as ?lib? is unspecified)
> > trying URL 'https://mac.R-project.org/src/contrib/rgdal_1.5-23.tar.gz'
> > Content type 'application/octet-stream' length 4393536 bytes (4.2 MB)
> > ==================================================
> > downloaded 4.2 MB
> >
> > trying URL 'https://mac.R-project.org/src/contrib/sf_1.0-2.tar.gz'
> > Content type 'application/octet-stream' length 3645982 bytes (3.5 MB)
> > ==================================================
> > downloaded 3.5 MB
> >
> > * installing *source* package ?rgdal? ...
> > ** package ?rgdal? successfully unpacked and MD5 sums checked
> > ** using staged installation
> > configure: R_HOME: /opt/local/Library/Frameworks/R.framework/Resources
> > configure: CC: /opt/local/bin/clang-mp-12
> > configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++14
> > configure: CFLAGS: -pipe -Os
> > -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> > configure: CPPFLAGS: -I/opt/local/include
> > -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
> > configure: CXXFLAGS: -pipe -Os -stdlib=libc++
> > -isysroot/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk -arch
> x86_64
> > configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> > -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
> -arch
> > x86_64
> > configure: LDFLAGS: -L/opt/local/lib -Wl,-headerpad_max_install_names
> > -Wl,-syslibroot,/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk
> -arch
> > x86_64
> > configure: CXX11 is: /opt/local/bin/clang++-mp-12, CXX11STD is:
> -std=gnu++11
> > configure: CXX is: /opt/local/bin/clang++-mp-12 -std=gnu++11
> > configure: C++11 support available
> > configure: rgdal: 1.5-23
> > checking for /usr/bin/svnversion... no
> > configure: svn revision: 1121
> > checking for gdal-config... /opt/local/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 3.3.0
> > checking GDAL version >= 1.11.4... yes
> > checking GDAL version <= 2.5 or >= 3.0... yes
> > checking GDAL: linking with --libs only... yes
> > checking GDAL: gdal-config data directory readable... yes
> > checking GDAL: /opt/local/share/gdal/stateplane.csv readable... yes
> > configure: pkg-config proj not available
> >  set PKG_CONFIG_PATH to the directory containing proj.pc
> > configure: PROJ version not determined using pkg-config proj
> > configure: PROJ CPP flags:  -I/opt/local/include
> > configure: PROJ LIBS:  -lproj
> > checking PROJ header API:... yes
> > configure: API to be used as yet undetermined, searching ...
> > configure: error: API to be used not found
> > ERROR: configuration failed for package ?rgdal?
> > * removing ?/Users/michal/Library/R/x86_64/4.1/library/rgdal?
> > * installing *source* package ?sf? ...
> > ** package ?sf? successfully unpacked and MD5 sums checked
> > ** using staged installation
> > configure: CC: /opt/local/bin/clang-mp-12
> > configure: CXX: /opt/local/bin/clang++-mp-12 -std=gnu++11
> > checking for gdal-config... /opt/local/bin/gdal-config
> > checking gdal-config usability... yes
> > configure: GDAL: 3.3.0
> > checking GDAL version >= 2.0.1... yes
> > checking for gcc... /opt/local/bin/clang-mp-12
> > checking whether the C compiler works... yes
> > checking for C compiler default output file name... a.out
> > checking for suffix of executables...
> > checking whether we are cross compiling... no
> > checking for suffix of object files... o
> > checking whether we are using the GNU C compiler... yes
> > checking whether /opt/local/bin/clang-mp-12 accepts -g... yes
> > checking for /opt/local/bin/clang-mp-12 option to accept ISO C89... none
> > needed
> > checking how to run the C preprocessor... /opt/local/bin/clang-mp-12 -E
> > checking for grep that handles long lines and -e... /usr/bin/grep
> > checking for egrep... /usr/bin/grep -E
> > checking for ANSI C header files... yes
> > checking for sys/types.h... yes
> > checking for sys/stat.h... yes
> > checking for stdlib.h... yes
> > checking for string.h... yes
> > checking for memory.h... yes
> > checking for strings.h... yes
> > checking for inttypes.h... yes
> > checking for stdint.h... yes
> > checking for unistd.h... yes
> > checking gdal.h usability... yes
> > checking gdal.h presence... yes
> > checking for gdal.h... yes
> > checking GDAL: linking with --libs only... yes
> > checking GDAL: /opt/local/share/gdal/pcs.csv readable... no
> > checking GDAL: checking whether PROJ is available for linking:... yes
> > checking GDAL: checking whether PROJ is available fur running:... yes
> > configure: GDAL: 3.3.0
> > checking proj.h usability... no
> > checking proj.h presence... no
> > checking for proj.h... no
> > checking proj_api.h usability... no
> > checking proj_api.h presence... no
> > checking for proj_api.h... no
> > configure: error: proj_api.h not found in standard or given locations.
> > ERROR: configuration failed for package ?sf?
> > * removing ?/Users/michal/Library/R/x86_64/4.1/library/sf?
> >
> > The downloaded source packages are in
> >
> ?/private/var/folders/07/47hs0f_j187393z5drwshbm00000gn/T/RtmpsD9V5a/downloaded_packages?
> > Warning messages:
> > 1: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org")
> :
> >  installation of package ?rgdal? had non-zero exit status
> > 2: In install.packages(c("rgdal", "sf"), , "https://mac.R-project.org")
> :
> >  installation of package ?sf? had non-zero exit status
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >
>
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sat Aug 21 18:28:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sat, 21 Aug 2021 12:28:03 -0400
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
 <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
 <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>
 <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>
Message-ID: <f386dba1-6621-e736-164f-f4390bf5b0c3@gmail.com>

The rgl patch was accepted by CRAN an hour ago, so you should see it soon.

Duncan Murdoch

On 19/08/2021 8:57 p.m., Simon Urbanek wrote:
> Duncan,
> 
> using that checkout I get
> 
> * checking package dependencies ... ERROR
> Package suggested but not available: ?webshot2?
> 
> but otherwise it works as advertised.
> 
> However, I just found out that there is another problem in R that rgl exposed. Using non-session terminal:
> 
>> png("/tmp/1.png", type="quartz")
>> plot(1)
> Warning in axis(side = side, at = at, labels = labels, ...) :
>    no font could be found for family "Arial"
> 
> so requests for fonts using Quartz-back-end without an UI session fail. It works fine inside a session, but since checks are normally run without a session that explains the check failures. I can run checks in a session, so I think that's what I'll do for now.
> 
> Now, back to rgl - so checks can be run in a session, but oddly, rgl manages to segfault XQuartz in the checks. I don't think it's rgl's fault - more likely something in XQuartz (a TCP connection shouldn't be able to segfault the other end...).
> 
> Anyway, so if you can post the fixed release I'd be happy the recompile and publish manually.
> 
> Cheers,
> Simon
> 
> PS: I found yet another problem - XQuartz has moved the location of fonts from X11/lib to X11/shared so our fontconfig configuration in R needs to add that directory as well. So all is all this has highlighted quite a few related issues ;)
> 
> 
> 
>> On Aug 20, 2021, at 11:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>> Thanks Simon (and Prof Ripley, offline).  The --static modifier needs to be added in two places in configure.ac, which leads to it being added in two places in configure.
>>
>> If anyone wants to build from source, you could get the CRAN release plus this modification using
>>
>>   remotes::install_github("dmurdoch/rgl at configpatch")
>>
>> Duncan Murdoch
>>
>>
>> On 19/08/2021 6:08 p.m., Simon Urbanek wrote:
>>> R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.
>>> The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
>>> https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html
>>> pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:
>>> $ pkg-config freetype2 --libs
>>> -L/opt/R/arm64/lib -lfreetype
>>> $ pkg-config freetype2 --static --libs
>>> -L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre
>>> The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
>>> It looks line rgl does the right thing for libpng but not for freetype.
>>> Cheers,
>>> Simon
>>>> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
>>>>
>>>>
>>>>
>>>>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>
>>>>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>>>>   unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>>>>   dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>>>>   Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>>   Expected in: flat namespace
>>>>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>
>>>>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
>>>>
>>>> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz.
>>>>
>>>> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
>>>>
>>>> Best,
>>>> Stefan
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>
>>
>


From @|mon@urb@nek @end|ng |rom R-project@org  Sun Aug 22 04:26:00 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Sun, 22 Aug 2021 14:26:00 +1200
Subject: [R-SIG-Mac] rgl in R version 4.1.1 Patched (2021-08-13 r80752)
In-Reply-To: <f386dba1-6621-e736-164f-f4390bf5b0c3@gmail.com>
References: <4E569115-B7FA-4AAB-AC21-822B225D564B@temple.edu>
 <672d8751-a71b-ffa2-2cf9-e11b34d55422@gmail.com>
 <0055CDE6-4624-4C18-B6B2-E8E6A9ECBB23@collocations.de>
 <8DF6882A-050E-40EE-81CF-DDACEA071F09@R-project.org>
 <761864b5-c106-6517-7bb0-7c03fc70b8d6@gmail.com>
 <C2918D8A-FF4B-4E51-9CEE-3427DF1D8183@R-project.org>
 <f386dba1-6621-e736-164f-f4390bf5b0c3@gmail.com>
Message-ID: <B73968EE-5A06-4B04-98BC-2306BA0C0896@R-project.org>


Duncan,

thanks, update received and it did pass checks on M1 so the binary is now on CRAN.

Thanks,
Simon


> On Aug 22, 2021, at 4:28 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
> The rgl patch was accepted by CRAN an hour ago, so you should see it soon.
> 
> Duncan Murdoch
> 
> On 19/08/2021 8:57 p.m., Simon Urbanek wrote:
>> Duncan,
>> using that checkout I get
>> * checking package dependencies ... ERROR
>> Package suggested but not available: ?webshot2?
>> but otherwise it works as advertised.
>> However, I just found out that there is another problem in R that rgl exposed. Using non-session terminal:
>>> png("/tmp/1.png", type="quartz")
>>> plot(1)
>> Warning in axis(side = side, at = at, labels = labels, ...) :
>>   no font could be found for family "Arial"
>> so requests for fonts using Quartz-back-end without an UI session fail. It works fine inside a session, but since checks are normally run without a session that explains the check failures. I can run checks in a session, so I think that's what I'll do for now.
>> Now, back to rgl - so checks can be run in a session, but oddly, rgl manages to segfault XQuartz in the checks. I don't think it's rgl's fault - more likely something in XQuartz (a TCP connection shouldn't be able to segfault the other end...).
>> Anyway, so if you can post the fixed release I'd be happy the recompile and publish manually.
>> Cheers,
>> Simon
>> PS: I found yet another problem - XQuartz has moved the location of fonts from X11/lib to X11/shared so our fontconfig configuration in R needs to add that directory as well. So all is all this has highlighted quite a few related issues ;)
>>> On Aug 20, 2021, at 11:43 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>> Thanks Simon (and Prof Ripley, offline).  The --static modifier needs to be added in two places in configure.ac, which leads to it being added in two places in configure.
>>> 
>>> If anyone wants to build from source, you could get the CRAN release plus this modification using
>>> 
>>>  remotes::install_github("dmurdoch/rgl at configpatch")
>>> 
>>> Duncan Murdoch
>>> 
>>> 
>>> On 19/08/2021 6:08 p.m., Simon Urbanek wrote:
>>>> R (and the CRAN builds) use more recent static freetype with harfbuzz support so it does not depend for those in XQuartz.
>>>> The issue is that rgl doesn't use sufficient flags to compile against freetype since it misses the dependencies - in fact is fails checks,
>>>> https://www.r-project.org/nosvn/R.check/r-release-macos-arm64/rgl-00check.html
>>>> pkg-config has to be used with --static --libs otherwise the linking doesn't have all the dependencies included that are necessary:
>>>> $ pkg-config freetype2 --libs
>>>> -L/opt/R/arm64/lib -lfreetype
>>>> $ pkg-config freetype2 --static --libs
>>>> -L/opt/R/arm64/lib -lfreetype -lbz2 -lpng16 -lz -lharfbuzz -lm -lglib-2.0 -lintl -liconv -lm -Wl,-framework,CoreFoundation -Wl,-framework,Carbon -Wl,-framework,Foundation -Wl,-framework,AppKit -lpcre
>>>> The CRAN binaries are built against static libraries to make sure the user doesn't have to install 3rd party dependencies.
>>>> It looks line rgl does the right thing for libpng but not for freetype.
>>>> Cheers,
>>>> Simon
>>>>> On Aug 19, 2021, at 9:54 PM, Stefan Evert <stefanML at collocations.de> wrote:
>>>>> 
>>>>> 
>>>>> 
>>>>>> On 19 Aug 2021, at 10:40, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>>> 
>>>>>>> Error in dyn.load(dynlib <- getDynlib(dir)) :
>>>>>>>  unable to load shared object '/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so':
>>>>>>>  dlopen(/Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so, 6): Symbol not found: _hb_buffer_add_utf8
>>>>>>>  Referenced from: /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>>>  Expected in: flat namespace
>>>>>>> in /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library/rgl/libs/rgl.so
>>>>>> 
>>>>>> That looks like a symbol in the harfbuzz lib.  rgl doesn't reference it directly, I think FreeType does.  I don't know what you need to do to fix this, but maybe that's enough of a hint.
>>>>> 
>>>>> I just ran into the same problem with a M1 MacBook and XQuartz 2.8.1 installed.  My MacBook has no developer tools installed, not even XCode ? just R, "rgl" (and various other packages) from CRAN, and XQuartz.
>>>>> 
>>>>> XQuartz doesn't include libharfbuzz, so I doubt that it's libfreetype depends on it.  Any chance that the CRAN machine that builds the aarch64 binary package links against some other version of freetype that pulls in the dependency?
>>>>> 
>>>>> Best,
>>>>> Stefan
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>> 
>>> 
> 


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Fri Aug 27 09:41:25 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Fri, 27 Aug 2021 08:41:25 +0100
Subject: [R-SIG-Mac] sessionInfo on Monterey
Message-ID: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>

One oddity is that the CRAN Intel binary build of R (or any other built 
under 10.x) when run on Big Sur reports

 > sessionInfo()
R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16
...

because the system call used reports '10.16'.

If anyone running a beta of Monterey has the CRAN binary installed, for 
completeness I would appreciate seeing what is reported.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From j@n @end|ng |rom de|eeuwpdx@net  Fri Aug 27 20:25:34 2021
From: j@n @end|ng |rom de|eeuwpdx@net (Jan de Leeuw)
Date: Fri, 27 Aug 2021 11:25:34 -0700
Subject: [R-SIG-Mac] R-SIG-Mac Digest, Vol 221, Issue 14
In-Reply-To: <mailman.14374.3.1630058401.54830.r-sig-mac@r-project.org>
References: <mailman.14374.3.1630058401.54830.r-sig-mac@r-project.org>
Message-ID: <252614B3-D3AB-4FE8-81CE-8129D7930216@deleeuwpdx.net>

OS

System Version:	macOS 12.0 (21A5304g)
Kernel Version:	Darwin 21.0.0

sessionInfo (CRAN binary)

R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16


> On Aug 27, 2021, at 03:00, r-sig-mac-request at r-project.org wrote:
> 
> sessionInfo on Monterey (Prof Brian Ripley)

------------------------------------------------------------------
Jan de Leeuw, Distinguished Professor Emeritus, UCLA Statistics 
https://jansweb.netlify.app ******** https://github.com/deleeuw
------------------------------------------------------------------
Remember, no matter where you go, there you are. (Buckaroo Banzai)












	[[alternative HTML version deleted]]


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Fri Aug 27 20:55:01 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Fri, 27 Aug 2021 19:55:01 +0100
Subject: [R-SIG-Mac] R-SIG-Mac Digest, Vol 221, Issue 14
In-Reply-To: <252614B3-D3AB-4FE8-81CE-8129D7930216@deleeuwpdx.net>
References: <mailman.14374.3.1630058401.54830.r-sig-mac@r-project.org>
 <252614B3-D3AB-4FE8-81CE-8129D7930216@deleeuwpdx.net>
Message-ID: <f2870789-a0dd-4ac7-c27e-55433bb912a4@stats.ox.ac.uk>

On 27/08/2021 19:25, Jan de Leeuw wrote:
> OS
> 
> System Version:	macOS 12.0 (21A5304g)
> Kernel Version:	Darwin 21.0.0
> 
> sessionInfo (CRAN binary)
> 
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16

Thanks.

> 
> 
>> On Aug 27, 2021, at 03:00, r-sig-mac-request at r-project.org wrote:
>>
>> sessionInfo on Monterey (Prof Brian Ripley)
> 
> ------------------------------------------------------------------
> Jan de Leeuw, Distinguished Professor Emeritus, UCLA Statistics
> https://jansweb.netlify.app ******** https://github.com/deleeuw
> ------------------------------------------------------------------
> Remember, no matter where you go, there you are. (Buckaroo Banzai)
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From bob @end|ng |rom rud@|@  Sat Aug 28 08:00:17 2021
From: bob @end|ng |rom rud@|@ (Bob Rudis)
Date: Sat, 28 Aug 2021 02:00:17 -0400
Subject: [R-SIG-Mac] sessionInfo on Monterey
In-Reply-To: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>
References: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>
Message-ID: <CAA-FpKUth=gqyVNSM6tRoLhmavjWz29aVAFJyToE1RibzEpXmg@mail.gmail.com>

arm64:

R version 4.1.1 Patched (2021-08-13 r80752)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Monterey 12.0


x86_64:

R version 4.1.1 Patched (2021-08-10 r80733)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

On Fri, Aug 27, 2021 at 3:42 AM Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>
> One oddity is that the CRAN Intel binary build of R (or any other built
> under 10.x) when run on Big Sur reports
>
>  > sessionInfo()
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> ...
>
> because the system call used reports '10.16'.
>
> If anyone running a beta of Monterey has the CRAN binary installed, for
> completeness I would appreciate seeing what is reported.
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Emeritus Professor of Applied Statistics, University of Oxford
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From pd@|gd @end|ng |rom gm@||@com  Sat Aug 28 14:36:56 2021
From: pd@|gd @end|ng |rom gm@||@com (peter dalgaard)
Date: Sat, 28 Aug 2021 14:36:56 +0200
Subject: [R-SIG-Mac] sessionInfo on Monterey
In-Reply-To: <CAA-FpKUth=gqyVNSM6tRoLhmavjWz29aVAFJyToE1RibzEpXmg@mail.gmail.com>
References: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>
 <CAA-FpKUth=gqyVNSM6tRoLhmavjWz29aVAFJyToE1RibzEpXmg@mail.gmail.com>
Message-ID: <8F1C4689-E7F7-42A5-B6F7-6D1C97E3F789@gmail.com>

Odd indeed. A local build of mine has

> sessionInfo()
R version 4.1.0 Patched (2021-05-25 r80389)
Platform: x86_64-apple-darwin20.5.0 (64-bit)
Running under: macOS Big Sur 11.5.2

(Obvsly not up-to-the minute, and my build tools are likely not either on this machine...)

- pd

> On 28 Aug 2021, at 08:00 , Bob Rudis <bob at rud.is> wrote:
> 
> arm64:
> 
> R version 4.1.1 Patched (2021-08-13 r80752)
> Platform: aarch64-apple-darwin20 (64-bit)
> Running under: macOS Monterey 12.0
> 
> 
> x86_64:
> 
> R version 4.1.1 Patched (2021-08-10 r80733)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> On Fri, Aug 27, 2021 at 3:42 AM Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>> 
>> One oddity is that the CRAN Intel binary build of R (or any other built
>> under 10.x) when run on Big Sur reports
>> 
>>> sessionInfo()
>> R version 4.1.1 (2021-08-10)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>> ...
>> 
>> because the system call used reports '10.16'.
>> 
>> If anyone running a beta of Monterey has the CRAN binary installed, for
>> completeness I would appreciate seeing what is reported.
>> 
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Emeritus Professor of Applied Statistics, University of Oxford
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From @pencer@gr@ve@ @end|ng |rom prod@y@e@com  Sat Aug 28 18:25:36 2021
From: @pencer@gr@ve@ @end|ng |rom prod@y@e@com (Spencer Graves)
Date: Sat, 28 Aug 2021 11:25:36 -0500
Subject: [R-SIG-Mac] sessionInfo on Monterey
In-Reply-To: <8F1C4689-E7F7-42A5-B6F7-6D1C97E3F789@gmail.com>
References: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>
 <CAA-FpKUth=gqyVNSM6tRoLhmavjWz29aVAFJyToE1RibzEpXmg@mail.gmail.com>
 <8F1C4689-E7F7-42A5-B6F7-6D1C97E3F789@gmail.com>
Message-ID: <97b6ce91-b5e2-f920-0bc8-52a7e9298054@prodsyse.com>

I updated yesterday to macOS Big Sur 11.5.2,


> sessionInfo()
R version 4.1.0 (2021-05-18)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16


I just upgraded to 4.1.1 with the same results:


 > sessionInfo()
R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16


	  Hope this helps.
	  Spencer Graves


On 8/28/21 7:36 AM, peter dalgaard wrote:
> Odd indeed. A local build of mine has
> 
>> sessionInfo()
> R version 4.1.0 Patched (2021-05-25 r80389)
> Platform: x86_64-apple-darwin20.5.0 (64-bit)
> Running under: macOS Big Sur 11.5.2
> 
> (Obvsly not up-to-the minute, and my build tools are likely not either on this machine...)
> 
> - pd
> 
>> On 28 Aug 2021, at 08:00 , Bob Rudis <bob at rud.is> wrote:
>>
>> arm64:
>>
>> R version 4.1.1 Patched (2021-08-13 r80752)
>> Platform: aarch64-apple-darwin20 (64-bit)
>> Running under: macOS Monterey 12.0
>>
>>
>> x86_64:
>>
>> R version 4.1.1 Patched (2021-08-10 r80733)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Big Sur 10.16
>>
>> On Fri, Aug 27, 2021 at 3:42 AM Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>>
>>> One oddity is that the CRAN Intel binary build of R (or any other built
>>> under 10.x) when run on Big Sur reports
>>>
>>>> sessionInfo()
>>> R version 4.1.1 (2021-08-10)
>>> Platform: x86_64-apple-darwin17.0 (64-bit)
>>> Running under: macOS Big Sur 10.16
>>> ...
>>>
>>> because the system call used reports '10.16'.
>>>
>>> If anyone running a beta of Monterey has the CRAN binary installed, for
>>> completeness I would appreciate seeing what is reported.
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Emeritus Professor of Applied Statistics, University of Oxford
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From bhh @end|ng |rom x@4@||@n|  Sat Aug 28 20:57:18 2021
From: bhh @end|ng |rom x@4@||@n| (Berend Hasselman)
Date: Sat, 28 Aug 2021 20:57:18 +0200
Subject: [R-SIG-Mac] sessionInfo on Monterey
In-Reply-To: <97b6ce91-b5e2-f920-0bc8-52a7e9298054@prodsyse.com>
References: <64da8d68-b296-6a26-1ce3-6c45d4859bc8@stats.ox.ac.uk>
 <CAA-FpKUth=gqyVNSM6tRoLhmavjWz29aVAFJyToE1RibzEpXmg@mail.gmail.com>
 <8F1C4689-E7F7-42A5-B6F7-6D1C97E3F789@gmail.com>
 <97b6ce91-b5e2-f920-0bc8-52a7e9298054@prodsyse.com>
Message-ID: <08F660D5-7CFF-483F-8322-63B201FC85C8@xs4all.nl>


Just now upgraded to macOS 11.5.2

> sessionInfo()

R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 11.5.2

Berend hasselman


> R version 4.1.0 (2021-05-18)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> 
> I just upgraded to 4.1.1 with the same results:
> 
> 
> > sessionInfo()
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Big Sur 10.16
> 
> 
> 	  Hope this helps.
> 	  Spencer Graves
> 
> 
> On 8/28/21 7:36 AM, peter dalgaard wrote:
>> Odd indeed. A local build of mine has
>>> sessionInfo()
>> R version 4.1.0 Patched (2021-05-25 r80389)
>> Platform: x86_64-apple-darwin20.5.0 (64-bit)
>> Running under: macOS Big Sur 11.5.2
>> (Obvsly not up-to-the minute, and my build tools are likely not either on this machine...)
>> - pd
>>> On 28 Aug 2021, at 08:00 , Bob Rudis <bob at rud.is> wrote:
>>> 
>>> arm64:
>>> 
>>> R version 4.1.1 Patched (2021-08-13 r80752)
>>> Platform: aarch64-apple-darwin20 (64-bit)
>>> Running under: macOS Monterey 12.0
>>> 
>>> 
>>> x86_64:
>>> 
>>> R version 4.1.1 Patched (2021-08-10 r80733)
>>> Platform: x86_64-apple-darwin17.0 (64-bit)
>>> Running under: macOS Big Sur 10.16
>>> 
>>> On Fri, Aug 27, 2021 at 3:42 AM Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>>> 
>>>> One oddity is that the CRAN Intel binary build of R (or any other built
>>>> under 10.x) when run on Big Sur reports
>>>> 
>>>>> sessionInfo()
>>>> R version 4.1.1 (2021-08-10)
>>>> Platform: x86_64-apple-darwin17.0 (64-bit)
>>>> Running under: macOS Big Sur 10.16
>>>> ...
>>>> 
>>>> because the system call used reports '10.16'.
>>>> 
>>>> If anyone running a beta of Monterey has the CRAN binary installed, for
>>>> completeness I would appreciate seeing what is reported.
>>>> 
>>>> --
>>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>>> Emeritus Professor of Applied Statistics, University of Oxford
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


