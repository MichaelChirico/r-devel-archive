From pohl.position at gmail.com  Tue Jul  1 22:59:44 2014
From: pohl.position at gmail.com (Jason Pohl)
Date: Tue, 1 Jul 2014 13:59:44 -0700
Subject: [R-SIG-Mac] Upgrading RCurl version to support sftp on Mac Mavericks
Message-ID: <FA5196BC-BA34-451B-9B0E-01A589462CF4@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140701/da6e680c/attachment.pl>

From gs at statlab.uni-heidelberg.de  Tue Jul  1 22:50:46 2014
From: gs at statlab.uni-heidelberg.de (G. Sawitzki)
Date: Tue, 01 Jul 2014 22:50:46 +0200
Subject: [R-SIG-Mac] How to move existing packages?
In-Reply-To: <F9A1FEDF-D953-4CBA-A0EB-D7608B2DEC66@r-project.org>
References: <F9A1FEDF-D953-4CBA-A0EB-D7608B2DEC66@r-project.org>
Message-ID: <53B31F26.4060009@statlab.uni-heidelberg.de>

This is a late follow up to
 <https://stat.ethz.ch/pipermail/r-sig-mac/2013-April/010045.html>

Is there a useful implementation to move existing packages?

This comes up if there is a new R release and you want your old
collection updated, but work on a system that does versioning (e.g. OS X).

The message referred above suggests to use the GUI Package Installer,
but at least on OS X this functionality does not exist.

On a command level, this might be implemeted as a variant of
update.packages() with an additional parameter old.lib.loc (or a changed
semantics for oldPkgs: get a list of packages from old.lib.loc, and
update these to lib.loc.

The design problem is that R does not keep a memory of where a package
has been installed. So an iteration over a list of repositories might be
needed.

   g.


-- 
G. Sawitzki
StatLab Heidelberg
Im Neuenheimer Feld 294
D 69120 Heidelberg
Tel. (+49) 62 21 - 54 89 79   Fax (+49) 62 21 - 54 53 31
    <http://www.statlab.uni-heidelberg.de/users/gs/>
GPG Fingerprint: FEA4 3F2A 88B2 2629 6CE2 0429 CC3C E49E D159 99AE


From dtemplelang at ucdavis.edu  Wed Jul  2 01:15:16 2014
From: dtemplelang at ucdavis.edu (Duncan Temple Lang)
Date: Tue, 01 Jul 2014 16:15:16 -0700
Subject: [R-SIG-Mac] Upgrading RCurl version to support sftp on Mac
	Mavericks
In-Reply-To: <FA5196BC-BA34-451B-9B0E-01A589462CF4@gmail.com>
References: <FA5196BC-BA34-451B-9B0E-01A589462CF4@gmail.com>
Message-ID: <53B34104.7030909@ucdavis.edu>

Hi Jason

After verifying curl --verion yields 7.37.0, did you re-install the
RCurl package? from the source tar.gz file?

 D.

On 7/1/14, 1:59 PM, Jason Pohl wrote:
> I want to use RCurl to do sftp requests. 
> 
> I installed the package and ran curlVersion().  It indicates version 7.30.0 and does not list "sftp" as one of the protocols. 
> 
> I installed homebrew and installed curl with ssh.  I also updated the symlinks so that /usr/bin/curl and /usr/bin/curl-config point to the newly installed package. 
> 
> When I run curl --version from the command prompt it indicates that the version is 7.37.0 and sftp IS a supported protocol.  However, when I run curlVersion() in R, it still indicates 7.30.0 
> 
> How do I get RCurl to leverage the newer version of curl? 
> 
> Mac OSX Mavericks 
> R Version 3.1.0 
> 
> 
> Cheers,
> 
> JP
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From dwinsemius at comcast.net  Wed Jul  2 08:39:21 2014
From: dwinsemius at comcast.net (David Winsemius)
Date: Tue, 1 Jul 2014 23:39:21 -0700
Subject: [R-SIG-Mac] How to move existing packages?
In-Reply-To: <53B31F26.4060009@statlab.uni-heidelberg.de>
References: <F9A1FEDF-D953-4CBA-A0EB-D7608B2DEC66@r-project.org>
	<53B31F26.4060009@statlab.uni-heidelberg.de>
Message-ID: <EC56ADF1-0ADB-4524-BF5B-A15017C658C6@comcast.net>


On Jul 1, 2014, at 1:50 PM, G. Sawitzki wrote:

> This is a late follow up to
> <https://stat.ethz.ch/pipermail/r-sig-mac/2013-April/010045.html>
> 
> Is there a useful implementation to move existing packages?
> 
> This comes up if there is a new R release and you want your old
> collection updated, but work on a system that does versioning (e.g. OS X).
> 
> The message referred above suggests to use the GUI Package Installer,
> but at least on OS X this functionality does not exist.

> On a command level, this might be implemeted as a variant of
> update.packages() with an additional parameter old.lib.loc (or a changed
> semantics for oldPkgs: get a list of packages from old.lib.loc, and
> update these to lib.loc.
> 
> The design problem is that R does not keep a memory of where a package
> has been installed. So an iteration over a list of repositories might be
> needed.

Not sure what the issue is, and I think your understanding of the library system may be inadequate. The example in that message was using the standard Frameworks location. If you needed to get a more expansive list of R libraries, then execute:

 .libPaths()

You could also point list.dirs() at an old ../../library/ or two to gather a list of folder names.

> all <- list.dirs("/Library/Frameworks/R.framework/Versions/3.1/Resources/library", recursive=FALSE, full.names=FALSE)
> all[1:10]
 [1] "A2R"        "abind"      "acepack"    "Acinonyx"   "actuar"     "ada"       
 [7] "adabag"     "ade4"       "adegenet"   "adehabitat"


It doesn't seem to be that difficult to iterate over the contents of that vector.


for (loc in .libPaths() ) {
   a=rownames(installed.packages(loc))
   install.packages(a[!(a %in% rownames(installed.packages()))])
                          }



-- 
David Winsemius
Alameda, CA, USA


From gs at statlab.uni-heidelberg.de  Wed Jul  2 11:13:24 2014
From: gs at statlab.uni-heidelberg.de (G. Sawitzki)
Date: Wed, 02 Jul 2014 11:13:24 +0200
Subject: [R-SIG-Mac] How to move existing packages?
In-Reply-To: <EC56ADF1-0ADB-4524-BF5B-A15017C658C6@comcast.net>
References: <F9A1FEDF-D953-4CBA-A0EB-D7608B2DEC66@r-project.org>
	<53B31F26.4060009@statlab.uni-heidelberg.de>
	<EC56ADF1-0ADB-4524-BF5B-A15017C658C6@comcast.net>
Message-ID: <53B3CD34.3050608@statlab.uni-heidelberg.de>

Currently for me, .libPaths() points to

"/Library/Frameworks/R.framework/Versions/3.1/Resources/library"

After the next update, it will point to some version 3.x

"/Library/Frameworks/R.framework/Versions/3.x/Resources/library"

The libraries I am using are still in 3.1. The new 3.x will only hold
the standard libraries. I want 3.x populated in what I had in 3.1.



Of course one way out is to append the previous version to the libPaths,
but this may lead to confusion.



(To make it more fun: on OS X, to be really Mac like, R could make use
of the link
	/Library/Frameworks/R.framework/R
which points to
	./Versions/Current/R
resp.
	/Library/Frameworks/R.framework/Libraries
which points to
	./Versions/Current/Resources/lib
)

  gs.


On 02.07.2014 08:39, David Winsemius wrote:
> 
> On Jul 1, 2014, at 1:50 PM, G. Sawitzki wrote:
> 
>> This is a late follow up to
>> <https://stat.ethz.ch/pipermail/r-sig-mac/2013-April/010045.html>
>>
>> Is there a useful implementation to move existing packages?
>>
>> This comes up if there is a new R release and you want your old
>> collection updated, but work on a system that does versioning (e.g. OS X).
>>
>> The message referred above suggests to use the GUI Package Installer,
>> but at least on OS X this functionality does not exist.
> 
>> On a command level, this might be implemeted as a variant of
>> update.packages() with an additional parameter old.lib.loc (or a changed
>> semantics for oldPkgs: get a list of packages from old.lib.loc, and
>> update these to lib.loc.
>>
>> The design problem is that R does not keep a memory of where a package
>> has been installed. So an iteration over a list of repositories might be
>> needed.
> 
> Not sure what the issue is, and I think your understanding of the library system may be inadequate. The example in that message was using the standard Frameworks location. If you needed to get a more expansive list of R libraries, then execute:
> 
>  .libPaths()
> 
> You could also point list.dirs() at an old ../../library/ or two to gather a list of folder names.
> 
>> all <- list.dirs("/Library/Frameworks/R.framework/Versions/3.1/Resources/library", recursive=FALSE, full.names=FALSE)
>> all[1:10]
>  [1] "A2R"        "abind"      "acepack"    "Acinonyx"   "actuar"     "ada"       
>  [7] "adabag"     "ade4"       "adegenet"   "adehabitat"
> 
> 
> It doesn't seem to be that difficult to iterate over the contents of that vector.
> 
> 
> for (loc in .libPaths() ) {
>    a=rownames(installed.packages(loc))
>    install.packages(a[!(a %in% rownames(installed.packages()))])
>                           }
> 
> 
> 

-- 
G. Sawitzki
StatLab Heidelberg
Im Neuenheimer Feld 294
D 69120 Heidelberg
Tel. (+49) 62 21 - 54 89 79   Fax (+49) 62 21 - 54 53 31
    <http://www.statlab.uni-heidelberg.de/users/gs/>
GPG Fingerprint: FEA4 3F2A 88B2 2629 6CE2 0429 CC3C E49E D159 99AE


From mietek at bak.io  Wed Jul  2 13:43:47 2014
From: mietek at bak.io (=?windows-1252?Q?Mi=EBtek_Bak?=)
Date: Wed, 2 Jul 2014 12:43:47 +0100
Subject: [R-SIG-Mac] Embedded R, event loops, GUI events, and OS X
Message-ID: <F899EF27-BC15-44A5-A08C-7298823915E3@bak.io>

Hello,

I?m helping with the development of an R-to-Haskell interoperability solution, called H.  The project allows Haskell functions to seamlessly call R functions and vice versa, making use of an embedded R interpreter.  H is developed in-house by Tweag I/O, and is soon to be open-sourced.

The project is stable on Linux and Windows, and I?m focussing on an OS X port.  Basic functionality is ready, but I?m having trouble with the GUI parts.  Specifically, any graph window, e.g. the one expected for `plot(cars)`, appears blank and unresponsive when triggered from H.

I think the issue lies between the H loop, the R event loop, and the Cocoa event loop.  So far, I?ve pored over ?Writing R Extensions? (chapter 8, ?Linking GUIs and other front-ends to R?), the R 3.1.0 sources, (`./src/library/grDevices/src/qdCocoa.m`), and the R.app 1.6.4 sources (`./RController.m`, `./REngine/RCallbacks.m`, `./REngine/RInit.m`, and `./REngine/REngine.m`).  I?ve also found interesting notes in the R.app `./ReadMe.txt`, but unfortunately, they no longer seem to be in sync with the code.

As I?ve seemingly hit a wall, I?m looking for advice.  Are any of the developers of the OS X port of R subscribed to this list?

Thanks, and kind regards,

-- 
Mi?tek Bak


From simon.urbanek at r-project.org  Wed Jul  2 16:06:23 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 2 Jul 2014 16:06:23 +0200
Subject: [R-SIG-Mac] Embedded R, event loops, GUI events, and OS X
In-Reply-To: <F899EF27-BC15-44A5-A08C-7298823915E3@bak.io>
References: <F899EF27-BC15-44A5-A08C-7298823915E3@bak.io>
Message-ID: <57606014-442B-4B72-8A40-EA2A2D4D9638@r-project.org>

Mi?tek,

On Jul 2, 2014, at 1:43 PM, Mi?tek Bak <mietek at bak.io> wrote:

> Hello,
> 
> I?m helping with the development of an R-to-Haskell interoperability solution, called H.  The project allows Haskell functions to seamlessly call R functions and vice versa, making use of an embedded R interpreter.  H is developed in-house by Tweag I/O, and is soon to be open-sourced.
> 
> The project is stable on Linux and Windows, and I?m focussing on an OS X port.  Basic functionality is ready, but I?m having trouble with the GUI parts.  Specifically, any graph window, e.g. the one expected for `plot(cars)`, appears blank and unresponsive when triggered from H.
> 
> I think the issue lies between the H loop, the R event loop, and the Cocoa event loop.  So far, I?ve pored over ?Writing R Extensions? (chapter 8, ?Linking GUIs and other front-ends to R?), the R 3.1.0 sources, (`./src/library/grDevices/src/qdCocoa.m`), and the R.app 1.6.4 sources (`./RController.m`, `./REngine/RCallbacks.m`, `./REngine/RInit.m`, and `./REngine/REngine.m`).  I?ve also found interesting notes in the R.app `./ReadMe.txt`, but unfortunately, they no longer seem to be in sync with the code.
> 
> As I?ve seemingly hit a wall, I?m looking for advice.  Are any of the developers of the OS X port of R subscribed to this list?
> 

Yes.

In general, the trick is to make sure that you setup the R event loop. That is an extra step after initializing the embedded R. There is nothing special about the OS X port in that regard - as long as you run the R event loop all is well. It becomes more tricky if the app you use wants to use its own event loop - that can cause issues as you have to make sure the two loops mesh properly.

For more specific help you'll need to ask more specific questions - possibly with link to reproducible code.

Cheers,
Simon



> Thanks, and kind regards,
> 
> -- 
> Mi?tek Bak
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From simon.urbanek at r-project.org  Wed Jul  2 16:08:06 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 2 Jul 2014 16:08:06 +0200
Subject: [R-SIG-Mac] How to move existing packages?
In-Reply-To: <53B31F26.4060009@statlab.uni-heidelberg.de>
References: <F9A1FEDF-D953-4CBA-A0EB-D7608B2DEC66@r-project.org>
	<53B31F26.4060009@statlab.uni-heidelberg.de>
Message-ID: <49E87290-43F2-4F24-94DC-40241176F1FB@r-project.org>


On Jul 1, 2014, at 10:50 PM, G. Sawitzki <gs at statlab.uni-heidelberg.de> wrote:

> This is a late follow up to
> <https://stat.ethz.ch/pipermail/r-sig-mac/2013-April/010045.html>
> 
> Is there a useful implementation to move existing packages?
> 
> This comes up if there is a new R release and you want your old
> collection updated, but work on a system that does versioning (e.g. OS X).
> 
> The message referred above suggests to use the GUI Package Installer,
> but at least on OS X this functionality does not exist.
> 

Yes it does - that is what the post you quote refers to - the OS X GUI specifically supports installation of packages based on previous R versions in the Package Installer.

Cheers,
Simon


> On a command level, this might be implemeted as a variant of
> update.packages() with an additional parameter old.lib.loc (or a changed
> semantics for oldPkgs: get a list of packages from old.lib.loc, and
> update these to lib.loc.
> 
> The design problem is that R does not keep a memory of where a package
> has been installed. So an iteration over a list of repositories might be
> needed.
> 
>   g.
> 
> 
> -- 
> G. Sawitzki
> StatLab Heidelberg
> Im Neuenheimer Feld 294
> D 69120 Heidelberg
> Tel. (+49) 62 21 - 54 89 79   Fax (+49) 62 21 - 54 53 31
>    <http://www.statlab.uni-heidelberg.de/users/gs/>
> GPG Fingerprint: FEA4 3F2A 88B2 2629 6CE2 0429 CC3C E49E D159 99AE
> 


From mietek at bak.io  Wed Jul  2 21:10:18 2014
From: mietek at bak.io (=?windows-1252?Q?Mi=EBtek_Bak?=)
Date: Wed, 2 Jul 2014 20:10:18 +0100
Subject: [R-SIG-Mac] Embedded R, event loops, GUI events, and OS X
In-Reply-To: <57606014-442B-4B72-8A40-EA2A2D4D9638@r-project.org>
References: <F899EF27-BC15-44A5-A08C-7298823915E3@bak.io>
	<57606014-442B-4B72-8A40-EA2A2D4D9638@r-project.org>
Message-ID: <CC3F55D9-684D-4347-80A5-188C8F900173@bak.io>

Hi Simon,

Thanks for the reply.  I?m looking into giving you access to the H repository.  Meanwhile, this is how we initialise embedded R, disabling stack limit checks:

    // NOTE: It is crucial to set the two R stack globals after calling
    // Rf_initialize_R() and before calling setup_Rmainloop().
    // H_initUnlimitedEmbeddedR() is based on Rf_initEmbeddedR(), found in
    // R 3.1.0 source code at src/gnuwin32/embeddedR.c:127.
    int H_initUnlimitedEmbeddedR(int argc, char **argv)
    {
        Rf_initialize_R(argc, argv);
        R_CStackLimit = -1;
        R_CStackStart = -1;
        setup_Rmainloop();
        return(1);
    }

We do use our own event loop.  In order to mesh the H loop and the R loop, we do two things every 0.03 seconds, depending on the platform, neither of which fixes the issue on OS X:

1. On Linux, we call the following:

    void processGUIEventsUnix(InputHandler** inputHandlers) {
      if (*inputHandlers == NULL)
          initStdinHandler();
      R_runHandlers(*inputHandlers, R_checkActivityEx(1000, 0, NULL));
    }

2. On Windows, we call `R_ProcessEvents`.

Can you say what exactly you have in mind when you say ?run the R event loop??

Best,

-- 
Mi?tek




On 2014-07-02, at 15:06, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> Mi?tek,
> 
> On Jul 2, 2014, at 1:43 PM, Mi?tek Bak <mietek at bak.io> wrote:
> 
>> Hello,
>> 
>> I?m helping with the development of an R-to-Haskell interoperability solution, called H.  The project allows Haskell functions to seamlessly call R functions and vice versa, making use of an embedded R interpreter.  H is developed in-house by Tweag I/O, and is soon to be open-sourced.
>> 
>> The project is stable on Linux and Windows, and I?m focussing on an OS X port.  Basic functionality is ready, but I?m having trouble with the GUI parts. Specifically, any graph window, e.g. the one expected for `plot(cars)`, appears blank and unresponsive when triggered from H.
>> 
>> I think the issue lies between the H loop, the R event loop, and the Cocoa event loop.  So far, I?ve pored over ?Writing R Extensions? (chapter 8, ?Linking GUIs and other front-ends to R?), the R 3.1.0 sources, (`./src/library/grDevices/src/qdCocoa.m`), and the R.app 1.6.4 sources (`./RController.m`, `./REngine/RCallbacks.m`, `./REngine/RInit.m`, and `./REngine/REngine.m`).  I?ve also found interesting notes in the R.app `./ReadMe.txt`, but unfortunately, they no longer seem to be in sync with the code.
>> 
>> As I?ve seemingly hit a wall, I?m looking for advice.  Are any of the developers of the OS X port of R subscribed to this list?
>> 
> 
> Yes.
> 
> In general, the trick is to make sure that you setup the R event loop. That is an extra step after initializing the embedded R. There is nothing special about the OS X port in that regard - as long as you run the R event loop all is well. It becomes more tricky if the app you use wants to use its own event loop - that can cause issues as you have to make sure the two loops mesh properly.
> 
> For more specific help you'll need to ask more specific questions - possibly with link to reproducible code.
> 
> Cheers,
> Simon
> 
> 
> 
>> Thanks, and kind regards,
>> 
>> -- 
>> Mi?tek Bak
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From sennorg at gmail.com  Thu Jul  3 17:09:36 2014
From: sennorg at gmail.com (Senyo Norgbey, MD)
Date: Thu, 3 Jul 2014 11:09:36 -0400
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
Message-ID: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140703/ccf556eb/attachment.pl>

From dusa.adrian at unibuc.ro  Thu Jul  3 17:23:20 2014
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Thu, 3 Jul 2014 18:23:20 +0300
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
In-Reply-To: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
References: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
Message-ID: <CAJ=0CtBW2aGzSjyGNZfqiKuBotazyjq40idvX5ry+U=LWi9-XA@mail.gmail.com>

On Thu, Jul 3, 2014 at 6:09 PM, Senyo Norgbey, MD <sennorg at gmail.com> wrote:
> Hello..
>
> After installing the above named version of R on my Macbook Pro and
> starting it, the message below appears in the R window...
> [...]

Try opening a Terminal, and type this:

      defaults write org.R-project.R force.LANG en_US.UTF-8

(adjust language options as needed, for me this solved it)

Hope this helps,
Adrian

PS: please note you only need this address "r-sig-mac at r-project.org"
to ask for help

-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
1, Schitu Magureanu Bd.
050025 Bucharest sector 5
Romania
Tel.:+40 21 3126618 \
        +40 21 3120210 / int.101
Fax: +40 21 3158391


From sennorg at gmail.com  Thu Jul  3 17:24:44 2014
From: sennorg at gmail.com (Senyo Norgbey, MD)
Date: Thu, 3 Jul 2014 11:24:44 -0400
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
In-Reply-To: <CAJ=0CtBW2aGzSjyGNZfqiKuBotazyjq40idvX5ry+U=LWi9-XA@mail.gmail.com>
References: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
	<CAJ=0CtBW2aGzSjyGNZfqiKuBotazyjq40idvX5ry+U=LWi9-XA@mail.gmail.com>
Message-ID: <CAN_2BSX46iVSoefR1oX8hKJrdOnb+uqfGpK4R2+TP+R+w3KJYA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140703/434622e4/attachment.pl>

From pdalgd at gmail.com  Thu Jul  3 17:26:02 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 3 Jul 2014 17:26:02 +0200
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
In-Reply-To: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
References: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
Message-ID: <AE73C252-4C29-42A1-A96D-1C9DA3F5AD7A@gmail.com>

Follow instructions in the MacOSX FAQ, section 7(!).

(The "9" in the warning is a relic from an older FAQ document.)

If you  need further guidance open up Terminal.app and tell us what is your equivalent of

Peters-iMac:R pd$ locale
LANG=
LC_COLLATE="en_US.UTF-8"
LC_CTYPE="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_ALL="en_US.UTF-8"

(i.e. just enter "locale" at the prompt)

-pd

On 03 Jul 2014, at 17:09 , Senyo Norgbey, MD <sennorg at gmail.com> wrote:

> Hello..
> 
> After installing the above named version of R on my Macbook Pro and
> starting it, the message below appears in the R window...
> 
> *R version 3.1.0 (2014-04-10) -- "Spring Dance"*
> *Copyright (C) 2014 The R Foundation for Statistical Computing*
> *Platform: x86_64-apple-darwin13.1.0 (64-bit)*
> 
> *R is free software and comes with ABSOLUTELY NO WARRANTY.*
> *You are welcome to redistribute it under certain conditions.*
> *Type 'license()' or 'licence()' for distribution details.*
> 
> *  Natural language support but running in an English locale*
> 
> *R is a collaborative project with many contributors.*
> *Type 'contributors()' for more information and*
> *'citation()' on how to cite R or R packages in publications.*
> 
> *Type 'demo()' for some demos, 'help()' for on-line help, or*
> *'help.start()' for an HTML browser interface to help.*
> *Type 'q()' to quit R.*
> 
> *During startup - Warning messages:*
> *1: Setting LC_CTYPE failed, using "C" *
> *2: Setting LC_COLLATE failed, using "C" *
> *3: Setting LC_TIME failed, using "C" *
> *4: Setting LC_MESSAGES failed, using "C" *
> *5: Setting LC_MONETARY failed, using "C" *
> *[R.app GUI 1.63 (6734) x86_64-apple-darwin13.1.0]*
> 
> *WARNING: You're using a non-UTF8 locale, therefore only ASCII characters
> will work.*
> *Please read R for Mac OS X FAQ (see Help) section 9 and adjust your system
> preferences accordingly.*
> *[History restored from /Users/sennorg/.Rapp.history]*
> 
> *starting httpd help server ... done*
> *> *
> *> *
> 
> How can i fix this..?? Need your help ASAP..
> 
> Kind regards..
> 
> 
> 
> *Senyo Norgbey, MD**MS Candidate '14*
> 
> *Johns Hopkins University School of Medicine, *
> *Division of Health Sciences Informatics,*
> 
> *2024 East Monument Street/Suite 1-200*
> 
> *Baltimore, MD 21205*
> 
> 
> *(+1) 443-529-3519(+233) 24-335-5561*
> 
> 
> 
> *snorgbe1 at jhmi.edu <snorgbe1 at jhmi.edu>sennorg at gmail.com <sennorg at gmail.com>*
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From simon.urbanek at r-project.org  Thu Jul  3 18:06:12 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 3 Jul 2014 18:06:12 +0200
Subject: [R-SIG-Mac] ZA
In-Reply-To: <CC3F55D9-684D-4347-80A5-188C8F900173@bak.io>
References: <F899EF27-BC15-44A5-A08C-7298823915E3@bak.io>
	<57606014-442B-4B72-8A40-EA2A2D4D9638@r-project.org>
	<CC3F55D9-684D-4347-80A5-188C8F900173@bak.io>
Message-ID: <1F2AF157-1F96-4A90-967F-1609296DA7AE@r-project.org>


On Jul 2, 2014, at 9:10 PM, Mi?tek Bak <mietek at bak.io> wrote:

> Hi Simon,
> 
> Thanks for the reply.  I?m looking into giving you access to the H repository.  Meanwhile, this is how we initialise embedded R, disabling stack limit checks:
> 

Why do you disable stack checks? That should never be necessary unless there is a serious problem with threads or stack management in your application.


>    // NOTE: It is crucial to set the two R stack globals after calling
>    // Rf_initialize_R() and before calling setup_Rmainloop().
>    // H_initUnlimitedEmbeddedR() is based on Rf_initEmbeddedR(), found in
>    // R 3.1.0 source code at src/gnuwin32/embeddedR.c:127.
>    int H_initUnlimitedEmbeddedR(int argc, char **argv)
>    {
>        Rf_initialize_R(argc, argv);
>        R_CStackLimit = -1;
>        R_CStackStart = -1;
>        setup_Rmainloop();
>        return(1);
>    }
> 
> We do use our own event loop.  In order to mesh the H loop and the R loop, we do two things every 0.03 seconds, depending on the platform, neither of which fixes the issue on OS X:
> 
> 1. On Linux, we call the following:
> 
>    void processGUIEventsUnix(InputHandler** inputHandlers) {
>      if (*inputHandlers == NULL)
>          initStdinHandler();
>      R_runHandlers(*inputHandlers, R_checkActivityEx(1000, 0, NULL));
>    }
> 
> 2. On Windows, we call `R_ProcessEvents`.
> 
> Can you say what exactly you have in mind when you say ?run the R event loop??
> 

The official way to check events is to use R_CheckUserInterrupt() - that works on all platforms.

But if you want to run the event loop for another loop, that's typically done using the combination of R_ReplDLLinit() setup and R_ReplDLLdo1() loop (see the Mac GUI).

Cheers,
Simon



> Best,
> 
> -- 
> Mi?tek
> 
> 
> 
> 
> On 2014-07-02, at 15:06, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
>> Mi?tek,
>> 
>> On Jul 2, 2014, at 1:43 PM, Mi?tek Bak <mietek at bak.io> wrote:
>> 
>>> Hello,
>>> 
>>> I?m helping with the development of an R-to-Haskell interoperability solution, called H.  The project allows Haskell functions to seamlessly call R functions and vice versa, making use of an embedded R interpreter.  H is developed in-house by Tweag I/O, and is soon to be open-sourced.
>>> 
>>> The project is stable on Linux and Windows, and I?m focussing on an OS X port.  Basic functionality is ready, but I?m having trouble with the GUI parts. Specifically, any graph window, e.g. the one expected for `plot(cars)`, appears blank and unresponsive when triggered from H.
>>> 
>>> I think the issue lies between the H loop, the R event loop, and the Cocoa event loop.  So far, I?ve pored over ?Writing R Extensions? (chapter 8, ?Linking GUIs and other front-ends to R?), the R 3.1.0 sources, (`./src/library/grDevices/src/qdCocoa.m`), and the R.app 1.6.4 sources (`./RController.m`, `./REngine/RCallbacks.m`, `./REngine/RInit.m`, and `./REngine/REngine.m`).  I?ve also found interesting notes in the R.app `./ReadMe.txt`, but unfortunately, they no longer seem to be in sync with the code.
>>> 
>>> As I?ve seemingly hit a wall, I?m looking for advice.  Are any of the developers of the OS X port of R subscribed to this list?
>>> 
>> 
>> Yes.
>> 
>> In general, the trick is to make sure that you setup the R event loop. That is an extra step after initializing the embedded R. There is nothing special about the OS X port in that regard - as long as you run the R event loop all is well. It becomes more tricky if the app you use wants to use its own event loop - that can cause issues as you have to make sure the two loops mesh properly.
>> 
>> For more specific help you'll need to ask more specific questions - possibly with link to reproducible code.
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> Thanks, and kind regards,
>>> 
>>> -- 
>>> Mi?tek Bak
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From marc_grt at yahoo.fr  Sun Jul  6 08:02:38 2014
From: marc_grt at yahoo.fr (Marc Girondot)
Date: Sun, 06 Jul 2014 08:02:38 +0200
Subject: [R-SIG-Mac] Shell used within system()
Message-ID: <53B8E67E.1090100@yahoo.fr>

Hi,

I try to automatize some commands normally used in terminal that I would 
like to run in R.

However, the same command xxx in terminal and in system("xxx") does not 
produce the same result.

It seems related to the shell used and the variables of the shell.

For example, in terminal:
Marc-Girondot-MBA:Chlorophyle marc$ echo $PATH
/opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/usr/local/ncl-6.2.0/bin:/opt/local/bin:/opt/local/sbin:/Library/Frameworks/GDAL.framework/Programs:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin

whereas in R:
 > system("echo $PATH")
/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin:/opt/local/bin

The shell used in terminal is
Marc-Girondot-MBA:Chlorophyle marc$ echo $SHELL
/bin/bash
Marc-Girondot-MBA:Chlorophyle marc$ echo $0
-bash

whereas in R, it is sh:
 > system("echo $0")
sh

And this sh does not read my configuration files. I have tried to 
modifiy the ~/.profile or ~/.login but system("echo $PATH") does not change.

My question is then:
is it possible to change the default shell used by system ? I have tried:
system("/bin/bash\necho $0\necho $PATH")

but R becomes unresponsive...

or where is the configuration file for sh run by R ?

Thanks a lot

Marc


From anne.cheylus at gmail.com  Sun Jul  6 12:04:12 2014
From: anne.cheylus at gmail.com (Anne Cheylus)
Date: Sun, 6 Jul 2014 12:04:12 +0200
Subject: [R-SIG-Mac] Shell used within system()
In-Reply-To: <53B8E67E.1090100@yahoo.fr>
References: <53B8E67E.1090100@yahoo.fr>
Message-ID: <CAL9-NvftJH1s5+V2L9V-o4VU+pYqtiPVoO67WQku-xK77OSBAw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140706/55f82284/attachment.pl>

From simon.urbanek at r-project.org  Sun Jul  6 13:03:59 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 6 Jul 2014 13:03:59 +0200
Subject: [R-SIG-Mac] Shell used within system()
In-Reply-To: <53B8E67E.1090100@yahoo.fr>
References: <53B8E67E.1090100@yahoo.fr>
Message-ID: <EF08AC7A-8F8C-4B8D-B8A1-AB1CD384BBEB@r-project.org>

Marc,

you omitted important details, but I think the short answer is see Mac FAQ 10.13.

The long answer is that it has nothing to do with the shell. If you run R on the command line then it inherits all your setting - including all variables that you set in your config files.

If you run the R.app Mac GUI then there is *no* login shell involved since it's an application run through launch services, so none of user login config files are processed. When you run system() - it is not running a login shell, but just regular shell hence the config files are again irrelevant (this is also true for R in Terminal, but there you already inherit the settings from the login shell). Also if you look at sh --version you will notice that it is already bash.

Cheers,
Simon

On Jul 6, 2014, at 8:02 AM, Marc Girondot <marc_grt at yahoo.fr> wrote:

> Hi,
> 
> I try to automatize some commands normally used in terminal that I would like to run in R.
> 
> However, the same command xxx in terminal and in system("xxx") does not produce the same result.
> 
> It seems related to the shell used and the variables of the shell.
> 
> For example, in terminal:
> Marc-Girondot-MBA:Chlorophyle marc$ echo $PATH
> /opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/usr/local/ncl-6.2.0/bin:/opt/local/bin:/opt/local/sbin:/Library/Frameworks/GDAL.framework/Programs:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin
> 
> whereas in R:
> > system("echo $PATH")
> /usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin:/opt/local/bin
> 
> The shell used in terminal is
> Marc-Girondot-MBA:Chlorophyle marc$ echo $SHELL
> /bin/bash
> Marc-Girondot-MBA:Chlorophyle marc$ echo $0
> -bash
> 
> whereas in R, it is sh:
> > system("echo $0")
> sh
> 
> And this sh does not read my configuration files. I have tried to modifiy the ~/.profile or ~/.login but system("echo $PATH") does not change.
> 
> My question is then:
> is it possible to change the default shell used by system ? I have tried:
> system("/bin/bash\necho $0\necho $PATH")
> 
> but R becomes unresponsive...
> 
> or where is the configuration file for sh run by R ?
> 
> Thanks a lot
> 
> Marc
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From marc_grt at yahoo.fr  Sun Jul  6 16:30:02 2014
From: marc_grt at yahoo.fr (Marc Girondot)
Date: Sun, 06 Jul 2014 16:30:02 +0200
Subject: [R-SIG-Mac] Shell used within system()
In-Reply-To: <EF08AC7A-8F8C-4B8D-B8A1-AB1CD384BBEB@r-project.org>
References: <53B8E67E.1090100@yahoo.fr>
	<EF08AC7A-8F8C-4B8D-B8A1-AB1CD384BBEB@r-project.org>
Message-ID: <53B95D6A.3000004@yahoo.fr>

Thanks a lot to Anne and Simon,
I much better understand now how R can interact with shell.

Here is a sysnthesis of the solutions based on your suggestions. I post 
here as it could help others.

Solution 1: read the .profile file and execute it before to send commands

# Here the content of the .profile file is read and store to be used later
# Note that other files can be used for configuration
fileprofile <- paste0(system("echo $HOME", intern=TRUE), "/.profile")
a <- readLines(con=fileprofile)
abat1 <- paste(a[a!=""], sep="", collapse=";")

# Here I indicate the commands that I want send to the shell
command <- "echo $0;echo $PATH"

# example with sh shell
system(paste(abat1, command, sep=";"))

# example with bash (Thanks Anne)
system(paste0("bash -c '", abat1, ";", command, "'"))

Solution 2: Modify the .Renviron file

The more "normal" solution is indeed indicated in R faq for Mac 10.13. 
It is to modify .Renviron directly.
All the variables indicated in .profile must be indicated here, not only 
the PATH variable.
It works also perfectly.


But still a problem: When I run the software ncl_convert2nc 
(https://www.ncl.ucar.edu/Document/Tools/ncl_convert2nc.shtml) using a 
shell script from R.app, it works but the same within Rstudio, it 
freezes Rstudio. I will contact the team who develops RStudio.

Thanks a lot. I progress very well today (waiting that sun comes to 
France :( )

Marc Girondot


Le 06/07/2014 13:03, Simon Urbanek a ?crit :
> Marc,
>
> you omitted important details, but I think the short answer is see Mac FAQ 10.13.
>
> The long answer is that it has nothing to do with the shell. If you run R on the command line then it inherits all your setting - including all variables that you set in your config files.
>
> If you run the R.app Mac GUI then there is *no* login shell involved since it's an application run through launch services, so none of user login config files are processed. When you run system() - it is not running a login shell, but just regular shell hence the config files are again irrelevant (this is also true for R in Terminal, but there you already inherit the settings from the login shell). Also if you look at sh --version you will notice that it is already bash.
>
> Cheers,
> Simon
>
> On Jul 6, 2014, at 8:02 AM, Marc Girondot <marc_grt at yahoo.fr> wrote:
>
>> Hi,
>>
>> I try to automatize some commands normally used in terminal that I would like to run in R.
>>
>> However, the same command xxx in terminal and in system("xxx") does not produce the same result.
>>
>> It seems related to the shell used and the variables of the shell.
>>
>> For example, in terminal:
>> Marc-Girondot-MBA:Chlorophyle marc$ echo $PATH
>> /opt/local/bin:/opt/local/sbin:/opt/local/bin:/opt/local/sbin:/usr/local/ncl-6.2.0/bin:/opt/local/bin:/opt/local/sbin:/Library/Frameworks/GDAL.framework/Programs:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin
>>
>> whereas in R:
>>> system("echo $PATH")
>> /usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt/X11/bin:/usr/texbin:/opt/local/bin
>>
>> The shell used in terminal is
>> Marc-Girondot-MBA:Chlorophyle marc$ echo $SHELL
>> /bin/bash
>> Marc-Girondot-MBA:Chlorophyle marc$ echo $0
>> -bash
>>
>> whereas in R, it is sh:
>>> system("echo $0")
>> sh
>>
>> And this sh does not read my configuration files. I have tried to modifiy the ~/.profile or ~/.login but system("echo $PATH") does not change.
>>
>> My question is then:
>> is it possible to change the default shell used by system ? I have tried:
>> system("/bin/bash\necho $0\necho $PATH")
>>
>> but R becomes unresponsive...
>>
>> or where is the configuration file for sh run by R ?
>>
>> Thanks a lot
>>
>> Marc
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>


From sennorg at gmail.com  Mon Jul  7 16:12:34 2014
From: sennorg at gmail.com (Senyo Norgbey, MD)
Date: Mon, 7 Jul 2014 10:12:34 -0400
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
In-Reply-To: <AE73C252-4C29-42A1-A96D-1C9DA3F5AD7A@gmail.com>
References: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>
	<AE73C252-4C29-42A1-A96D-1C9DA3F5AD7A@gmail.com>
Message-ID: <CAN_2BSW=N1DBWcmjohxe3=10YELgUmy=JpWH2YHrD8G7zzkppg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140707/8568fde8/attachment.pl>

From ripley at stats.ox.ac.uk  Mon Jul  7 22:00:52 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 07 Jul 2014 21:00:52 +0100
Subject: [R-SIG-Mac] HELP: R for Mac OS 10.9 Mavericks Malfunction
In-Reply-To: <CAN_2BSW=N1DBWcmjohxe3=10YELgUmy=JpWH2YHrD8G7zzkppg@mail.gmail.com>
References: <CAN_2BSXLxVc_3BwL4pmv5K5Q4qNnJusFHEE43WbRvrBh37ObKg@mail.gmail.com>	<AE73C252-4C29-42A1-A96D-1C9DA3F5AD7A@gmail.com>
	<CAN_2BSW=N1DBWcmjohxe3=10YELgUmy=JpWH2YHrD8G7zzkppg@mail.gmail.com>
Message-ID: <53BAFC74.7060004@stats.ox.ac.uk>

On 07/07/2014 15:12, Senyo Norgbey, MD wrote:
> On opening terminal.app, here is my equivalent below..
>
> Last login: Mon Jul  7 08:04:16 on console
>
> Senyo-Norgbeys-MacBook-Pro:~ sennorg$ locale
>
> LANG=
>
> LC_COLLATE="C"
>
> LC_CTYPE="UTF-8"
>
> LC_MESSAGES="C"
>
> LC_MONETARY="C"
>
> LC_NUMERIC="C"
>
> LC_TIME="C"
>
> LC_ALL=
>
>
> Can you please provide me further instructions on how to
> proceed with my problem..??

Correct

LC_CTYPE="UTF-8"

That is simply not a locale name.  Given where you are, most likely you want

export LC_CTYPE=en_US.UTF-8

(assuming a bash shell).  But you might also want to find out what you 
did to your poor Mac to get these settings.

>
> Kind regards...
>
>
>
> *Senyo Norgbey, MD**MS Candidate '14*
>
> *Johns Hopkins University School of Medicine, *
> *Division of Health Sciences Informatics,*
>
> *2024 East Monument Street/Suite 1-200*
>
> *Baltimore, MD 21205*
>
>
> *(+1) 443-529-3519(+233) 24-335-5561*
>
>
>
> *snorgbe1 at jhmi.edu <snorgbe1 at jhmi.edu>sennorg at gmail.com <sennorg at gmail.com>*
>
>
> On Thu, Jul 3, 2014 at 11:26 AM, peter dalgaard <pdalgd at gmail.com> wrote:
>
>> Follow instructions in the MacOSX FAQ, section 7(!).
>>
>> (The "9" in the warning is a relic from an older FAQ document.)
>>
>> If you  need further guidance open up Terminal.app and tell us what is
>> your equivalent of
>>
>> Peters-iMac:R pd$ locale
>> LANG=
>> LC_COLLATE="en_US.UTF-8"
>> LC_CTYPE="en_US.UTF-8"
>> LC_MESSAGES="en_US.UTF-8"
>> LC_MONETARY="en_US.UTF-8"
>> LC_NUMERIC="en_US.UTF-8"
>> LC_TIME="en_US.UTF-8"
>> LC_ALL="en_US.UTF-8"
>>
>> (i.e. just enter "locale" at the prompt)
>>
>> -pd
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pdalgd at gmail.com  Tue Jul  8 13:30:51 2014
From: pdalgd at gmail.com (peter dalgaard)
Date: Tue, 8 Jul 2014 13:30:51 +0200
Subject: [R-SIG-Mac] Package Manager does not work with the new R version
In-Reply-To: <53AF7EE1.5030104@gmail.com>
References: <53AF7EE1.5030104@gmail.com>
Message-ID: <349ECB68-E8BE-4D71-BB47-BBE41B7E1D24@gmail.com>

Quoting Simon Urbanek on April 16

------
Thanks, this is now fixed in the latest GUI that can be downloaded form

http://r.research.att.com

You can simply grab the latest R 3.1.0-patched form there and get other bug fixes as well.

Cheers,
Simon
-------

With 3.1.1 imminent, 3.1.0-patched has turned into 3.1.1 RC. If you're afraid of prereleases, you might want to wait a few days and get (very likely, nearly) the same thing but labeled 3.1.1 Patched. 

-pd

On 29 Jun 2014, at 04:50 , Silvia Solis <silvia at elremanso.com> wrote:

> Hello,
> 
> I just updated R to *R**version 3.1.0 (2014-04-10) -- "Spring Dance"*, 
> but the Package Manager function does not work.  when I call it I get 
> this message:
> 
> Error: '.find.package' is defunct.
> Use 'find.package' instead.
> See help("Defunct")
> In addition: Warning message:
> In library() :
>   library '/Users/Silvia/Library/R/3.1/library' contains no packages
> 2014-06-28 17:38:15.774 R[352:707] -deltaZ is deprecated for 
> NSEventTypeMagnify.  Please use -magnification.
>> 
> 
> When I call installed.packages() I get the list of packages and the 
> following .libPath
> 
>> .libPaths()
> [1] "/Users/Silvia/Library/R/3.1/library"
> [2] "/Library/Frameworks/R.framework/Versions/3.1/Resources/library"
> 
> But I cannot acces any package, and I cannot call any package from the 
> library.  Is it a bug, how can I fix it?
> 
> I'll apprecciate any help!
> 
> Silvia
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From simon.urbanek at r-project.org  Tue Jul  8 14:21:39 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 8 Jul 2014 14:21:39 +0200
Subject: [R-SIG-Mac] ncdf4 not auto-building on Mavericks -- can't tell
	why
In-Reply-To: <CAL+Zad9ZVo=Ugv2U2xxZ2PYorPTMaaGKkhej6CmHiuiKYxNs2A@mail.gmail.com>
References: <CAL+Zad9ZVo=Ugv2U2xxZ2PYorPTMaaGKkhej6CmHiuiKYxNs2A@mail.gmail.com>
Message-ID: <1BF2339A-C82A-470E-9230-F83BBC928493@r-project.org>

For posterity: this message got apparently suck in some queue - the issue has been resolved off-list in the mean time where simply HDF5 binary was not installed on the build machine.

Cheers,
Simon

On Jun 20, 2014, at 6:14 PM, David W. Pierce <dpierce at ucsd.edu> wrote:

> Hello,
> 
> I'm the package maintainer for ncdf4, which provides an R interface
> for netcdf files. I have successfully built and installed the package
> on a OS X Mavericks machine I have access to, but the nightly build on
> that platform for R failed with an error I'm trying to understand.
> 
> I'm sure it's documented somewhere who to contact about odd results on
> the specific Mavericks machine used for the CRAN compiles, but I have
> not been able to find that despite some searching. Does anyone know if
> there's a contact who can be approached about the software environment
> of that particular machine?
> 
> More technical details of the compiling problem follow.
> 
> The netcdf library has an accessory script that shows how it was
> configured on the machine in question (the Mavericks machine in this
> case). This shows:
> 
> ------
> 
> This netCDF 4.1.3 has been built with the following features:
> 
>  --cc        -> gcc -arch i386 -std=gnu99
>  --cflags    ->  -I/usr/local/include
>  --libs      -> -L/usr/local/lib  -lnetcdf -lhdf5_hl -lhdf5 -lm -lz -lcurl
> 
> -----
> 
> which is stating that the library compiled correctly using
> -L/usr/local/lib -lhdf4_hl (among other libs). Yet the R build failed
> with:
> 
> clang -dynamiclib -Wl,-headerpad_max_install_names -undefined
> dynamic_lookup -single_module -multiply_defined suppress
> -L/usr/local/lib -o ncdf4.so ncdf.o ncdf2.o ncdf3.o src_ncdf4.o
> -Wl,-rpath,/usr/local/lib -L/usr/local/lib -lnetcdf -lhdf5_hl -lhdf5
> -lm -lz -lcurl -F/Library/Frameworks/R.framework/.. -framework R
> -Wl,-framework -Wl,CoreFoundation
> ld: library not found for -lhdf5_hl
> clang: error: linker command failed with exit code 1 (use -v to see invocation)
> 
> which claims that -lhdf5_hl was not found. The odd part is, if that
> library was found when the netcdf library was compiled, why wasn't it
> found when the R ncdf4 package was compiled with the same -L library
> path flag? Am I missing something here?
> 
> Also, I know essentially nothing about Macs (hopefully some people
> here can help me on this), but I see that the netcdf library was
> compiled with "-arch i386", while the R package was compiled with
> "clang -Wall -mtune=core2 -g -O2", which does not specify -arch i386.
> Is it possible that the linker is reporting "hdf5_hl" not found
> because the existing library is a 32-bit library but it's looking for
> a 64-bit library? On Windows, for example,this would give an error
> along the lines of "library is 32 bit not 64 bit" but I don't know how
> OS X would handle this.
> 
> Thanks for any info,
> 
> --Dave
> 
> -- 
> Dr. David W. Pierce
> Division of Climate, Atmospheric Science, and Physical Oceanography
> Scripps Institution of Oceanography, La Jolla, California, USA
> (858) 534-8276 (voice)  /  (858) 534-8561 (fax)    dpierce at ucsd.edu
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From simon.urbanek at r-project.org  Tue Jul  8 14:24:46 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 8 Jul 2014 14:24:46 +0200
Subject: [R-SIG-Mac] system() not always working
In-Reply-To: <7C331619-8BDB-40A0-ADB9-C2D74BD87060@gmail.com>
References: <7C331619-8BDB-40A0-ADB9-C2D74BD87060@gmail.com>
Message-ID: <53F5920D-A3AB-4256-80E5-1322135BBFCD@r-project.org>

Mollie,

.*profile are only used by login shells, not by R or R.app. Please use R startup files to set any settings you require - see also Mac FAQ 10.13.

Cheers,
Simon


On Jun 28, 2014, at 4:08 PM, Mollie Brooks <mollieebrooks at gmail.com> wrote:

> Hi R-sig-mac,
> 
> I?m trying to use R2admb in R.app (extension usually hidden). I?ve narrowed down the problem to the fact that the command 
> system("admb") returns an error.
>> system("admb")
> /bin/sh: admb: command not found
> 
> Other system commands seem to work
>> system("texi2dvi")
> /usr/bin/texi2dvi: Missing file arguments.
> /usr/bin/texi2dvi: Try `--help' for more information.
>> system("gcc")
> clang: error: no input files
> 
> If I open R from a terminal and do the same thing, it works. 
> If I simply try admb in a terminal, it works too. 
> My .bash_profile has these lines  
> ADMB_HOME=/Applications/ADMBTerminal.app/admb 
> export PATH="/Applications/ADMBTerminal.app/admb/bin":${PATH} 
> And the terminal starts with the bash command, so that it knows this information.
> Does R.app miss this step?
> 
> Can I fix R.app?
> 
> I?m using R 3.1.0 and have xcode 5.1 installed.
> 
> Thanks,
> Mollie
> 
> ------------------------
> Mollie Brooks, PhD
> Postdoctoral Researcher, Population Ecology Research Group http://www.popecol.org
> Institute of Evolutionary Biology & Environmental Studies, University of Z?rich
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From dpierce at ucsd.edu  Tue Jul  8 15:56:47 2014
From: dpierce at ucsd.edu (David W. Pierce)
Date: Tue, 8 Jul 2014 06:56:47 -0700
Subject: [R-SIG-Mac] ncdf4 not auto-building on Mavericks -- can't tell
	why
In-Reply-To: <1BF2339A-C82A-470E-9230-F83BBC928493@r-project.org>
References: <CAL+Zad9ZVo=Ugv2U2xxZ2PYorPTMaaGKkhej6CmHiuiKYxNs2A@mail.gmail.com>
	<1BF2339A-C82A-470E-9230-F83BBC928493@r-project.org>
Message-ID: <CAL+Zad89fRCG1KWSNA7Ec3-gCPGLFursrTksAt+n7Lu4kpUkXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140708/fa5959f9/attachment.pl>

From marc_grt at yahoo.fr  Wed Jul  9 18:54:57 2014
From: marc_grt at yahoo.fr (Marc Girondot)
Date: Wed, 09 Jul 2014 18:54:57 +0200
Subject: [R-SIG-Mac] ncdf4 not auto-building on Mavericks -- can't tell
 why
In-Reply-To: <CAL+Zad89fRCG1KWSNA7Ec3-gCPGLFursrTksAt+n7Lu4kpUkXQ@mail.gmail.com>
References: <CAL+Zad9ZVo=Ugv2U2xxZ2PYorPTMaaGKkhej6CmHiuiKYxNs2A@mail.gmail.com>	<1BF2339A-C82A-470E-9230-F83BBC928493@r-project.org>
	<CAL+Zad89fRCG1KWSNA7Ec3-gCPGLFursrTksAt+n7Lu4kpUkXQ@mail.gmail.com>
Message-ID: <53BD73E1.30401@yahoo.fr>

I was stuck very long with similar problem.
I write a little tutorial to help to install this package:

http://max2.ese.u-psud.fr/epc/conservation/Girondot/Publications/Blog_r/Entrees/2014/4/7_rgdal_and_other_packages_with_R_3.1.html

Sincerely

Marc Girondot

Le 08/07/2014 15:56, David W. Pierce a ?crit :
> On Tuesday, July 8, 2014, Simon Urbanek<simon.urbanek at r-project.org>  wrote:
>
>> >For posterity: this message got apparently suck in some queue - the issue
>> >has been resolved off-list in the mean time where simply HDF5 binary was
>> >not installed on the build machine.
>> >
>> >Cheers,
>> >Simon
>> >
>> >
> Hi Simon,
>
> Just wanted to check on this. I looked just now at the ncdf4 build log on
> CRAN and it still seems to be giving the same error...?
>
> Dave,
>
>
>


From YAMPOLSK at mail.etsu.edu  Fri Jul 11 22:45:36 2014
From: YAMPOLSK at mail.etsu.edu (Yampolsky, Lev)
Date: Fri, 11 Jul 2014 20:45:36 +0000
Subject: [R-SIG-Mac] tcltk not working in R 3.1.1  on MacOS X 10.9.2
Message-ID: <CFE5C530.435C1%YAMPOLSK@mail.etsu.edu>

Dear Colleagues,

Attempts to use tcltk (R 3.1.1  on MacOS X 10.9.2) or any dependent library (for example qvalue) results in:

> library(tcltk)
Error : .onLoad failed in loadNamespace() for 'tcltk', details:
  call: dyn.load(file, DLLpath = DLLpath, ...)
  error: unable to load shared object '/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so':
  dlopen(/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so, 10): Library not loaded: /opt/X11/lib/libX11.6.dylib
  Referenced from: /Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so
  Reason: image not found
Error: package or namespace load failed for ?tcltk?

Tried:
- upgraded to the most recent R (it did say at installation that it includes tcltk)
- manually upgraded tcltk to tcltk 8.6.1

Neither helped. A few discussions I read imply that I should not do anything and R ver3 or more recent should come bundled with tcltk and it should work.

Any ideas?

Thanks very much in advance,



--
Lev Yampolsky

Associate Professor
Department of Biological Sciences
East Tennessee State University
Box 70703
Johnson City TN 37614-1710
Cell 423-676-7489
Office/lab 423-439-4359
Fax        423-439-5958


From ripley at stats.ox.ac.uk  Mon Jul 14 08:22:45 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 14 Jul 2014 07:22:45 +0100
Subject: [R-SIG-Mac] tcltk not working in R 3.1.1  on MacOS X 10.9.2
In-Reply-To: <CFE5C530.435C1%YAMPOLSK@mail.etsu.edu>
References: <CFE5C530.435C1%YAMPOLSK@mail.etsu.edu>
Message-ID: <53C37735.50001@stats.ox.ac.uk>

On 11/07/2014 21:45, Yampolsky, Lev wrote:
> Dear Colleagues,
>
> Attempts to use tcltk (R 3.1.1  on MacOS X 10.9.2) or any dependent library (for example qvalue) results in:
>
>> library(tcltk)
> Error : .onLoad failed in loadNamespace() for 'tcltk', details:
>    call: dyn.load(file, DLLpath = DLLpath, ...)
>    error: unable to load shared object '/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so':
>    dlopen(/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so, 10): Library not loaded: /opt/X11/lib/libX11.6.dylib
>    Referenced from: /Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so
>    Reason: image not found
> Error: package or namespace load failed for ?tcltk?
>
> Tried:
> - upgraded to the most recent R (it did say at installation that it includes tcltk)
> - manually upgraded tcltk to tcltk 8.6.1
>
> Neither helped. A few discussions I read imply that I should not do anything and R ver3 or more recent should come bundled with tcltk and it should work.

> Any ideas?

You need XQuartz installed on Mavericks to use X11-based tcltk.  See the 
manuals.


>
> Thanks very much in advance,
>
>
>
> --
> Lev Yampolsky
>
> Associate Professor
> Department of Biological Sciences
> East Tennessee State University
> Box 70703
> Johnson City TN 37614-1710
> Cell 423-676-7489
> Office/lab 423-439-4359
> Fax        423-439-5958
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From YAMPOLSK at mail.etsu.edu  Mon Jul 14 12:10:04 2014
From: YAMPOLSK at mail.etsu.edu (Yampolsky, Lev)
Date: Mon, 14 Jul 2014 10:10:04 +0000
Subject: [R-SIG-Mac] tcltk not working in R 3.1.1  on MacOS X 10.9.2
In-Reply-To: <53C37735.50001@stats.ox.ac.uk>
References: <CFE5C530.435C1%YAMPOLSK@mail.etsu.edu>,
	<53C37735.50001@stats.ox.ac.uk>
Message-ID: <A5CE54244E64C44BA2CB9505CC77581585C1C98D@etsums4.etsu.edu>

Thank you very much! I actually figured it out while my post was in moderation.

________________________________________
From: r-sig-mac-bounces at r-project.org [r-sig-mac-bounces at r-project.org] on behalf of Prof Brian Ripley [ripley at stats.ox.ac.uk]
Sent: Monday, July 14, 2014 2:22 AM
To: r-sig-mac at r-project.org
Subject: Re: [R-SIG-Mac] tcltk not working in R 3.1.1  on MacOS X 10.9.2

On 11/07/2014 21:45, Yampolsky, Lev wrote:
> Dear Colleagues,
>
> Attempts to use tcltk (R 3.1.1  on MacOS X 10.9.2) or any dependent library (for example qvalue) results in:
>
>> library(tcltk)
> Error : .onLoad failed in loadNamespace() for 'tcltk', details:
>    call: dyn.load(file, DLLpath = DLLpath, ...)
>    error: unable to load shared object '/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so':
>    dlopen(/Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so, 10): Library not loaded: /opt/X11/lib/libX11.6.dylib
>    Referenced from: /Library/Frameworks/R.framework/Versions/3.1/Resources/library/tcltk/libs/tcltk.so
>    Reason: image not found
> Error: package or namespace load failed for ?tcltk?
>
> Tried:
> - upgraded to the most recent R (it did say at installation that it includes tcltk)
> - manually upgraded tcltk to tcltk 8.6.1
>
> Neither helped. A few discussions I read imply that I should not do anything and R ver3 or more recent should come bundled with tcltk and it should work.

> Any ideas?

You need XQuartz installed on Mavericks to use X11-based tcltk.  See the
manuals.


>
> Thanks very much in advance,
>
>
>
> --
> Lev Yampolsky
>
> Associate Professor
> Department of Biological Sciences
> East Tennessee State University
> Box 70703
> Johnson City TN 37614-1710
> Cell 423-676-7489
> Office/lab 423-439-4359
> Fax        423-439-5958
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


--
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

_______________________________________________
R-SIG-Mac mailing list
R-SIG-Mac at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From jfox at mcmaster.ca  Mon Jul 14 23:13:22 2014
From: jfox at mcmaster.ca (John Fox)
Date: Mon, 14 Jul 2014 17:13:22 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
Message-ID: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>

Dear Simon and list members,

As many of you are aware, when X11 isn't installed on Mac OS X, loading the
tcltk package produces an error, with a message that many users find
cryptic. There was yet another instance of this problem reported to the list
today.

I'm interested in the issue because the Rcmdr package uses tcltk and thus
fails to load when X11 is absent. Rcmdr users tend to be inexperienced and
so, unless they find their way to the Rcmdr installation webpage, where
detailed installation instructions are provided, they tend to be stymied by
the problem.

If I could, I'd intercept the problem by checking capabilities()["X11"] in
the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr package
imports the tcltk namespace, the error occurs before these startup functions
are executed -- a chicken-and-egg problem.

It occurs to me that tcltk could fail more gracefully on Mac OS X when X11
is absent, perhaps popping up a webpage in a browser with instructions and a
link for installing XQuartz. I'd do this myself in the Rcmdr package if I
could. Or tcltk could check for the presence of X11 and not try to start it
if it's absent, reporting a warning rather than throwing an error.

Alternatively, I'd be grateful if someone could suggest how I might detect
the problem in the Rcmdr package before loading fails. The only thing that I
could think of was writing a separate RcmdrInstall package that bypasses
tcltk, but that would be awkward and would only help users who discovered
that RcmdrInstall exists.

Thanks,
 John

-----------------------------------------------
John Fox, Professor
McMaster University
Hamilton, Ontario, Canada
http://socserv.socsci.mcmaster.ca/jfox/


From marc_schwartz at me.com  Mon Jul 14 23:53:14 2014
From: marc_schwartz at me.com (Marc Schwartz)
Date: Mon, 14 Jul 2014 16:53:14 -0500
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
Message-ID: <C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>

On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:

> Dear Simon and list members,
> 
> As many of you are aware, when X11 isn't installed on Mac OS X, loading the
> tcltk package produces an error, with a message that many users find
> cryptic. There was yet another instance of this problem reported to the list
> today.
> 
> I'm interested in the issue because the Rcmdr package uses tcltk and thus
> fails to load when X11 is absent. Rcmdr users tend to be inexperienced and
> so, unless they find their way to the Rcmdr installation webpage, where
> detailed installation instructions are provided, they tend to be stymied by
> the problem.
> 
> If I could, I'd intercept the problem by checking capabilities()["X11"] in
> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr package
> imports the tcltk namespace, the error occurs before these startup functions
> are executed -- a chicken-and-egg problem.
> 
> It occurs to me that tcltk could fail more gracefully on Mac OS X when X11
> is absent, perhaps popping up a webpage in a browser with instructions and a
> link for installing XQuartz. I'd do this myself in the Rcmdr package if I
> could. Or tcltk could check for the presence of X11 and not try to start it
> if it's absent, reporting a warning rather than throwing an error.
> 
> Alternatively, I'd be grateful if someone could suggest how I might detect
> the problem in the Rcmdr package before loading fails. The only thing that I
> could think of was writing a separate RcmdrInstall package that bypasses
> tcltk, but that would be awkward and would only help users who discovered
> that RcmdrInstall exists.
> 
> Thanks,
> John


John,

Is there someplace in your startup process where you could run code along the lines of:

if (grepl("apple", R.version$platform) & length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
     cat("X11 is required. Please visit http://xquartz.macosforge.org to download and install Xquartz.")
     stop()
}


The above code will check to see if the user is running R on OS X and also if the Xquartz binary is present in the default location.

Not sure if this is helpful.

Regards,

Marc Schwartz


From kasperdanielhansen at gmail.com  Tue Jul 15 00:07:33 2014
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Tue, 15 Jul 2014 00:07:33 +0200
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
Message-ID: <CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140715/5e501b6e/attachment.pl>

From marc_schwartz at me.com  Tue Jul 15 00:13:38 2014
From: marc_schwartz at me.com (Marc Schwartz)
Date: Mon, 14 Jul 2014 17:13:38 -0500
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
Message-ID: <FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>


On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com> wrote:

> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
> 
>> Dear Simon and list members,
>> 
>> As many of you are aware, when X11 isn't installed on Mac OS X, loading the
>> tcltk package produces an error, with a message that many users find
>> cryptic. There was yet another instance of this problem reported to the list
>> today.
>> 
>> I'm interested in the issue because the Rcmdr package uses tcltk and thus
>> fails to load when X11 is absent. Rcmdr users tend to be inexperienced and
>> so, unless they find their way to the Rcmdr installation webpage, where
>> detailed installation instructions are provided, they tend to be stymied by
>> the problem.
>> 
>> If I could, I'd intercept the problem by checking capabilities()["X11"] in
>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr package
>> imports the tcltk namespace, the error occurs before these startup functions
>> are executed -- a chicken-and-egg problem.
>> 
>> It occurs to me that tcltk could fail more gracefully on Mac OS X when X11
>> is absent, perhaps popping up a webpage in a browser with instructions and a
>> link for installing XQuartz. I'd do this myself in the Rcmdr package if I
>> could. Or tcltk could check for the presence of X11 and not try to start it
>> if it's absent, reporting a warning rather than throwing an error.
>> 
>> Alternatively, I'd be grateful if someone could suggest how I might detect
>> the problem in the Rcmdr package before loading fails. The only thing that I
>> could think of was writing a separate RcmdrInstall package that bypasses
>> tcltk, but that would be awkward and would only help users who discovered
>> that RcmdrInstall exists.
>> 
>> Thanks,
>> John
> 
> 
> John,
> 
> Is there someplace in your startup process where you could run code along the lines of:
> 
> if (grepl("apple", R.version$platform) & length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>     cat("X11 is required. Please visit http://xquartz.macosforge.org to download and install Xquartz.")
>     stop()
> }
> 
> 
> The above code will check to see if the user is running R on OS X and also if the Xquartz binary is present in the default location.
> 
> Not sure if this is helpful.


A possible correction in the above code relative to detecting OS X:

if ((Sys.info()["sysname"] == "Darwin") & length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
    cat("X11 is required. Please visit http://xquartz.macosforge.org to download and install Xquartz.")
    stop()
}


I believe that Sys.info()["sysname"] == "Darwin" is preferred for detecting the OS that R is running on versus the OS that it was built upon according to the help files, if I read correctly. This could be important if someone is building R from source versus installing Simon's CRAN binary, I presume.

Regards,

Marc


From marc_schwartz at me.com  Tue Jul 15 00:33:02 2014
From: marc_schwartz at me.com (Marc Schwartz)
Date: Mon, 14 Jul 2014 17:33:02 -0500
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>
Message-ID: <E26E9F48-234F-4528-9F7F-91876038CACB@me.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140714/9aa947de/attachment.pl>

From csardi.gabor at gmail.com  Tue Jul 15 00:36:31 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 14 Jul 2014 18:36:31 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
Message-ID: <CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>

What's wrong with capabilities("X11")?

I am not sure if teting for the OS, and especially for a particular X
server, installed in a particular directory, is a good idea, even if
it covers most of the _current_ installations.

Gabor

On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com> wrote:
>
> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com> wrote:
>
>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>>
>>> Dear Simon and list members,
>>>
>>> As many of you are aware, when X11 isn't installed on Mac OS X, loading the
>>> tcltk package produces an error, with a message that many users find
>>> cryptic. There was yet another instance of this problem reported to the list
>>> today.
>>>
>>> I'm interested in the issue because the Rcmdr package uses tcltk and thus
>>> fails to load when X11 is absent. Rcmdr users tend to be inexperienced and
>>> so, unless they find their way to the Rcmdr installation webpage, where
>>> detailed installation instructions are provided, they tend to be stymied by
>>> the problem.
>>>
>>> If I could, I'd intercept the problem by checking capabilities()["X11"] in
>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr package
>>> imports the tcltk namespace, the error occurs before these startup functions
>>> are executed -- a chicken-and-egg problem.
>>>
>>> It occurs to me that tcltk could fail more gracefully on Mac OS X when X11
>>> is absent, perhaps popping up a webpage in a browser with instructions and a
>>> link for installing XQuartz. I'd do this myself in the Rcmdr package if I
>>> could. Or tcltk could check for the presence of X11 and not try to start it
>>> if it's absent, reporting a warning rather than throwing an error.
>>>
>>> Alternatively, I'd be grateful if someone could suggest how I might detect
>>> the problem in the Rcmdr package before loading fails. The only thing that I
>>> could think of was writing a separate RcmdrInstall package that bypasses
>>> tcltk, but that would be awkward and would only help users who discovered
>>> that RcmdrInstall exists.
>>>
>>> Thanks,
>>> John
>>
>>
>> John,
>>
>> Is there someplace in your startup process where you could run code along the lines of:
>>
>> if (grepl("apple", R.version$platform) & length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>     cat("X11 is required. Please visit http://xquartz.macosforge.org to download and install Xquartz.")
>>     stop()
>> }
>>
>>
>> The above code will check to see if the user is running R on OS X and also if the Xquartz binary is present in the default location.
>>
>> Not sure if this is helpful.
>
>
> A possible correction in the above code relative to detecting OS X:
>
> if ((Sys.info()["sysname"] == "Darwin") & length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>     cat("X11 is required. Please visit http://xquartz.macosforge.org to download and install Xquartz.")
>     stop()
> }
>
>
> I believe that Sys.info()["sysname"] == "Darwin" is preferred for detecting the OS that R is running on versus the OS that it was built upon according to the help files, if I read correctly. This could be important if someone is building R from source versus installing Simon's CRAN binary, I presume.
>
> Regards,
>
> Marc
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From jfox at mcmaster.ca  Tue Jul 15 02:08:25 2014
From: jfox at mcmaster.ca (John Fox)
Date: Mon, 14 Jul 2014 20:08:25 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <E26E9F48-234F-4528-9F7F-91876038CACB@me.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>
	<E26E9F48-234F-4528-9F7F-91876038CACB@me.com>
Message-ID: <005001cf9fc0$e6269860$b273c920$@mcmaster.ca>

Dear Marc and Kasper,

I already know how to test whether the Rcmdr is running under Mac OS X and
to test whether X11 is installed. But AFAICS there is no way for me to run
this code in the Rcmdr package at startup *before* tcltk fails to load -- I
did try to do this, both in .onLoad() and in .onAttach(). 

I thought that I'd made this problem clear in my initial message but
apparently I hadn't. I'd be happy if someone proved me wrong by showing me
another way to intercept the problem on startup of the Rcmdr package, but I
think that the fix has to go into tcltk, as Kasper suggests.

Best,
 John

> -----Original Message-----
> From: Marc Schwartz [mailto:marc_schwartz at me.com]
> Sent: Monday, July 14, 2014 6:33 PM
> To: Kasper Daniel Hansen
> Cc: John Fox; urbanek at research.att.com; r-sig-mac at r-project.org
> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
> 
> Kasper,
> 
> Understood. I was not sure if there was someplace in John's startup
> code that might catch it early on before tcltk loads, but that may be
> confounded by the sequence of the package import process as John notes
> below.
> 
> Reading R-exts and the related help files does not make it clear to me
> that there is a window of opportunity to run the check before the
> import occurs, but I would defer to Simon et al on the finer points
> here.
> 
> Regards,
> 
> Marc
> 
> 
> On Jul 14, 2014, at 5:07 PM, Kasper Daniel Hansen
> <kasperdanielhansen at gmail.com> wrote:
> 
> 
> 	Basically John is asking for code like this to be included in
> tcltk.
> 
> 	Best,
> 	Kasper
> 
> 
> 	On Mon, Jul 14, 2014 at 11:53 PM, Marc Schwartz
> <marc_schwartz at me.com> wrote:
> 
> 
> 		On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca>
> wrote:
> 
> 		> Dear Simon and list members,
> 		>
> 		> As many of you are aware, when X11 isn't installed on Mac
> OS X, loading the
> 		> tcltk package produces an error, with a message that many
> users find
> 		> cryptic. There was yet another instance of this problem
> reported to the list
> 		> today.
> 		>
> 		> I'm interested in the issue because the Rcmdr package uses
> tcltk and thus
> 		> fails to load when X11 is absent. Rcmdr users tend to be
> inexperienced and
> 		> so, unless they find their way to the Rcmdr installation
> webpage, where
> 		> detailed installation instructions are provided, they tend
> to be stymied by
> 		> the problem.
> 		>
> 		> If I could, I'd intercept the problem by checking
> capabilities()["X11"] in
> 		> the Rcmdr .onLoad() or .onAttach() function, but because
> the Rcmdr package
> 		> imports the tcltk namespace, the error occurs before these
> startup functions
> 		> are executed -- a chicken-and-egg problem.
> 		>
> 		> It occurs to me that tcltk could fail more gracefully on
> Mac OS X when X11
> 		> is absent, perhaps popping up a webpage in a browser with
> instructions and a
> 		> link for installing XQuartz. I'd do this myself in the
> Rcmdr package if I
> 		> could. Or tcltk could check for the presence of X11 and
not
> try to start it
> 		> if it's absent, reporting a warning rather than throwing
an
> error.
> 		>
> 		> Alternatively, I'd be grateful if someone could suggest
how
> I might detect
> 		> the problem in the Rcmdr package before loading fails. The
> only thing that I
> 		> could think of was writing a separate RcmdrInstall package
> that bypasses
> 		> tcltk, but that would be awkward and would only help users
> who discovered
> 		> that RcmdrInstall exists.
> 		>
> 		> Thanks,
> 		> John
> 
> 
> 
> 		John,
> 
> 		Is there someplace in your startup process where you could
> run code along the lines of:
> 
> 		if (grepl("apple", R.version$platform) &
> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> 		     cat("X11 is required. Please visit
> http://xquartz.macosforge.org <http://xquartz.macosforge.org/>  to
> download and install Xquartz.")
> 		     stop()
> 		}
> 
> 
> 		The above code will check to see if the user is running R on
> OS X and also if the Xquartz binary is present in the default location.
> 
> 		Not sure if this is helpful.
> 
> 		Regards,
> 
> 		Marc Schwartz
> 
> 
> 		_______________________________________________
> 		R-SIG-Mac mailing list
> 		R-SIG-Mac at r-project.org
> 		https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
>


From jfox at mcmaster.ca  Tue Jul 15 02:12:32 2014
From: jfox at mcmaster.ca (John Fox)
Date: Mon, 14 Jul 2014 20:12:32 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
Message-ID: <005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>

Dear Gabor,

As I just explained, the problem isn't testing for X11, which I know how to do -- though capabilities("X11") is a bit better than what I suggested. The issue is specific to Mac OS X because the Windows implementation of R includes a Tcl/Tk that doesn't use X11, and I've never seen the problem on Linux.

Best,
 John

> -----Original Message-----
> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
> Sent: Monday, July 14, 2014 6:37 PM
> To: Marc Schwartz
> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
> 
> What's wrong with capabilities("X11")?
> 
> I am not sure if teting for the OS, and especially for a particular X
> server, installed in a particular directory, is a good idea, even if
> it covers most of the _current_ installations.
> 
> Gabor
> 
> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
> wrote:
> >
> > On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
> wrote:
> >
> >> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
> >>
> >>> Dear Simon and list members,
> >>>
> >>> As many of you are aware, when X11 isn't installed on Mac OS X,
> loading the
> >>> tcltk package produces an error, with a message that many users
> find
> >>> cryptic. There was yet another instance of this problem reported to
> the list
> >>> today.
> >>>
> >>> I'm interested in the issue because the Rcmdr package uses tcltk
> and thus
> >>> fails to load when X11 is absent. Rcmdr users tend to be
> inexperienced and
> >>> so, unless they find their way to the Rcmdr installation webpage,
> where
> >>> detailed installation instructions are provided, they tend to be
> stymied by
> >>> the problem.
> >>>
> >>> If I could, I'd intercept the problem by checking
> capabilities()["X11"] in
> >>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
> package
> >>> imports the tcltk namespace, the error occurs before these startup
> functions
> >>> are executed -- a chicken-and-egg problem.
> >>>
> >>> It occurs to me that tcltk could fail more gracefully on Mac OS X
> when X11
> >>> is absent, perhaps popping up a webpage in a browser with
> instructions and a
> >>> link for installing XQuartz. I'd do this myself in the Rcmdr
> package if I
> >>> could. Or tcltk could check for the presence of X11 and not try to
> start it
> >>> if it's absent, reporting a warning rather than throwing an error.
> >>>
> >>> Alternatively, I'd be grateful if someone could suggest how I might
> detect
> >>> the problem in the Rcmdr package before loading fails. The only
> thing that I
> >>> could think of was writing a separate RcmdrInstall package that
> bypasses
> >>> tcltk, but that would be awkward and would only help users who
> discovered
> >>> that RcmdrInstall exists.
> >>>
> >>> Thanks,
> >>> John
> >>
> >>
> >> John,
> >>
> >> Is there someplace in your startup process where you could run code
> along the lines of:
> >>
> >> if (grepl("apple", R.version$platform) &
> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >>     cat("X11 is required. Please visit http://xquartz.macosforge.org
> to download and install Xquartz.")
> >>     stop()
> >> }
> >>
> >>
> >> The above code will check to see if the user is running R on OS X
> and also if the Xquartz binary is present in the default location.
> >>
> >> Not sure if this is helpful.
> >
> >
> > A possible correction in the above code relative to detecting OS X:
> >
> > if ((Sys.info()["sysname"] == "Darwin") &
> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >     cat("X11 is required. Please visit http://xquartz.macosforge.org
> to download and install Xquartz.")
> >     stop()
> > }
> >
> >
> > I believe that Sys.info()["sysname"] == "Darwin" is preferred for
> detecting the OS that R is running on versus the OS that it was built
> upon according to the help files, if I read correctly. This could be
> important if someone is building R from source versus installing
> Simon's CRAN binary, I presume.
> >
> > Regards,
> >
> > Marc
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From ramos.grad.student at gmail.com  Tue Jul 15 03:19:31 2014
From: ramos.grad.student at gmail.com (Antonio Pedro Ramos)
Date: Tue, 15 Jul 2014 01:19:31 +0000
Subject: [R-SIG-Mac] Check out my profile on LinkedIn
Message-ID: <815955758.5863900.1405387171113.JavaMail.app@ela4-app2717.prod>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140715/85e08009/attachment.pl>

From ramos.grad.student at gmail.com  Tue Jul 15 03:19:38 2014
From: ramos.grad.student at gmail.com (Antonio Pedro Ramos)
Date: Tue, 15 Jul 2014 01:19:38 +0000 (UTC)
Subject: [R-SIG-Mac] I'd like to add you to my professional network on
	LinkedIn
Message-ID: <1266686656.5624933.1405387178331.JavaMail.app@ela4-app8097.prod>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140715/8e752851/attachment.pl>

From csardi.gabor at gmail.com  Tue Jul 15 03:37:54 2014
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Mon, 14 Jul 2014 21:37:54 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
Message-ID: <CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>

Hi John,

On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
> Dear Gabor,
>
> As I just explained, the problem isn't testing for X11, which I know how to do -- though capabilities("X11") is a bit better than what I suggested. The issue is specific to Mac OS X because the Windows implementation of R includes a Tcl/Tk that doesn't use X11, and I've never seen the problem on Linux.

actually, what I am saying is, that it is not specific to OSX. Some
(older, before 2012) OSX versions do include an X11 server, and some
Linux or other Unix installations do not.

I am not saying tcltk should not test for an X11 server, all I am
saying is that the test suggested below (based on the os and the
existence of a certain file) is not the best one.

If it turns out that there is no X11 server, and the os is OSX, then
indeed a dialog box could be displayed, see e.g. the one at
http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-x-mountain-lion-shifts-support-to-open-source-xquartz/

Best,
Gabor

> Best,
>  John
>
>> -----Original Message-----
>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
>> Sent: Monday, July 14, 2014 6:37 PM
>> To: Marc Schwartz
>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>>
>> What's wrong with capabilities("X11")?
>>
>> I am not sure if teting for the OS, and especially for a particular X
>> server, installed in a particular directory, is a good idea, even if
>> it covers most of the _current_ installations.
>>
>> Gabor
>>
>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
>> wrote:
>> >
>> > On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
>> wrote:
>> >
>> >> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>> >>
>> >>> Dear Simon and list members,
>> >>>
>> >>> As many of you are aware, when X11 isn't installed on Mac OS X,
>> loading the
>> >>> tcltk package produces an error, with a message that many users
>> find
>> >>> cryptic. There was yet another instance of this problem reported to
>> the list
>> >>> today.
>> >>>
>> >>> I'm interested in the issue because the Rcmdr package uses tcltk
>> and thus
>> >>> fails to load when X11 is absent. Rcmdr users tend to be
>> inexperienced and
>> >>> so, unless they find their way to the Rcmdr installation webpage,
>> where
>> >>> detailed installation instructions are provided, they tend to be
>> stymied by
>> >>> the problem.
>> >>>
>> >>> If I could, I'd intercept the problem by checking
>> capabilities()["X11"] in
>> >>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
>> package
>> >>> imports the tcltk namespace, the error occurs before these startup
>> functions
>> >>> are executed -- a chicken-and-egg problem.
>> >>>
>> >>> It occurs to me that tcltk could fail more gracefully on Mac OS X
>> when X11
>> >>> is absent, perhaps popping up a webpage in a browser with
>> instructions and a
>> >>> link for installing XQuartz. I'd do this myself in the Rcmdr
>> package if I
>> >>> could. Or tcltk could check for the presence of X11 and not try to
>> start it
>> >>> if it's absent, reporting a warning rather than throwing an error.
>> >>>
>> >>> Alternatively, I'd be grateful if someone could suggest how I might
>> detect
>> >>> the problem in the Rcmdr package before loading fails. The only
>> thing that I
>> >>> could think of was writing a separate RcmdrInstall package that
>> bypasses
>> >>> tcltk, but that would be awkward and would only help users who
>> discovered
>> >>> that RcmdrInstall exists.
>> >>>
>> >>> Thanks,
>> >>> John
>> >>
>> >>
>> >> John,
>> >>
>> >> Is there someplace in your startup process where you could run code
>> along the lines of:
>> >>
>> >> if (grepl("apple", R.version$platform) &
>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>> >>     cat("X11 is required. Please visit http://xquartz.macosforge.org
>> to download and install Xquartz.")
>> >>     stop()
>> >> }
>> >>
>> >>
>> >> The above code will check to see if the user is running R on OS X
>> and also if the Xquartz binary is present in the default location.
>> >>
>> >> Not sure if this is helpful.
>> >
>> >
>> > A possible correction in the above code relative to detecting OS X:
>> >
>> > if ((Sys.info()["sysname"] == "Darwin") &
>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>> >     cat("X11 is required. Please visit http://xquartz.macosforge.org
>> to download and install Xquartz.")
>> >     stop()
>> > }
>> >
>> >
>> > I believe that Sys.info()["sysname"] == "Darwin" is preferred for
>> detecting the OS that R is running on versus the OS that it was built
>> upon according to the help files, if I read correctly. This could be
>> important if someone is building R from source versus installing
>> Simon's CRAN binary, I presume.
>> >
>> > Regards,
>> >
>> > Marc
>> >
>> > _______________________________________________
>> > R-SIG-Mac mailing list
>> > R-SIG-Mac at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From jmc at r-project.org  Tue Jul 15 03:41:22 2014
From: jmc at r-project.org (John Chambers)
Date: Mon, 14 Jul 2014 18:41:22 -0700
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <005001cf9fc0$e6269860$b273c920$@mcmaster.ca>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>
	<E26E9F48-234F-4528-9F7F-91876038CACB@me.com>
	<005001cf9fc0$e6269860$b273c920$@mcmaster.ca>
Message-ID: <44DBA666-1E42-4970-B08E-6338AFB14A87@r-project.org>

See ?setLoadActions, which arranges for functions to be called while the package's namespace is still accessible during load.

The .onLoad function is essentially useless for anything not in the base R.

JMC

On Jul 14, 2014, at 5:08 PM, John Fox <jfox at mcmaster.ca> wrote:

> Dear Marc and Kasper,
> 
> I already know how to test whether the Rcmdr is running under Mac OS X and
> to test whether X11 is installed. But AFAICS there is no way for me to run
> this code in the Rcmdr package at startup *before* tcltk fails to load -- I
> did try to do this, both in .onLoad() and in .onAttach(). 
> 
> I thought that I'd made this problem clear in my initial message but
> apparently I hadn't. I'd be happy if someone proved me wrong by showing me
> another way to intercept the problem on startup of the Rcmdr package, but I
> think that the fix has to go into tcltk, as Kasper suggests.
> 
> Best,
> John
> 
>> -----Original Message-----
>> From: Marc Schwartz [mailto:marc_schwartz at me.com]
>> Sent: Monday, July 14, 2014 6:33 PM
>> To: Kasper Daniel Hansen
>> Cc: John Fox; urbanek at research.att.com; r-sig-mac at r-project.org
>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>> 
>> Kasper,
>> 
>> Understood. I was not sure if there was someplace in John's startup
>> code that might catch it early on before tcltk loads, but that may be
>> confounded by the sequence of the package import process as John notes
>> below.
>> 
>> Reading R-exts and the related help files does not make it clear to me
>> that there is a window of opportunity to run the check before the
>> import occurs, but I would defer to Simon et al on the finer points
>> here.
>> 
>> Regards,
>> 
>> Marc
>> 
>> 
>> On Jul 14, 2014, at 5:07 PM, Kasper Daniel Hansen
>> <kasperdanielhansen at gmail.com> wrote:
>> 
>> 
>> 	Basically John is asking for code like this to be included in
>> tcltk.
>> 
>> 	Best,
>> 	Kasper
>> 
>> 
>> 	On Mon, Jul 14, 2014 at 11:53 PM, Marc Schwartz
>> <marc_schwartz at me.com> wrote:
>> 
>> 
>> 		On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca>
>> wrote:
>> 
>> 		> Dear Simon and list members,
>> 		>
>> 		> As many of you are aware, when X11 isn't installed on Mac
>> OS X, loading the
>> 		> tcltk package produces an error, with a message that many
>> users find
>> 		> cryptic. There was yet another instance of this problem
>> reported to the list
>> 		> today.
>> 		>
>> 		> I'm interested in the issue because the Rcmdr package uses
>> tcltk and thus
>> 		> fails to load when X11 is absent. Rcmdr users tend to be
>> inexperienced and
>> 		> so, unless they find their way to the Rcmdr installation
>> webpage, where
>> 		> detailed installation instructions are provided, they tend
>> to be stymied by
>> 		> the problem.
>> 		>
>> 		> If I could, I'd intercept the problem by checking
>> capabilities()["X11"] in
>> 		> the Rcmdr .onLoad() or .onAttach() function, but because
>> the Rcmdr package
>> 		> imports the tcltk namespace, the error occurs before these
>> startup functions
>> 		> are executed -- a chicken-and-egg problem.
>> 		>
>> 		> It occurs to me that tcltk could fail more gracefully on
>> Mac OS X when X11
>> 		> is absent, perhaps popping up a webpage in a browser with
>> instructions and a
>> 		> link for installing XQuartz. I'd do this myself in the
>> Rcmdr package if I
>> 		> could. Or tcltk could check for the presence of X11 and
> not
>> try to start it
>> 		> if it's absent, reporting a warning rather than throwing
> an
>> error.
>> 		>
>> 		> Alternatively, I'd be grateful if someone could suggest
> how
>> I might detect
>> 		> the problem in the Rcmdr package before loading fails. The
>> only thing that I
>> 		> could think of was writing a separate RcmdrInstall package
>> that bypasses
>> 		> tcltk, but that would be awkward and would only help users
>> who discovered
>> 		> that RcmdrInstall exists.
>> 		>
>> 		> Thanks,
>> 		> John
>> 
>> 
>> 
>> 		John,
>> 
>> 		Is there someplace in your startup process where you could
>> run code along the lines of:
>> 
>> 		if (grepl("apple", R.version$platform) &
>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>> 		     cat("X11 is required. Please visit
>> http://xquartz.macosforge.org <http://xquartz.macosforge.org/>  to
>> download and install Xquartz.")
>> 		     stop()
>> 		}
>> 
>> 
>> 		The above code will check to see if the user is running R on
>> OS X and also if the Xquartz binary is present in the default location.
>> 
>> 		Not sure if this is helpful.
>> 
>> 		Regards,
>> 
>> 		Marc Schwartz
>> 
>> 
>> 		_______________________________________________
>> 		R-SIG-Mac mailing list
>> 		R-SIG-Mac at r-project.org
>> 		https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> 
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From jfox at mcmaster.ca  Tue Jul 15 06:25:45 2014
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 15 Jul 2014 00:25:45 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <44DBA666-1E42-4970-B08E-6338AFB14A87@r-project.org>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<CAC2h7uuMJ2DMWUTwb+ac4gbhWX5La2VfC0LvdAAxoXD2kdt4Jg@mail.gmail.com>
	<E26E9F48-234F-4528-9F7F-91876038CACB@me.com>
	<005001cf9fc0$e6269860$b273c920$@mcmaster.ca>
	<44DBA666-1E42-4970-B08E-6338AFB14A87@r-project.org>
Message-ID: <web-518627037@cgpsrv2.cis.mcmaster.ca>

Dear John,

That looks like exactly what I need -- I'll try it.

I still think that it would be best to handle this issue in the tcltk package, but this should solve my problem in the Rcmdr package.

Thanks,
 John

On Mon, 14 Jul 2014 18:41:22 -0700
 John Chambers <jmc at r-project.org> wrote:
> See ?setLoadActions, which arranges for functions to be called while the package's namespace is still accessible during load.
> 
> The .onLoad function is essentially useless for anything not in the base R.
> 
> JMC
> 
> On Jul 14, 2014, at 5:08 PM, John Fox <jfox at mcmaster.ca> wrote:
> 
> > Dear Marc and Kasper,
> > 
> > I already know how to test whether the Rcmdr is running under Mac OS X and
> > to test whether X11 is installed. But AFAICS there is no way for me to run
> > this code in the Rcmdr package at startup *before* tcltk fails to load -- I
> > did try to do this, both in .onLoad() and in .onAttach(). 
> > 
> > I thought that I'd made this problem clear in my initial message but
> > apparently I hadn't. I'd be happy if someone proved me wrong by showing me
> > another way to intercept the problem on startup of the Rcmdr package, but I
> > think that the fix has to go into tcltk, as Kasper suggests.
> > 
> > Best,
> > John
> > 
> >> -----Original Message-----
> >> From: Marc Schwartz [mailto:marc_schwartz at me.com]
> >> Sent: Monday, July 14, 2014 6:33 PM
> >> To: Kasper Daniel Hansen
> >> Cc: John Fox; urbanek at research.att.com; r-sig-mac at r-project.org
> >> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
> >> 
> >> Kasper,
> >> 
> >> Understood. I was not sure if there was someplace in John's startup
> >> code that might catch it early on before tcltk loads, but that may be
> >> confounded by the sequence of the package import process as John notes
> >> below.
> >> 
> >> Reading R-exts and the related help files does not make it clear to me
> >> that there is a window of opportunity to run the check before the
> >> import occurs, but I would defer to Simon et al on the finer points
> >> here.
> >> 
> >> Regards,
> >> 
> >> Marc
> >> 
> >> 
> >> On Jul 14, 2014, at 5:07 PM, Kasper Daniel Hansen
> >> <kasperdanielhansen at gmail.com> wrote:
> >> 
> >> 
> >> 	Basically John is asking for code like this to be included in
> >> tcltk.
> >> 
> >> 	Best,
> >> 	Kasper
> >> 
> >> 
> >> 	On Mon, Jul 14, 2014 at 11:53 PM, Marc Schwartz
> >> <marc_schwartz at me.com> wrote:
> >> 
> >> 
> >> 		On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca>
> >> wrote:
> >> 
> >> 		> Dear Simon and list members,
> >> 		>
> >> 		> As many of you are aware, when X11 isn't installed on Mac
> >> OS X, loading the
> >> 		> tcltk package produces an error, with a message that many
> >> users find
> >> 		> cryptic. There was yet another instance of this problem
> >> reported to the list
> >> 		> today.
> >> 		>
> >> 		> I'm interested in the issue because the Rcmdr package uses
> >> tcltk and thus
> >> 		> fails to load when X11 is absent. Rcmdr users tend to be
> >> inexperienced and
> >> 		> so, unless they find their way to the Rcmdr installation
> >> webpage, where
> >> 		> detailed installation instructions are provided, they tend
> >> to be stymied by
> >> 		> the problem.
> >> 		>
> >> 		> If I could, I'd intercept the problem by checking
> >> capabilities()["X11"] in
> >> 		> the Rcmdr .onLoad() or .onAttach() function, but because
> >> the Rcmdr package
> >> 		> imports the tcltk namespace, the error occurs before these
> >> startup functions
> >> 		> are executed -- a chicken-and-egg problem.
> >> 		>
> >> 		> It occurs to me that tcltk could fail more gracefully on
> >> Mac OS X when X11
> >> 		> is absent, perhaps popping up a webpage in a browser with
> >> instructions and a
> >> 		> link for installing XQuartz. I'd do this myself in the
> >> Rcmdr package if I
> >> 		> could. Or tcltk could check for the presence of X11 and
> > not
> >> try to start it
> >> 		> if it's absent, reporting a warning rather than throwing
> > an
> >> error.
> >> 		>
> >> 		> Alternatively, I'd be grateful if someone could suggest
> > how
> >> I might detect
> >> 		> the problem in the Rcmdr package before loading fails. The
> >> only thing that I
> >> 		> could think of was writing a separate RcmdrInstall package
> >> that bypasses
> >> 		> tcltk, but that would be awkward and would only help users
> >> who discovered
> >> 		> that RcmdrInstall exists.
> >> 		>
> >> 		> Thanks,
> >> 		> John
> >> 
> >> 
> >> 
> >> 		John,
> >> 
> >> 		Is there someplace in your startup process where you could
> >> run code along the lines of:
> >> 
> >> 		if (grepl("apple", R.version$platform) &
> >> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >> 		     cat("X11 is required. Please visit
> >> http://xquartz.macosforge.org <http://xquartz.macosforge.org/>  to
> >> download and install Xquartz.")
> >> 		     stop()
> >> 		}
> >> 
> >> 
> >> 		The above code will check to see if the user is running R on
> >> OS X and also if the Xquartz binary is present in the default location.
> >> 
> >> 		Not sure if this is helpful.
> >> 
> >> 		Regards,
> >> 
> >> 		Marc Schwartz
> >> 
> >> 
> >> 		_______________________________________________
> >> 		R-SIG-Mac mailing list
> >> 		R-SIG-Mac at r-project.org
> >> 		https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >> 
> >> 
> >> 
> > 
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
>


From jfox at mcmaster.ca  Tue Jul 15 06:37:19 2014
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 15 Jul 2014 00:37:19 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
Message-ID: <web-518627350@cgpsrv2.cis.mcmaster.ca>

Hi Gabor,

Thanks for the clarification.

I agree that it would be best to intercept the problem on Linux/Unix as well as on Mac OS X. Do you know that X11 is necessary for the tcltk package to work on Linux/Unix systems (or is there possibly a non-X11 Tcl/Tk there that's compatible with the tcltk package)?

As a practical matter, the problem occurs with some regularity on Mac OS X (I'm aware that the availability and default installation of X11 varies by version of the OS), but I've not seen a report of it on Linux, so my immediate concern was to solve the problem on Mac OS X.

Best,
 John

On Mon, 14 Jul 2014 21:37:54 -0400
 G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> Hi John,
> 
> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
> > Dear Gabor,
> >
> > As I just explained, the problem isn't testing for X11, which I know how to do -- though capabilities("X11") is a bit better than what I suggested. The issue is specific to Mac OS X because the Windows implementation of R includes a Tcl/Tk that doesn't use X11, and I've never seen the problem on Linux.
> 
> actually, what I am saying is, that it is not specific to OSX. Some
> (older, before 2012) OSX versions do include an X11 server, and some
> Linux or other Unix installations do not.
> 
> I am not saying tcltk should not test for an X11 server, all I am
> saying is that the test suggested below (based on the os and the
> existence of a certain file) is not the best one.
> 
> If it turns out that there is no X11 server, and the os is OSX, then
> indeed a dialog box could be displayed, see e.g. the one at
> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-x-mountain-lion-shifts-support-to-open-source-xquartz/
> 
> Best,
> Gabor
> 
> > Best,
> >  John
> >
> >> -----Original Message-----
> >> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
> >> Sent: Monday, July 14, 2014 6:37 PM
> >> To: Marc Schwartz
> >> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
> >> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
> >>
> >> What's wrong with capabilities("X11")?
> >>
> >> I am not sure if teting for the OS, and especially for a particular X
> >> server, installed in a particular directory, is a good idea, even if
> >> it covers most of the _current_ installations.
> >>
> >> Gabor
> >>
> >> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
> >> wrote:
> >> >
> >> > On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
> >> wrote:
> >> >
> >> >> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
> >> >>
> >> >>> Dear Simon and list members,
> >> >>>
> >> >>> As many of you are aware, when X11 isn't installed on Mac OS X,
> >> loading the
> >> >>> tcltk package produces an error, with a message that many users
> >> find
> >> >>> cryptic. There was yet another instance of this problem reported to
> >> the list
> >> >>> today.
> >> >>>
> >> >>> I'm interested in the issue because the Rcmdr package uses tcltk
> >> and thus
> >> >>> fails to load when X11 is absent. Rcmdr users tend to be
> >> inexperienced and
> >> >>> so, unless they find their way to the Rcmdr installation webpage,
> >> where
> >> >>> detailed installation instructions are provided, they tend to be
> >> stymied by
> >> >>> the problem.
> >> >>>
> >> >>> If I could, I'd intercept the problem by checking
> >> capabilities()["X11"] in
> >> >>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
> >> package
> >> >>> imports the tcltk namespace, the error occurs before these startup
> >> functions
> >> >>> are executed -- a chicken-and-egg problem.
> >> >>>
> >> >>> It occurs to me that tcltk could fail more gracefully on Mac OS X
> >> when X11
> >> >>> is absent, perhaps popping up a webpage in a browser with
> >> instructions and a
> >> >>> link for installing XQuartz. I'd do this myself in the Rcmdr
> >> package if I
> >> >>> could. Or tcltk could check for the presence of X11 and not try to
> >> start it
> >> >>> if it's absent, reporting a warning rather than throwing an error.
> >> >>>
> >> >>> Alternatively, I'd be grateful if someone could suggest how I might
> >> detect
> >> >>> the problem in the Rcmdr package before loading fails. The only
> >> thing that I
> >> >>> could think of was writing a separate RcmdrInstall package that
> >> bypasses
> >> >>> tcltk, but that would be awkward and would only help users who
> >> discovered
> >> >>> that RcmdrInstall exists.
> >> >>>
> >> >>> Thanks,
> >> >>> John
> >> >>
> >> >>
> >> >> John,
> >> >>
> >> >> Is there someplace in your startup process where you could run code
> >> along the lines of:
> >> >>
> >> >> if (grepl("apple", R.version$platform) &
> >> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >> >>     cat("X11 is required. Please visit http://xquartz.macosforge.org
> >> to download and install Xquartz.")
> >> >>     stop()
> >> >> }
> >> >>
> >> >>
> >> >> The above code will check to see if the user is running R on OS X
> >> and also if the Xquartz binary is present in the default location.
> >> >>
> >> >> Not sure if this is helpful.
> >> >
> >> >
> >> > A possible correction in the above code relative to detecting OS X:
> >> >
> >> > if ((Sys.info()["sysname"] == "Darwin") &
> >> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >> >     cat("X11 is required. Please visit http://xquartz.macosforge.org
> >> to download and install Xquartz.")
> >> >     stop()
> >> > }
> >> >
> >> >
> >> > I believe that Sys.info()["sysname"] == "Darwin" is preferred for
> >> detecting the OS that R is running on versus the OS that it was built
> >> upon according to the help files, if I read correctly. This could be
> >> important if someone is building R from source versus installing
> >> Simon's CRAN binary, I presume.
> >> >
> >> > Regards,
> >> >
> >> > Marc
> >> >
> >> > _______________________________________________
> >> > R-SIG-Mac mailing list
> >> > R-SIG-Mac at r-project.org
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >


From marc_schwartz at me.com  Tue Jul 15 14:05:43 2014
From: marc_schwartz at me.com (Marc Schwartz)
Date: Tue, 15 Jul 2014 07:05:43 -0500
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <web-518627350@cgpsrv2.cis.mcmaster.ca>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
	<web-518627350@cgpsrv2.cis.mcmaster.ca>
Message-ID: <034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>

John,

First, apologies for my narrow focus on the solutions that I proposed yesterday. I suffered from tunnel vision on the OS X issue and as Gabor has noted, it would not be sufficiently portable. There can be potential variations on where X11 is installed on OS X, depending upon the use of Xquartz, the original Apple distribution of X11 and presumably could further vary if one installs from source, is using Homebrew, Macports or similar, which are package management systems for OS X. Thus, as Gabor pointed out, capabilities("X11") is the most portable approach.

With respect to Linux, to the best of my knowledge, X11 (for some time X.org) is still a requirement for tk (but not tcl). In checking at least the current Fedora repos, X11 is still listed as a dependency for tk. So if one is using the common package management systems, X11 will be installed if not already, when installing tk, unless one overrides the defaults.

Also, at least for Fedora and perhaps other Linuxen, X11 is listed as a dependency for R itself, so if one is installing R on Fedora, X11 will be installed as well, if not present.

Thus, between the common Linux package management systems and that Linux users tend to be more technically saavy, you do not see many reports.

You likely already know this, but you could utilize a more generic approach to testing the platform by using:

  if (.Platform$OS.type == "unix")
    ...

which would cover Linuxen, Unixen and OS X and then run your X11 checks, secondarily perhaps testing for OS X, if you wish to give a more specific error message for OS X users and point them to XQuartz.

Regards,

Marc

 

On Jul 14, 2014, at 11:37 PM, John Fox <jfox at mcmaster.ca> wrote:

> Hi Gabor,
> 
> Thanks for the clarification.
> 
> I agree that it would be best to intercept the problem on Linux/Unix as well as on Mac OS X. Do you know that X11 is necessary for the tcltk package to work on Linux/Unix systems (or is there possibly a non-X11 Tcl/Tk there that's compatible with the tcltk package)?
> 
> As a practical matter, the problem occurs with some regularity on Mac OS X (I'm aware that the availability and default installation of X11 varies by version of the OS), but I've not seen a report of it on Linux, so my immediate concern was to solve the problem on Mac OS X.
> 
> Best,
> John
> 
> On Mon, 14 Jul 2014 21:37:54 -0400
> G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>> Hi John,
>> 
>> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
>>> Dear Gabor,
>>> 
>>> As I just explained, the problem isn't testing for X11, which I know how to do -- though capabilities("X11") is a bit better than what I suggested. The issue is specific to Mac OS X because the Windows implementation of R includes a Tcl/Tk that doesn't use X11, and I've never seen the problem on Linux.
>> 
>> actually, what I am saying is, that it is not specific to OSX. Some
>> (older, before 2012) OSX versions do include an X11 server, and some
>> Linux or other Unix installations do not.
>> 
>> I am not saying tcltk should not test for an X11 server, all I am
>> saying is that the test suggested below (based on the os and the
>> existence of a certain file) is not the best one.
>> 
>> If it turns out that there is no X11 server, and the os is OSX, then
>> indeed a dialog box could be displayed, see e.g. the one at
>> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-x-mountain-lion-shifts-support-to-open-source-xquartz/
>> 
>> Best,
>> Gabor
>> 
>>> Best,
>>> John
>>> 
>>>> -----Original Message-----
>>>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
>>>> Sent: Monday, July 14, 2014 6:37 PM
>>>> To: Marc Schwartz
>>>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
>>>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>>>> 
>>>> What's wrong with capabilities("X11")?
>>>> 
>>>> I am not sure if teting for the OS, and especially for a particular X
>>>> server, installed in a particular directory, is a good idea, even if
>>>> it covers most of the _current_ installations.
>>>> 
>>>> Gabor
>>>> 
>>>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
>>>> wrote:
>>>>> 
>>>>> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
>>>> wrote:
>>>>> 
>>>>>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>>> 
>>>>>>> Dear Simon and list members,
>>>>>>> 
>>>>>>> As many of you are aware, when X11 isn't installed on Mac OS X,
>>>> loading the
>>>>>>> tcltk package produces an error, with a message that many users
>>>> find
>>>>>>> cryptic. There was yet another instance of this problem reported to
>>>> the list
>>>>>>> today.
>>>>>>> 
>>>>>>> I'm interested in the issue because the Rcmdr package uses tcltk
>>>> and thus
>>>>>>> fails to load when X11 is absent. Rcmdr users tend to be
>>>> inexperienced and
>>>>>>> so, unless they find their way to the Rcmdr installation webpage,
>>>> where
>>>>>>> detailed installation instructions are provided, they tend to be
>>>> stymied by
>>>>>>> the problem.
>>>>>>> 
>>>>>>> If I could, I'd intercept the problem by checking
>>>> capabilities()["X11"] in
>>>>>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
>>>> package
>>>>>>> imports the tcltk namespace, the error occurs before these startup
>>>> functions
>>>>>>> are executed -- a chicken-and-egg problem.
>>>>>>> 
>>>>>>> It occurs to me that tcltk could fail more gracefully on Mac OS X
>>>> when X11
>>>>>>> is absent, perhaps popping up a webpage in a browser with
>>>> instructions and a
>>>>>>> link for installing XQuartz. I'd do this myself in the Rcmdr
>>>> package if I
>>>>>>> could. Or tcltk could check for the presence of X11 and not try to
>>>> start it
>>>>>>> if it's absent, reporting a warning rather than throwing an error.
>>>>>>> 
>>>>>>> Alternatively, I'd be grateful if someone could suggest how I might
>>>> detect
>>>>>>> the problem in the Rcmdr package before loading fails. The only
>>>> thing that I
>>>>>>> could think of was writing a separate RcmdrInstall package that
>>>> bypasses
>>>>>>> tcltk, but that would be awkward and would only help users who
>>>> discovered
>>>>>>> that RcmdrInstall exists.
>>>>>>> 
>>>>>>> Thanks,
>>>>>>> John
>>>>>> 
>>>>>> 
>>>>>> John,
>>>>>> 
>>>>>> Is there someplace in your startup process where you could run code
>>>> along the lines of:
>>>>>> 
>>>>>> if (grepl("apple", R.version$platform) &
>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>> to download and install Xquartz.")
>>>>>>    stop()
>>>>>> }
>>>>>> 
>>>>>> 
>>>>>> The above code will check to see if the user is running R on OS X
>>>> and also if the Xquartz binary is present in the default location.
>>>>>> 
>>>>>> Not sure if this is helpful.
>>>>> 
>>>>> 
>>>>> A possible correction in the above code relative to detecting OS X:
>>>>> 
>>>>> if ((Sys.info()["sysname"] == "Darwin") &
>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>> to download and install Xquartz.")
>>>>>    stop()
>>>>> }
>>>>> 
>>>>> 
>>>>> I believe that Sys.info()["sysname"] == "Darwin" is preferred for
>>>> detecting the OS that R is running on versus the OS that it was built
>>>> upon according to the help files, if I read correctly. This could be
>>>> important if someone is building R from source versus installing
>>>> Simon's CRAN binary, I presume.
>>>>> 
>>>>> Regards,
>>>>> 
>>>>> Marc
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 


From ripley at stats.ox.ac.uk  Tue Jul 15 16:16:21 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 15 Jul 2014 15:16:21 +0100
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>	<web-518627350@cgpsrv2.cis.mcmaster.ca>
	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
Message-ID: <53C537B5.9050501@stats.ox.ac.uk>

John talked to me about this a month ago and after some sick 
leave/vacation I had just got around to thinking into it.

Minor points:

1) The usual way to check for OS X in the R sources is
grepl("darwin", R.version$os)

2) It is perfectly possible to build R on Linuxen without X11 
headers/libraries.

3) There are three branches to the Tk code, X11, Aqua and Windows.  So 
apart from on Windows and OS X you either use X11 or do not have Tk.

4) It is possible to build R without Tcl/Tk, in which case you get a 
stub tcltk package.  Then capabilities('tcltk') tells you that you have 
the stub.

5) Just so we are all understand, it is possible (and documented in the 
manuals) for tcltk to be built using the Aqua Tk branch, and then Rcmdr 
works well (in my opinion much better) without X11 present.  So we do 
not want Rcmdr checking unconditionally for X11 being present.


My understanding is that the main problem is that if someone installs 
one of the CRAN binary packages for OS X and does not have X11 installed 
then library(tcltk) will fail with a message that they do not 
understand, e.g. 
https://stat.ethz.ch/pipermail/r-sig-mac/2014-July/010954.html .

For the future, probably the best thing to do is for the tcltk startup 
code to try to trap that case and suggest that X11/XQuartz needs to be 
installed.  The problem is accurately identifying 'that case'.

If a package has tcltk in the imports of its NAMESPACE, there is nothing 
it can do about a broken tcltk as the namespaces it imports will be 
processed before any of the code in the package.  So the other 
possibility is to not have tcltk in the imports but to load its 
namespace via Rcmd::.onLoad.  I figured out how to to do that but it 
would be rather fragile.


There is another possible problem which is that X11 is installed but a X 
server is not running.  That's what capabilities('X11') checks, and on 
modern OS X it ought to launch the X server as required.  However, I do 
not think we have a way to telling which Tk branch package tcltk was 
built against.  Since that is only an issue on OS X (no other OS can use 
more than one branch) you could use something like

Tk_is_X11 <- function()
{
     DLL <- system.file("libs", "tcltk.so", package = "tcltk")
     out <- system2("otool", c("-L", shQuote(DLL)), stdout = TRUE)
     length(grep("libX11[.][0-9]+[.]dylib", out)) > 0L
}

and then

if (.Platform$OS.type == "unix") {
    if (!grepl("darwin", R.version$os) || Tk_is_X11())
        if(!capabilities("X11"))
             stop("Rcmdr requires a running X server")
}


On 15/07/2014 13:05, Marc Schwartz wrote:
> John,
>
> First, apologies for my narrow focus on the solutions that I proposed yesterday. I suffered from tunnel vision on the OS X issue and as Gabor has noted, it would not be sufficiently portable. There can be potential variations on where X11 is installed on OS X, depending upon the use of Xquartz, the original Apple distribution of X11 and presumably could further vary if one installs from source, is using Homebrew, Macports or similar, which are package management systems for OS X. Thus, as Gabor pointed out, capabilities("X11") is the most portable approach.
>
> With respect to Linux, to the best of my knowledge, X11 (for some time X.org) is still a requirement for tk (but not tcl). In checking at least the current Fedora repos, X11 is still listed as a dependency for tk. So if one is using the common package management systems, X11 will be installed if not already, when installing tk, unless one overrides the defaults.
>
> Also, at least for Fedora and perhaps other Linuxen, X11 is listed as a dependency for R itself, so if one is installing R on Fedora, X11 will be installed as well, if not present.
>
> Thus, between the common Linux package management systems and that Linux users tend to be more technically saavy, you do not see many reports.
>
> You likely already know this, but you could utilize a more generic approach to testing the platform by using:
>
>    if (.Platform$OS.type == "unix")
>      ...
>
> which would cover Linuxen, Unixen and OS X and then run your X11 checks, secondarily perhaps testing for OS X, if you wish to give a more specific error message for OS X users and point them to XQuartz.
>
> Regards,
>
> Marc
>
>
>
> On Jul 14, 2014, at 11:37 PM, John Fox <jfox at mcmaster.ca> wrote:
>
>> Hi Gabor,
>>
>> Thanks for the clarification.
>>
>> I agree that it would be best to intercept the problem on Linux/Unix as well as on Mac OS X. Do you know that X11 is necessary for the tcltk package to work on Linux/Unix systems (or is there possibly a non-X11 Tcl/Tk there that's compatible with the tcltk package)?
>>
>> As a practical matter, the problem occurs with some regularity on Mac OS X (I'm aware that the availability and default installation of X11 varies by version of the OS), but I've not seen a report of it on Linux, so my immediate concern was to solve the problem on Mac OS X.
>>
>> Best,
>> John
>>
>> On Mon, 14 Jul 2014 21:37:54 -0400
>> G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>>> Hi John,
>>>
>>> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>> Dear Gabor,
>>>>
>>>> As I just explained, the problem isn't testing for X11, which I know how to do -- though capabilities("X11") is a bit better than what I suggested. The issue is specific to Mac OS X because the Windows implementation of R includes a Tcl/Tk that doesn't use X11, and I've never seen the problem on Linux.
>>>
>>> actually, what I am saying is, that it is not specific to OSX. Some
>>> (older, before 2012) OSX versions do include an X11 server, and some
>>> Linux or other Unix installations do not.
>>>
>>> I am not saying tcltk should not test for an X11 server, all I am
>>> saying is that the test suggested below (based on the os and the
>>> existence of a certain file) is not the best one.
>>>
>>> If it turns out that there is no X11 server, and the os is OSX, then
>>> indeed a dialog box could be displayed, see e.g. the one at
>>> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-x-mountain-lion-shifts-support-to-open-source-xquartz/
>>>
>>> Best,
>>> Gabor
>>>
>>>> Best,
>>>> John
>>>>
>>>>> -----Original Message-----
>>>>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
>>>>> Sent: Monday, July 14, 2014 6:37 PM
>>>>> To: Marc Schwartz
>>>>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
>>>>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>>>>>
>>>>> What's wrong with capabilities("X11")?
>>>>>
>>>>> I am not sure if teting for the OS, and especially for a particular X
>>>>> server, installed in a particular directory, is a good idea, even if
>>>>> it covers most of the _current_ installations.
>>>>>
>>>>> Gabor
>>>>>
>>>>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>> wrote:
>>>>>>
>>>>>> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>> wrote:
>>>>>>
>>>>>>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>>>>
>>>>>>>> Dear Simon and list members,
>>>>>>>>
>>>>>>>> As many of you are aware, when X11 isn't installed on Mac OS X,
>>>>> loading the
>>>>>>>> tcltk package produces an error, with a message that many users
>>>>> find
>>>>>>>> cryptic. There was yet another instance of this problem reported to
>>>>> the list
>>>>>>>> today.
>>>>>>>>
>>>>>>>> I'm interested in the issue because the Rcmdr package uses tcltk
>>>>> and thus
>>>>>>>> fails to load when X11 is absent. Rcmdr users tend to be
>>>>> inexperienced and
>>>>>>>> so, unless they find their way to the Rcmdr installation webpage,
>>>>> where
>>>>>>>> detailed installation instructions are provided, they tend to be
>>>>> stymied by
>>>>>>>> the problem.
>>>>>>>>
>>>>>>>> If I could, I'd intercept the problem by checking
>>>>> capabilities()["X11"] in
>>>>>>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
>>>>> package
>>>>>>>> imports the tcltk namespace, the error occurs before these startup
>>>>> functions
>>>>>>>> are executed -- a chicken-and-egg problem.
>>>>>>>>
>>>>>>>> It occurs to me that tcltk could fail more gracefully on Mac OS X
>>>>> when X11
>>>>>>>> is absent, perhaps popping up a webpage in a browser with
>>>>> instructions and a
>>>>>>>> link for installing XQuartz. I'd do this myself in the Rcmdr
>>>>> package if I
>>>>>>>> could. Or tcltk could check for the presence of X11 and not try to
>>>>> start it
>>>>>>>> if it's absent, reporting a warning rather than throwing an error.
>>>>>>>>
>>>>>>>> Alternatively, I'd be grateful if someone could suggest how I might
>>>>> detect
>>>>>>>> the problem in the Rcmdr package before loading fails. The only
>>>>> thing that I
>>>>>>>> could think of was writing a separate RcmdrInstall package that
>>>>> bypasses
>>>>>>>> tcltk, but that would be awkward and would only help users who
>>>>> discovered
>>>>>>>> that RcmdrInstall exists.
>>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> John
>>>>>>>
>>>>>>>
>>>>>>> John,
>>>>>>>
>>>>>>> Is there someplace in your startup process where you could run code
>>>>> along the lines of:
>>>>>>>
>>>>>>> if (grepl("apple", R.version$platform) &
>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>>     cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>>> to download and install Xquartz.")
>>>>>>>     stop()
>>>>>>> }
>>>>>>>
>>>>>>>
>>>>>>> The above code will check to see if the user is running R on OS X
>>>>> and also if the Xquartz binary is present in the default location.
>>>>>>>
>>>>>>> Not sure if this is helpful.
>>>>>>
>>>>>>
>>>>>> A possible correction in the above code relative to detecting OS X:
>>>>>>
>>>>>> if ((Sys.info()["sysname"] == "Darwin") &
>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>     cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>>> to download and install Xquartz.")
>>>>>>     stop()
>>>>>> }
>>>>>>
>>>>>>
>>>>>> I believe that Sys.info()["sysname"] == "Darwin" is preferred for
>>>>> detecting the OS that R is running on versus the OS that it was built
>>>>> upon according to the help files, if I read correctly. This could be
>>>>> important if someone is building R from source versus installing
>>>>> Simon's CRAN binary, I presume.
>>>>>>
>>>>>> Regards,
>>>>>>
>>>>>> Marc
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-SIG-Mac mailing list
>>>>>> R-SIG-Mac at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From kasperdanielhansen at gmail.com  Tue Jul 15 21:01:26 2014
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Tue, 15 Jul 2014 21:01:26 +0200
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <53C537B5.9050501@stats.ox.ac.uk>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
	<web-518627350@cgpsrv2.cis.mcmaster.ca>
	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
	<53C537B5.9050501@stats.ox.ac.uk>
Message-ID: <CAC2h7uuBf8SLt1t7cToY32w7RJHGNkPnJmC649-pCG0agJ-WnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140715/31357b04/attachment.pl>

From simon.urbanek at r-project.org  Thu Jul 17 02:05:23 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 16 Jul 2014 20:05:23 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <CAC2h7uuBf8SLt1t7cToY32w7RJHGNkPnJmC649-pCG0agJ-WnQ@mail.gmail.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
	<web-518627350@cgpsrv2.cis.mcmaster.ca>
	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
	<53C537B5.9050501@stats.ox.ac.uk>
	<CAC2h7uuBf8SLt1t7cToY32w7RJHGNkPnJmC649-pCG0agJ-WnQ@mail.gmail.com>
Message-ID: <05350A4D-7C17-4CD7-B28A-F128A918CDC6@r-project.org>

On Jul 15, 2014, at 3:01 PM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:

> Prof Ripley and other people involved with tcltk,
> 
> You could have the tcltk building routine leave some evidence behind re.
> how it was build.
> 
> For example, in Rgraphviz we used to grapple with something similar at the
> abstract level - was the Graphviz version used to build a binary
> distributed version of Rgraphviz, the same as the Graphviz installed by the
> user (if there was a version mismatch on Windows, there was a high chance
> of an arcane error time).  As part of running configure, we save the
> Graphviz version at build time into a variable kept in a file in /R.
> Specifically we have a file
> R/graphviz_build_version.R.in
> which contains something like
>  graphviz_build_version=@GRAPHVIZ_BUILD@
> configure does the usual transformation (code here is from memory).
> 
> This was then checked in .onLoad before the Rgraphviz dynamic library was
> loaded.  Now the code is different, because we bundle Graphviz with
> Rgraphviz.
> 
> Something similar should not be too hard to introduce for tcltk to keep a
> record of how it was build.
> 
> We see a lot of noise about this issue, so it may be worthwhile to solve
> robustly.
> 

Well, but the above is entirely irrelevant to the discussion at hand (AFAICT). The problem here is that we are talking about *binary* distribution - so the build process was indeed created in a fully working environment, but the user failed to re-create the environment and thus the assumptions at build time are broken. The assumptions are directly at the linking level, and the dependency that fails is not even under our control - X11 installation - so it's not something we can modify.

Brian did indeed describe quite precisely the various issues involved here.

IMHO the other contributions are a bit off track - I would argue that this is only about CRAN binary so adding a very specific extra check in R along the lines of what Brian proposed is the most robust and relevant way forward (note that the check may be identical for the X11 device). We're certainly not talking about a cross-platform solution but rather a very specific solution for the CRAN binary.

Cheers,
Simon



> Best,
> Kasper
> 
> 
> On Tue, Jul 15, 2014 at 4:16 PM, Prof Brian Ripley <ripley at stats.ox.ac.uk>
> wrote:
> 
>> John talked to me about this a month ago and after some sick
>> leave/vacation I had just got around to thinking into it.
>> 
>> Minor points:
>> 
>> 1) The usual way to check for OS X in the R sources is
>> grepl("darwin", R.version$os)
>> 
>> 2) It is perfectly possible to build R on Linuxen without X11
>> headers/libraries.
>> 
>> 3) There are three branches to the Tk code, X11, Aqua and Windows.  So
>> apart from on Windows and OS X you either use X11 or do not have Tk.
>> 
>> 4) It is possible to build R without Tcl/Tk, in which case you get a stub
>> tcltk package.  Then capabilities('tcltk') tells you that you have the stub.
>> 
>> 5) Just so we are all understand, it is possible (and documented in the
>> manuals) for tcltk to be built using the Aqua Tk branch, and then Rcmdr
>> works well (in my opinion much better) without X11 present.  So we do not
>> want Rcmdr checking unconditionally for X11 being present.
>> 
>> 
>> My understanding is that the main problem is that if someone installs one
>> of the CRAN binary packages for OS X and does not have X11 installed then
>> library(tcltk) will fail with a message that they do not understand, e.g.
>> https://stat.ethz.ch/pipermail/r-sig-mac/2014-July/010954.html .
>> 
>> For the future, probably the best thing to do is for the tcltk startup
>> code to try to trap that case and suggest that X11/XQuartz needs to be
>> installed.  The problem is accurately identifying 'that case'.
>> 
>> If a package has tcltk in the imports of its NAMESPACE, there is nothing
>> it can do about a broken tcltk as the namespaces it imports will be
>> processed before any of the code in the package.  So the other possibility
>> is to not have tcltk in the imports but to load its namespace via
>> Rcmd::.onLoad.  I figured out how to to do that but it would be rather
>> fragile.
>> 
>> 
>> There is another possible problem which is that X11 is installed but a X
>> server is not running.  That's what capabilities('X11') checks, and on
>> modern OS X it ought to launch the X server as required.  However, I do not
>> think we have a way to telling which Tk branch package tcltk was built
>> against.  Since that is only an issue on OS X (no other OS can use more
>> than one branch) you could use something like
>> 
>> Tk_is_X11 <- function()
>> {
>>    DLL <- system.file("libs", "tcltk.so", package = "tcltk")
>>    out <- system2("otool", c("-L", shQuote(DLL)), stdout = TRUE)
>>    length(grep("libX11[.][0-9]+[.]dylib", out)) > 0L
>> }
>> 
>> and then
>> 
>> if (.Platform$OS.type == "unix") {
>>   if (!grepl("darwin", R.version$os) || Tk_is_X11())
>>       if(!capabilities("X11"))
>>            stop("Rcmdr requires a running X server")
>> 
>> }
>> 
>> 
>> On 15/07/2014 13:05, Marc Schwartz wrote:
>> 
>>> John,
>>> 
>>> First, apologies for my narrow focus on the solutions that I proposed
>>> yesterday. I suffered from tunnel vision on the OS X issue and as Gabor has
>>> noted, it would not be sufficiently portable. There can be potential
>>> variations on where X11 is installed on OS X, depending upon the use of
>>> Xquartz, the original Apple distribution of X11 and presumably could
>>> further vary if one installs from source, is using Homebrew, Macports or
>>> similar, which are package management systems for OS X. Thus, as Gabor
>>> pointed out, capabilities("X11") is the most portable approach.
>>> 
>>> With respect to Linux, to the best of my knowledge, X11 (for some time
>>> X.org) is still a requirement for tk (but not tcl). In checking at least
>>> the current Fedora repos, X11 is still listed as a dependency for tk. So if
>>> one is using the common package management systems, X11 will be installed
>>> if not already, when installing tk, unless one overrides the defaults.
>>> 
>>> Also, at least for Fedora and perhaps other Linuxen, X11 is listed as a
>>> dependency for R itself, so if one is installing R on Fedora, X11 will be
>>> installed as well, if not present.
>>> 
>>> Thus, between the common Linux package management systems and that Linux
>>> users tend to be more technically saavy, you do not see many reports.
>>> 
>>> You likely already know this, but you could utilize a more generic
>>> approach to testing the platform by using:
>>> 
>>>   if (.Platform$OS.type == "unix")
>>>     ...
>>> 
>>> which would cover Linuxen, Unixen and OS X and then run your X11 checks,
>>> secondarily perhaps testing for OS X, if you wish to give a more specific
>>> error message for OS X users and point them to XQuartz.
>>> 
>>> Regards,
>>> 
>>> Marc
>>> 
>>> 
>>> 
>>> On Jul 14, 2014, at 11:37 PM, John Fox <jfox at mcmaster.ca> wrote:
>>> 
>>> Hi Gabor,
>>>> 
>>>> Thanks for the clarification.
>>>> 
>>>> I agree that it would be best to intercept the problem on Linux/Unix as
>>>> well as on Mac OS X. Do you know that X11 is necessary for the tcltk
>>>> package to work on Linux/Unix systems (or is there possibly a non-X11
>>>> Tcl/Tk there that's compatible with the tcltk package)?
>>>> 
>>>> As a practical matter, the problem occurs with some regularity on Mac OS
>>>> X (I'm aware that the availability and default installation of X11 varies
>>>> by version of the OS), but I've not seen a report of it on Linux, so my
>>>> immediate concern was to solve the problem on Mac OS X.
>>>> 
>>>> Best,
>>>> John
>>>> 
>>>> On Mon, 14 Jul 2014 21:37:54 -0400
>>>> G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>>>> 
>>>>> Hi John,
>>>>> 
>>>>> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>> 
>>>>>> Dear Gabor,
>>>>>> 
>>>>>> As I just explained, the problem isn't testing for X11, which I know
>>>>>> how to do -- though capabilities("X11") is a bit better than what I
>>>>>> suggested. The issue is specific to Mac OS X because the Windows
>>>>>> implementation of R includes a Tcl/Tk that doesn't use X11, and I've never
>>>>>> seen the problem on Linux.
>>>>>> 
>>>>> 
>>>>> actually, what I am saying is, that it is not specific to OSX. Some
>>>>> (older, before 2012) OSX versions do include an X11 server, and some
>>>>> Linux or other Unix installations do not.
>>>>> 
>>>>> I am not saying tcltk should not test for an X11 server, all I am
>>>>> saying is that the test suggested below (based on the os and the
>>>>> existence of a certain file) is not the best one.
>>>>> 
>>>>> If it turns out that there is no X11 server, and the os is OSX, then
>>>>> indeed a dialog box could be displayed, see e.g. the one at
>>>>> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-
>>>>> x-mountain-lion-shifts-support-to-open-source-xquartz/
>>>>> 
>>>>> Best,
>>>>> Gabor
>>>>> 
>>>>> Best,
>>>>>> John
>>>>>> 
>>>>>> -----Original Message-----
>>>>>>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
>>>>>>> Sent: Monday, July 14, 2014 6:37 PM
>>>>>>> To: Marc Schwartz
>>>>>>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
>>>>>>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>>>>>>> 
>>>>>>> What's wrong with capabilities("X11")?
>>>>>>> 
>>>>>>> I am not sure if teting for the OS, and especially for a particular X
>>>>>>> server, installed in a particular directory, is a good idea, even if
>>>>>>> it covers most of the _current_ installations.
>>>>>>> 
>>>>>>> Gabor
>>>>>>> 
>>>>>>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>>>> wrote:
>>>>>>> 
>>>>>>>> 
>>>>>>>> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>>>>> 
>>>>>>> wrote:
>>>>>>> 
>>>>>>>> 
>>>>>>>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>>>>>> 
>>>>>>>>> Dear Simon and list members,
>>>>>>>>>> 
>>>>>>>>>> As many of you are aware, when X11 isn't installed on Mac OS X,
>>>>>>>>>> 
>>>>>>>>> loading the
>>>>>>> 
>>>>>>>> tcltk package produces an error, with a message that many users
>>>>>>>>>> 
>>>>>>>>> find
>>>>>>> 
>>>>>>>> cryptic. There was yet another instance of this problem reported to
>>>>>>>>>> 
>>>>>>>>> the list
>>>>>>> 
>>>>>>>> today.
>>>>>>>>>> 
>>>>>>>>>> I'm interested in the issue because the Rcmdr package uses tcltk
>>>>>>>>>> 
>>>>>>>>> and thus
>>>>>>> 
>>>>>>>> fails to load when X11 is absent. Rcmdr users tend to be
>>>>>>>>>> 
>>>>>>>>> inexperienced and
>>>>>>> 
>>>>>>>> so, unless they find their way to the Rcmdr installation webpage,
>>>>>>>>>> 
>>>>>>>>> where
>>>>>>> 
>>>>>>>> detailed installation instructions are provided, they tend to be
>>>>>>>>>> 
>>>>>>>>> stymied by
>>>>>>> 
>>>>>>>> the problem.
>>>>>>>>>> 
>>>>>>>>>> If I could, I'd intercept the problem by checking
>>>>>>>>>> 
>>>>>>>>> capabilities()["X11"] in
>>>>>>> 
>>>>>>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
>>>>>>>>>> 
>>>>>>>>> package
>>>>>>> 
>>>>>>>> imports the tcltk namespace, the error occurs before these startup
>>>>>>>>>> 
>>>>>>>>> functions
>>>>>>> 
>>>>>>>> are executed -- a chicken-and-egg problem.
>>>>>>>>>> 
>>>>>>>>>> It occurs to me that tcltk could fail more gracefully on Mac OS X
>>>>>>>>>> 
>>>>>>>>> when X11
>>>>>>> 
>>>>>>>> is absent, perhaps popping up a webpage in a browser with
>>>>>>>>>> 
>>>>>>>>> instructions and a
>>>>>>> 
>>>>>>>> link for installing XQuartz. I'd do this myself in the Rcmdr
>>>>>>>>>> 
>>>>>>>>> package if I
>>>>>>> 
>>>>>>>> could. Or tcltk could check for the presence of X11 and not try to
>>>>>>>>>> 
>>>>>>>>> start it
>>>>>>> 
>>>>>>>> if it's absent, reporting a warning rather than throwing an error.
>>>>>>>>>> 
>>>>>>>>>> Alternatively, I'd be grateful if someone could suggest how I might
>>>>>>>>>> 
>>>>>>>>> detect
>>>>>>> 
>>>>>>>> the problem in the Rcmdr package before loading fails. The only
>>>>>>>>>> 
>>>>>>>>> thing that I
>>>>>>> 
>>>>>>>> could think of was writing a separate RcmdrInstall package that
>>>>>>>>>> 
>>>>>>>>> bypasses
>>>>>>> 
>>>>>>>> tcltk, but that would be awkward and would only help users who
>>>>>>>>>> 
>>>>>>>>> discovered
>>>>>>> 
>>>>>>>> that RcmdrInstall exists.
>>>>>>>>>> 
>>>>>>>>>> Thanks,
>>>>>>>>>> John
>>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> John,
>>>>>>>>> 
>>>>>>>>> Is there someplace in your startup process where you could run code
>>>>>>>>> 
>>>>>>>> along the lines of:
>>>>>>> 
>>>>>>>> 
>>>>>>>>> if (grepl("apple", R.version$platform) &
>>>>>>>>> 
>>>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>> 
>>>>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>>>>>>> 
>>>>>>>> to download and install Xquartz.")
>>>>>>> 
>>>>>>>>    stop()
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> The above code will check to see if the user is running R on OS X
>>>>>>>>> 
>>>>>>>> and also if the Xquartz binary is present in the default location.
>>>>>>> 
>>>>>>>> 
>>>>>>>>> Not sure if this is helpful.
>>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> A possible correction in the above code relative to detecting OS X:
>>>>>>>> 
>>>>>>>> if ((Sys.info()["sysname"] == "Darwin") &
>>>>>>>> 
>>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>> 
>>>>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>>>>>> 
>>>>>>> to download and install Xquartz.")
>>>>>>> 
>>>>>>>>    stop()
>>>>>>>> }
>>>>>>>> 
>>>>>>>> 
>>>>>>>> I believe that Sys.info()["sysname"] == "Darwin" is preferred for
>>>>>>>> 
>>>>>>> detecting the OS that R is running on versus the OS that it was built
>>>>>>> upon according to the help files, if I read correctly. This could be
>>>>>>> important if someone is building R from source versus installing
>>>>>>> Simon's CRAN binary, I presume.
>>>>>>> 
>>>>>>>> 
>>>>>>>> Regards,
>>>>>>>> 
>>>>>>>> Marc
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Mac mailing list
>>>>>>>> R-SIG-Mac at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>>>> 
>>>>>>> 
>>>>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> 
>> 
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>> 
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From ripley at stats.ox.ac.uk  Thu Jul 17 11:40:06 2014
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 17 Jul 2014 10:40:06 +0100
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <53C537B5.9050501@stats.ox.ac.uk>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>	<web-518627350@cgpsrv2.cis.mcmaster.ca>	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
	<53C537B5.9050501@stats.ox.ac.uk>
Message-ID: <53C799F6.6000103@stats.ox.ac.uk>

For the record, if you have package tcltk loaded you can ask it which 
windowing system Tk uses by

tclvalue(.Tcl("tk windowingsystem"))  # "x11" or "aqua"

However, if you want to find out which it was compiled against before 
loading it, you need to do the sort of thing below.

R-patched and R-devel now have (see NEWS)

     ? (OS X only.) Package tcltk checks if it is linked against the
       CRAN X11-based Tcl/Tk and if so that the Tcl/Tk component and the
       X11 libraries are installed.  This allows more informative error
       messages to be given.


On 15/07/2014 15:16, Prof Brian Ripley wrote:
> John talked to me about this a month ago and after some sick
> leave/vacation I had just got around to thinking into it.
>
> Minor points:
>
> 1) The usual way to check for OS X in the R sources is
> grepl("darwin", R.version$os)
>
> 2) It is perfectly possible to build R on Linuxen without X11
> headers/libraries.
>
> 3) There are three branches to the Tk code, X11, Aqua and Windows.  So
> apart from on Windows and OS X you either use X11 or do not have Tk.
>
> 4) It is possible to build R without Tcl/Tk, in which case you get a
> stub tcltk package.  Then capabilities('tcltk') tells you that you have
> the stub.
>
> 5) Just so we are all understand, it is possible (and documented in the
> manuals) for tcltk to be built using the Aqua Tk branch, and then Rcmdr
> works well (in my opinion much better) without X11 present.  So we do
> not want Rcmdr checking unconditionally for X11 being present.
>
>
> My understanding is that the main problem is that if someone installs
> one of the CRAN binary packages for OS X and does not have X11 installed
> then library(tcltk) will fail with a message that they do not
> understand, e.g.
> https://stat.ethz.ch/pipermail/r-sig-mac/2014-July/010954.html .
>
> For the future, probably the best thing to do is for the tcltk startup
> code to try to trap that case and suggest that X11/XQuartz needs to be
> installed.  The problem is accurately identifying 'that case'.
>
> If a package has tcltk in the imports of its NAMESPACE, there is nothing
> it can do about a broken tcltk as the namespaces it imports will be
> processed before any of the code in the package.  So the other
> possibility is to not have tcltk in the imports but to load its
> namespace via Rcmd::.onLoad.  I figured out how to to do that but it
> would be rather fragile.
>
>
> There is another possible problem which is that X11 is installed but a X
> server is not running.  That's what capabilities('X11') checks, and on
> modern OS X it ought to launch the X server as required.  However, I do
> not think we have a way to telling which Tk branch package tcltk was
> built against.  Since that is only an issue on OS X (no other OS can use
> more than one branch) you could use something like
>
> Tk_is_X11 <- function()
> {
>      DLL <- system.file("libs", "tcltk.so", package = "tcltk")
>      out <- system2("otool", c("-L", shQuote(DLL)), stdout = TRUE)
>      length(grep("libX11[.][0-9]+[.]dylib", out)) > 0L
> }
>
> and then
>
> if (.Platform$OS.type == "unix") {
>     if (!grepl("darwin", R.version$os) || Tk_is_X11())
>         if(!capabilities("X11"))
>              stop("Rcmdr requires a running X server")
> }
>
>
> On 15/07/2014 13:05, Marc Schwartz wrote:
>> John,
>>
>> First, apologies for my narrow focus on the solutions that I proposed
>> yesterday. I suffered from tunnel vision on the OS X issue and as
>> Gabor has noted, it would not be sufficiently portable. There can be
>> potential variations on where X11 is installed on OS X, depending upon
>> the use of Xquartz, the original Apple distribution of X11 and
>> presumably could further vary if one installs from source, is using
>> Homebrew, Macports or similar, which are package management systems
>> for OS X. Thus, as Gabor pointed out, capabilities("X11") is the most
>> portable approach.
>>
>> With respect to Linux, to the best of my knowledge, X11 (for some time
>> X.org) is still a requirement for tk (but not tcl). In checking at
>> least the current Fedora repos, X11 is still listed as a dependency
>> for tk. So if one is using the common package management systems, X11
>> will be installed if not already, when installing tk, unless one
>> overrides the defaults.
>>
>> Also, at least for Fedora and perhaps other Linuxen, X11 is listed as
>> a dependency for R itself, so if one is installing R on Fedora, X11
>> will be installed as well, if not present.
>>
>> Thus, between the common Linux package management systems and that
>> Linux users tend to be more technically saavy, you do not see many
>> reports.
>>
>> You likely already know this, but you could utilize a more generic
>> approach to testing the platform by using:
>>
>>    if (.Platform$OS.type == "unix")
>>      ...
>>
>> which would cover Linuxen, Unixen and OS X and then run your X11
>> checks, secondarily perhaps testing for OS X, if you wish to give a
>> more specific error message for OS X users and point them to XQuartz.
>>
>> Regards,
>>
>> Marc
>>
>>
>>
>> On Jul 14, 2014, at 11:37 PM, John Fox <jfox at mcmaster.ca> wrote:
>>
>>> Hi Gabor,
>>>
>>> Thanks for the clarification.
>>>
>>> I agree that it would be best to intercept the problem on Linux/Unix
>>> as well as on Mac OS X. Do you know that X11 is necessary for the
>>> tcltk package to work on Linux/Unix systems (or is there possibly a
>>> non-X11 Tcl/Tk there that's compatible with the tcltk package)?
>>>
>>> As a practical matter, the problem occurs with some regularity on Mac
>>> OS X (I'm aware that the availability and default installation of X11
>>> varies by version of the OS), but I've not seen a report of it on
>>> Linux, so my immediate concern was to solve the problem on Mac OS X.
>>>
>>> Best,
>>> John
>>>
>>> On Mon, 14 Jul 2014 21:37:54 -0400
>>> G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
>>>> Hi John,
>>>>
>>>> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>> Dear Gabor,
>>>>>
>>>>> As I just explained, the problem isn't testing for X11, which I
>>>>> know how to do -- though capabilities("X11") is a bit better than
>>>>> what I suggested. The issue is specific to Mac OS X because the
>>>>> Windows implementation of R includes a Tcl/Tk that doesn't use X11,
>>>>> and I've never seen the problem on Linux.
>>>>
>>>> actually, what I am saying is, that it is not specific to OSX. Some
>>>> (older, before 2012) OSX versions do include an X11 server, and some
>>>> Linux or other Unix installations do not.
>>>>
>>>> I am not saying tcltk should not test for an X11 server, all I am
>>>> saying is that the test suggested below (based on the os and the
>>>> existence of a certain file) is not the best one.
>>>>
>>>> If it turns out that there is no X11 server, and the os is OSX, then
>>>> indeed a dialog box could be displayed, see e.g. the one at
>>>> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-x-mountain-lion-shifts-support-to-open-source-xquartz/
>>>>
>>>>
>>>> Best,
>>>> Gabor
>>>>
>>>>> Best,
>>>>> John
>>>>>
>>>>>> -----Original Message-----
>>>>>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
>>>>>> Sent: Monday, July 14, 2014 6:37 PM
>>>>>> To: Marc Schwartz
>>>>>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
>>>>>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
>>>>>>
>>>>>> What's wrong with capabilities("X11")?
>>>>>>
>>>>>> I am not sure if teting for the OS, and especially for a particular X
>>>>>> server, installed in a particular directory, is a good idea, even if
>>>>>> it covers most of the _current_ installations.
>>>>>>
>>>>>> Gabor
>>>>>>
>>>>>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>>> wrote:
>>>>>>>
>>>>>>> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
>>>>>> wrote:
>>>>>>>
>>>>>>>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
>>>>>>>>
>>>>>>>>> Dear Simon and list members,
>>>>>>>>>
>>>>>>>>> As many of you are aware, when X11 isn't installed on Mac OS X,
>>>>>> loading the
>>>>>>>>> tcltk package produces an error, with a message that many users
>>>>>> find
>>>>>>>>> cryptic. There was yet another instance of this problem
>>>>>>>>> reported to
>>>>>> the list
>>>>>>>>> today.
>>>>>>>>>
>>>>>>>>> I'm interested in the issue because the Rcmdr package uses tcltk
>>>>>> and thus
>>>>>>>>> fails to load when X11 is absent. Rcmdr users tend to be
>>>>>> inexperienced and
>>>>>>>>> so, unless they find their way to the Rcmdr installation webpage,
>>>>>> where
>>>>>>>>> detailed installation instructions are provided, they tend to be
>>>>>> stymied by
>>>>>>>>> the problem.
>>>>>>>>>
>>>>>>>>> If I could, I'd intercept the problem by checking
>>>>>> capabilities()["X11"] in
>>>>>>>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
>>>>>> package
>>>>>>>>> imports the tcltk namespace, the error occurs before these startup
>>>>>> functions
>>>>>>>>> are executed -- a chicken-and-egg problem.
>>>>>>>>>
>>>>>>>>> It occurs to me that tcltk could fail more gracefully on Mac OS X
>>>>>> when X11
>>>>>>>>> is absent, perhaps popping up a webpage in a browser with
>>>>>> instructions and a
>>>>>>>>> link for installing XQuartz. I'd do this myself in the Rcmdr
>>>>>> package if I
>>>>>>>>> could. Or tcltk could check for the presence of X11 and not try to
>>>>>> start it
>>>>>>>>> if it's absent, reporting a warning rather than throwing an error.
>>>>>>>>>
>>>>>>>>> Alternatively, I'd be grateful if someone could suggest how I
>>>>>>>>> might
>>>>>> detect
>>>>>>>>> the problem in the Rcmdr package before loading fails. The only
>>>>>> thing that I
>>>>>>>>> could think of was writing a separate RcmdrInstall package that
>>>>>> bypasses
>>>>>>>>> tcltk, but that would be awkward and would only help users who
>>>>>> discovered
>>>>>>>>> that RcmdrInstall exists.
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> John
>>>>>>>>
>>>>>>>>
>>>>>>>> John,
>>>>>>>>
>>>>>>>> Is there someplace in your startup process where you could run code
>>>>>> along the lines of:
>>>>>>>>
>>>>>>>> if (grepl("apple", R.version$platform) &
>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>>>     cat("X11 is required. Please visit
>>>>>>>> http://xquartz.macosforge.org
>>>>>> to download and install Xquartz.")
>>>>>>>>     stop()
>>>>>>>> }
>>>>>>>>
>>>>>>>>
>>>>>>>> The above code will check to see if the user is running R on OS X
>>>>>> and also if the Xquartz binary is present in the default location.
>>>>>>>>
>>>>>>>> Not sure if this is helpful.
>>>>>>>
>>>>>>>
>>>>>>> A possible correction in the above code relative to detecting OS X:
>>>>>>>
>>>>>>> if ((Sys.info()["sysname"] == "Darwin") &
>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
>>>>>>>     cat("X11 is required. Please visit http://xquartz.macosforge.org
>>>>>> to download and install Xquartz.")
>>>>>>>     stop()
>>>>>>> }
>>>>>>>
>>>>>>>
>>>>>>> I believe that Sys.info()["sysname"] == "Darwin" is preferred for
>>>>>> detecting the OS that R is running on versus the OS that it was built
>>>>>> upon according to the help files, if I read correctly. This could be
>>>>>> important if someone is building R from source versus installing
>>>>>> Simon's CRAN binary, I presume.
>>>>>>>
>>>>>>> Regards,
>>>>>>>
>>>>>>> Marc
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Mac mailing list
>>>>>>> R-SIG-Mac at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rmh at temple.edu  Thu Jul 17 14:03:26 2014
From: rmh at temple.edu (Richard M. Heiberger)
Date: Thu, 17 Jul 2014 08:03:26 -0400
Subject: [R-SIG-Mac] consistent segfault
Message-ID: <CAGx1TMCzXnDBiu0Su1AuVvgeiAj626KXz_8xXuFUQOV9mJR5mQ@mail.gmail.com>

I can consistently get a segfault from Mavericks 3.1 and I suspect it
is from a mismatch
of compiled code.  Can this type of mismatch be detected when the
package is loaded?


When I moved to the Mavericks R distribution, I copied packages from
my 3.0 (SnowLeopard) library and then did an update.packages().  That
gives a segfault.
I did a fresh install of the relevant package and then it worked.
Both listings are below.

A. segfault listing with copied colorspace package

R version 3.1.1 (2014-07-10) -- "Sock it to Me"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.1.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> > options(STERM='iESS', str.dendrogram.last="'", editor='emacsclient', show.error.locations=TRUE)
> library(colorspace)
> ?hex
>      hsv = HSV(seq(0, 360, length = 7)[-7], 1, 1)
>      hsv
       H S V
[1,]   0 1 1
[2,]  60 1 1
[3,] 120 1 1
[4,] 180 1 1
[5,] 240 1 1
[6,] 300 1 1
>      hex(hsv)

 *** caught segfault ***
address 0x0, cause 'memory not mapped'

Traceback:
 1: .Call("as_sRGB", from at coords, class(from), .WhitePoint, PACKAGE =
"colorspace")
 2: cbind(R, if (missing(G)) NULL else G, if (missing(B)) NULL else B)
 3: sRGB(.Call("as_sRGB", from at coords, class(from), .WhitePoint,
PACKAGE = "colorspace"), names = dimnames(from at coords)[[1]])
 4: asMethod(object)
 5: as(from, "sRGB")
 6: hex(hsv)

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 2

Process R finished at Thu Jul 17 07:25:40 2014


B. same R distribution with newer colorspace

R version 3.1.1 (2014-07-10) -- "Sock it to Me"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.1.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> > options(STERM='iESS', str.dendrogram.last="'", editor='emacsclient', show.error.locations=TRUE)
> install.packages("colorspace")
--- Please select a CRAN mirror for use in this session ---
trying URL 'http://lib.stat.cmu.edu/R/CRAN/bin/macosx/mavericks/contrib/3.1/colorspace_1.2-4.tgz'
Content type 'application/x-gzip' length 391920 bytes (382 Kb)
opened URL
==================================================
downloaded 382 Kb


The downloaded binary packages are in
/var/folders/vq/xl0j17pn29g52mgx7lqxl8d80000gn/T//Rtmp5YxaKt/downloaded_packages
> library(colorspace)
>      hsv = HSV(seq(0, 360, length = 7)[-7], 1, 1)
>      hsv
       H S V
[1,]   0 1 1
[2,]  60 1 1
[3,] 120 1 1
[4,] 180 1 1
[5,] 240 1 1
[6,] 300 1 1
>      hex(hsv)
[1] "#FF0000" "#FFFF00" "#00FF00" "#00FFFF" "#0000FF" "#FF00FF"
> q()

Process R finished at Thu Jul 17 07:34:55 2014



Both colorspace package DESCRIPTION files start with
Package: colorspace
Version: 1.2-4
Date: 2013-09-30

The only difference in the DESCRIPTION file is
Built: R 3.0.2; x86_64-apple-darwin10.8.0; 2014-01-09 19:11:14 UTC; unix
Built: R 3.1.0; x86_64-apple-darwin13.1.0; 2014-04-24 15:04:36 UTC; unix

The files in the libs directory are different


From dtenenba at fhcrc.org  Thu Jul 17 16:08:27 2014
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Thu, 17 Jul 2014 07:08:27 -0700 (PDT)
Subject: [R-SIG-Mac] consistent segfault
In-Reply-To: <CAGx1TMCzXnDBiu0Su1AuVvgeiAj626KXz_8xXuFUQOV9mJR5mQ@mail.gmail.com>
Message-ID: <568258607.1034311.1405606107207.JavaMail.root@fhcrc.org>



----- Original Message -----
> From: "Richard M. Heiberger" <rmh at temple.edu>
> To: r-sig-mac at r-project.org
> Sent: Thursday, July 17, 2014 5:03:26 AM
> Subject: [R-SIG-Mac] consistent segfault
> 
> I can consistently get a segfault from Mavericks 3.1 and I suspect it
> is from a mismatch
> of compiled code.  Can this type of mismatch be detected when the
> package is loaded?
> 
> 
> When I moved to the Mavericks R distribution, I copied packages from
> my 3.0 (SnowLeopard) library and then did an update.packages(). 

You can't copy Snow Leopard packages to Mavericks. They are not compatible.
You should remove your installation and then reinstall R,  reinstalling the packages you need
with install.packages().

Dan

> That
> gives a segfault.
> I did a fresh install of the relevant package and then it worked.
> Both listings are below.
> 
> A. segfault listing with copied colorspace package
> 
> R version 3.1.1 (2014-07-10) -- "Sock it to Me"
> Copyright (C) 2014 The R Foundation for Statistical Computing
> Platform: x86_64-apple-darwin13.1.0 (64-bit)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> > > options(STERM='iESS', str.dendrogram.last="'",
> > > editor='emacsclient', show.error.locations=TRUE)
> > library(colorspace)
> > ?hex
> >      hsv = HSV(seq(0, 360, length = 7)[-7], 1, 1)
> >      hsv
>        H S V
> [1,]   0 1 1
> [2,]  60 1 1
> [3,] 120 1 1
> [4,] 180 1 1
> [5,] 240 1 1
> [6,] 300 1 1
> >      hex(hsv)
> 
>  *** caught segfault ***
> address 0x0, cause 'memory not mapped'
> 
> Traceback:
>  1: .Call("as_sRGB", from at coords, class(from), .WhitePoint, PACKAGE =
> "colorspace")
>  2: cbind(R, if (missing(G)) NULL else G, if (missing(B)) NULL else
>  B)
>  3: sRGB(.Call("as_sRGB", from at coords, class(from), .WhitePoint,
> PACKAGE = "colorspace"), names = dimnames(from at coords)[[1]])
>  4: asMethod(object)
>  5: as(from, "sRGB")
>  6: hex(hsv)
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 2
> 
> Process R finished at Thu Jul 17 07:25:40 2014
> 
> 
> B. same R distribution with newer colorspace
> 
> R version 3.1.1 (2014-07-10) -- "Sock it to Me"
> Copyright (C) 2014 The R Foundation for Statistical Computing
> Platform: x86_64-apple-darwin13.1.0 (64-bit)
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> > > options(STERM='iESS', str.dendrogram.last="'",
> > > editor='emacsclient', show.error.locations=TRUE)
> > install.packages("colorspace")
> --- Please select a CRAN mirror for use in this session ---
> trying URL
> 'http://lib.stat.cmu.edu/R/CRAN/bin/macosx/mavericks/contrib/3.1/colorspace_1.2-4.tgz'
> Content type 'application/x-gzip' length 391920 bytes (382 Kb)
> opened URL
> ==================================================
> downloaded 382 Kb
> 
> 
> The downloaded binary packages are in
> /var/folders/vq/xl0j17pn29g52mgx7lqxl8d80000gn/T//Rtmp5YxaKt/downloaded_packages
> > library(colorspace)
> >      hsv = HSV(seq(0, 360, length = 7)[-7], 1, 1)
> >      hsv
>        H S V
> [1,]   0 1 1
> [2,]  60 1 1
> [3,] 120 1 1
> [4,] 180 1 1
> [5,] 240 1 1
> [6,] 300 1 1
> >      hex(hsv)
> [1] "#FF0000" "#FFFF00" "#00FF00" "#00FFFF" "#0000FF" "#FF00FF"
> > q()
> 
> Process R finished at Thu Jul 17 07:34:55 2014
> 
> 
> 
> Both colorspace package DESCRIPTION files start with
> Package: colorspace
> Version: 1.2-4
> Date: 2013-09-30
> 
> The only difference in the DESCRIPTION file is
> Built: R 3.0.2; x86_64-apple-darwin10.8.0; 2014-01-09 19:11:14 UTC;
> unix
> Built: R 3.1.0; x86_64-apple-darwin13.1.0; 2014-04-24 15:04:36 UTC;
> unix
> 
> The files in the libs directory are different
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From brian.s.diggs at gmail.com  Fri Jul 18 00:19:01 2014
From: brian.s.diggs at gmail.com (Brian Diggs)
Date: Thu, 17 Jul 2014 15:19:01 -0700
Subject: [R-SIG-Mac] Mavericks/Snow Leopard package incompatibilities
Message-ID: <53C84BD5.2070909@gmail.com>

I've seen a few messages about incompatibilities between the Mavericks 
and Snow Leopard builds of R. They have different binary build types and 
packages built for one can not be used for the other.

It occurs to me that it would be helpful if R would report when a 
mismatch happens between the version of R running and the version of R a 
package is compiled for. Looking at testPlatformEquivalence in library.R 
(in base), it appears this is the right place for this check to be made. 
However, I don't readily understand exactly what might be passed to that 
function or what the specific differences are in the version strings for 
these two build.

Does having this checked automatically seem like a good idea? If so, can 
someone who understands the finer points of the version strings make the 
proper enhancement?


-- 
Brian S. Diggs, PhD
Senior Research Associate, Department of Surgery
Oregon Health & Science University


From kasperdanielhansen at gmail.com  Fri Jul 18 11:17:02 2014
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Fri, 18 Jul 2014 11:17:02 +0200
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <05350A4D-7C17-4CD7-B28A-F128A918CDC6@r-project.org>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
	<web-518627350@cgpsrv2.cis.mcmaster.ca>
	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
	<53C537B5.9050501@stats.ox.ac.uk>
	<CAC2h7uuBf8SLt1t7cToY32w7RJHGNkPnJmC649-pCG0agJ-WnQ@mail.gmail.com>
	<05350A4D-7C17-4CD7-B28A-F128A918CDC6@r-project.org>
Message-ID: <CAC2h7uv-kiNzAY0cR8XiY7HpwMcwJ7=DzEtMqBSiOC0f-WxCyQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140718/b06d0861/attachment.pl>

From simon.urbanek at r-project.org  Fri Jul 18 16:26:31 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 18 Jul 2014 10:26:31 -0400
Subject: [R-SIG-Mac] Mac OS X tcltk/X11 issues
In-Reply-To: <CAC2h7uv-kiNzAY0cR8XiY7HpwMcwJ7=DzEtMqBSiOC0f-WxCyQ@mail.gmail.com>
References: <002c01cf9fa8$719b77d0$54d26770$@mcmaster.ca>
	<C54C14D8-36A2-4E55-B160-A2A2D7F1E6CF@me.com>
	<FDC5EF12-080A-457A-BC0D-C615C53D2E0F@me.com>
	<CABtg=KnphWiv=7=aSEyg7cQDvmW=fYpjf8my5zO6EDQfAGjhdg@mail.gmail.com>
	<005101cf9fc1$794763e0$6bd62ba0$@mcmaster.ca>
	<CABtg=KmCKMQ+_5XWQzdKQWb46ckL2pQVgDqYnz0y31mRCpCYVA@mail.gmail.com>
	<web-518627350@cgpsrv2.cis.mcmaster.ca>
	<034E765A-874D-49DD-ACD8-4A73CC7C637B@me.com>
	<53C537B5.9050501@stats.ox.ac.uk>
	<CAC2h7uuBf8SLt1t7cToY32w7RJHGNkPnJmC649-pCG0agJ-WnQ@mail.gmail.com>
	<05350A4D-7C17-4CD7-B28A-F128A918CDC6@r-project.org>
	<CAC2h7uv-kiNzAY0cR8XiY7HpwMcwJ7=DzEtMqBSiOC0f-WxCyQ@mail.gmail.com>
Message-ID: <18FE178E-D868-4A86-AE88-5DC3C2652018@r-project.org>


On Jul 18, 2014, at 5:17 AM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:

> On Thu, Jul 17, 2014 at 2:05 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> On Jul 15, 2014, at 3:01 PM, Kasper Daniel Hansen <kasperdanielhansen at gmail.com> wrote:
> 
> > Prof Ripley and other people involved with tcltk,
> >
> > You could have the tcltk building routine leave some evidence behind re.
> > how it was build.
> >
> > For example, in Rgraphviz we used to grapple with something similar at the
> > abstract level - was the Graphviz version used to build a binary
> > distributed version of Rgraphviz, the same as the Graphviz installed by the
> > user (if there was a version mismatch on Windows, there was a high chance
> > of an arcane error time).  As part of running configure, we save the
> > Graphviz version at build time into a variable kept in a file in /R.
> > Specifically we have a file
> > R/graphviz_build_version.R.in
> > which contains something like
> >  graphviz_build_version=@GRAPHVIZ_BUILD@
> > configure does the usual transformation (code here is from memory).
> >
> > This was then checked in .onLoad before the Rgraphviz dynamic library was
> > loaded.  Now the code is different, because we bundle Graphviz with
> > Rgraphviz.
> >
> > Something similar should not be too hard to introduce for tcltk to keep a
> > record of how it was build.
> >
> > We see a lot of noise about this issue, so it may be worthwhile to solve
> > robustly.
> >
> 
> Well, but the above is entirely irrelevant to the discussion at hand (AFAICT). The problem here is that we are talking about *binary* distribution - so the build process was indeed created in a fully working environment, but the user failed to re-create the environment and thus the assumptions at build time are broken. The assumptions are directly at the linking level, and the dependency that fails is not even under our control - X11 installation - so it's not something we can modify
> 
> It seems that Prof. Ripley has fixed this, but I still want to reply to this.
> 
> As I can tell, this is exactly the same as with tcltk: The binary version of Rgaphviz build on the Bioconductor Windows machines used a specific version of Graphviz, which (it used to be) was the user's responsibility to create.  If the user failed to do so, the package would throw an error when loaded.   
> 

Yes, but in our case it's *not* the direct dependency - i.e. we do control Tcl/Tk which we build and we could check that it's missing, but the thread here is about X11 missing which is not a direct dependency and thus not something we have control over. Also this is not about versions - it's about availability. Moreover, the actual X11 binary can be very different - it can be anything from Apple's X11 to Xquartz or even a custom build (however unlikely).

Cheers,
Simon


> Best,
> Kasper
> 
> 
>  
> Brian did indeed describe quite precisely the various issues involved here.
> 
> IMHO the other contributions are a bit off track - I would argue that this is only about CRAN binary so adding a very specific extra check in R along the lines of what Brian proposed is the most robust and relevant way forward (note that the check may be identical for the X11 device). We're certainly not talking about a cross-platform solution but rather a very specific solution for the CRAN binary.
> 
> Cheers,
> Simon
> 
> 
> 
> > Best,
> > Kasper
> >
> >
> > On Tue, Jul 15, 2014 at 4:16 PM, Prof Brian Ripley <ripley at stats.ox.ac.uk>
> > wrote:
> >
> >> John talked to me about this a month ago and after some sick
> >> leave/vacation I had just got around to thinking into it.
> >>
> >> Minor points:
> >>
> >> 1) The usual way to check for OS X in the R sources is
> >> grepl("darwin", R.version$os)
> >>
> >> 2) It is perfectly possible to build R on Linuxen without X11
> >> headers/libraries.
> >>
> >> 3) There are three branches to the Tk code, X11, Aqua and Windows.  So
> >> apart from on Windows and OS X you either use X11 or do not have Tk.
> >>
> >> 4) It is possible to build R without Tcl/Tk, in which case you get a stub
> >> tcltk package.  Then capabilities('tcltk') tells you that you have the stub.
> >>
> >> 5) Just so we are all understand, it is possible (and documented in the
> >> manuals) for tcltk to be built using the Aqua Tk branch, and then Rcmdr
> >> works well (in my opinion much better) without X11 present.  So we do not
> >> want Rcmdr checking unconditionally for X11 being present.
> >>
> >>
> >> My understanding is that the main problem is that if someone installs one
> >> of the CRAN binary packages for OS X and does not have X11 installed then
> >> library(tcltk) will fail with a message that they do not understand, e.g.
> >> https://stat.ethz.ch/pipermail/r-sig-mac/2014-July/010954.html .
> >>
> >> For the future, probably the best thing to do is for the tcltk startup
> >> code to try to trap that case and suggest that X11/XQuartz needs to be
> >> installed.  The problem is accurately identifying 'that case'.
> >>
> >> If a package has tcltk in the imports of its NAMESPACE, there is nothing
> >> it can do about a broken tcltk as the namespaces it imports will be
> >> processed before any of the code in the package.  So the other possibility
> >> is to not have tcltk in the imports but to load its namespace via
> >> Rcmd::.onLoad.  I figured out how to to do that but it would be rather
> >> fragile.
> >>
> >>
> >> There is another possible problem which is that X11 is installed but a X
> >> server is not running.  That's what capabilities('X11') checks, and on
> >> modern OS X it ought to launch the X server as required.  However, I do not
> >> think we have a way to telling which Tk branch package tcltk was built
> >> against.  Since that is only an issue on OS X (no other OS can use more
> >> than one branch) you could use something like
> >>
> >> Tk_is_X11 <- function()
> >> {
> >>    DLL <- system.file("libs", "tcltk.so", package = "tcltk")
> >>    out <- system2("otool", c("-L", shQuote(DLL)), stdout = TRUE)
> >>    length(grep("libX11[.][0-9]+[.]dylib", out)) > 0L
> >> }
> >>
> >> and then
> >>
> >> if (.Platform$OS.type == "unix") {
> >>   if (!grepl("darwin", R.version$os) || Tk_is_X11())
> >>       if(!capabilities("X11"))
> >>            stop("Rcmdr requires a running X server")
> >>
> >> }
> >>
> >>
> >> On 15/07/2014 13:05, Marc Schwartz wrote:
> >>
> >>> John,
> >>>
> >>> First, apologies for my narrow focus on the solutions that I proposed
> >>> yesterday. I suffered from tunnel vision on the OS X issue and as Gabor has
> >>> noted, it would not be sufficiently portable. There can be potential
> >>> variations on where X11 is installed on OS X, depending upon the use of
> >>> Xquartz, the original Apple distribution of X11 and presumably could
> >>> further vary if one installs from source, is using Homebrew, Macports or
> >>> similar, which are package management systems for OS X. Thus, as Gabor
> >>> pointed out, capabilities("X11") is the most portable approach.
> >>>
> >>> With respect to Linux, to the best of my knowledge, X11 (for some time
> >>> X.org) is still a requirement for tk (but not tcl). In checking at least
> >>> the current Fedora repos, X11 is still listed as a dependency for tk. So if
> >>> one is using the common package management systems, X11 will be installed
> >>> if not already, when installing tk, unless one overrides the defaults.
> >>>
> >>> Also, at least for Fedora and perhaps other Linuxen, X11 is listed as a
> >>> dependency for R itself, so if one is installing R on Fedora, X11 will be
> >>> installed as well, if not present.
> >>>
> >>> Thus, between the common Linux package management systems and that Linux
> >>> users tend to be more technically saavy, you do not see many reports.
> >>>
> >>> You likely already know this, but you could utilize a more generic
> >>> approach to testing the platform by using:
> >>>
> >>>   if (.Platform$OS.type == "unix")
> >>>     ...
> >>>
> >>> which would cover Linuxen, Unixen and OS X and then run your X11 checks,
> >>> secondarily perhaps testing for OS X, if you wish to give a more specific
> >>> error message for OS X users and point them to XQuartz.
> >>>
> >>> Regards,
> >>>
> >>> Marc
> >>>
> >>>
> >>>
> >>> On Jul 14, 2014, at 11:37 PM, John Fox <jfox at mcmaster.ca> wrote:
> >>>
> >>> Hi Gabor,
> >>>>
> >>>> Thanks for the clarification.
> >>>>
> >>>> I agree that it would be best to intercept the problem on Linux/Unix as
> >>>> well as on Mac OS X. Do you know that X11 is necessary for the tcltk
> >>>> package to work on Linux/Unix systems (or is there possibly a non-X11
> >>>> Tcl/Tk there that's compatible with the tcltk package)?
> >>>>
> >>>> As a practical matter, the problem occurs with some regularity on Mac OS
> >>>> X (I'm aware that the availability and default installation of X11 varies
> >>>> by version of the OS), but I've not seen a report of it on Linux, so my
> >>>> immediate concern was to solve the problem on Mac OS X.
> >>>>
> >>>> Best,
> >>>> John
> >>>>
> >>>> On Mon, 14 Jul 2014 21:37:54 -0400
> >>>> G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> >>>>
> >>>>> Hi John,
> >>>>>
> >>>>> On Mon, Jul 14, 2014 at 8:12 PM, John Fox <jfox at mcmaster.ca> wrote:
> >>>>>
> >>>>>> Dear Gabor,
> >>>>>>
> >>>>>> As I just explained, the problem isn't testing for X11, which I know
> >>>>>> how to do -- though capabilities("X11") is a bit better than what I
> >>>>>> suggested. The issue is specific to Mac OS X because the Windows
> >>>>>> implementation of R includes a Tcl/Tk that doesn't use X11, and I've never
> >>>>>> seen the problem on Linux.
> >>>>>>
> >>>>>
> >>>>> actually, what I am saying is, that it is not specific to OSX. Some
> >>>>> (older, before 2012) OSX versions do include an X11 server, and some
> >>>>> Linux or other Unix installations do not.
> >>>>>
> >>>>> I am not saying tcltk should not test for an X11 server, all I am
> >>>>> saying is that the test suggested below (based on the os and the
> >>>>> existence of a certain file) is not the best one.
> >>>>>
> >>>>> If it turns out that there is no X11 server, and the os is OSX, then
> >>>>> indeed a dialog box could be displayed, see e.g. the one at
> >>>>> http://www.macrumors.com/2012/02/17/apple-removes-x11-in-os-
> >>>>> x-mountain-lion-shifts-support-to-open-source-xquartz/
> >>>>>
> >>>>> Best,
> >>>>> Gabor
> >>>>>
> >>>>> Best,
> >>>>>> John
> >>>>>>
> >>>>>> -----Original Message-----
> >>>>>>> From: G?bor Cs?rdi [mailto:csardi.gabor at gmail.com]
> >>>>>>> Sent: Monday, July 14, 2014 6:37 PM
> >>>>>>> To: Marc Schwartz
> >>>>>>> Cc: John Fox; urbanek at research.att.com; R-SIG-Mac
> >>>>>>> Subject: Re: [R-SIG-Mac] Mac OS X tcltk/X11 issues
> >>>>>>>
> >>>>>>> What's wrong with capabilities("X11")?
> >>>>>>>
> >>>>>>> I am not sure if teting for the OS, and especially for a particular X
> >>>>>>> server, installed in a particular directory, is a good idea, even if
> >>>>>>> it covers most of the _current_ installations.
> >>>>>>>
> >>>>>>> Gabor
> >>>>>>>
> >>>>>>> On Mon, Jul 14, 2014 at 6:13 PM, Marc Schwartz <marc_schwartz at me.com>
> >>>>>>> wrote:
> >>>>>>>
> >>>>>>>>
> >>>>>>>> On Jul 14, 2014, at 4:53 PM, Marc Schwartz <marc_schwartz at me.com>
> >>>>>>>>
> >>>>>>> wrote:
> >>>>>>>
> >>>>>>>>
> >>>>>>>> On Jul 14, 2014, at 4:13 PM, John Fox <jfox at mcmaster.ca> wrote:
> >>>>>>>>>
> >>>>>>>>> Dear Simon and list members,
> >>>>>>>>>>
> >>>>>>>>>> As many of you are aware, when X11 isn't installed on Mac OS X,
> >>>>>>>>>>
> >>>>>>>>> loading the
> >>>>>>>
> >>>>>>>> tcltk package produces an error, with a message that many users
> >>>>>>>>>>
> >>>>>>>>> find
> >>>>>>>
> >>>>>>>> cryptic. There was yet another instance of this problem reported to
> >>>>>>>>>>
> >>>>>>>>> the list
> >>>>>>>
> >>>>>>>> today.
> >>>>>>>>>>
> >>>>>>>>>> I'm interested in the issue because the Rcmdr package uses tcltk
> >>>>>>>>>>
> >>>>>>>>> and thus
> >>>>>>>
> >>>>>>>> fails to load when X11 is absent. Rcmdr users tend to be
> >>>>>>>>>>
> >>>>>>>>> inexperienced and
> >>>>>>>
> >>>>>>>> so, unless they find their way to the Rcmdr installation webpage,
> >>>>>>>>>>
> >>>>>>>>> where
> >>>>>>>
> >>>>>>>> detailed installation instructions are provided, they tend to be
> >>>>>>>>>>
> >>>>>>>>> stymied by
> >>>>>>>
> >>>>>>>> the problem.
> >>>>>>>>>>
> >>>>>>>>>> If I could, I'd intercept the problem by checking
> >>>>>>>>>>
> >>>>>>>>> capabilities()["X11"] in
> >>>>>>>
> >>>>>>>> the Rcmdr .onLoad() or .onAttach() function, but because the Rcmdr
> >>>>>>>>>>
> >>>>>>>>> package
> >>>>>>>
> >>>>>>>> imports the tcltk namespace, the error occurs before these startup
> >>>>>>>>>>
> >>>>>>>>> functions
> >>>>>>>
> >>>>>>>> are executed -- a chicken-and-egg problem.
> >>>>>>>>>>
> >>>>>>>>>> It occurs to me that tcltk could fail more gracefully on Mac OS X
> >>>>>>>>>>
> >>>>>>>>> when X11
> >>>>>>>
> >>>>>>>> is absent, perhaps popping up a webpage in a browser with
> >>>>>>>>>>
> >>>>>>>>> instructions and a
> >>>>>>>
> >>>>>>>> link for installing XQuartz. I'd do this myself in the Rcmdr
> >>>>>>>>>>
> >>>>>>>>> package if I
> >>>>>>>
> >>>>>>>> could. Or tcltk could check for the presence of X11 and not try to
> >>>>>>>>>>
> >>>>>>>>> start it
> >>>>>>>
> >>>>>>>> if it's absent, reporting a warning rather than throwing an error.
> >>>>>>>>>>
> >>>>>>>>>> Alternatively, I'd be grateful if someone could suggest how I might
> >>>>>>>>>>
> >>>>>>>>> detect
> >>>>>>>
> >>>>>>>> the problem in the Rcmdr package before loading fails. The only
> >>>>>>>>>>
> >>>>>>>>> thing that I
> >>>>>>>
> >>>>>>>> could think of was writing a separate RcmdrInstall package that
> >>>>>>>>>>
> >>>>>>>>> bypasses
> >>>>>>>
> >>>>>>>> tcltk, but that would be awkward and would only help users who
> >>>>>>>>>>
> >>>>>>>>> discovered
> >>>>>>>
> >>>>>>>> that RcmdrInstall exists.
> >>>>>>>>>>
> >>>>>>>>>> Thanks,
> >>>>>>>>>> John
> >>>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> John,
> >>>>>>>>>
> >>>>>>>>> Is there someplace in your startup process where you could run code
> >>>>>>>>>
> >>>>>>>> along the lines of:
> >>>>>>>
> >>>>>>>>
> >>>>>>>>> if (grepl("apple", R.version$platform) &
> >>>>>>>>>
> >>>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >>>>>>>
> >>>>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
> >>>>>>>>>
> >>>>>>>> to download and install Xquartz.")
> >>>>>>>
> >>>>>>>>    stop()
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> The above code will check to see if the user is running R on OS X
> >>>>>>>>>
> >>>>>>>> and also if the Xquartz binary is present in the default location.
> >>>>>>>
> >>>>>>>>
> >>>>>>>>> Not sure if this is helpful.
> >>>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> A possible correction in the above code relative to detecting OS X:
> >>>>>>>>
> >>>>>>>> if ((Sys.info()["sysname"] == "Darwin") &
> >>>>>>>>
> >>>>>>> length(list.files("/opt/X11/bin", pattern = "Xquartz")) == 0) {
> >>>>>>>
> >>>>>>>>    cat("X11 is required. Please visit http://xquartz.macosforge.org
> >>>>>>>>
> >>>>>>> to download and install Xquartz.")
> >>>>>>>
> >>>>>>>>    stop()
> >>>>>>>> }
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> I believe that Sys.info()["sysname"] == "Darwin" is preferred for
> >>>>>>>>
> >>>>>>> detecting the OS that R is running on versus the OS that it was built
> >>>>>>> upon according to the help files, if I read correctly. This could be
> >>>>>>> important if someone is building R from source versus installing
> >>>>>>> Simon's CRAN binary, I presume.
> >>>>>>>
> >>>>>>>>
> >>>>>>>> Regards,
> >>>>>>>>
> >>>>>>>> Marc
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> R-SIG-Mac mailing list
> >>>>>>>> R-SIG-Mac at r-project.org
> >>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >>>>>>>>
> >>>>>>>
> >>>>>>
> >>> _______________________________________________
> >>> R-SIG-Mac mailing list
> >>> R-SIG-Mac at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >>>
> >>>
> >>
> >> --
> >> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >> University of Oxford,             Tel:  +44 1865 272861 (self)
> >> 1 South Parks Road,                     +44 1865 272866 (PA)
> >> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >>
> >>
> >> _______________________________________________
> >> R-SIG-Mac mailing list
> >> R-SIG-Mac at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 


From rkoenker at illinois.edu  Fri Jul 18 23:41:09 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Fri, 18 Jul 2014 16:41:09 -0500
Subject: [R-SIG-Mac] rgl for R-devel
Message-ID: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>

I'm trying to

install.packages("rgl", type = "source")

with

> sessionInfo()
R Under development (unstable) (2014-07-09 r66111)
Platform: x86_64-apple-darwin13.1.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] quantreg_5.05 SparseM_1.05 

loaded via a namespace (and not attached):
[1] tcltk_3.2.0 tools_3.2.0

and seeing (eventually):

clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
#include <GLKMathUtils.h> 
         ^
1 error generated.
make: *** [platform.o] Error 1
ERROR: compilation failed for package ?rgl?

I do have a GLKit.framework  but there is no Headers subdir ...  


url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Urbana, IL 61801


From murdoch.duncan at gmail.com  Sat Jul 19 03:07:16 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 18 Jul 2014 20:07:16 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
Message-ID: <53C9C4C4.6050700@gmail.com>

On 18/07/2014, 4:41 PM, Roger Koenker wrote:
> I'm trying to
> 
> install.packages("rgl", type = "source")
> 
> with
> 
>> sessionInfo()
> R Under development (unstable) (2014-07-09 r66111)
> Platform: x86_64-apple-darwin13.1.0 (64-bit)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> other attached packages:
> [1] quantreg_5.05 SparseM_1.05 
> 
> loaded via a namespace (and not attached):
> [1] tcltk_3.2.0 tools_3.2.0
> 
> and seeing (eventually):
> 
> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
> #include <GLKMathUtils.h> 
>          ^
> 1 error generated.
> make: *** [platform.o] Error 1
> ERROR: compilation failed for package ?rgl?
> 
> I do have a GLKit.framework  but there is no Headers subdir ...  
> 

What OSX version is that?  There were warnings about deprecated code in
rgl, so I switched to using GLKMathUtils, but apparently the configure
script isn't quite right.

Duncan Murdoch


From simon.urbanek at r-project.org  Sat Jul 19 03:18:16 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 18 Jul 2014 21:18:16 -0400
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <53C9C4C4.6050700@gmail.com>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
Message-ID: <A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>

Duncan,

I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be

#include <GLKit/GLKMathUtils.h>

without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.


@Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
$ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
total 16
-rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
-rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
[...]
-rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
[...]

Cheers,
Simon


On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>> I'm trying to
>> 
>> install.packages("rgl", type = "source")
>> 
>> with
>> 
>>> sessionInfo()
>> R Under development (unstable) (2014-07-09 r66111)
>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>> 
>> other attached packages:
>> [1] quantreg_5.05 SparseM_1.05 
>> 
>> loaded via a namespace (and not attached):
>> [1] tcltk_3.2.0 tools_3.2.0
>> 
>> and seeing (eventually):
>> 
>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>> #include <GLKMathUtils.h> 
>>         ^
>> 1 error generated.
>> make: *** [platform.o] Error 1
>> ERROR: compilation failed for package ?rgl?
>> 
>> I do have a GLKit.framework  but there is no Headers subdir ...  
>> 
> 
> What OSX version is that?  There were warnings about deprecated code in
> rgl, so I switched to using GLKMathUtils, but apparently the configure
> script isn't quite right.
> 
> Duncan Murdoch
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From rkoenker at illinois.edu  Sat Jul 19 03:13:56 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Fri, 18 Jul 2014 20:13:56 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <1ae6ece34cca4839b13752bfb97d5146@CITESHT3.ad.uillinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<1ae6ece34cca4839b13752bfb97d5146@CITESHT3.ad.uillinois.edu>
Message-ID: <0C29D67C-FD00-4CF8-9502-A1BF992FA176@illinois.edu>

yzzy: system_profiler SPSoftwareDataType
Software:

    System Software Overview:

      System Version: OS X 10.9.4 (13E28)
      Kernel Version: Darwin 13.3.0
      

Roger Koenker
rkoenker at illinois.edu




On Jul 18, 2014, at 8:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>> I'm trying to
>> 
>> install.packages("rgl", type = "source")
>> 
>> with
>> 
>>> sessionInfo()
>> R Under development (unstable) (2014-07-09 r66111)
>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>> 
>> other attached packages:
>> [1] quantreg_5.05 SparseM_1.05 
>> 
>> loaded via a namespace (and not attached):
>> [1] tcltk_3.2.0 tools_3.2.0
>> 
>> and seeing (eventually):
>> 
>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>> #include <GLKMathUtils.h> 
>>         ^
>> 1 error generated.
>> make: *** [platform.o] Error 1
>> ERROR: compilation failed for package ?rgl?
>> 
>> I do have a GLKit.framework  but there is no Headers subdir ...  
>> 
> 
> What OSX version is that?  There were warnings about deprecated code in
> rgl, so I switched to using GLKMathUtils, but apparently the configure
> script isn't quite right.
> 
> Duncan Murdoch


From murdoch.duncan at gmail.com  Sat Jul 19 11:42:17 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 19 Jul 2014 04:42:17 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>
Message-ID: <53CA3D79.7030502@gmail.com>

On 18/07/2014, 8:18 PM, Simon Urbanek wrote:
> Duncan,
> 
> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
> 
> #include <GLKit/GLKMathUtils.h>
> 
> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.

Thanks.  I forget where that code came from.  Obviously I don't know
much about OSX programming.

One other question that might be simple, or might not:  I'm seeing
problems in Cocoa because after a user closes an rgl window (by clicking
on the x on the frame), the cleanup code is not being called.  rgl declares

@interface GLView : NSOpenGLView {
  rgl::OSXWindowImpl *impl;
  NSUInteger lastModifierFlags;
}

- (id)initWithFrame:(NSRect)frame
        pixelFormat:(NSOpenGLPixelFormat *)pixelFormat
               impl:(rgl::OSXWindowImpl *)impl;
@end

and then in the implementation section has the cleanup code in

- (void)dealloc
{
  if (impl) impl->on_dealloc();
  [super dealloc];
}

but as far as I can tell this isn't being called when the user closes
the window.  Is there some other method that is called to allow cleanup?
 The Apple docs probably talk about this somewhere, but I haven't found
where...

Duncan Murdoch

> 
> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
> total 16
> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
> [...]
> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
> [...]
> 
> Cheers,
> Simon
> 
> 
> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>> I'm trying to
>>>
>>> install.packages("rgl", type = "source")
>>>
>>> with
>>>
>>>> sessionInfo()
>>> R Under development (unstable) (2014-07-09 r66111)
>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>
>>> other attached packages:
>>> [1] quantreg_5.05 SparseM_1.05 
>>>
>>> loaded via a namespace (and not attached):
>>> [1] tcltk_3.2.0 tools_3.2.0
>>>
>>> and seeing (eventually):
>>>
>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>> #include <GLKMathUtils.h> 
>>>         ^
>>> 1 error generated.
>>> make: *** [platform.o] Error 1
>>> ERROR: compilation failed for package ?rgl?
>>>
>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>
>>
>> What OSX version is that?  There were warnings about deprecated code in
>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>> script isn't quite right.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>


From murdoch.duncan at gmail.com  Sat Jul 19 12:05:32 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 19 Jul 2014 05:05:32 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <53CA3D79.7030502@gmail.com>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>
	<53CA3D79.7030502@gmail.com>
Message-ID: <53CA42EC.5080202@gmail.com>

On 19/07/2014, 4:42 AM, Duncan Murdoch wrote:
> On 18/07/2014, 8:18 PM, Simon Urbanek wrote:
>> Duncan,
>>
>> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
>>
>> #include <GLKit/GLKMathUtils.h>
>>
>> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
> 
> Thanks.  I forget where that code came from.  Obviously I don't know
> much about OSX programming.
> 
> One other question that might be simple, or might not:  I'm seeing
> problems in Cocoa because after a user closes an rgl window (by clicking
> on the x on the frame), the cleanup code is not being called.  rgl declares
> 
> @interface GLView : NSOpenGLView {
>   rgl::OSXWindowImpl *impl;
>   NSUInteger lastModifierFlags;
> }
> 
> - (id)initWithFrame:(NSRect)frame
>         pixelFormat:(NSOpenGLPixelFormat *)pixelFormat
>                impl:(rgl::OSXWindowImpl *)impl;
> @end
> 
> and then in the implementation section has the cleanup code in
> 
> - (void)dealloc
> {
>   if (impl) impl->on_dealloc();
>   [super dealloc];
> }
> 
> but as far as I can tell this isn't being called when the user closes
> the window.  Is there some other method that is called to allow cleanup?
>  The Apple docs probably talk about this somewhere, but I haven't found
> where...
> 

More precisely:  this isn't being called *immediately* when the window
is closed.  It is called a little bit later, but in some circumstances
that's too late, because the user can ask rgl to do something in between
and it tries to make changes to a window that isn't there any more.

Duncan Murdoch

> Duncan Murdoch
> 
>>
>> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
>> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
>> total 16
>> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
>> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
>> [...]
>> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
>> [...]
>>
>> Cheers,
>> Simon
>>
>>
>> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>
>>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>>> I'm trying to
>>>>
>>>> install.packages("rgl", type = "source")
>>>>
>>>> with
>>>>
>>>>> sessionInfo()
>>>> R Under development (unstable) (2014-07-09 r66111)
>>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>>
>>>> locale:
>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>>
>>>> other attached packages:
>>>> [1] quantreg_5.05 SparseM_1.05 
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] tcltk_3.2.0 tools_3.2.0
>>>>
>>>> and seeing (eventually):
>>>>
>>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>>> #include <GLKMathUtils.h> 
>>>>         ^
>>>> 1 error generated.
>>>> make: *** [platform.o] Error 1
>>>> ERROR: compilation failed for package ?rgl?
>>>>
>>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>>
>>>
>>> What OSX version is that?  There were warnings about deprecated code in
>>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>>> script isn't quite right.
>>>
>>> Duncan Murdoch
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>
>>
>


From murdoch.duncan at gmail.com  Sat Jul 19 14:41:13 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 19 Jul 2014 07:41:13 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <0C29D67C-FD00-4CF8-9502-A1BF992FA176@illinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<1ae6ece34cca4839b13752bfb97d5146@CITESHT3.ad.uillinois.edu>
	<0C29D67C-FD00-4CF8-9502-A1BF992FA176@illinois.edu>
Message-ID: <53CA6769.7080902@gmail.com>

On 18/07/2014, 8:13 PM, Roger Koenker wrote:
> yzzy: system_profiler SPSoftwareDataType
> Software:
> 
>     System Software Overview:
> 
>       System Version: OS X 10.9.4 (13E28)
>       Kernel Version: Darwin 13.3.0
>       

I've just committed a patch to the rgl source on R-forge.r-project.org
following Simon's advice.  You'll get it if you download version
0.94.1118 or newer.  (It may take a while for R-forge to build the
tarball; it's been slow lately.)

There are a lot of other changes there compared to what's on CRAN, and
it doesn't include a bug fix for the dealloc bug I mentioned in another
email, so I don't recommend using this version:  but I'd appreciate
hearing if it fixes your problem.

Duncan Murdoch

> 
> Roger Koenker
> rkoenker at illinois.edu
> 
> 
> 
> 
> On Jul 18, 2014, at 8:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>> I'm trying to
>>>
>>> install.packages("rgl", type = "source")
>>>
>>> with
>>>
>>>> sessionInfo()
>>> R Under development (unstable) (2014-07-09 r66111)
>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>
>>> other attached packages:
>>> [1] quantreg_5.05 SparseM_1.05 
>>>
>>> loaded via a namespace (and not attached):
>>> [1] tcltk_3.2.0 tools_3.2.0
>>>
>>> and seeing (eventually):
>>>
>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>> #include <GLKMathUtils.h> 
>>>         ^
>>> 1 error generated.
>>> make: *** [platform.o] Error 1
>>> ERROR: compilation failed for package ?rgl?
>>>
>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>
>>
>> What OSX version is that?  There were warnings about deprecated code in
>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>> script isn't quite right.
>>
>> Duncan Murdoch
>


From rkoenker at illinois.edu  Sat Jul 19 16:15:00 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Sat, 19 Jul 2014 09:15:00 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <d4a437552c594d27afd90548417098c3@CHIHT2.ad.uillinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<d4a437552c594d27afd90548417098c3@CHIHT2.ad.uillinois.edu>
Message-ID: <EA08563B-64A3-4705-80F9-CC3B9EB64E4A@illinois.edu>

Simon,   Maybe there is something wrong with my system, since I see:

yzzy: ls -l /System/Library/Frameworks/GLKit.framework
total 16
lrwxr-xr-x  1 root  wheel   22 Feb 17 23:46 GLKit -> Versions/Current/GLKit
lrwxr-xr-x  1 root  wheel   26 Feb 17 23:46 Resources -> Versions/Current/Resources
drwxr-xr-x  4 root  wheel  136 Feb 17 23:50 Versions

Duncan:  I'll try the new patched version of rgl once it is available on R Forge.

Thanks to you both!

Roger


Thanks
Roger Koenker
rkoenker at illinois.edu




On Jul 18, 2014, at 8:18 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> Duncan,
> 
> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
> 
> #include <GLKit/GLKMathUtils.h>
> 
> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
> 
> 
> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
> total 16
> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
> [...]
> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
> [...]
> 
> Cheers,
> Simon
> 
> 
> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>> I'm trying to
>>> 
>>> install.packages("rgl", type = "source")
>>> 
>>> with
>>> 
>>>> sessionInfo()
>>> R Under development (unstable) (2014-07-09 r66111)
>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>> 
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>> 
>>> other attached packages:
>>> [1] quantreg_5.05 SparseM_1.05 
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] tcltk_3.2.0 tools_3.2.0
>>> 
>>> and seeing (eventually):
>>> 
>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>> #include <GLKMathUtils.h> 
>>>        ^
>>> 1 error generated.
>>> make: *** [platform.o] Error 1
>>> ERROR: compilation failed for package ?rgl?
>>> 
>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>> 
>> 
>> What OSX version is that?  There were warnings about deprecated code in
>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>> script isn't quite right.
>> 
>> Duncan Murdoch
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Sat Jul 19 17:31:24 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 19 Jul 2014 11:31:24 -0400
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <53CA42EC.5080202@gmail.com>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>
	<53CA3D79.7030502@gmail.com> <53CA42EC.5080202@gmail.com>
Message-ID: <C12352FA-1BCE-40BF-B873-4685D66B7925@r-project.org>


On Jul 19, 2014, at 6:05 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> On 19/07/2014, 4:42 AM, Duncan Murdoch wrote:
>> On 18/07/2014, 8:18 PM, Simon Urbanek wrote:
>>> Duncan,
>>> 
>>> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
>>> 
>>> #include <GLKit/GLKMathUtils.h>
>>> 
>>> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
>> 
>> Thanks.  I forget where that code came from.  Obviously I don't know
>> much about OSX programming.
>> 
>> One other question that might be simple, or might not:  I'm seeing
>> problems in Cocoa because after a user closes an rgl window (by clicking
>> on the x on the frame), the cleanup code is not being called.  rgl declares
>> 
>> @interface GLView : NSOpenGLView {
>>  rgl::OSXWindowImpl *impl;
>>  NSUInteger lastModifierFlags;
>> }
>> 
>> - (id)initWithFrame:(NSRect)frame
>>        pixelFormat:(NSOpenGLPixelFormat *)pixelFormat
>>               impl:(rgl::OSXWindowImpl *)impl;
>> @end
>> 
>> and then in the implementation section has the cleanup code in
>> 
>> - (void)dealloc
>> {
>>  if (impl) impl->on_dealloc();
>>  [super dealloc];
>> }
>> 
>> but as far as I can tell this isn't being called when the user closes
>> the window.  Is there some other method that is called to allow cleanup?
>> The Apple docs probably talk about this somewhere, but I haven't found
>> where...
>> 
> 
> More precisely:  this isn't being called *immediately* when the window
> is closed.  It is called a little bit later, but in some circumstances
> that's too late, because the user can ask rgl to do something in between
> and it tries to make changes to a window that isn't there any more.
> 

Yes, dealloc is asynchronous, because it gets called only when the object is actually released which is only after garbage collection (or allocation pool flush). For immediate action I would recommend windowShouldClose: (can cancel) or windowWillClose: (cannot cancel) window delegate methods.

Cheers,
Simon


> Duncan Murdoch
> 
>> Duncan Murdoch
>> 
>>> 
>>> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
>>> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
>>> total 16
>>> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
>>> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
>>> [...]
>>> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
>>> [...]
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> 
>>> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>>>> I'm trying to
>>>>> 
>>>>> install.packages("rgl", type = "source")
>>>>> 
>>>>> with
>>>>> 
>>>>>> sessionInfo()
>>>>> R Under development (unstable) (2014-07-09 r66111)
>>>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>>> 
>>>>> locale:
>>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>> 
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>>> 
>>>>> other attached packages:
>>>>> [1] quantreg_5.05 SparseM_1.05 
>>>>> 
>>>>> loaded via a namespace (and not attached):
>>>>> [1] tcltk_3.2.0 tools_3.2.0
>>>>> 
>>>>> and seeing (eventually):
>>>>> 
>>>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>>>> #include <GLKMathUtils.h> 
>>>>>        ^
>>>>> 1 error generated.
>>>>> make: *** [platform.o] Error 1
>>>>> ERROR: compilation failed for package ?rgl?
>>>>> 
>>>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>>> 
>>>> 
>>>> What OSX version is that?  There were warnings about deprecated code in
>>>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>>>> script isn't quite right.
>>>> 
>>>> Duncan Murdoch
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> 
>>> 
>> 
> 


From simon.urbanek at r-project.org  Sat Jul 19 19:35:19 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 19 Jul 2014 13:35:19 -0400
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <EA08563B-64A3-4705-80F9-CC3B9EB64E4A@illinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<d4a437552c594d27afd90548417098c3@CHIHT2.ad.uillinois.edu>
	<EA08563B-64A3-4705-80F9-CC3B9EB64E4A@illinois.edu>
Message-ID: <E4AEE393-F668-4B95-A29C-EE7D7EFB5ADE@r-project.org>

On Jul 19, 2014, at 10:15 AM, Roger Koenker <rkoenker at illinois.edu> wrote:

> Simon,   Maybe there is something wrong with my system, since I see:
> 
> yzzy: ls -l /System/Library/Frameworks/GLKit.framework
> total 16
> lrwxr-xr-x  1 root  wheel   22 Feb 17 23:46 GLKit -> Versions/Current/GLKit
> lrwxr-xr-x  1 root  wheel   26 Feb 17 23:46 Resources -> Versions/Current/Resources
> drwxr-xr-x  4 root  wheel  136 Feb 17 23:50 Versions
> 

It's possible that your system has only the run-time and the headers are only in the SDK inside Xcode. In that case the change Duncan made should work, because the compilers are aware of the SDK and thus will find it even if it's not in /System.

Cheers,
Simon



> Duncan:  I'll try the new patched version of rgl once it is available on R Forge.
> 
> Thanks to you both!
> 
> Roger
> 
> 
> Thanks
> Roger Koenker
> rkoenker at illinois.edu
> 
> 
> 
> 
> On Jul 18, 2014, at 8:18 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
>> Duncan,
>> 
>> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
>> 
>> #include <GLKit/GLKMathUtils.h>
>> 
>> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
>> 
>> 
>> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
>> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
>> total 16
>> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
>> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
>> [...]
>> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
>> [...]
>> 
>> Cheers,
>> Simon
>> 
>> 
>> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>> 
>>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>>> I'm trying to
>>>> 
>>>> install.packages("rgl", type = "source")
>>>> 
>>>> with
>>>> 
>>>>> sessionInfo()
>>>> R Under development (unstable) (2014-07-09 r66111)
>>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>> 
>>>> locale:
>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>> 
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>> 
>>>> other attached packages:
>>>> [1] quantreg_5.05 SparseM_1.05 
>>>> 
>>>> loaded via a namespace (and not attached):
>>>> [1] tcltk_3.2.0 tools_3.2.0
>>>> 
>>>> and seeing (eventually):
>>>> 
>>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>>> #include <GLKMathUtils.h> 
>>>>       ^
>>>> 1 error generated.
>>>> make: *** [platform.o] Error 1
>>>> ERROR: compilation failed for package ?rgl?
>>>> 
>>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>> 
>>> 
>>> What OSX version is that?  There were warnings about deprecated code in
>>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>>> script isn't quite right.
>>> 
>>> Duncan Murdoch
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From rkoenker at illinois.edu  Sat Jul 19 20:37:44 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Sat, 19 Jul 2014 13:37:44 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <1e82ba0a389744ecb5d2ab266b6cb5e9@CHIHT2.ad.uillinois.edu>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<d4a437552c594d27afd90548417098c3@CHIHT2.ad.uillinois.edu>
	<EA08563B-64A3-4705-80F9-CC3B9EB64E4A@illinois.edu>
	<1e82ba0a389744ecb5d2ab266b6cb5e9@CHIHT2.ad.uillinois.edu>
Message-ID: <FC20B541-2A83-4154-9B17-BA10AD606C12@illinois.edu>

Yes,  installing 0.94.1118  went smoothly...  although running my quantreg demo(combos) as a test crashed, but I'll assume
that this is connected to your other problem and try again later.  Thanks again to both of you

Roger

Roger Koenker
rkoenker at illinois.edu




On Jul 19, 2014, at 12:35 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> On Jul 19, 2014, at 10:15 AM, Roger Koenker <rkoenker at illinois.edu> wrote:
> 
>> Simon,   Maybe there is something wrong with my system, since I see:
>> 
>> yzzy: ls -l /System/Library/Frameworks/GLKit.framework
>> total 16
>> lrwxr-xr-x  1 root  wheel   22 Feb 17 23:46 GLKit -> Versions/Current/GLKit
>> lrwxr-xr-x  1 root  wheel   26 Feb 17 23:46 Resources -> Versions/Current/Resources
>> drwxr-xr-x  4 root  wheel  136 Feb 17 23:50 Versions
>> 
> 
> It's possible that your system has only the run-time and the headers are only in the SDK inside Xcode. In that case the change Duncan made should work, because the compilers are aware of the SDK and thus will find it even if it's not in /System.
> 
> Cheers,
> Simon
> 
> 
> 
>> Duncan:  I'll try the new patched version of rgl once it is available on R Forge.
>> 
>> Thanks to you both!
>> 
>> Roger
>> 
>> 
>> Thanks
>> Roger Koenker
>> rkoenker at illinois.edu
>> 
>> 
>> 
>> 
>> On Jul 18, 2014, at 8:18 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>> 
>>> Duncan,
>>> 
>>> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
>>> 
>>> #include <GLKit/GLKMathUtils.h>
>>> 
>>> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
>>> 
>>> 
>>> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
>>> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
>>> total 16
>>> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
>>> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
>>> [...]
>>> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
>>> [...]
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> 
>>> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>> 
>>>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>>>> I'm trying to
>>>>> 
>>>>> install.packages("rgl", type = "source")
>>>>> 
>>>>> with
>>>>> 
>>>>>> sessionInfo()
>>>>> R Under development (unstable) (2014-07-09 r66111)
>>>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>>> 
>>>>> locale:
>>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>> 
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>>> 
>>>>> other attached packages:
>>>>> [1] quantreg_5.05 SparseM_1.05 
>>>>> 
>>>>> loaded via a namespace (and not attached):
>>>>> [1] tcltk_3.2.0 tools_3.2.0
>>>>> 
>>>>> and seeing (eventually):
>>>>> 
>>>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>>>> #include <GLKMathUtils.h> 
>>>>>      ^
>>>>> 1 error generated.
>>>>> make: *** [platform.o] Error 1
>>>>> ERROR: compilation failed for package ?rgl?
>>>>> 
>>>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>>> 
>>>> 
>>>> What OSX version is that?  There were warnings about deprecated code in
>>>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>>>> script isn't quite right.
>>>> 
>>>> Duncan Murdoch
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 


From murdoch.duncan at gmail.com  Sun Jul 20 03:51:51 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 19 Jul 2014 20:51:51 -0500
Subject: [R-SIG-Mac] rgl for R-devel
In-Reply-To: <C12352FA-1BCE-40BF-B873-4685D66B7925@r-project.org>
References: <D96DCB24-26E7-495A-9F22-AFD1D3D734A9@illinois.edu>
	<53C9C4C4.6050700@gmail.com>
	<A1C99C46-61B3-4B9E-A3CC-709B08C94CA6@r-project.org>
	<53CA3D79.7030502@gmail.com> <53CA42EC.5080202@gmail.com>
	<C12352FA-1BCE-40BF-B873-4685D66B7925@r-project.org>
Message-ID: <53CB20B7.3050806@gmail.com>

On 19/07/2014, 10:31 AM, Simon Urbanek wrote:
> 
> On Jul 19, 2014, at 6:05 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 19/07/2014, 4:42 AM, Duncan Murdoch wrote:
>>> On 18/07/2014, 8:18 PM, Simon Urbanek wrote:
>>>> Duncan,
>>>>
>>>> I didn't look at the code, but the approach seems strange - if you use something from the GLKit framework then the include should be
>>>>
>>>> #include <GLKit/GLKMathUtils.h>
>>>>
>>>> without specifying -I... You should never have the need to include the "Headers" directory directly (other than cases where the framework contains non-framework headers like R does) since frameworks are searched automatically when referenced.
>>>
>>> Thanks.  I forget where that code came from.  Obviously I don't know
>>> much about OSX programming.
>>>
>>> One other question that might be simple, or might not:  I'm seeing
>>> problems in Cocoa because after a user closes an rgl window (by clicking
>>> on the x on the frame), the cleanup code is not being called.  rgl declares
>>>
>>> @interface GLView : NSOpenGLView {
>>>  rgl::OSXWindowImpl *impl;
>>>  NSUInteger lastModifierFlags;
>>> }
>>>
>>> - (id)initWithFrame:(NSRect)frame
>>>        pixelFormat:(NSOpenGLPixelFormat *)pixelFormat
>>>               impl:(rgl::OSXWindowImpl *)impl;
>>> @end
>>>
>>> and then in the implementation section has the cleanup code in
>>>
>>> - (void)dealloc
>>> {
>>>  if (impl) impl->on_dealloc();
>>>  [super dealloc];
>>> }
>>>
>>> but as far as I can tell this isn't being called when the user closes
>>> the window.  Is there some other method that is called to allow cleanup?
>>> The Apple docs probably talk about this somewhere, but I haven't found
>>> where...
>>>
>>
>> More precisely:  this isn't being called *immediately* when the window
>> is closed.  It is called a little bit later, but in some circumstances
>> that's too late, because the user can ask rgl to do something in between
>> and it tries to make changes to a window that isn't there any more.
>>
> 
> Yes, dealloc is asynchronous, because it gets called only when the object is actually released which is only after garbage collection (or allocation pool flush). For immediate action I would recommend windowShouldClose: (can cancel) or windowWillClose: (cannot cancel) window delegate methods.

It makes sense to use windowWillClose here, and I've got an NSWindow
object that could receive the message, but I don't know Objective C
(++?) well enough to know how to tell it to do so.  Do I need to create
a new interface to it?  I've mostly been on planes today so I haven't
had much time to Google a solution, but the Apple docs don't seem to
give any good examples of this.

BTW, thanks for the fix to the headers, and thanks Roger for testing them.

Duncan

> Cheers,
> Simon
> 
> 
>> Duncan Murdoch
>>
>>> Duncan Murdoch
>>>
>>>>
>>>> @Roger: on 10.9.2 (darwin 13.1.0 - which matches your build) I see
>>>> $ ls -l /System/Library/Frameworks/GLKit.framework/Headers/
>>>> total 16
>>>> -rw-r--r--  1 root  wheel   7327 Apr 11 05:49 GLKBaseEffect.h
>>>> -rw-r--r--  1 root  wheel   1435 Apr 11 05:49 GLKEffectProperty.h
>>>> [...]
>>>> -rw-r--r--  1 root  wheel   1224 Apr 11 05:49 GLKMathUtils.h
>>>> [...]
>>>>
>>>> Cheers,
>>>> Simon
>>>>
>>>>
>>>> On Jul 18, 2014, at 9:07 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>>>>
>>>>> On 18/07/2014, 4:41 PM, Roger Koenker wrote:
>>>>>> I'm trying to
>>>>>>
>>>>>> install.packages("rgl", type = "source")
>>>>>>
>>>>>> with
>>>>>>
>>>>>>> sessionInfo()
>>>>>> R Under development (unstable) (2014-07-09 r66111)
>>>>>> Platform: x86_64-apple-darwin13.1.0 (64-bit)
>>>>>>
>>>>>> locale:
>>>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] quantreg_5.05 SparseM_1.05 
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] tcltk_3.2.0 tools_3.2.0
>>>>>>
>>>>>> and seeing (eventually):
>>>>>>
>>>>>> clang++ -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG -I/System/Library/Frameworks/GLKit.framework/Headers -I/System/Library/Frameworks/OpenGL.framework/Headers  -DHAVE_PNG_H -I/usr/local/include/libpng12 -I/usr/X11/include -DDarwin -DNO_GL_PREFIX -I/usr/X11R6/include -DHAVE_FREETYPE -Iext/ftgl -I/opt/X11/include/freetype2 -Iext -I/usr/local/include -I/usr/local/include/freetype2 -I/opt/X11/include   -Wall -mtune=core2 -g -O2  -fPIC  -Wall -mtune=core2 -g -O2  -c platform.cpp -o platform.o
>>>>>> platform.cpp:16:10: fatal error: 'GLKMathUtils.h' file not found
>>>>>> #include <GLKMathUtils.h> 
>>>>>>        ^
>>>>>> 1 error generated.
>>>>>> make: *** [platform.o] Error 1
>>>>>> ERROR: compilation failed for package ?rgl?
>>>>>>
>>>>>> I do have a GLKit.framework  but there is no Headers subdir ...  
>>>>>>
>>>>>
>>>>> What OSX version is that?  There were warnings about deprecated code in
>>>>> rgl, so I switched to using GLKMathUtils, but apparently the configure
>>>>> script isn't quite right.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>
>>>>
>>>
>>
>


From murdoch.duncan at gmail.com  Wed Jul 23 17:46:44 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 23 Jul 2014 11:46:44 -0400
Subject: [R-SIG-Mac] Threads in R.app?
Message-ID: <53CFD8E4.6060301@gmail.com>

As I've mentioned before, I'm seeing crashes in rgl when running in 
R.app.  I'm starting to wonder if the Cocoa messages that my window 
receives are running in a different thread from the thread where the R 
console takes input, because it seems some changes are not happening in 
the expected order.  Is this the case?  Is there any way I can force the 
rgl window to have its messages received in the same thread?

Duncan Murdoch


From simon.urbanek at r-project.org  Wed Jul 23 22:10:24 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 23 Jul 2014 16:10:24 -0400
Subject: [R-SIG-Mac] Threads in R.app?
In-Reply-To: <53CFD8E4.6060301@gmail.com>
References: <53CFD8E4.6060301@gmail.com>
Message-ID: <46E90A29-884C-4FC9-8566-3666C5D8FA35@r-project.org>

On Jul 23, 2014, at 11:46 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:

> As I've mentioned before, I'm seeing crashes in rgl when running in R.app.  I'm starting to wonder if the Cocoa messages that my window receives are running in a different thread from the thread where the R console takes input, because it seems some changes are not happening in the expected order.  Is this the case?  Is there any way I can force the rgl window to have its messages received in the same thread?
> 

Normally, all messages are on the main loop. Although apps can run separate threads, the OS loop is always on the main thread (that's why it's so delicate for us, because R also runs on the main thread so the two loops must be meshed together without blocking each other).

Can you send me a reference to the issue, please? I'll try to find some spare cycles to look into it later this week.

Thanks,
Simon


From murdoch.duncan at gmail.com  Thu Jul 24 03:35:24 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 23 Jul 2014 21:35:24 -0400
Subject: [R-SIG-Mac] Threads in R.app?
In-Reply-To: <46E90A29-884C-4FC9-8566-3666C5D8FA35@r-project.org>
References: <53CFD8E4.6060301@gmail.com>
	<46E90A29-884C-4FC9-8566-3666C5D8FA35@r-project.org>
Message-ID: <53D062DC.4020107@gmail.com>

On 23/07/2014, 4:10 PM, Simon Urbanek wrote:
> On Jul 23, 2014, at 11:46 AM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> As I've mentioned before, I'm seeing crashes in rgl when running in R.app.  I'm starting to wonder if the Cocoa messages that my window receives are running in a different thread from the thread where the R console takes input, because it seems some changes are not happening in the expected order.  Is this the case?  Is there any way I can force the rgl window to have its messages received in the same thread?
>>
> 
> Normally, all messages are on the main loop. Although apps can run separate threads, the OS loop is always on the main thread (that's why it's so delicate for us, because R also runs on the main thread so the two loops must be meshed together without blocking each other).
> 
> Can you send me a reference to the issue, please? I'll try to find some spare cycles to look into it later this week.

Thanks for the offer.  Here's how to trigger the bug:

The current rgl version on R-forge (rev 1122, downloadable as
http://download.r-forge.r-project.org/src/contrib/rgl_0.94.1118.tar.gz)
shows the bug pretty reliably if you do this:

# Open a new window by running this demo:
demo(subdivision)

# Now manually close that window by clicking on the x in the frame,
# and make the following call:

rgl.clear()

This should open a new window and clear it, but it usually tries the
clear the window that was just closed, and crashes.

Sometimes this takes another try (just close the blank window and run
rgl.clear() again), but usually not.

I wouldn't be surprised if this is nothing to do with a lack of
synchronization, because every time I make a change that might affect
that the bug remains.  It could well be a simple error elsewhere, but I
really can't spot it when debugging.

Duncan Murdoch


From simon.urbanek at r-project.org  Fri Jul 25 15:14:18 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 25 Jul 2014 09:14:18 -0400
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
Message-ID: <1DCA60F5-151B-4A69-A427-1ECF44D1E946@r-project.org>

Eduardo,

On Jul 24, 2014, at 8:37 PM, Eduardo M. A. M.Mendes <emammendes at gmail.com> wrote:

> Hello
> 
> I have recently upgraded R to the newest version.  Unfortunately my old (fortran and C) R-package cannot be installed anymore (was built before R 3.0.0: please re-install it). 
> 
> I have tried R CMD INSTALL package_name but I noticed that R-3.1.1-binary-mac requests gcc-4.8.2 and specific locations for the libraries (gcc and gfortran).  

No, it doesn't. You must be using some other binary that the official CRAN one (http://cran.r-project.org/bin/macosx )
Our binaries only use standard Apple compilers (from Xcode - in recent OS X versions you can use xcode-select --install on the command line to install) plus a GNU Fortran that you can download from CRAN.


> Can someone point me to the documentation on how to install  gcc as R requires, please?
> 
> Please note that I have used "brew install gcc" on another mac and soft linked all the necessary libraries so that gcc-4.9.1 can be used as 4.8 (as R requires). However I would like a clean installation.
> 

I you use brew, then you're on your own and you should refer to their support. Our builds do not require brew (or any other 3rd party build system).

Cheers,
Simon

PS: Please note that R-SIG-Mac is the proper mailing list for Mac-specific questions.


From rkoenker at illinois.edu  Fri Jul 25 17:25:29 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Fri, 25 Jul 2014 10:25:29 -0500
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
Message-ID: <8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>

FWIW when I installed R-devel  a week or so ago, I had to also install gfortran-4.8.2-darwin13.tar.bz2 from 

http://r.research.att.com/libs/

well "had to"  is perhaps too strong, but I was seeing complaints about not running 4.8 and they went away
after this install.

Roger

url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Urbana, IL 61801

On Jul 25, 2014, at 8:14 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> Eduardo,
> 
> On Jul 24, 2014, at 8:37 PM, Eduardo M. A. M.Mendes <emammendes at gmail.com> wrote:
> 
>> Hello
>> 
>> I have recently upgraded R to the newest version.  Unfortunately my old (fortran and C) R-package cannot be installed anymore (was built before R 3.0.0: please re-install it). 
>> 
>> I have tried R CMD INSTALL package_name but I noticed that R-3.1.1-binary-mac requests gcc-4.8.2 and specific locations for the libraries (gcc and gfortran).  
> 
> No, it doesn't. You must be using some other binary that the official CRAN one (http://cran.r-project.org/bin/macosx )
> Our binaries only use standard Apple compilers (from Xcode - in recent OS X versions you can use xcode-select --install on the command line to install) plus a GNU Fortran that you can download from CRAN.
> 
> 
>> Can someone point me to the documentation on how to install  gcc as R requires, please?
>> 
>> Please note that I have used "brew install gcc" on another mac and soft linked all the necessary libraries so that gcc-4.9.1 can be used as 4.8 (as R requires). However I would like a clean installation.
>> 
> 
> I you use brew, then you're on your own and you should refer to their support. Our builds do not require brew (or any other 3rd party build system).
> 
> Cheers,
> Simon
> 
> PS: Please note that R-SIG-Mac is the proper mailing list for Mac-specific questions.
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Fri Jul 25 17:50:30 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 25 Jul 2014 11:50:30 -0400
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
	<8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
Message-ID: <BD2E1D48-957E-4FB1-BC86-4F5239B61EBD@r-project.org>

On Jul 25, 2014, at 11:25 AM, Roger Koenker <rkoenker at illinois.edu> wrote:

> FWIW when I installed R-devel  a week or so ago, I had to also install gfortran-4.8.2-darwin13.tar.bz2 from 
> 
> http://r.research.att.com/libs/
> 
> well "had to"  is perhaps too strong, but I was seeing complaints about not running 4.8 and they went away
> after this install.
> 

Ah, I think you're talking about the Mavericks builds. That one is indeed using GNU Fortran 4.8.2, but it should technically work even with the 4.2 CRAN Fortran. The only issue is that it uses the gfortran-4.8 name with version, so apart from symlinking the versions the easiest way is to install the binary above.

Thanks,
Simon


> Roger
> 
> url:    www.econ.uiuc.edu/~roger            Roger Koenker
> email    rkoenker at uiuc.edu            Department of Economics
> vox:     217-333-4558                University of Illinois
> fax:       217-244-6678                Urbana, IL 61801
> 
> On Jul 25, 2014, at 8:14 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
>> Eduardo,
>> 
>> On Jul 24, 2014, at 8:37 PM, Eduardo M. A. M.Mendes <emammendes at gmail.com> wrote:
>> 
>>> Hello
>>> 
>>> I have recently upgraded R to the newest version.  Unfortunately my old (fortran and C) R-package cannot be installed anymore (was built before R 3.0.0: please re-install it). 
>>> 
>>> I have tried R CMD INSTALL package_name but I noticed that R-3.1.1-binary-mac requests gcc-4.8.2 and specific locations for the libraries (gcc and gfortran).  
>> 
>> No, it doesn't. You must be using some other binary that the official CRAN one (http://cran.r-project.org/bin/macosx )
>> Our binaries only use standard Apple compilers (from Xcode - in recent OS X versions you can use xcode-select --install on the command line to install) plus a GNU Fortran that you can download from CRAN.
>> 
>> 
>>> Can someone point me to the documentation on how to install  gcc as R requires, please?
>>> 
>>> Please note that I have used "brew install gcc" on another mac and soft linked all the necessary libraries so that gcc-4.9.1 can be used as 4.8 (as R requires). However I would like a clean installation.
>>> 
>> 
>> I you use brew, then you're on your own and you should refer to their support. Our builds do not require brew (or any other 3rd party build system).
>> 
>> Cheers,
>> Simon
>> 
>> PS: Please note that R-SIG-Mac is the proper mailing list for Mac-specific questions.
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From rkoenker at illinois.edu  Fri Jul 25 18:09:36 2014
From: rkoenker at illinois.edu (Roger Koenker)
Date: Fri, 25 Jul 2014 11:09:36 -0500
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <c4373a30b433470a816d102fad31c99f@CITESHT1.ad.uillinois.edu>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
	<8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
	<c4373a30b433470a816d102fad31c99f@CITESHT1.ad.uillinois.edu>
Message-ID: <5E49AAF7-68D1-4725-B1D8-61BCDEB6E194@illinois.edu>

Yes,  Mavericks as I should have mentioned.  Anyway,  thanks for providing the 4.8 version, this made it all very
convenient, and I always have more confidence when downloading R tools of yours, rather than exploring further
afield.

Roger

url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Urbana, IL 61801

On Jul 25, 2014, at 10:50 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:

> On Jul 25, 2014, at 11:25 AM, Roger Koenker <rkoenker at illinois.edu> wrote:
> 
>> FWIW when I installed R-devel  a week or so ago, I had to also install gfortran-4.8.2-darwin13.tar.bz2 from 
>> 
>> http://r.research.att.com/libs/
>> 
>> well "had to"  is perhaps too strong, but I was seeing complaints about not running 4.8 and they went away
>> after this install.
>> 
> 
> Ah, I think you're talking about the Mavericks builds. That one is indeed using GNU Fortran 4.8.2, but it should technically work even with the 4.2 CRAN Fortran. The only issue is that it uses the gfortran-4.8 name with version, so apart from symlinking the versions the easiest way is to install the binary above.
> 
> Thanks,
> Simon
> 
> 
>> Roger
>> 
>> url:    www.econ.uiuc.edu/~roger            Roger Koenker
>> email    rkoenker at uiuc.edu            Department of Economics
>> vox:     217-333-4558                University of Illinois
>> fax:       217-244-6678                Urbana, IL 61801
>> 
>> On Jul 25, 2014, at 8:14 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>> 
>>> Eduardo,
>>> 
>>> On Jul 24, 2014, at 8:37 PM, Eduardo M. A. M.Mendes <emammendes at gmail.com> wrote:
>>> 
>>>> Hello
>>>> 
>>>> I have recently upgraded R to the newest version.  Unfortunately my old (fortran and C) R-package cannot be installed anymore (was built before R 3.0.0: please re-install it). 
>>>> 
>>>> I have tried R CMD INSTALL package_name but I noticed that R-3.1.1-binary-mac requests gcc-4.8.2 and specific locations for the libraries (gcc and gfortran).  
>>> 
>>> No, it doesn't. You must be using some other binary that the official CRAN one (http://cran.r-project.org/bin/macosx )
>>> Our binaries only use standard Apple compilers (from Xcode - in recent OS X versions you can use xcode-select --install on the command line to install) plus a GNU Fortran that you can download from CRAN.
>>> 
>>> 
>>>> Can someone point me to the documentation on how to install  gcc as R requires, please?
>>>> 
>>>> Please note that I have used "brew install gcc" on another mac and soft linked all the necessary libraries so that gcc-4.9.1 can be used as 4.8 (as R requires). However I would like a clean installation.
>>>> 
>>> 
>>> I you use brew, then you're on your own and you should refer to their support. Our builds do not require brew (or any other 3rd party build system).
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> PS: Please note that R-SIG-Mac is the proper mailing list for Mac-specific questions.
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 


From joe at BIO.UMASS.EDU  Sun Jul 27 16:36:12 2014
From: joe at BIO.UMASS.EDU (Joseph Kunkel)
Date: Sun, 27 Jul 2014 10:36:12 -0400
Subject: [R-SIG-Mac] Difference between Terminal output and GUI output.
Message-ID: <AAE7AD1F-5499-47FC-87A7-9231D1A093ED@bio.umass.edu>

Dear R-sig-Mac,

Sorry, this was sent via another email(non-SIG-member instance) and I am resending this in order to get consideration perhaps more quickly.

I have a problem with output from the R.app GUI which is at odds in part with the Terminal console output which I prefer.  The GUI does debug requests interspersed with the desired output.

My system is:

 Model Name:   MacBook Pro
 Model Identifier:     MacBookPro10,1
 Processor Name:       Intel Core i7
 Processor Speed:      2.7 GHz
 Number of Processors: 1
 Total Number of Cores:        4
 L2 Cache (per Core):  256 KB
 L3 Cache:     6 MB
 Memory:       16 GB
System Software Overview:
System Version:        OS X 10.9.4 (13E28)
Kernel Version:        Darwin 13.3.0

R version 3.1.1 (2014-07-10) -- "Sock it to Me"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin10.8.0 (64-bit)

R.app GUI 1.65 (6784 Snow Leopard build), S.

An R-script accesses an array XX which has ...

> attributes(XX)
$dim
[1] 12  3  8

The R-script that gives me the problem:
# GetCL.R
for (i in 1:4) { out<- round(((sum((XX[3,,i]-XX[10,,i])^2))^0.5 + (sum((XX[2,,i]-XX[10,,i])^2))^0.5)/2,3)
                   cat(out,'\n')
                   }

The correct output obtained in Terminal mode is:

> source("GetCL.R")
35.791
35.811
44.625
43.316

In the GUI I get:

> source("GetCL.R")
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
   , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]>
debug at GetCL.R#4: cat(out, "\n")
Browse[2]>
35.791
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
   , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]>
debug at GetCL.R#4: cat(out, "\n")
Browse[2]>
35.811
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
   , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]>
debug at GetCL.R#4: cat(out, "\n")
Browse[2]>
44.625
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
   , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]>
debug at GetCL.R#4: cat(out, "\n")
Browse[2]>
43.316

Of course this output gets more tedious if I try to process the entire array by running for i in 1:larger-n.
Is there any way to get rid of these debug and browse messages messages in GUI mode?
I have never experienced this debug output in my ca. 12+ years of using R intensely.

I just recently upgraded to R version 3.1.1 (2014-07-10) and renewed all my libraries.

-?.  .? ?.  .><((((?>?.  .? ?.  .><((((?>?.  .? ?.  .><((((?> .??.? >=-       =?}}}}}><
Joseph G. Kunkel, Emeritus Professor
Biology Department
UMass Amherst 
Amherst MA 01003
joe at bio.umass.edu


From murdoch.duncan at gmail.com  Sun Jul 27 21:32:24 2014
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 27 Jul 2014 15:32:24 -0400
Subject: [R-SIG-Mac] Difference between Terminal output and GUI output.
In-Reply-To: <AAE7AD1F-5499-47FC-87A7-9231D1A093ED@bio.umass.edu>
References: <AAE7AD1F-5499-47FC-87A7-9231D1A093ED@bio.umass.edu>
Message-ID: <53D553C8.4020008@gmail.com>

On 27/07/2014, 10:36 AM, Joseph Kunkel wrote:
> Dear R-sig-Mac,
> 
> Sorry, this was sent via another email(non-SIG-member instance) and I am resending this in order to get consideration perhaps more quickly.
> 
> I have a problem with output from the R.app GUI which is at odds in part with the Terminal console output which I prefer.  The GUI does debug requests interspersed with the desired output.
> 
> My system is:
> 
>  Model Name:   MacBook Pro
>  Model Identifier:     MacBookPro10,1
>  Processor Name:       Intel Core i7
>  Processor Speed:      2.7 GHz
>  Number of Processors: 1
>  Total Number of Cores:        4
>  L2 Cache (per Core):  256 KB
>  L3 Cache:     6 MB
>  Memory:       16 GB
> System Software Overview:
> System Version:        OS X 10.9.4 (13E28)
> Kernel Version:        Darwin 13.3.0
> 
> R version 3.1.1 (2014-07-10) -- "Sock it to Me"
> Copyright (C) 2014 The R Foundation for Statistical Computing
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
> 
> R.app GUI 1.65 (6784 Snow Leopard build), S.
> 
> An R-script accesses an array XX which has ...
> 
>> attributes(XX)
> $dim
> [1] 12  3  8
> 
> The R-script that gives me the problem:
> # GetCL.R
> for (i in 1:4) { out<- round(((sum((XX[3,,i]-XX[10,,i])^2))^0.5 + (sum((XX[2,,i]-XX[10,,i])^2))^0.5)/2,3)
>                    cat(out,'\n')
>                    }
> 
> The correct output obtained in Terminal mode is:
> 
>> source("GetCL.R")
> 35.791
> 35.811
> 44.625
> 43.316
> 
> In the GUI I get:
> 
>> source("GetCL.R")
> debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
>    , i] - XX[10, , i])^2))^0.5)/2, 3)
> Browse[2]>

etc.

That's not normal output.  It's hard to guess exactly what's going
wrong, but perhaps you have set a hook somewhere (see ?getHook), or have
an option set that is not obvious, or have some code in your workspace
that is interfering with normal evaluation.

Duncan Murdoch

> debug at GetCL.R#4: cat(out, "\n")
> Browse[2]>
> 35.791
> debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
>    , i] - XX[10, , i])^2))^0.5)/2, 3)
> Browse[2]>
> debug at GetCL.R#4: cat(out, "\n")
> Browse[2]>
> 35.811
> debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
>    , i] - XX[10, , i])^2))^0.5)/2, 3)
> Browse[2]>
> debug at GetCL.R#4: cat(out, "\n")
> Browse[2]>
> 44.625
> debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2,
>    , i] - XX[10, , i])^2))^0.5)/2, 3)
> Browse[2]>
> debug at GetCL.R#4: cat(out, "\n")
> Browse[2]>
> 43.316
> 
> Of course this output gets more tedious if I try to process the entire array by running for i in 1:larger-n.
> Is there any way to get rid of these debug and browse messages messages in GUI mode?
> I have never experienced this debug output in my ca. 12+ years of using R intensely.
> 
> I just recently upgraded to R version 3.1.1 (2014-07-10) and renewed all my libraries.
> 
> -?.  .? ?.  .><((((?>?.  .? ?.  .><((((?>?.  .? ?.  .><((((?> .??.? >=-       =?}}}}}><
> Joseph G. Kunkel, Emeritus Professor
> Biology Department
> UMass Amherst 
> Amherst MA 01003
> joe at bio.umass.edu
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From emammendes at gmail.com  Fri Jul 25 20:55:09 2014
From: emammendes at gmail.com (Eduardo M. A. M.Mendes)
Date: Fri, 25 Jul 2014 15:55:09 -0300
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
	<8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
Message-ID: <C0330E94-A9EB-4526-9E39-37F24FE0000C@gmail.com>

Many thanks.

It worked just fine.

Ed


On Jul 25, 2014, at 12:25 PM, Roger Koenker <rkoenker at illinois.edu> wrote:

> FWIW when I installed R-devel  a week or so ago, I had to also install gfortran-4.8.2-darwin13.tar.bz2 from 
> 
> http://r.research.att.com/libs/
> 
> well "had to"  is perhaps too strong, but I was seeing complaints about not running 4.8 and they went away
> after this install.
> 
> Roger
> 
> url:    www.econ.uiuc.edu/~roger            Roger Koenker
> email    rkoenker at uiuc.edu            Department of Economics
> vox:     217-333-4558                University of Illinois
> fax:       217-244-6678                Urbana, IL 61801
> 
> On Jul 25, 2014, at 8:14 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> 
>> Eduardo,
>> 
>> On Jul 24, 2014, at 8:37 PM, Eduardo M. A. M.Mendes <emammendes at gmail.com> wrote:
>> 
>>> Hello
>>> 
>>> I have recently upgraded R to the newest version.  Unfortunately my old (fortran and C) R-package cannot be installed anymore (was built before R 3.0.0: please re-install it). 
>>> 
>>> I have tried R CMD INSTALL package_name but I noticed that R-3.1.1-binary-mac requests gcc-4.8.2 and specific locations for the libraries (gcc and gfortran).  
>> 
>> No, it doesn't. You must be using some other binary that the official CRAN one (http://cran.r-project.org/bin/macosx )
>> Our binaries only use standard Apple compilers (from Xcode - in recent OS X versions you can use xcode-select --install on the command line to install) plus a GNU Fortran that you can download from CRAN.
>> 
>> 
>>> Can someone point me to the documentation on how to install  gcc as R requires, please?
>>> 
>>> Please note that I have used "brew install gcc" on another mac and soft linked all the necessary libraries so that gcc-4.9.1 can be used as 4.8 (as R requires). However I would like a clean installation.
>>> 
>> 
>> I you use brew, then you're on your own and you should refer to their support. Our builds do not require brew (or any other 3rd party build system).
>> 
>> Cheers,
>> Simon
>> 
>> PS: Please note that R-SIG-Mac is the proper mailing list for Mac-specific questions.
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From Roger.Dean at uws.edu.au  Fri Jul 25 15:44:52 2014
From: Roger.Dean at uws.edu.au (Roger Dean)
Date: Fri, 25 Jul 2014 13:44:52 +0000
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
 within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
Message-ID: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140725/69a29ecb/attachment.pl>

From emammendes at gmail.com  Fri Jul 25 20:55:13 2014
From: emammendes at gmail.com (Eduardo M. A. M.Mendes)
Date: Fri, 25 Jul 2014 15:55:13 -0300
Subject: [R-SIG-Mac] [Rd] R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <1DCA60F5-151B-4A69-A427-1ECF44D1E946@r-project.org>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<1DCA60F5-151B-4A69-A427-1ECF44D1E946@r-project.org>
Message-ID: <52D45901-5844-43E3-9AFF-8F16112EAD50@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140725/72a0a282/attachment.pl>

From emammendes at gmail.com  Fri Jul 25 20:56:36 2014
From: emammendes at gmail.com (Eduardo M. A. M.Mendes)
Date: Fri, 25 Jul 2014 15:56:36 -0300
Subject: [R-SIG-Mac] [Rd]   R-3.1.1 - R CMD INSTALL problem
In-Reply-To: <5E49AAF7-68D1-4725-B1D8-61BCDEB6E194@illinois.edu>
References: <FB8776EE-B310-4C1D-A07C-B600BEED83B7@gmail.com>
	<85b07415be0f4c80893ee011dac466c6@CHIHT1.ad.uillinois.edu>
	<8F36E8A9-B021-4CAA-82A5-56EC6EAF9950@illinois.edu>
	<c4373a30b433470a816d102fad31c99f@CITESHT1.ad.uillinois.edu>
	<5E49AAF7-68D1-4725-B1D8-61BCDEB6E194@illinois.edu>
Message-ID: <48F852B9-1219-4187-AF57-EB7436656F89@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140725/0253d9dd/attachment.pl>

From jkunkel1 at une.edu  Sun Jul 27 16:24:12 2014
From: jkunkel1 at une.edu (Joseph Kunkel)
Date: Sun, 27 Jul 2014 10:24:12 -0400
Subject: [R-SIG-Mac] Difference between Terminal output and GUI output.
Message-ID: <8AE36DA3-95B9-46FC-88F0-E84822A9544C@une.edu>

Dear R-sig-Mac, 

I have a problem with output from the R.app GUI which is at odds in part with the Terminal console output which I prefer.  The GUI does debug requests interspersed with the desired output. 

My system is:

  Model Name:	MacBook Pro
  Model Identifier:	MacBookPro10,1
  Processor Name:	Intel Core i7
  Processor Speed:	2.7 GHz
  Number of Processors:	1
  Total Number of Cores:	4
  L2 Cache (per Core):	256 KB
  L3 Cache:	6 MB
  Memory:	16 GB
System Software Overview:
 System Version:	OS X 10.9.4 (13E28)
 Kernel Version:	Darwin 13.3.0

R version 3.1.1 (2014-07-10) -- "Sock it to Me"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin10.8.0 (64-bit)

R.app GUI 1.65 (6784 Snow Leopard build), S. 

An R-script accesses an array XX which has ...

> attributes(XX)
$dim
[1] 12  3  8

The R-script that gives me the problem:
# GetCL.R
for (i in 1:4) { out<- round(((sum((XX[3,,i]-XX[10,,i])^2))^0.5 + (sum((XX[2,,i]-XX[10,,i])^2))^0.5)/2,3)
	            cat(out,'\n')
	            }

The correct output obtained in Terminal mode is:

> source("GetCL.R")
35.791 
35.811 
44.625 
43.316 

In the GUI I get:

> source("GetCL.R")
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2, 
    , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]> 
debug at GetCL.R#4: cat(out, "\n")
Browse[2]> 
35.791 
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2, 
    , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]> 
debug at GetCL.R#4: cat(out, "\n")
Browse[2]> 
35.811 
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2, 
    , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]> 
debug at GetCL.R#4: cat(out, "\n")
Browse[2]> 
44.625 
debug at GetCL.R#3: out <- round(((sum((XX[3, , i] - XX[10, , i])^2))^0.5 + (sum((XX[2, 
    , i] - XX[10, , i])^2))^0.5)/2, 3)
Browse[2]> 
debug at GetCL.R#4: cat(out, "\n")
Browse[2]> 
43.316

Of course this output gets more tedious if I try to process the entire array by running for i in 1:larger-n.
Is there any way to get rid of these debug and browse messages messages in GUI mode? 
I have never experienced this debug output in my ca. 12+ years of using R intensely.

I just recently upgraded to R version 3.1.1 (2014-07-10) and renewed all my libraries.


-?.  .? ?.  .><((((?>?.  .? ?.  .><((((?>?.  .? ?.  .><((((?> .??.? >=-       =?}}}}}><
Joseph G. Kunkel, Research Professor
112A Marine Science Center
University of New England
Biddeford ME 04005
http://www.bio.umass.edu/biology/kunkel/


From kevinushey at gmail.com  Mon Jul 28 08:13:45 2014
From: kevinushey at gmail.com (Kevin Ushey)
Date: Sun, 27 Jul 2014 23:13:45 -0700
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
 within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
In-Reply-To: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
References: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
Message-ID: <CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140727/9983fcf6/attachment.pl>

From simon.urbanek at r-project.org  Mon Jul 28 15:58:17 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 28 Jul 2014 09:58:17 -0400
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
	within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
In-Reply-To: <CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>
References: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
	<CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>
Message-ID: <CCB1A4AF-E45B-413A-B8B5-C27B9ECA2259@r-project.org>

To be precise this seems like a bug in Rcpp/RInside - whichever is adding the -I../Rcpp include. Since Rcpp contains String.h it will break everything due to the conflict with standard string.h (HFS is case-insensitive by default).

Cheers,
Simon


On Jul 28, 2014, at 2:13 AM, Kevin Ushey <kevinushey at gmail.com> wrote:

> Hi Roger,
> 
> Did you see this StackOverflow post?
> http://stackoverflow.com/questions/15489065/rcppeclipse-on-mac-os-x/17054405
> 
> It sounds like the poster describes the same problem as what you're seeing,
> and various prescriptions are offered.
> 
> Cheers,
> Kevin
> 
> 
> On Fri, Jul 25, 2014 at 6:44 AM, Roger Dean <Roger.Dean at uws.edu.au> wrote:
> 
>> Request for guidance on compiling C++ using RInside within Xcode 5, OSX
>> 10.9.4, R 3.1.1 (mavericks version).
>> 
>> Hi R-SIG-mac experts,
>> I know this question is close to some asked previously, and also to
>> comment 2.10 of the FAQ document on RInside provided by Dirk Eddelbuettel
>> and Romain Francois, but I still cannot solve it, nor find examples of
>> others doing so that are clear (or at least, clear to me, apologies if
>> appropriate).
>> 
>> I would like to compile C++ code that uses RInside, but within Xcode 5,
>> and using OSX 10.9.4, R 3.1.1 (mavericks version). The reason I wish to do
>> this is that I am writing time series analysis/generative externals for
>> MAXMSP, a widely used MIDI and audio processing platform, and it is built
>> on C and focused on Xcode as the developer tool (it is difficult to find
>> people compiling MAX externals using clang++ and not Xcode, though I
>> continue to search also towards this possible alternative route.)
>> 
>> So the helpful examples in the RInside source include rinside_sample0.cpp,
>> and this compiles/builds fine for me with the Make process, or with clang++
>> directly. And it runs, as do all but one of the other examples. It is very
>> simple as intended, and I'm sure many of you will have looked at it:
>> 
>> // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
>> //
>> // Simple example showing how to do the standard 'hello, world' using
>> embedded R
>> //
>> // Copyright (C) 2009 Dirk Eddelbuettel
>> // Copyright (C) 2010 Dirk Eddelbuettel and Romain Francois
>> //
>> // GPL'ed
>> 
>> #include <RInside.h>                    // for the embedded R via RInside
>> 
>> int main(int argc, char *argv[]) {
>> 
>>    RInside R(argc, argv);              // create an embedded R instance
>> 
>>    R["txt"] = "Hello, world!\n"; // assign a char* (string) to 'txt'
>> 
>>    R.parseEvalQ("cat(txt)");           // eval the init string, ignoring
>> any returns
>> 
>>    exit(0);
>> }
>> 
>> I have taken note of the comments about the .R/Makevars, including the
>> statements about -stdlib=libstdc++ -mmacosx-version-min=10.6 from Sturla
>> Molden (Feb 8 2014) and others. I am providing to Xcode libR.dylib, and
>> paths to headers and other libraries. I saw a reference to an Rcpp library,
>> but in my RCpp source and R 3.1.1 there is only Rcpp.so, not .dylib. I have
>> added this to the Xcode project, though I am not clear that it will be used.
>> 
>> After innumerable permutations in my attempts, I can only get as far as
>> reproducible problems with the string.h code from the Rcpp source (see
>> listing below taken directly from the Xcode 'issues' listing). I realise
>> there is a historic issue about the LLVM default compiler (now labelled
>> Apple LLVM 5.0), but I hoped that was what Makevars could solve.
>> 
>> Can anyone advise whether it is currently feasible to do what I want, and
>> ideally give more specific cues, please?
>> 
>> many thanks in advance
>> 
>> Roger Dean
>> 
>> roger.dean at uws.edu.au<mailto:roger.dean at uws.edu.au>
>> Reported Issues:
>> 
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:17:
>> Use of undeclared identifier 'internal'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:39:
>> Expected member name or ';' after declaration specifiers
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:17:
>> Use of undeclared identifier 'internal'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:45:
>> Expected member name or ';' after declaration specifiers
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:66:16:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:71:23:
>> Unknown type name 'StringProxy'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:75:23:
>> Unknown type name 'const_StringProxy'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:102:17:
>> Unknown type name 'Rcomplex'; did you mean '_Complex'?
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:103:17:
>> Unknown type name 'Rbyte'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:108:35:
>> Unknown type name 'Rbyte'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:110:35:
>> Unknown type name 'Rcomplex'; did you mean '_Complex'?
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:111:35:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:112:41:
>> Unknown type name 'StringProxy'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:170:42:
>> Unknown type name 'StringProxy'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:178:36:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:313:16:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:318:16:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:355:9:
>> Unknown type name 'SEXP'
>> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:358:21:
>> Implicit instantiation of undefined template 'std::basic_string<char,
>> std::char_traits<char>, std::allocator<char> >'
>> Too many errors emitted, stopping now
>> 
>> 
>> Roger Dean, Founder and Artistic Director, austraLYSIS. Mobile: +61 (0)481
>> 309 612.
>> Mail: austraLYSIS, PO Box 225, Milperra, NSW 2214, Australia.
>> Email<mailto:dr.metagroove at mindless.com> ... Web<
>> http://www.australysis.com/> ? Recent CD release: MultiPiano (1978-2012),
>> solo and computer interactive piano, Tall Poppies TP 225 (double CD). John
>> Shand's review: 'a trail-blazer', 'exquisite',  'surprising and
>> disquieting', 'willing grooves' ...
>> 
>> Prof Roger Dean,PhD, DSc, DLitt, FAHA, Research Professor of Sonic
>> Communication, Music, Cognition and Action Group, MARCS Institute.
>> Mail: MARCS Institute, University of Western Sydney, Locked Bag 1797,
>> PENRITH, NSW 2751, Australia.
>> Emai<mailto:roger.dean at uws.edu.au>l ? Phone: +61 2 9772 6902 ...  Fax: +61
>> 2 9772 6040
>> We are in Milperra ('Bankstown Campus'), just by the M5 motorway. Check
>> the campus maps to visit.
>> Web<http://marcs.uws.edu.au> ... Articles list<
>> http://tinyurl.com/RTDeanCitations>  ...  Wikipedia<
>> http://en.wikipedia.org/wiki/Roger_Dean_(musician)> ? I am founding
>> co-editor of the sound intermedia journal soundsRite<
>> http://soundsite.uws.edu.au> and currently co-editing the forthcoming
>> Oxford Handbook of Algorithmic Music.
>> I try to minimise 'Email Distraction', in order to get on with research
>> and creative work. So I reply to all appropriate emails, but in batches. If
>> yours needs a response, please expect to get one normally within 2-4
>> working days.
>> 
>> 
>>        [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Mon Jul 28 16:21:35 2014
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 28 Jul 2014 10:21:35 -0400
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
	within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
In-Reply-To: <21462.23248.315961.500990@max.nulle.part>
References: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
	<CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>
	<CCB1A4AF-E45B-413A-B8B5-C27B9ECA2259@r-project.org>
	<21462.23248.315961.500990@max.nulle.part>
Message-ID: <278B736F-4BAD-4928-87AB-2F954E9FE2C6@r-project.org>

On Jul 28, 2014, at 10:14 AM, Dirk Eddelbuettel <edd at debian.org> wrote:

> 
> I am somewhat new to this thread as Simon just added me to the CC list ...
> 
> On 28 July 2014 at 09:58, Simon Urbanek wrote:
> | To be precise this seems like a bug in Rcpp/RInside - whichever is adding the -I../Rcpp include. Since Rcpp contains String.h it will break everything due to the conflict with standard string.h (HFS is case-insensitive by default).
> 
> ... but I cannot help but notice that we had String.h since approximately forever:
> 
>   edd at max:~/git/rcpp$ git log inst/include/Rcpp/String.h | tail -5
>   commit b5bff59902c3cabd73f592b362e7cc76a7d06496
>   Author: Romain Fran?ois <romain at r-enthusiasts.com>
>   Date:   Mon Dec 3 10:06:18 2012 +0000
> 
>       Rcpp::String
>   edd at max:~/git/rcpp$ 
> 
> Folks have built RInside happily since 2012.  Could this not be a simple
> matter of header inclusion order?
> 

You'll have to ask the author of this thread (it's a bit cryptic - and/or check out the SO post), but as I understand it something is adding -I...Rcpp to CPPFLAGS which is bad and not needed since the proper include is #include <Rcpp/String.h> which is fine. I don't know who/what is adding the internal Rcpp directory to the include path.

Cheers,
Simon



> Dirk
> 
> 
> | 
> | Cheers,
> | Simon
> | 
> | 
> | On Jul 28, 2014, at 2:13 AM, Kevin Ushey <kevinushey at gmail.com> wrote:
> | 
> | > Hi Roger,
> | > 
> | > Did you see this StackOverflow post?
> | > http://stackoverflow.com/questions/15489065/rcppeclipse-on-mac-os-x/17054405
> | > 
> | > It sounds like the poster describes the same problem as what you're seeing,
> | > and various prescriptions are offered.
> | > 
> | > Cheers,
> | > Kevin
> | > 
> | > 
> | > On Fri, Jul 25, 2014 at 6:44 AM, Roger Dean <Roger.Dean at uws.edu.au> wrote:
> | > 
> | >> Request for guidance on compiling C++ using RInside within Xcode 5, OSX
> | >> 10.9.4, R 3.1.1 (mavericks version).
> | >> 
> | >> Hi R-SIG-mac experts,
> | >> I know this question is close to some asked previously, and also to
> | >> comment 2.10 of the FAQ document on RInside provided by Dirk Eddelbuettel
> | >> and Romain Francois, but I still cannot solve it, nor find examples of
> | >> others doing so that are clear (or at least, clear to me, apologies if
> | >> appropriate).
> | >> 
> | >> I would like to compile C++ code that uses RInside, but within Xcode 5,
> | >> and using OSX 10.9.4, R 3.1.1 (mavericks version). The reason I wish to do
> | >> this is that I am writing time series analysis/generative externals for
> | >> MAXMSP, a widely used MIDI and audio processing platform, and it is built
> | >> on C and focused on Xcode as the developer tool (it is difficult to find
> | >> people compiling MAX externals using clang++ and not Xcode, though I
> | >> continue to search also towards this possible alternative route.)
> | >> 
> | >> So the helpful examples in the RInside source include rinside_sample0.cpp,
> | >> and this compiles/builds fine for me with the Make process, or with clang++
> | >> directly. And it runs, as do all but one of the other examples. It is very
> | >> simple as intended, and I'm sure many of you will have looked at it:
> | >> 
> | >> // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
> | >> //
> | >> // Simple example showing how to do the standard 'hello, world' using
> | >> embedded R
> | >> //
> | >> // Copyright (C) 2009 Dirk Eddelbuettel
> | >> // Copyright (C) 2010 Dirk Eddelbuettel and Romain Francois
> | >> //
> | >> // GPL'ed
> | >> 
> | >> #include <RInside.h>                    // for the embedded R via RInside
> | >> 
> | >> int main(int argc, char *argv[]) {
> | >> 
> | >>    RInside R(argc, argv);              // create an embedded R instance
> | >> 
> | >>    R["txt"] = "Hello, world!\n"; // assign a char* (string) to 'txt'
> | >> 
> | >>    R.parseEvalQ("cat(txt)");           // eval the init string, ignoring
> | >> any returns
> | >> 
> | >>    exit(0);
> | >> }
> | >> 
> | >> I have taken note of the comments about the .R/Makevars, including the
> | >> statements about -stdlib=libstdc++ -mmacosx-version-min=10.6 from Sturla
> | >> Molden (Feb 8 2014) and others. I am providing to Xcode libR.dylib, and
> | >> paths to headers and other libraries. I saw a reference to an Rcpp library,
> | >> but in my RCpp source and R 3.1.1 there is only Rcpp.so, not .dylib. I have
> | >> added this to the Xcode project, though I am not clear that it will be used.
> | >> 
> | >> After innumerable permutations in my attempts, I can only get as far as
> | >> reproducible problems with the string.h code from the Rcpp source (see
> | >> listing below taken directly from the Xcode 'issues' listing). I realise
> | >> there is a historic issue about the LLVM default compiler (now labelled
> | >> Apple LLVM 5.0), but I hoped that was what Makevars could solve.
> | >> 
> | >> Can anyone advise whether it is currently feasible to do what I want, and
> | >> ideally give more specific cues, please?
> | >> 
> | >> many thanks in advance
> | >> 
> | >> Roger Dean
> | >> 
> | >> roger.dean at uws.edu.au<mailto:roger.dean at uws.edu.au>
> | >> Reported Issues:
> | >> 
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:17:
> | >> Use of undeclared identifier 'internal'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:39:
> | >> Expected member name or ';' after declaration specifiers
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:17:
> | >> Use of undeclared identifier 'internal'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:45:
> | >> Expected member name or ';' after declaration specifiers
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:66:16:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:71:23:
> | >> Unknown type name 'StringProxy'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:75:23:
> | >> Unknown type name 'const_StringProxy'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:102:17:
> | >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:103:17:
> | >> Unknown type name 'Rbyte'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:108:35:
> | >> Unknown type name 'Rbyte'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:110:35:
> | >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:111:35:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:112:41:
> | >> Unknown type name 'StringProxy'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:170:42:
> | >> Unknown type name 'StringProxy'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:178:36:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:313:16:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:318:16:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:355:9:
> | >> Unknown type name 'SEXP'
> | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:358:21:
> | >> Implicit instantiation of undefined template 'std::basic_string<char,
> | >> std::char_traits<char>, std::allocator<char> >'
> | >> Too many errors emitted, stopping now
> | >> 
> | >> 
> | >> Roger Dean, Founder and Artistic Director, austraLYSIS. Mobile: +61 (0)481
> | >> 309 612.
> | >> Mail: austraLYSIS, PO Box 225, Milperra, NSW 2214, Australia.
> | >> Email<mailto:dr.metagroove at mindless.com> ... Web<
> | >> http://www.australysis.com/> ? Recent CD release: MultiPiano (1978-2012),
> | >> solo and computer interactive piano, Tall Poppies TP 225 (double CD). John
> | >> Shand's review: 'a trail-blazer', 'exquisite',  'surprising and
> | >> disquieting', 'willing grooves' ...
> | >> 
> | >> Prof Roger Dean,PhD, DSc, DLitt, FAHA, Research Professor of Sonic
> | >> Communication, Music, Cognition and Action Group, MARCS Institute.
> | >> Mail: MARCS Institute, University of Western Sydney, Locked Bag 1797,
> | >> PENRITH, NSW 2751, Australia.
> | >> Emai<mailto:roger.dean at uws.edu.au>l ? Phone: +61 2 9772 6902 ...  Fax: +61
> | >> 2 9772 6040
> | >> We are in Milperra ('Bankstown Campus'), just by the M5 motorway. Check
> | >> the campus maps to visit.
> | >> Web<http://marcs.uws.edu.au> ... Articles list<
> | >> http://tinyurl.com/RTDeanCitations>  ...  Wikipedia<
> | >> http://en.wikipedia.org/wiki/Roger_Dean_(musician)> ? I am founding
> | >> co-editor of the sound intermedia journal soundsRite<
> | >> http://soundsite.uws.edu.au> and currently co-editing the forthcoming
> | >> Oxford Handbook of Algorithmic Music.
> | >> I try to minimise 'Email Distraction', in order to get on with research
> | >> and creative work. So I reply to all appropriate emails, but in batches. If
> | >> yours needs a response, please expect to get one normally within 2-4
> | >> working days.
> | >> 
> | >> 
> | >>        [[alternative HTML version deleted]]
> | >> 
> | >> 
> | >> _______________________________________________
> | >> R-SIG-Mac mailing list
> | >> R-SIG-Mac at r-project.org
> | >> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> | >> 
> | >> 
> | > 
> | > 	[[alternative HTML version deleted]]
> | > 
> | > _______________________________________________
> | > R-SIG-Mac mailing list
> | > R-SIG-Mac at r-project.org
> | > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> | 
> 
> -- 
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> 


From tyy3737 at gmail.com  Mon Jul 28 22:22:35 2014
From: tyy3737 at gmail.com (Yingying Tan)
Date: Mon, 28 Jul 2014 15:22:35 -0500
Subject: [R-SIG-Mac] Problem of running lmer function on Mac OS 10.9
	Mavericks
Message-ID: <CAMLCjkwRQfWUijS6295YS3EUtPQCoHpQZ5RuQAj731jEN9v9MQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20140728/b79398e8/attachment.pl>

From edd at debian.org  Mon Jul 28 16:14:40 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 28 Jul 2014 09:14:40 -0500
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
	within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
In-Reply-To: <CCB1A4AF-E45B-413A-B8B5-C27B9ECA2259@r-project.org>
References: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
	<CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>
	<CCB1A4AF-E45B-413A-B8B5-C27B9ECA2259@r-project.org>
Message-ID: <21462.23248.315961.500990@max.nulle.part>


I am somewhat new to this thread as Simon just added me to the CC list ...

On 28 July 2014 at 09:58, Simon Urbanek wrote:
| To be precise this seems like a bug in Rcpp/RInside - whichever is adding the -I../Rcpp include. Since Rcpp contains String.h it will break everything due to the conflict with standard string.h (HFS is case-insensitive by default).

... but I cannot help but notice that we had String.h since approximately forever:

   edd at max:~/git/rcpp$ git log inst/include/Rcpp/String.h | tail -5
   commit b5bff59902c3cabd73f592b362e7cc76a7d06496
   Author: Romain Fran?ois <romain at r-enthusiasts.com>
   Date:   Mon Dec 3 10:06:18 2012 +0000

       Rcpp::String
   edd at max:~/git/rcpp$ 

Folks have built RInside happily since 2012.  Could this not be a simple
matter of header inclusion order?

Dirk


| 
| Cheers,
| Simon
| 
| 
| On Jul 28, 2014, at 2:13 AM, Kevin Ushey <kevinushey at gmail.com> wrote:
| 
| > Hi Roger,
| > 
| > Did you see this StackOverflow post?
| > http://stackoverflow.com/questions/15489065/rcppeclipse-on-mac-os-x/17054405
| > 
| > It sounds like the poster describes the same problem as what you're seeing,
| > and various prescriptions are offered.
| > 
| > Cheers,
| > Kevin
| > 
| > 
| > On Fri, Jul 25, 2014 at 6:44 AM, Roger Dean <Roger.Dean at uws.edu.au> wrote:
| > 
| >> Request for guidance on compiling C++ using RInside within Xcode 5, OSX
| >> 10.9.4, R 3.1.1 (mavericks version).
| >> 
| >> Hi R-SIG-mac experts,
| >> I know this question is close to some asked previously, and also to
| >> comment 2.10 of the FAQ document on RInside provided by Dirk Eddelbuettel
| >> and Romain Francois, but I still cannot solve it, nor find examples of
| >> others doing so that are clear (or at least, clear to me, apologies if
| >> appropriate).
| >> 
| >> I would like to compile C++ code that uses RInside, but within Xcode 5,
| >> and using OSX 10.9.4, R 3.1.1 (mavericks version). The reason I wish to do
| >> this is that I am writing time series analysis/generative externals for
| >> MAXMSP, a widely used MIDI and audio processing platform, and it is built
| >> on C and focused on Xcode as the developer tool (it is difficult to find
| >> people compiling MAX externals using clang++ and not Xcode, though I
| >> continue to search also towards this possible alternative route.)
| >> 
| >> So the helpful examples in the RInside source include rinside_sample0.cpp,
| >> and this compiles/builds fine for me with the Make process, or with clang++
| >> directly. And it runs, as do all but one of the other examples. It is very
| >> simple as intended, and I'm sure many of you will have looked at it:
| >> 
| >> // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
| >> //
| >> // Simple example showing how to do the standard 'hello, world' using
| >> embedded R
| >> //
| >> // Copyright (C) 2009 Dirk Eddelbuettel
| >> // Copyright (C) 2010 Dirk Eddelbuettel and Romain Francois
| >> //
| >> // GPL'ed
| >> 
| >> #include <RInside.h>                    // for the embedded R via RInside
| >> 
| >> int main(int argc, char *argv[]) {
| >> 
| >>    RInside R(argc, argv);              // create an embedded R instance
| >> 
| >>    R["txt"] = "Hello, world!\n"; // assign a char* (string) to 'txt'
| >> 
| >>    R.parseEvalQ("cat(txt)");           // eval the init string, ignoring
| >> any returns
| >> 
| >>    exit(0);
| >> }
| >> 
| >> I have taken note of the comments about the .R/Makevars, including the
| >> statements about -stdlib=libstdc++ -mmacosx-version-min=10.6 from Sturla
| >> Molden (Feb 8 2014) and others. I am providing to Xcode libR.dylib, and
| >> paths to headers and other libraries. I saw a reference to an Rcpp library,
| >> but in my RCpp source and R 3.1.1 there is only Rcpp.so, not .dylib. I have
| >> added this to the Xcode project, though I am not clear that it will be used.
| >> 
| >> After innumerable permutations in my attempts, I can only get as far as
| >> reproducible problems with the string.h code from the Rcpp source (see
| >> listing below taken directly from the Xcode 'issues' listing). I realise
| >> there is a historic issue about the LLVM default compiler (now labelled
| >> Apple LLVM 5.0), but I hoped that was what Makevars could solve.
| >> 
| >> Can anyone advise whether it is currently feasible to do what I want, and
| >> ideally give more specific cues, please?
| >> 
| >> many thanks in advance
| >> 
| >> Roger Dean
| >> 
| >> roger.dean at uws.edu.au<mailto:roger.dean at uws.edu.au>
| >> Reported Issues:
| >> 
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:17:
| >> Use of undeclared identifier 'internal'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:39:
| >> Expected member name or ';' after declaration specifiers
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:17:
| >> Use of undeclared identifier 'internal'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:45:
| >> Expected member name or ';' after declaration specifiers
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:66:16:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:71:23:
| >> Unknown type name 'StringProxy'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:75:23:
| >> Unknown type name 'const_StringProxy'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:102:17:
| >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:103:17:
| >> Unknown type name 'Rbyte'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:108:35:
| >> Unknown type name 'Rbyte'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:110:35:
| >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:111:35:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:112:41:
| >> Unknown type name 'StringProxy'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:170:42:
| >> Unknown type name 'StringProxy'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:178:36:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:313:16:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:318:16:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:355:9:
| >> Unknown type name 'SEXP'
| >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:358:21:
| >> Implicit instantiation of undefined template 'std::basic_string<char,
| >> std::char_traits<char>, std::allocator<char> >'
| >> Too many errors emitted, stopping now
| >> 
| >> 
| >> Roger Dean, Founder and Artistic Director, austraLYSIS. Mobile: +61 (0)481
| >> 309 612.
| >> Mail: austraLYSIS, PO Box 225, Milperra, NSW 2214, Australia.
| >> Email<mailto:dr.metagroove at mindless.com> ... Web<
| >> http://www.australysis.com/> ? Recent CD release: MultiPiano (1978-2012),
| >> solo and computer interactive piano, Tall Poppies TP 225 (double CD). John
| >> Shand's review: 'a trail-blazer', 'exquisite',  'surprising and
| >> disquieting', 'willing grooves' ...
| >> 
| >> Prof Roger Dean,PhD, DSc, DLitt, FAHA, Research Professor of Sonic
| >> Communication, Music, Cognition and Action Group, MARCS Institute.
| >> Mail: MARCS Institute, University of Western Sydney, Locked Bag 1797,
| >> PENRITH, NSW 2751, Australia.
| >> Emai<mailto:roger.dean at uws.edu.au>l ? Phone: +61 2 9772 6902 ...  Fax: +61
| >> 2 9772 6040
| >> We are in Milperra ('Bankstown Campus'), just by the M5 motorway. Check
| >> the campus maps to visit.
| >> Web<http://marcs.uws.edu.au> ... Articles list<
| >> http://tinyurl.com/RTDeanCitations>  ...  Wikipedia<
| >> http://en.wikipedia.org/wiki/Roger_Dean_(musician)> ? I am founding
| >> co-editor of the sound intermedia journal soundsRite<
| >> http://soundsite.uws.edu.au> and currently co-editing the forthcoming
| >> Oxford Handbook of Algorithmic Music.
| >> I try to minimise 'Email Distraction', in order to get on with research
| >> and creative work. So I reply to all appropriate emails, but in batches. If
| >> yours needs a response, please expect to get one normally within 2-4
| >> working days.
| >> 
| >> 
| >>        [[alternative HTML version deleted]]
| >> 
| >> 
| >> _______________________________________________
| >> R-SIG-Mac mailing list
| >> R-SIG-Mac at r-project.org
| >> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
| >> 
| >> 
| > 
| > 	[[alternative HTML version deleted]]
| > 
| > _______________________________________________
| > R-SIG-Mac mailing list
| > R-SIG-Mac at r-project.org
| > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
| 

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Mon Jul 28 23:31:53 2014
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 28 Jul 2014 16:31:53 -0500
Subject: [R-SIG-Mac] Request for guidance on compiling C++ using RInside
	within Xcode 5, OSX 10.9.4, R 3.1.1 (mavericks version)
In-Reply-To: <278B736F-4BAD-4928-87AB-2F954E9FE2C6@r-project.org>
References: <46245092-FDC4-4D78-9064-D0F0499BA4EC@uws.edu.au>
	<CAJXgQP0KL-hgm2CvOQ1HXhwo_K=0OYJmVMZcs8QFH+gMAcseSQ@mail.gmail.com>
	<CCB1A4AF-E45B-413A-B8B5-C27B9ECA2259@r-project.org>
	<21462.23248.315961.500990@max.nulle.part>
	<278B736F-4BAD-4928-87AB-2F954E9FE2C6@r-project.org>
Message-ID: <21462.49481.568441.802317@max.nulle.part>


It is a user error as pointed out by this answer

     http://stackoverflow.com/a/17054405/143305

The OP adds the   Rcpp/include/Rcpp   directory on top of already having
Rcpp/include (which eg our Makefiles do).

It simply is a case of a wrong and overzealous local configuration coupled
with the case-insensitivity of the HFS file system.

No Rcpp or RInside issue here.

Dirk


On 28 July 2014 at 10:21, Simon Urbanek wrote:
| On Jul 28, 2014, at 10:14 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
| 
| > 
| > I am somewhat new to this thread as Simon just added me to the CC list ...
| > 
| > On 28 July 2014 at 09:58, Simon Urbanek wrote:
| > | To be precise this seems like a bug in Rcpp/RInside - whichever is adding the -I../Rcpp include. Since Rcpp contains String.h it will break everything due to the conflict with standard string.h (HFS is case-insensitive by default).
| > 
| > ... but I cannot help but notice that we had String.h since approximately forever:
| > 
| >   edd at max:~/git/rcpp$ git log inst/include/Rcpp/String.h | tail -5
| >   commit b5bff59902c3cabd73f592b362e7cc76a7d06496
| >   Author: Romain Fran?ois <romain at r-enthusiasts.com>
| >   Date:   Mon Dec 3 10:06:18 2012 +0000
| > 
| >       Rcpp::String
| >   edd at max:~/git/rcpp$ 
| > 
| > Folks have built RInside happily since 2012.  Could this not be a simple
| > matter of header inclusion order?
| > 
| 
| You'll have to ask the author of this thread (it's a bit cryptic - and/or check out the SO post), but as I understand it something is adding -I...Rcpp to CPPFLAGS which is bad and not needed since the proper include is #include <Rcpp/String.h> which is fine. I don't know who/what is adding the internal Rcpp directory to the include path.
| 
| Cheers,
| Simon
| 
| 
| 
| > Dirk
| > 
| > 
| > | 
| > | Cheers,
| > | Simon
| > | 
| > | 
| > | On Jul 28, 2014, at 2:13 AM, Kevin Ushey <kevinushey at gmail.com> wrote:
| > | 
| > | > Hi Roger,
| > | > 
| > | > Did you see this StackOverflow post?
| > | > http://stackoverflow.com/questions/15489065/rcppeclipse-on-mac-os-x/17054405
| > | > 
| > | > It sounds like the poster describes the same problem as what you're seeing,
| > | > and various prescriptions are offered.
| > | > 
| > | > Cheers,
| > | > Kevin
| > | > 
| > | > 
| > | > On Fri, Jul 25, 2014 at 6:44 AM, Roger Dean <Roger.Dean at uws.edu.au> wrote:
| > | > 
| > | >> Request for guidance on compiling C++ using RInside within Xcode 5, OSX
| > | >> 10.9.4, R 3.1.1 (mavericks version).
| > | >> 
| > | >> Hi R-SIG-mac experts,
| > | >> I know this question is close to some asked previously, and also to
| > | >> comment 2.10 of the FAQ document on RInside provided by Dirk Eddelbuettel
| > | >> and Romain Francois, but I still cannot solve it, nor find examples of
| > | >> others doing so that are clear (or at least, clear to me, apologies if
| > | >> appropriate).
| > | >> 
| > | >> I would like to compile C++ code that uses RInside, but within Xcode 5,
| > | >> and using OSX 10.9.4, R 3.1.1 (mavericks version). The reason I wish to do
| > | >> this is that I am writing time series analysis/generative externals for
| > | >> MAXMSP, a widely used MIDI and audio processing platform, and it is built
| > | >> on C and focused on Xcode as the developer tool (it is difficult to find
| > | >> people compiling MAX externals using clang++ and not Xcode, though I
| > | >> continue to search also towards this possible alternative route.)
| > | >> 
| > | >> So the helpful examples in the RInside source include rinside_sample0.cpp,
| > | >> and this compiles/builds fine for me with the Make process, or with clang++
| > | >> directly. And it runs, as do all but one of the other examples. It is very
| > | >> simple as intended, and I'm sure many of you will have looked at it:
| > | >> 
| > | >> // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
| > | >> //
| > | >> // Simple example showing how to do the standard 'hello, world' using
| > | >> embedded R
| > | >> //
| > | >> // Copyright (C) 2009 Dirk Eddelbuettel
| > | >> // Copyright (C) 2010 Dirk Eddelbuettel and Romain Francois
| > | >> //
| > | >> // GPL'ed
| > | >> 
| > | >> #include <RInside.h>                    // for the embedded R via RInside
| > | >> 
| > | >> int main(int argc, char *argv[]) {
| > | >> 
| > | >>    RInside R(argc, argv);              // create an embedded R instance
| > | >> 
| > | >>    R["txt"] = "Hello, world!\n"; // assign a char* (string) to 'txt'
| > | >> 
| > | >>    R.parseEvalQ("cat(txt)");           // eval the init string, ignoring
| > | >> any returns
| > | >> 
| > | >>    exit(0);
| > | >> }
| > | >> 
| > | >> I have taken note of the comments about the .R/Makevars, including the
| > | >> statements about -stdlib=libstdc++ -mmacosx-version-min=10.6 from Sturla
| > | >> Molden (Feb 8 2014) and others. I am providing to Xcode libR.dylib, and
| > | >> paths to headers and other libraries. I saw a reference to an Rcpp library,
| > | >> but in my RCpp source and R 3.1.1 there is only Rcpp.so, not .dylib. I have
| > | >> added this to the Xcode project, though I am not clear that it will be used.
| > | >> 
| > | >> After innumerable permutations in my attempts, I can only get as far as
| > | >> reproducible problems with the string.h code from the Rcpp source (see
| > | >> listing below taken directly from the Xcode 'issues' listing). I realise
| > | >> there is a historic issue about the LLVM default compiler (now labelled
| > | >> Apple LLVM 5.0), but I hoped that was what Makevars could solve.
| > | >> 
| > | >> Can anyone advise whether it is currently feasible to do what I want, and
| > | >> ideally give more specific cues, please?
| > | >> 
| > | >> many thanks in advance
| > | >> 
| > | >> Roger Dean
| > | >> 
| > | >> roger.dean at uws.edu.au<mailto:roger.dean at uws.edu.au>
| > | >> Reported Issues:
| > | >> 
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:17:
| > | >> Use of undeclared identifier 'internal'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:52:39:
| > | >> Expected member name or ';' after declaration specifiers
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:17:
| > | >> Use of undeclared identifier 'internal'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:53:45:
| > | >> Expected member name or ';' after declaration specifiers
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:66:16:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:71:23:
| > | >> Unknown type name 'StringProxy'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:75:23:
| > | >> Unknown type name 'const_StringProxy'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:102:17:
| > | >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:103:17:
| > | >> Unknown type name 'Rbyte'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:108:35:
| > | >> Unknown type name 'Rbyte'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:110:35:
| > | >> Unknown type name 'Rcomplex'; did you mean '_Complex'?
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:111:35:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:112:41:
| > | >> Unknown type name 'StringProxy'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:170:42:
| > | >> Unknown type name 'StringProxy'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:178:36:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:313:16:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:318:16:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:355:9:
| > | >> Unknown type name 'SEXP'
| > | >> /Library/Frameworks/R.framework/Versions/3.1/Resources/library/Rcpp/include/Rcpp/String.h:358:21:
| > | >> Implicit instantiation of undefined template 'std::basic_string<char,
| > | >> std::char_traits<char>, std::allocator<char> >'
| > | >> Too many errors emitted, stopping now
| > | >> 
| > | >> 
| > | >> Roger Dean, Founder and Artistic Director, austraLYSIS. Mobile: +61 (0)481
| > | >> 309 612.
| > | >> Mail: austraLYSIS, PO Box 225, Milperra, NSW 2214, Australia.
| > | >> Email<mailto:dr.metagroove at mindless.com> ... Web<
| > | >> http://www.australysis.com/> ? Recent CD release: MultiPiano (1978-2012),
| > | >> solo and computer interactive piano, Tall Poppies TP 225 (double CD). John
| > | >> Shand's review: 'a trail-blazer', 'exquisite',  'surprising and
| > | >> disquieting', 'willing grooves' ...
| > | >> 
| > | >> Prof Roger Dean,PhD, DSc, DLitt, FAHA, Research Professor of Sonic
| > | >> Communication, Music, Cognition and Action Group, MARCS Institute.
| > | >> Mail: MARCS Institute, University of Western Sydney, Locked Bag 1797,
| > | >> PENRITH, NSW 2751, Australia.
| > | >> Emai<mailto:roger.dean at uws.edu.au>l ? Phone: +61 2 9772 6902 ...  Fax: +61
| > | >> 2 9772 6040
| > | >> We are in Milperra ('Bankstown Campus'), just by the M5 motorway. Check
| > | >> the campus maps to visit.
| > | >> Web<http://marcs.uws.edu.au> ... Articles list<
| > | >> http://tinyurl.com/RTDeanCitations>  ...  Wikipedia<
| > | >> http://en.wikipedia.org/wiki/Roger_Dean_(musician)> ? I am founding
| > | >> co-editor of the sound intermedia journal soundsRite<
| > | >> http://soundsite.uws.edu.au> and currently co-editing the forthcoming
| > | >> Oxford Handbook of Algorithmic Music.
| > | >> I try to minimise 'Email Distraction', in order to get on with research
| > | >> and creative work. So I reply to all appropriate emails, but in batches. If
| > | >> yours needs a response, please expect to get one normally within 2-4
| > | >> working days.
| > | >> 
| > | >> 
| > | >>        [[alternative HTML version deleted]]
| > | >> 
| > | >> 
| > | >> _______________________________________________
| > | >> R-SIG-Mac mailing list
| > | >> R-SIG-Mac at r-project.org
| > | >> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
| > | >> 
| > | >> 
| > | > 
| > | > 	[[alternative HTML version deleted]]
| > | > 
| > | > _______________________________________________
| > | > R-SIG-Mac mailing list
| > | > R-SIG-Mac at r-project.org
| > | > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
| > | 
| > 
| > -- 
| > http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| > 
| 

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


