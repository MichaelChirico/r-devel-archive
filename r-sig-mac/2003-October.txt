From gwgilc at wm.edu  Wed Oct  1 08:59:50 2003
From: gwgilc at wm.edu (George W. Gilchrist)
Date: Wed Oct  1 13:59:08 2003
Subject: [R-SIG-Mac] Trouble building R 1.7.1
Message-ID: <BBA039F6.2FF4%gwgilc@wm.edu>

I'm trying to build R following Stefano's step by step directions. I am
using gcc 3.3 and g77 3.4. After a few minutes compiling, I get the
following set of messages/errors.

gcc -no-cpp-precomp -I. -I../../src/include -I../../src/include
-I/usr/X11R6/include -I/sw/include -I/usr/local/include -DHAVE_CONFIG_H   -g
-O2 -c devQuartz.c -o devQuartz.o
In file included from
/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
ework/Headers/CarbonCore.h:113,
                 from
/System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:21,
                 from
/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20,
                 from devQuartz.c:42:
/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
ework/Headers/Debugging.h:285:2: #else without #if
/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
ework/Headers/Debugging.h:287:2: #endif without #if
/System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
ework/Headers/Debugging.h:301:1: missing binary operator before token "enum"
devQuartz.c:1156:1: unterminated #if
make[3]: *** [devQuartz.o] Error 1
make[2]: *** [R] Error 2
make[1]: *** [R] Error 1
make: *** [R] Error 1

I looked at those lines in Debugging.h and everything looks fine. Any clues?
Thanks to all for your help.

==================================================================
George W. Gilchrist                        Email #1: gwgilc@wm.edu
Department of Biology, Box 8795          Email #2: kitesci@cox.net
College of William & Mary                    Phone: (757) 221-7751
Williamsburg, VA 23187-8795                    Fax: (757) 221-6483
http://gwgilc.people.wm.edu/

From tlumley at u.washington.edu  Wed Oct  1 07:34:25 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed Oct  1 15:33:46 2003
Subject: [R-SIG-Mac] Trouble building R 1.7.1
In-Reply-To: <BBA039F6.2FF4%gwgilc@wm.edu>
References: <BBA039F6.2FF4%gwgilc@wm.edu>
Message-ID: <Pine.A41.4.58.0310010632540.121210@homer06.u.washington.edu>

On Wed, 1 Oct 2003, George W. Gilchrist wrote:

> I'm trying to build R following Stefano's step by step directions. I am
> using gcc 3.3 and g77 3.4. After a few minutes compiling, I get the
> following set of messages/errors.

Yes, this is a known problem. I forget the solution, but someone will
probably point it out.  More importantly, if you build the r-devel
snapshot (which is now in code freeze and will be 1.8.0 next week) it
doesn't happen.

	-thomas

> gcc -no-cpp-precomp -I. -I../../src/include -I../../src/include
> -I/usr/X11R6/include -I/sw/include -I/usr/local/include -DHAVE_CONFIG_H   -g
> -O2 -c devQuartz.c -o devQuartz.o
> In file included from
> /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
> ework/Headers/CarbonCore.h:113,
>                  from
> /System/Library/Frameworks/CoreServices.framework/Headers/CoreServices.h:21,
>                  from
> /System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20,
>                  from devQuartz.c:42:
> /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
> ework/Headers/Debugging.h:285:2: #else without #if
> /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
> ework/Headers/Debugging.h:287:2: #endif without #if
> /System/Library/Frameworks/CoreServices.framework/Frameworks/CarbonCore.fram
> ework/Headers/Debugging.h:301:1: missing binary operator before token "enum"
> devQuartz.c:1156:1: unterminated #if
> make[3]: *** [devQuartz.o] Error 1
> make[2]: *** [R] Error 2
> make[1]: *** [R] Error 1
> make: *** [R] Error 1
>
> I looked at those lines in Debugging.h and everything looks fine. Any clues?
> Thanks to all for your help.
>
> ==================================================================
> George W. Gilchrist                        Email #1: gwgilc@wm.edu
> Department of Biology, Box 8795          Email #2: kitesci@cox.net
> College of William & Mary                    Phone: (757) 221-7751
> Williamsburg, VA 23187-8795                    Fax: (757) 221-6483
> http://gwgilc.people.wm.edu/
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From Simon.Urbanek at math.uni-augsburg.de  Wed Oct  1 17:13:24 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Wed Oct  1 16:12:45 2003
Subject: [R-SIG-Mac] Trouble building R 1.7.1
In-Reply-To: <BBA039F6.2FF4%gwgilc@wm.edu>
Message-ID: <6B3E2FD5-F419-11D7-B001-000A957CEFBA@math.uni-augsburg.de>

As Thomas pointed out this was an issue a while ago. This is a part of  
post I sent at that time:
(the proposed solution refers to the relevant #include in devQuartz.c)

--- cut here ---

I was just building R-devel with aqua today. I had some issues  
compiling it, so I'm letting you know ... just in case ... ;)

gcc -no-cpp-precomp -I. -I../../src/include  
-I../../../../R-devel/src/include -I/usr/X11R6/include  
-I/usr/local/include -DHAVE_CONFIG_H   -g -O2 -c  
../../../../R-devel/src/unix/devQuartz.c -o devQuartz.o
In file included from  
/System/Library/Frameworks/CoreServices.framework/Frameworks/ 
CarbonCore.framework/Headers/CarbonCore.h:113,
                  from  
/System/Library/Frameworks/CoreServices.framework/Headers/ 
CoreServices.h:21,
                  from  
/System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20,
                  from ../../../../R-devel/src/unix/devQuartz.c:35:
/System/Library/Frameworks/CoreServices.framework/Frameworks/ 
CarbonCore.framework/Headers/Debugging.h:285:2: #else without #if
/System/Library/Frameworks/CoreServices.framework/Frameworks/ 
CarbonCore.framework/Headers/Debugging.h:287:2: #endif without #if
/System/Library/Frameworks/CoreServices.framework/Frameworks/ 
CarbonCore.framework/Headers/Debugging.h:301:1: missing binary operator  
before token "enum"
../../../../R-devel/src/unix/devQuartz.c:922:1: unterminated #if
make[3]: *** [devQuartz.o] Error 1

This is mainly due to the fact that R uses DEBUG in some way where  
Carbon expects it to be either undefined or defined as 0/1. Dirty fix  
is to always #undef it before including Carbon.h, but that is just a  
quick hack, not a real solution. A bit more general (but clumsy) is the  
following:

#ifdef DEBUG
#define __R_DEBUG DEBUG
#undef DEBUG
#endif
#include <Carbon/Carbon.h>
#ifdef __R_DEBUG
#define DEBUG __R_DEBUG
#undef __R_DEBUG
#endif

that works for me ... although I'm still not happy about R using DEBUG  
... I fell into that trap with Rserve already.

--- cut here ---

... and as Thomas also pointed out this was fixed in R-devel since.

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From jago at mclink.it  Wed Oct  1 18:34:07 2003
From: jago at mclink.it (Stefano Iacus)
Date: Wed Oct  1 17:33:31 2003
Subject: [R-SIG-Mac] Trouble building R 1.7.1
In-Reply-To: <BBA039F6.2FF4%gwgilc@wm.edu>
Message-ID: <B231C106-F424-11D7-B67F-003065CC4CB8@mclink.it>

You should either use -D__DEBUGGING__, use Simon's patch or build the  
latest R-devel sources.

R 1.7.1 builds fine with that instruction using Dec2002 Dev Tools. When  
you update the tools the problems comes out. I should mention it in the  
instructions page.

BTW, R-1.8.0 is going to be released next week, and this version builds  
fine.

stefano


On Mercoled?, ott 1, 2003, at 13:59 Europe/Rome, George W. Gilchrist  
wrote:

> I'm trying to build R following Stefano's step by step directions. I am
> using gcc 3.3 and g77 3.4. After a few minutes compiling, I get the
> following set of messages/errors.
>
> gcc -no-cpp-precomp -I. -I../../src/include -I../../src/include
> -I/usr/X11R6/include -I/sw/include -I/usr/local/include  
> -DHAVE_CONFIG_H   -g
> -O2 -c devQuartz.c -o devQuartz.o
> In file included from
> /System/Library/Frameworks/CoreServices.framework/Frameworks/ 
> CarbonCore.fram
> ework/Headers/CarbonCore.h:113,
>                  from
> /System/Library/Frameworks/CoreServices.framework/Headers/ 
> CoreServices.h:21,
>                  from
> /System/Library/Frameworks/Carbon.framework/Headers/Carbon.h:20,
>                  from devQuartz.c:42:
> /System/Library/Frameworks/CoreServices.framework/Frameworks/ 
> CarbonCore.fram
> ework/Headers/Debugging.h:285:2: #else without #if
> /System/Library/Frameworks/CoreServices.framework/Frameworks/ 
> CarbonCore.fram
> ework/Headers/Debugging.h:287:2: #endif without #if
> /System/Library/Frameworks/CoreServices.framework/Frameworks/ 
> CarbonCore.fram
> ework/Headers/Debugging.h:301:1: missing binary operator before token  
> "enum"
> devQuartz.c:1156:1: unterminated #if
> make[3]: *** [devQuartz.o] Error 1
> make[2]: *** [R] Error 2
> make[1]: *** [R] Error 1
> make: *** [R] Error 1
>
> I looked at those lines in Debugging.h and everything looks fine. Any  
> clues?
> Thanks to all for your help.
>
> ==================================================================
> George W. Gilchrist                        Email #1: gwgilc@wm.edu
> Department of Biology, Box 8795          Email #2: kitesci@cox.net
> College of William & Mary                    Phone: (757) 221-7751
> Williamsburg, VA 23187-8795                    Fax: (757) 221-6483
> http://gwgilc.people.wm.edu/
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac
>

From deleeuw at stat.ucla.edu  Tue Oct  7 13:29:55 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Tue Oct  7 21:27:06 2003
Subject: [R-SIG-Mac] updates R, Emacs on gifi
Message-ID: <A16F7A9A-F8FC-11D7-A865-000393860F3C@stat.ucla.edu>

I have updated both R and Emacs with ESS on  
http://gifi.stat.ucla.edu/pub.

Both are diskimages with installer packages, and both install required
dynamic libraries in the correct places. Both are compiled with gcc-3.3
and g77-3.4 on Panther and on a G5, but they should work with Jaguar
on a G4 as well.

The R package contains both RAqua and the Darwin/X11 version of R.
(1.8.0 beta, with base packages).

====
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 9432 Boelter Hall, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
------------------------------------------------------------------------ 
------------------------------
            No matter where you go, there you are. --- Buckaroo Banzai
                     http://gifi.stat.ucla.edu/sounds/nomatter.au

From d.firth at warwick.ac.uk  Thu Oct  9 11:09:28 2003
From: d.firth at warwick.ac.uk (David Firth)
Date: Thu Oct  9 11:08:32 2003
Subject: [R-SIG-Mac] R and XDarwin -- should tcltk still work?
Message-ID: <491BA249-FA38-11D7-AC79-0050E4C03977@warwick.ac.uk>

This is a question about running R in an X-windows environment on the 
Mac.

I haven't yet "upgraded" to Apple's X11, and am still using the 
Xfree86/XDarwin setup, which worked fine with R up to and including 
1.7.1.

With the new R 1.8.0 (the binary RAqua from CRAN), though, I get the 
following problem:

 > library(tcltk)
 > kCGErrorIllegalArgument : CGSGetWindowType: Invalid window
kCGErrorIllegalArgument : CGSGetWindowType: Invalid window

Is this because R now tries to draw Aqua-based Tk windows rather than 
X11 ones?  or something else?  I'd welcome any hints before I spend 
time experimenting.

Thanks,
David

From stefano.iacus at unimi.it  Thu Oct  9 12:15:38 2003
From: stefano.iacus at unimi.it (Stefano Iacus)
Date: Thu Oct  9 11:14:47 2003
Subject: [R-SIG-Mac] Re: R-SIG-Mac post from df@stats.warwick.ac.uk requires
	approval
In-Reply-To: <mailman.28.1065688771.378.r-sig-mac@stat.math.ethz.ch>
Message-ID: <25EDD9C0-FA39-11D7-82E4-003065CC4CB8@unimi.it>

It depends on how you configure R. If you specify X11 tcltk 
headers/libs than you should not have any problem at all. You should 
also not use --with-aqua when configuring nor use --gui-aqua when 
starting R.

If you installed RAqua is because you are going to use aqua gui 
everywhere...more or less this is the assumption.

stefano

p.s. I also get this kind of problems when trying to run R remotely on 
a server without logging as root.



> From: David Firth <df@stats.warwick.ac.uk>
> Date: Gio ott 9, 2003  10:40:16 Europe/Rome
> To: r-sig-mac@stat.math.ethz.ch
> Subject: R and XDarwin -- should tcltk still work?
>
>
> This is a question about running R in an X-windows environment on the 
> Mac.
>
> I haven't yet "upgraded" to Apple's X11, and am still using the 
> Xfree86/XDarwin setup, which worked fine with R up to and including 
> 1.7.1.
>
> With the new R 1.8.0, though, I get the following problem:
>
> > library(tcltk)
> > kCGErrorIllegalArgument : CGSGetWindowType: Invalid window
> kCGErrorIllegalArgument : CGSGetWindowType: Invalid window
>
> Is this because R now tries to draw Aqua-based Tk windows rather than 
> X11 ones?  or something else?  I'd welcome any hints before I spend 
> time experimenting.
>
> Thanks,
> David
>
>
>
>
> From: r-sig-mac-request@stat.math.ethz.ch
> Subject: confirm 859bd41fa789c26e69f240b959e28b506db8c63a
>
>
> If you reply to this message, keeping the Subject: header intact,
> Mailman will discard the held message.  Do this if the message is
> spam.  If you reply to this message and include an Approved: header
> with the list password in it, the message will be approved for posting
> to the list.  The Approved: header can also appear in the first line
> of the body of the reply.
>
>

From jago at mclink.it  Thu Oct  9 12:46:58 2003
From: jago at mclink.it (Stefano Iacus)
Date: Thu Oct  9 11:46:21 2003
Subject: [R-SIG-Mac] R and XDarwin -- should tcltk still work?
In-Reply-To: <491BA249-FA38-11D7-AC79-0050E4C03977@warwick.ac.uk>
Message-ID: <865A8A3D-FA3D-11D7-82E4-003065CC4CB8@mclink.it>

David,
I've checked in my config. Package tcltk should load quietly under X11 
even when if configured to used aqua TclTk, but when you try to access 
the tcltk GUI you should come to a bus error.
stefano


On Gioved?, ott 9, 2003, at 11:09 Europe/Rome, David Firth wrote:

> This is a question about running R in an X-windows environment on the 
> Mac.
>
> I haven't yet "upgraded" to Apple's X11, and am still using the 
> Xfree86/XDarwin setup, which worked fine with R up to and including 
> 1.7.1.
>
> With the new R 1.8.0 (the binary RAqua from CRAN), though, I get the 
> following problem:
>
> > library(tcltk)
> > kCGErrorIllegalArgument : CGSGetWindowType: Invalid window
> kCGErrorIllegalArgument : CGSGetWindowType: Invalid window
>
> Is this because R now tries to draw Aqua-based Tk windows rather than 
> X11 ones?  or something else?  I'd welcome any hints before I spend 
> time experimenting.
>
> Thanks,
> David
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac
>

From deleeuw at stat.ucla.edu  Thu Oct  9 10:05:12 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct  9 18:04:34 2003
Subject: [R-SIG-Mac] RAqua, Darwin/X11 R, and tcltk
Message-ID: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>

What does not work:

 From the terminal, use quartz(). The quartz device does not receive
events and cannot be made the front window. This does not work
because the API to access the windowmanager from the command line
is hidden by Apple. Would be nice if it worked, though.

 From the terminal, use library(tcltk). This gives a segmentation error.
Now I wonder what would happen if I replaced tcltk.so in  
/usr/local/lib/R
by a  version build by using X11 tcltk. More generally, since R is  
compiled with
both X11 and Aqua support, and since there are two copies of tcltk.so
anyway (one in RAqua and one in /usr/local/lib/R) it would make sense
to configure in such a way that these two versions were indeed the
Aqua and X11 versions.

 From RAqua, use library(tcltk) and demo(tkdensity). This creates the
windows nicely, but they cannot handle events. This is the one that  
really
should work.

What does work:

 From RAqua, use library(tcltk), tkStartGUI(). This creates a tk  
terminal,
where you can say demo(tkdensity). This is obviously not elegant --  
because
tkStartGUI() is not a serious GUI, and because you don't want two  
consoles
active at the same time.

Use IDLE, load Rpy. Then R.library("tcltk") and R.demo("tkdensity")  
works.
That's a bad hack, of course, but it's interesting anyway.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From tlumley at u.washington.edu  Thu Oct  9 10:31:52 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Oct  9 18:31:09 2003
Subject: [R-SIG-Mac] RAqua, Darwin/X11 R, and tcltk
In-Reply-To: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>
References: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>
Message-ID: <Pine.A41.4.58.0310090926140.28292@homer15.u.washington.edu>

On Thu, 9 Oct 2003, Jan de Leeuw wrote:

> What does not work:
>
>  From the terminal, use quartz(). The quartz device does not receive
> events and cannot be made the front window. This does not work
> because the API to access the windowmanager from the command line
> is hidden by Apple. Would be nice if it worked, though.

You should get
Error in quartz() : quartz() currently works only under RAqua

I put that in a couple of weeks ago because the alternative was often a
bus error.

>  From the terminal, use library(tcltk). This gives a segmentation error.
> Now I wonder what would happen if I replaced tcltk.so in
> /usr/local/lib/R
> by a  version build by using X11 tcltk. More generally, since R is
> compiled with
> both X11 and Aqua support, and since there are two copies of tcltk.so
> anyway (one in RAqua and one in /usr/local/lib/R)

Not with CRAN's RAqua, there aren't.

>						 it would make sense
> to configure in such a way that these two versions were indeed the
> Aqua and X11 versions.
>
>  From RAqua, use library(tcltk) and demo(tkdensity). This creates the
> windows nicely, but they cannot handle events. This is the one that
> really
> should work.

Yes, although it is documented that you have to use tkStartGUI.


	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From jbowers at csm.berkeley.edu  Thu Oct  9 10:32:39 2003
From: jbowers at csm.berkeley.edu (Jake Bowers)
Date: Thu Oct  9 18:31:47 2003
Subject: [R-SIG-Mac] Quartz() Device with R via ESS
In-Reply-To: <25EDD9C0-FA39-11D7-82E4-003065CC4CB8@unimi.it>
References: <25EDD9C0-FA39-11D7-82E4-003065CC4CB8@unimi.it>
Message-ID: <Pine.GSO.4.51.0310090929020.13330@csm.Berkeley.EDU>

Hi All,

RAqua looks great! Despite it's beauty, I still find myself most
comfortable using R in Emacs via ESS. Up to now I've just started Apples
X11 server and used the x11() device for graphics. With this new release
of R I tried to start the quartz() device but it said I must use the RAqua
gui for this. Is there any way around this? Is there any way to use R the
"old-fashioned" way in Emacs (or at the console) but also use the
beautiful quartz() device? I'd love to not have to use up system resources
starting an X server to look at my plots.


Thanks very much,

Jake Bowers
Dept of Political Science
University of Michigan

From tlumley at u.washington.edu  Thu Oct  9 10:33:28 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Thu Oct  9 18:33:11 2003
Subject: [R-SIG-Mac] Raqua on a clean OS X
In-Reply-To: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>
References: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>
Message-ID: <Pine.A41.4.58.0310090932080.28292@homer15.u.washington.edu>


I am (unfortunately) in a position to say that RAqua seems to install and
work perfectly well on a clean install of OS X on a G4 PowerBook, so we
have been successful in getting rid of dependencies.

	-thomas


Thomas Lumley			Assoc. Professor, Biostatistics
tlumley@u.washington.edu	University of Washington, Seattle

From Simon.Urbanek at math.uni-augsburg.de  Thu Oct  9 20:05:02 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Thu Oct  9 19:04:14 2003
Subject: [R-SIG-Mac] RAqua, Darwin/X11 R, and tcltk
In-Reply-To: <5CF4CC86-FA72-11D7-A489-000A95A67E82@stat.ucla.edu>
Message-ID: <B8ED5C1C-FA7A-11D7-8FA3-000A957CEFBA@math.uni-augsburg.de>

On Thursday, October 9, 2003, at 06:05  PM, Jan de Leeuw wrote:

> What does not work:
> [...]

Since Jan is at it, I'll add my problem:

RAqua + Java doesn't work. What happens is that RAqua crashes with a 
segfault after a while (you don't even have to run any Java code except 
for initialization). Producing any system events in RAqua (clicking, 
moving windows etc. will do the trick) accelerates the process, i.e. it 
happens almost immediately. This is not really a fault of Java, but 
rather due to the RAqua design (imho). The entire solution of RAqua 
seems to me very 'hacked' (just to have something in time for 1.8) and 
I hope we can do much better.
The main problem here is that the event handling is incompatible with 
other applications. If you fire up Java, it needs to poll for system 
events as well. But since RAqua uses its own (unsynchronized) polling, 
the whole event system crashes. It is not a particular code (the crash 
is every time at a different location, mostly in a system thread i.e. 
outside R and Java), but rather a design issue.
I suspect that taking any OS X native application (e.g. Cocoa-based) 
will cause exactly the same problem - Java was just the first I saw to 
trigger this.
Running the same program in the console works fine (no wonder - no 
event polling there ;)).

Presumably most of the problems (except from the 
I'm-using-the-wrong-library-problem) posted by Jan will go away once we 
have the new event loop in R and everyone (incl. tcl/tk and aqua) uses 
it.

Since Jan was listing what doesn't work, I just wanted to let you know 
about it ;). I'm going to fiddle around with the event polling issue 
and see if it can be fixed.

Cheers,
Simon

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From deleeuw at stat.ucla.edu  Thu Oct  9 11:07:38 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct  9 19:06:55 2003
Subject: [R-SIG-Mac] odds and ends
Message-ID: <1616AA5E-FA7B-11D7-A489-000A95A67E82@stat.ucla.edu>

The RAqua on gifi installs both RAqua.app in /Applications and the
Darwin/X11 version of R in /usr/local/lib. I have now replaced the
tcltk in /usr/local/lib/R/library with a version compiled using the
X11 version of tk. The version in RAqua.app is the Aqua version,
of course.

Now using tcltk from tkStartGUI() in RAqua uses the Aqua version,
while using it from the command line (or from ESS) uses the
X11 version, which is guess is an improvement over a bus error.

I will post a new version of the modified R-1.8.0 on gifi as soon as
I get to UCLA tomorrow.

By the way, XML 0.95-4 installs and checks without a hitch. I'll
included updates of the usual packages in the new version on gifi.


===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From jago at mclink.it  Thu Oct  9 23:51:51 2003
From: jago at mclink.it (Stefano Iacus)
Date: Thu Oct  9 22:51:05 2003
Subject: [R-SIG-Mac] RAqua, Darwin/X11 R, and tcltk
In-Reply-To: <B8ED5C1C-FA7A-11D7-8FA3-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <68A26C06-FA9A-11D7-B956-003065CC4CB8@mclink.it>

Thanks to all of you! You have raised several interesting points.

Simon has the right point: the way the event loop is implemented does 
not allow several things (i.e. quartz from the shell, java problems, 
tcltk only through tkStartGUI, etc)
R-core has a commitment to change the event loop structure for R-1.9.0.

With RAqua you don't need to install another copy of R in 
/usr/local/lib, just do a couple of symbolic links

sudo ln -s /Applications/StartR.app/RAqua.app/Contents/ /usr/local/lib/R
sudo ln /Applications/StartR.app/RAqua.app/Contents/MacOS/R 
/usr/local/bin/R

and all should work as well as the former darwin/x11 release (apart the 
tcltk issue).

I had in mind to produce two versions of tcltk package: one for X11 and 
one for aqua (say aquatcltk) but it was to late for doing that in time 
for 1.8.0 and we really want to change the internal event loop so in 
the end I gave up.

We can think of prepearing a X11tcltk package and distribute as a 
special contrib binary package. I'm not sure if it can work with the 
binary of RAqua but if any of you wants to help me, we can distribute 
it (Jan? Simon?). X11 works fine from inside RAqua.

I remind all the people the main assumption beside RAqua: it is for 
people who were used to work with Carbon R and don't know how to build 
an application from sources. We have made big efforts to let R build on 
MacOSX out of the box, so any other unix-macosx user should be able to 
build R without using RAqua.
All of this is a second best, but you know we need not to stop MacOS 
support and I think RAqua is a good compromise.

Also consider that RAqua is a stand-alone application and it simply 
works. I can imagine several macos(x) users that don't know what X11 
is, what a dll is and will be never faced to "/usr" etc stuff because 
the finder doesn't show them!

BTW, we distribute binary prebuilt packages that should work also with 
an R build by users themself so, in my opinion, Jan should avoid to 
recompile all the packages.
The packages binary distributed on cran all have passed CHECK/INSTALL 
step, so they are guaranteed in some sense.
The other packages can be normally built via RAqua from sources by the 
user.

stefano

p.s. I'm actually rebuilding all the packages for RAqua 1.8.0 so until 
tomorrow you'll probably find nothing on CRAN as I have intentionally 
cleaned it. Also the following: the version of RAqua I put on cran 
yesterday wasn't built against readline. I have uploaded a new version, 
so please download the new version if you want to have the nice 
readline capability.



On Gioved?, ott 9, 2003, at 19:05 Europe/Rome, Simon Urbanek wrote:

> On Thursday, October 9, 2003, at 06:05  PM, Jan de Leeuw wrote:
>
>> What does not work:
>> [...]
>
> Since Jan is at it, I'll add my problem:
>
> RAqua + Java doesn't work. What happens is that RAqua crashes with a 
> segfault after a while (you don't even have to run any Java code 
> except for initialization). Producing any system events in RAqua 
> (clicking, moving windows etc. will do the trick) accelerates the 
> process, i.e. it happens almost immediately. This is not really a 
> fault of Java, but rather due to the RAqua design (imho). The entire 
> solution of RAqua seems to me very 'hacked' (just to have something in 
> time for 1.8) and I hope we can do much better.
> The main problem here is that the event handling is incompatible with 
> other applications. If you fire up Java, it needs to poll for system 
> events as well. But since RAqua uses its own (unsynchronized) polling, 
> the whole event system crashes. It is not a particular code (the crash 
> is every time at a different location, mostly in a system thread i.e. 
> outside R and Java), but rather a design issue.
> I suspect that taking any OS X native application (e.g. Cocoa-based) 
> will cause exactly the same problem - Java was just the first I saw to 
> trigger this.
> Running the same program in the console works fine (no wonder - no 
> event polling there ;)).
>
> Presumably most of the problems (except from the 
> I'm-using-the-wrong-library-problem) posted by Jan will go away once 
> we have the new event loop in R and everyone (incl. tcl/tk and aqua) 
> uses it.
>
> Since Jan was listing what doesn't work, I just wanted to let you know 
> about it ;). I'm going to fiddle around with the event polling issue 
> and see if it can be fixed.
>
> Cheers,
> Simon
>
> ---
> Simon Urbanek
> Department of computer oriented statistics and data analysis
> University of Augsburg
> Universit?tsstr. 14
> 86135 Augsburg
> Germany
>
> Tel: +49-821-598-2236
> Fax: +49-821-598-2200
>
> Simon.Urbanek@Math.Uni-Augsburg.de
> http://simon.urbanek.info
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac
>

From stefano.iacus at unimi.it  Fri Oct 10 12:37:00 2003
From: stefano.iacus at unimi.it (Stefano Iacus)
Date: Fri Oct 10 12:39:22 2003
Subject: [R-SIG-Mac] RAqua installer, new version available
Message-ID: <AE5639A8-FB0D-11D7-88A6-003065CC4CB8@unimi.it>

Dear RAqua users,

in the first version of the RAqua.dmg disk image one item was missing 
and RAqua will not launch unless one additional component is installed 
in your system.

The new package available soon on CRAN will install this component for 
you.

In case you don't want to wait for the new RAqua.dmg file or in case 
you have already installed RAqua, you could install the additional 
component your own by downloading the readline.tgz from the site 
location where RAqua.dmg is archived ( 
http://cran.r-project.org/bin/macosx ). Unpack it and install the 
readline 4.3 library in your System typing the following three lines:

tar zxf readline.tgz
cd readline
sudo ./install.sh


I apologize for any incovinience I could have caused and hope you enjoy 
RAqua.

Stefano

From deleeuw at stat.ucla.edu  Sat Oct 11 05:11:17 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sat Oct 11 05:13:11 2003
Subject: [R-SIG-Mac] packages
Message-ID: <948E739C-FB98-11D7-8B23-000A95A67E82@stat.ucla.edu>

You may have problems compiling tseries and gbm for Mac OS X.

tseries does not compile with g77-3.4 (Khanna), but does compile
with g77-3.3 (fink). Don't ask me why.

gbm needs a patch with R-1.8.0 (not just on the Mac). Greg says


Somehow IEEE_754 is defined on Windows and Darwin yet it cannot locate  
isnan(x). I'm not sure what to make of this.?This problem did not  
occur?on Linux. But to get around it on my Windows machine I modified  
buildinfo.h in the gbm package to have the following lines after  
#include <R.h>
?
??? #ifdef IEEE_754
??? #undef ISNAN
??? #define ISNAN(x)?? R_IsNaNorNA(x)
??? #endif
I'll work on this some more and hopefully come up with a more polished  
solution to submit with gbm 1.1.
?

===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au
   
------------------------------------------------------------------------ 
------------------------- 
        
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 1565 bytes
Desc: not available
Url : https://www.stat.math.ethz.ch/pipermail/r-sig-mac/attachments/20031010/b1107bbf/attachment.bin
From deleeuw at stat.ucla.edu  Sat Oct 11 07:57:56 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sat Oct 11 07:57:03 2003
Subject: [R-SIG-Mac] IBM compilers on OS X
Message-ID: <DC3EFE21-FBAF-11D7-BF40-000A95A67E82@stat.ucla.edu>

Although I still have to look into the various flags, the IBM vacpp
(C and C++) and xlf (FORTRAN) compilers can be used to build
at least R.bin. Of course libR.dylib and the various bundles are
more complicated, but R.bin runs (in as far as it does not depend
on any modules and packages).

This is important, because people report speed increases of
100-200% compared to gcc/g77.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From deleeuw at stat.ucla.edu  Sun Oct 12 20:51:50 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Sun Oct 12 20:51:04 2003
Subject: [R-SIG-Mac] xlc/xlf on osx 
Message-ID: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>

I can now build most of R with XLC/XLF using optimization level O4
on OS X. I twice have to intervene and manually set optimization
to O3 (for trees.c in zlib and util.c in main). But, more importantly, I
cannot use the xlc/xlf compiler drivers for linking. They do not
understand some of the gcc flags, which is no problem because they
then pass them to ld, but more importantly they refuse to handle
any file with name  foo.lo. Is the "lo" a configure switch I can set to
"o" ? Currently I am building everything by setting LD_MAIN and
LD_SHLIB to gcc, i.e. xlc/xlf does the actual compilations and gcc 
drives the
linking. This is not ideal, because it may include the wrong options and
libraries, and it eventually breaks the methods package (which refuses
to dump code after it compiles).

Other things which I see is that the "-framework Carbon" flag gets
lost when linking R.bin, and that I can only link libLapack.dylib
by adding "-flat_namespace -undefined suppress" to the linker
flags. These are somewhat mysterious.

I am attaching config.site.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: config.site
Type: application/octet-stream
Size: 7441 bytes
Desc: not available
Url : https://www.stat.math.ethz.ch/pipermail/r-sig-mac/attachments/20031012/3174fbde/config.obj
-------------- next part --------------

===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au
   
------------------------------------------------------------------------ 
------------------------- 
        
From Kurt.Hornik at wu-wien.ac.at  Sun Oct 12 21:12:36 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Sun Oct 12 23:38:01 2003
Subject: [R-SIG-Mac] Re: [Rd] xlc/xlf on osx 
In-Reply-To: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>
References: <234602B9-FCE5-11D7-B43E-000A95A67E82@stat.ucla.edu>
Message-ID: <16265.42916.558227.492142@mithrandir.hornik.net>

>>>>> Jan de Leeuw writes:

> I can now build most of R with XLC/XLF using optimization level O4 on
> OS X. I twice have to intervene and manually set optimization to O3
> (for trees.c in zlib and util.c in main). But, more importantly, I
> cannot use the xlc/xlf compiler drivers for linking. They do not
> understand some of the gcc flags, which is no problem because they
> then pass them to ld, but more importantly they refuse to handle any
> file with name foo.lo. Is the "lo" a configure switch I can set to "o"
> ? Currently I am building everything by setting LD_MAIN and LD_SHLIB
> to gcc, i.e. xlc/xlf does the actual compilations and gcc drives the
> linking. This is not ideal, because it may include the wrong options
> and libraries, and it eventually breaks the methods package (which
> refuses to dump code after it compiles).

I think the configure code actually tests whether the compilers can
handle -c -o .lo, and have a workaround if this fails.

-k

From david.orlovich at botany.otago.ac.nz  Mon Oct 13 22:21:08 2003
From: david.orlovich at botany.otago.ac.nz (David Orlovich)
Date: Mon Oct 13 22:20:21 2003
Subject: [R-SIG-Mac] mgcv doesn't compile
Message-ID: <C78BC53C-FDBA-11D7-94FC-000A957DD1B4@botany.otago.ac.nz>

G'day R-Aqua people.

I've just installed R 1.8.0 on my OS X 10.2.8 machine and it is working 
more or less to my satisfaction - thanks heaps to those who have been 
developing this - it's great!

However, when I do an update.packages() one of the packages 
(mgcv_0.9-4) doesn't compile.  It fails with the messages pasted below. 
  In an attempt to try a few things to sort it out, I have done the 
update.packages() as both a normal user and after sudo but it makes no 
difference (this is usually the problem with Linux - forgetting to do 
the update as root) and I installed the GCC 3.3 update and it makes no 
difference.

So ... I'm not really a UNIX expert so I'm putting this to the list in 
the hope you can help.  It's not a critical problem for me as I don't 
use that package... but it'd be nice to work out the problem.  Thanks 
in advance for any help - I can supply more info if necessary.

Cheers, David Orlovich.

ld: warning -L: directory name 
(/usr/local/lib/gcc/powerpc-apple-darwin6.6/3.4) does not exist
ld: warning -L: directory name 
(/usr/local/lib/gcc/powerpc-apple-darwin6.6/3.4/../../..) does not exist
ld: can't locate file for: -lfrtbegin
make: *** [mgcv.so] Error 1
ERROR: compilation failed for package 'mgcv'
** Removing '/Applications/StartR.app/RAqua.app/Contents/library/mgcv'
** Restoring previous 
'/Applications/StartR.app/RAqua.app/Contents/library/mgcv'

Delete downloaded files (y/N)?
The packages are in /tmp/Rtmp474/Rinstdir2781e494
Warning message:
Installation of package mgcv had non-zero exit status in: 
install.packages(update[, "Package"], instlib, contriburl = contriburl,

From jago at mclink.it  Mon Oct 13 22:55:42 2003
From: jago at mclink.it (Stefano Iacus)
Date: Mon Oct 13 22:55:23 2003
Subject: [R-SIG-Mac] mgcv doesn't compile
In-Reply-To: <C78BC53C-FDBA-11D7-94FC-000A957DD1B4@botany.otago.ac.nz>
Message-ID: <9BA9B608-FDBF-11D7-88A6-003065CC4CB8@mclink.it>

One user reports something similar to me.
It seems like you are using gcc from fink while RAqua is configured to 
use Apple's gcc + g77 from khanna (see http://www.economia.unimi.it/R/ )
You should not directly update that package as it come from base 
distribution.
BTW, if you prefer to use fink stuff, you should better build RAqua 
from the R sources and install it with make install-aqua. Then all 
whould work fine.

Let me know

stefano


On Luned?, ott 13, 2003, at 22:21 Europe/Rome, David Orlovich wrote:

> G'day R-Aqua people.
>
> I've just installed R 1.8.0 on my OS X 10.2.8 machine and it is 
> working more or less to my satisfaction - thanks heaps to those who 
> have been developing this - it's great!
>
> However, when I do an update.packages() one of the packages 
> (mgcv_0.9-4) doesn't compile.  It fails with the messages pasted 
> below.  In an attempt to try a few things to sort it out, I have done 
> the update.packages() as both a normal user and after sudo but it 
> makes no difference (this is usually the problem with Linux - 
> forgetting to do the update as root) and I installed the GCC 3.3 
> update and it makes no difference.
>
> So ... I'm not really a UNIX expert so I'm putting this to the list in 
> the hope you can help.  It's not a critical problem for me as I don't 
> use that package... but it'd be nice to work out the problem.  Thanks 
> in advance for any help - I can supply more info if necessary.
>
> Cheers, David Orlovich.
>
> ld: warning -L: directory name 
> (/usr/local/lib/gcc/powerpc-apple-darwin6.6/3.4) does not exist
> ld: warning -L: directory name 
> (/usr/local/lib/gcc/powerpc-apple-darwin6.6/3.4/../../..) does not 
> exist
> ld: can't locate file for: -lfrtbegin
> make: *** [mgcv.so] Error 1
> ERROR: compilation failed for package 'mgcv'
> ** Removing '/Applications/StartR.app/RAqua.app/Contents/library/mgcv'
> ** Restoring previous 
> '/Applications/StartR.app/RAqua.app/Contents/library/mgcv'
>
> Delete downloaded files (y/N)?
> The packages are in /tmp/Rtmp474/Rinstdir2781e494
> Warning message:
> Installation of package mgcv had non-zero exit status in: 
> install.packages(update[, "Package"], instlib, contriburl = > contriburl,
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac@stat.math.ethz.ch
> https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac
>

From deleeuw at stat.ucla.edu  Tue Oct 14 20:51:49 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Tue Oct 14 20:49:23 2003
Subject: [R-SIG-Mac] R-1.8.0  and Emacs/ESS on gifi
Message-ID: <77C3490E-FE77-11D7-AD69-000393860F3C@stat.ucla.edu>

There is a new R-1.8.0 package on gifi. It contains StartR/RAqua,
Carbon Emacs, the Darwin/X11 version of R, and the Darwin
version of emacs. The Darwin/X11 version of R comes with
330 compiled packages.

Problems to me. Download from http://gifi.stat.ucla.edu/pub. In
the future I will only make these announcements on the UCLA
statcompute list -- this is a very unofficial version of R for OS X.
====
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 9432 Boelter Hall, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
------------------------------------------------------------------------ 
------------------------------
            No matter where you go, there you are. --- Buckaroo Banzai
                     http://gifi.stat.ucla.edu/sounds/nomatter.au

From deleeuw at stat.ucla.edu  Wed Oct 15 07:46:00 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Wed Oct 15 07:45:13 2003
Subject: [R-SIG-Mac] R-1.8.0.dmg.gz on gifi
Message-ID: <DB3B305A-FED2-11D7-B288-000A95A67E82@stat.ucla.edu>

I removed today's version, because it had permission problems and could
not write to various places. It required a restart, but no root  
authorization.
That's fixed (I hope). To compensate for the inconvenience, I replaced  
R-1.8.0
by R-1.8.0-patched, I added the Darwin and the Aqua versions of Tcl/Tk  
8.5,
and g77-3.4. Tomorrow's version will be on gifi tomorrow. It's about
170MB.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From deleeuw at stat.ucla.edu  Thu Oct 16 01:41:05 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct 16 01:40:17 2003
Subject: [R-SIG-Mac] todays R-1.8.0 package (problems)
Message-ID: <0B3A4806-FF69-11D7-87D8-000A95A67E82@stat.ucla.edu>

1. It creates g77-v3.4.bin.tar in the root directory. Toss this.

2. It creates a folder Frameworks in the root directory,
containing the Tcl and Tk frameworks. Move these
frameworks to /Library/Frameworks and toss the Frameworks
folder in /.

3. tcltk.so in the Darwin version is compiled with AquaTclTk.
In the next version I'll replace it with an X11 version.
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From deleeuw at stat.ucla.edu  Thu Oct 16 04:14:23 2003
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Thu Oct 16 04:13:35 2003
Subject: [R-SIG-Mac] another problem
Message-ID: <7552EED2-FF7E-11D7-AAF8-000A95A67E82@stat.ucla.edu>

The latest R-1.8.0 package from gifi does not run on Jaguar, because
it needs an different version of readline than the one I included. The  
new
update will have libreadline.4.3.dylib (for Panther) and  
libreadline.4.3.dylib.old
(for Jaguar). On Jaguar go to /usr/local/lib and say  "mv  
libreadline.4.3.dylib.old libreadline.4.3.dylib"
after the install.

Alternatively, compile a version of readline on your Jaguar machine, see
http://www.economia.unimi.it/R/
===
Jan de Leeuw; Professor and Chair, UCLA Department of Statistics;
Editor: Journal of Multivariate Analysis, Journal of Statistical  
Software
US mail: 8130 Math Sciences Bldg, Box 951554, Los Angeles, CA 90095-1554
phone (310)-825-9550;  fax (310)-206-5658;  email: deleeuw@stat.ucla.edu
homepage: http://gifi.stat.ucla.edu
   
------------------------------------------------------------------------ 
-------------------------
           No matter where you go, there you are. --- Buckaroo Banzai
                    http://gifi.stat.ucla.edu/sounds/nomatter.au

From prathouz at health.bsd.uchicago.edu  Fri Oct 17 17:12:22 2003
From: prathouz at health.bsd.uchicago.edu (Paul Rathouz)
Date: Fri Oct 17 17:11:45 2003
Subject: [R-SIG-Mac] problem with eigen() ??
Message-ID: <Pine.GSO.4.43L0.0310171008500.15885-100000@snow>

Hi All -- I am running a dual processor G4 with R v 1.6.2 for X11 which I
installed from fink.  Look what the eigen() function produces.  Am I
thinking about this wrong, or should  all of the eigen values be 1? -- pr

-----------------------------
> diag(rep(1,3))
     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1
> diag(rep(1,4))
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1
> diag(rep(1,5))
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    0    0    0    0
[2,]    0    1    0    0    0
[3,]    0    0    1    0    0
[4,]    0    0    0    1    0
[5,]    0    0    0    0    1
>
> eigen(diag(rep(1,5)))$val
[1] 1 1 1 1 0
> eigen(diag(rep(1,14)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 0 0
> eigen(diag(rep(1,15)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0
> eigen(diag(rep(1,16)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
> eigen(diag(rep(1,17)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
> eigen(diag(rep(1,20)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
> eigen(diag(rep(1,22)))$val
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
>
> q("no")
-----------------------------

==========================================================================
Paul Rathouz, Asst. Professor        ph   773-834-1970
Dept. of Health Studies, Rm. W-264   fax  773-702-1979
University of Chicago                prathouz@health.bsd.uchicago.edu
5841 S. Maryland Ave. MC 2007
Chicago, IL  60637

From macq at llnl.gov  Fri Oct 17 17:33:54 2003
From: macq at llnl.gov (Don MacQueen)
Date: Fri Oct 17 17:33:30 2003
Subject: [R-SIG-Mac] problem with eigen() ??
In-Reply-To: <Pine.GSO.4.43L0.0310171008500.15885-100000@snow>
References: <Pine.GSO.4.43L0.0310171008500.15885-100000@snow>
Message-ID: <p05210603bbb5bbed8616@[128.115.153.6]>

Whether or not this is a Mac issue, I would suggest upgrading R to 1.8.0.

-Don

>  eigen(diag(rep(1,5)))$val
[1] 1 1 1 1 1

>  version
          _                       
platform powerpc-apple-darwin6.7.5
arch     powerpc                 
os       darwin6.7.5             
system   powerpc, darwin6.7.5    
status   Patched                 
major    1                       
minor    8.0                     
year     2003                    
month    10                      
day      13                      
language R                       


At 10:12 AM -0500 10/17/03, Paul Rathouz wrote:
>Hi All -- I am running a dual processor G4 with R v 1.6.2 for X11 which I
>installed from fink.  Look what the eigen() function produces.  Am I
>thinking about this wrong, or should  all of the eigen values be 1? -- pr
>
>-----------------------------
>>  diag(rep(1,3))
>      [,1] [,2] [,3]
>[1,]    1    0    0
>[2,]    0    1    0
>[3,]    0    0    1
>>  diag(rep(1,4))
>      [,1] [,2] [,3] [,4]
>[1,]    1    0    0    0
>[2,]    0    1    0    0
>[3,]    0    0    1    0
>[4,]    0    0    0    1
>>  diag(rep(1,5))
>      [,1] [,2] [,3] [,4] [,5]
>[1,]    1    0    0    0    0
>[2,]    0    1    0    0    0
>[3,]    0    0    1    0    0
>[4,]    0    0    0    1    0
>[5,]    0    0    0    0    1
>>
>  > eigen(diag(rep(1,5)))$val
>[1] 1 1 1 1 0
>>  eigen(diag(rep(1,14)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 0 0
>>  eigen(diag(rep(1,15)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0
>>  eigen(diag(rep(1,16)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
>>  eigen(diag(rep(1,17)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0
>>  eigen(diag(rep(1,20)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
>>  eigen(diag(rep(1,22)))$val
>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0
>>
>>  q("no")
>-----------------------------
>
>==========================================================================
>Paul Rathouz, Asst. Professor        ph   773-834-1970
>Dept. of Health Studies, Rm. W-264   fax  773-702-1979
>University of Chicago                prathouz@health.bsd.uchicago.edu
>5841 S. Maryland Ave. MC 2007
>Chicago, IL  60637
>
>_______________________________________________
>R-SIG-Mac mailing list
>R-SIG-Mac@stat.math.ethz.ch
>https://www.stat.math.ethz.ch/mailman/listinfo/r-sig-mac


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA

From tlumley at u.washington.edu  Fri Oct 17 20:50:24 2003
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri Oct 17 20:49:28 2003
Subject: [R-SIG-Mac] problem with eigen() ??
In-Reply-To: <Pine.GSO.4.43L0.0310171008500.15885-100000@snow>
References: <Pine.GSO.4.43L0.0310171008500.15885-100000@snow>
Message-ID: <Pine.A41.4.58.0310171148270.53714@homer27.u.washington.edu>

On Fri, 17 Oct 2003, Paul Rathouz wrote:

> Hi All -- I am running a dual processor G4 with R v 1.6.2 for X11 which I
> installed from fink.  Look what the eigen() function produces.  Am I
> thinking about this wrong, or should  all of the eigen values be 1? -- pr
>

They should be 1, and if you were using more recent version of R they
would be. I seem to recall that there were a number of problems with
getting linear algebra code linked in properly back then.

	-thomas

From Simon.Urbanek at math.uni-augsburg.de  Fri Oct 31 13:33:09 2003
From: Simon.Urbanek at math.uni-augsburg.de (Simon Urbanek)
Date: Fri Oct 31 13:34:13 2003
Subject: [R-SIG-Mac] R-1.8.0 + IBM VisualAge/C for AIX compiler
Message-ID: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>

A while ago I compiled R 1.7.0 for AIX (with the above compiler - I'll  
call it xlc) and I was surprised that it went quite smoothly.

Unfortunately with R 1.8.0 it's not as easy, but I succeeded at least  
partially. Static R works fine (after some tweaking), but  
--enable-R-shlib fails resp. produces a buggy R. Following are the  
problems I encountered (in a warning-to-fatal-error sequence):

0)
  configure says:
configure: WARNING: I could not determine SHLIB_CXXLDFLAGS
I don't know if this is important, I assume it's not since there should  
be no C++ code ;)

1) .lo files
As Jan already stated in his r-sig-mac post:

>> then pass them to ld, but more importantly they refuse to handle any
>> file with name foo.lo. Is the "lo" a configure switch I can set to "o"
>
> I think the configure code actually tests whether the compilers can
> handle -c -o .lo, and have a workaround if this fails.

The configure code looks whether the compile can *create* .lo (xlc can  
do so), but xlc issues tons of warnings when it's told to *link* .lo  
files:

[...]
cc: 1501-218 file ../unix/sys-common.lo contains an incorrect file  
suffix
cc: 1501-218 file ../unix/sys-std.lo contains an incorrect file suffix
cc: 1501-218 file ../unix/sys-unix.lo contains an incorrect file suffix
cc: 1501-218 file ../unix/system.lo contains an incorrect file suffix

I don't know if this has an impact on the linking, but I hope it  
doesn't since fixing this one is really a pain. It is possible that  
more recent xlcs turned this warning into an error...

2) this is not AIX related, but nevertheless annoying:
make[3]: Entering directory `/tmp/R-1.8.0.build/src/library/base'
building package 'base'
/bin/sh: /usr/bin/cat: 0403-027 The parameter list is too long.

If unfixed, I get errors like:
Error: couldn't find function "attach"
(fix: put the source directory somewhere down the tree - e.g. I  
symlinked it to /tmp/R ;)).

3) tilde_expand from readline:
"/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0/src/ 
unix/sys-unix.c", line 103.14: 1506-196 (S) Initialization between  
types "char*" and "int" is not allowed.
fix: add a corresponding declaration for tilde_expand

4) .so vs .a
ld: 0706-006 Cannot find or open library file: -l Rlapack
         ld:open(): A file or directory in the path name does not exist.
problem: xlc looks for .a suffix even for shared libraries, butR uses  
.so - a fix is to symlink libRlapack.so to libRlapack.a (any AIX-savvy  
folks here that could tell me how to change that behavior in xlc?)

Ok, now such static R works fine.

But when --enable-R-shlib is on then I get:

5) while making libR.so - bad path to R.exp
ld: 0706-003 Cannot find or read import file: /etc/R.exp
         ld:accessx(): A file or directory in the path name does not  
exist.
make[3]: *** [libR.so] Error 255

for some reason /etc/R.exp ends up in the flags instead of  
$(top_builddir)/etc/R.exp . My guess is that there is also  
$(R_HOME)/etc/R.exp in Makeconf and $R_HOME is not set when compiling  
the R shared library.
Setting R_HOME to the build directory indeed fixes this.

6) when linking to libR.a: many duplicate symbols
Every time a module links against libR duplicate symbols are claimed.  
For example when compiling R_X11.so:

         xlc -Wl,-bM:SRE -Wl,-H512 -Wl,-T512 -Wl,-bnoentry -Wl,-bexpall  
-Wl,-bI:../../../etc/R.exp -L/usr/local/lib -o R_X11.so  dataentry.lo  
devX11.lo rotated.lo rbitmap.lo -lSM -lICE -lX11   -L../../../bin -lR  
-lbz2 -lreadline -ldl -lncurses -lm -lc
xlc: 1501-218 file dataentry.lo contains an incorrect file suffix
xlc: 1501-218 file devX11.lo contains an incorrect file suffix
xlc: 1501-218 file rotated.lo contains an incorrect file suffix
xlc: 1501-218 file rbitmap.lo contains an incorrect file suffix
ld: 0711-224 WARNING: Duplicate symbol: p_xargc
ld: 0711-224 WARNING: Duplicate symbol: p_xargv
ld: 0711-224 WARNING: Duplicate symbol: p_xrcfg
ld: 0711-224 WARNING: Duplicate symbol: p_xrc
ld: 0711-224 WARNING: Duplicate symbol: end
ld: 0711-224 WARNING: Duplicate symbol: .Rf_error
ld: 0711-224 WARNING: Duplicate symbol: Rf_error
ld: 0711-224 WARNING: Duplicate symbol: .Rf_warning
ld: 0711-224 WARNING: Duplicate symbol: Rf_warning
ld: 0711-224 WARNING: Duplicate symbol: .Rf_lengthgets
ld: 0711-224 WARNING: Duplicate symbol: Rf_lengthgets
ld: 0711-224 WARNING: Duplicate symbol: .R_Reprotect
ld: 0711-224 WARNING: Duplicate symbol: R_Reprotect
ld: 0711-224 WARNING: Duplicate symbol: .Rf_mkChar
ld: 0711-224 WARNING: Duplicate symbol: Rf_mkChar
ld: 0711-224 WARNING: Duplicate symbol: .SET_STRING_ELT
ld: 0711-224 WARNING: Duplicate symbol: SET_STRING_ELT
ld: 0711-224 WARNING: Duplicate symbol: .Rf_isNull
ld: 0711-224 WARNING: Duplicate symbol: Rf_isNull
[...]
ld: 0711-224 WARNING: Duplicate symbol: .Rprintf
ld: 0711-224 WARNING: Duplicate symbol: Rprintf
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more  
information.

with -bnoquiet I get:

  p_xargc                   crt0main.s(/lib/crt0.o)
     ** Duplicate **        {../../../bin/libR.a}
[...]
.Rf_error                 {../../../bin/libR.a}
     ** Duplicate **        ../../../etc/R.exp{.}
  Rf_error                  {../../../bin/libR.a}
     ** Duplicate **        ../../../etc/R.exp{.}
[...]

7) now, when such R is run, things go wrong. Just after starting R this  
appears:

Error in open.connection(con, "rb") : unable to open connection
In addition: Warning message:
cannot open compressed file  
`/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R- 
1.8.0.build/library/methods/R/all.rda'

doing anything produces more warnings:

 > 1:10/2
  [1] 0.5 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0
Warning message:
package methods in options("defaultPackages") was not found

back to 6) - Removing -Wl:-bI...R.exp from the linking removes all  
R-related warnings, but then something strange happens:

building package 'methods'
mkdir -p -- ../../../library/methods/R
all.R is unchanged
mkdir -p -- ../../../library/methods/man
Target "Makedeps" is up to date.
mkdir -p -- ../../../../library/methods/libs
dumping R code in package 'methods'
Saving namespace image ...
/bin/sh: 26442 Segmentation fault(coredump)
make: 1254-004 The error code from the last command is 139.

Any idea how to debug this or what goes on with the R.exp??

Simon

----

R 1.8.0 (release tar-ball)
System: AIX 4.3.3.0
compiler: VisualAge C++/C for AIX Version 5.0.2.0, XL Fortran for AIX  
7.1.0.0

call to configure:
CC=xlc CXX=xlc  
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0/ 
configure --prefix=${HOME}/aix --enable-R-shlib

configure output:
R is now configured for powerpc-ibm-aix4.3.3.0

   Source directory:           
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/work/R-1.8.0
   Installation directory:     
/.../dce.uni-augsburg.de/fs/home/mathe/sta/urbanesi/aix

   C compiler:                xlc  -g
   C++ compiler:              xlc  -g
   Fortran compiler:          f77  -g

   Interfaces supported:      X11
   External libraries:        readline, BLAS(ESSL)
   Additional capabilities:   bzip2, PCRE
   Options enabled:           shared library, R profiling

   Recommended packages:      yes

configure: WARNING: I could not determine SHLIB_CXXLDFLAGS

---
Simon Urbanek
Department of computer oriented statistics and data analysis
University of Augsburg
Universit?tsstr. 14
86135 Augsburg
Germany

Tel: +49-821-598-2236
Fax: +49-821-598-2200

Simon.Urbanek@Math.Uni-Augsburg.de
http://simon.urbanek.info

From Kurt.Hornik at wu-wien.ac.at  Fri Oct 31 13:51:36 2003
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Fri Oct 31 22:45:14 2003
Subject: [R-SIG-Mac] Re: R-1.8.0 + IBM VisualAge/C for AIX compiler
In-Reply-To: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>
References: <627D4F05-0B9E-11D8-B482-000A957CEFBA@math.uni-augsburg.de>
Message-ID: <16290.23256.562898.528155@mithrandir.hornik.net>

>>>>> Simon Urbanek writes:

> A while ago I compiled R 1.7.0 for AIX (with the above compiler - I'll  
> call it xlc) and I was surprised that it went quite smoothly.

> Unfortunately with R 1.8.0 it's not as easy, but I succeeded at least
> partially. Static R works fine (after some tweaking), but
> --enable-R-shlib fails resp. produces a buggy R. Following are the
> problems I encountered (in a warning-to-fatal-error sequence):

> ...


> 5) while making libR.so - bad path to R.exp
> ld: 0706-003 Cannot find or read import file: /etc/R.exp
>          ld:accessx(): A file or directory in the path name does not  
> exist.
> make[3]: *** [libR.so] Error 255

> for some reason /etc/R.exp ends up in the flags instead of  
> $(top_builddir)/etc/R.exp . My guess is that there is also  
> $(R_HOME)/etc/R.exp in Makeconf and $R_HOME is not set when compiling  
> the R shared library.
> Setting R_HOME to the build directory indeed fixes this.

> ...

libR.so is built using DYLIB_LDFLAGS which by default is set to
SHLIB_LDFLAGS.  For AIX, we have

    shlib_ldflags="${wl}-bM:SRE ${wl}-H512 ${wl}-T512 ${wl}-bnoentry ${wl}-bexpa
ll ${wl}-bI:\$(R_HOME)/etc/R.exp"

but R_HOME is not set when libR.so is built.  We could either do that,
or set DYLIB_LDFLAGS as needed.

-k

