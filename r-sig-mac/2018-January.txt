From Eric.Gero at ge.com  Wed Jan  3 19:33:18 2018
From: Eric.Gero at ge.com (Gero, Eric (GE Digital))
Date: Wed, 3 Jan 2018 18:33:18 +0000
Subject: [R-SIG-Mac] Issue in R Console
Message-ID: <8603E3BE-8C47-40D2-A2F4-9701DCEB22A2@ge.com>

The following appears as soon as I open R Console and continues until the application is closed.  This is on a Mac - Sierra 10.12.6 and R version 3.4.3.  Has anyone seen this issue before or know how to resolve?  Also, I have tried installing older versions of R, back to 3.4.0 but the same issue occurs.

Thank you.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20180103/4d28d281/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screen Shot 2018-01-03 at 1.23.35 PM.png
Type: image/png
Size: 442398 bytes
Desc: Screen Shot 2018-01-03 at 1.23.35 PM.png
URL: <https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20180103/4d28d281/attachment-0001.png>

From knnewtonk at gmail.com  Mon Jan  8 03:02:43 2018
From: knnewtonk at gmail.com (Katherine Newton)
Date: Sun, 7 Jan 2018 21:02:43 -0500
Subject: [R-SIG-Mac] SPSS 25 and R plug-in, R essentials
Message-ID: <DAF43804-2CD1-4D7E-BBCB-63396BF0EB84@zips.uakron.edu>

Good evening,

I have followed the instructions online on how to install the R extension for SPSS 25 and everything seems to be ok until I test it with the command:
begin program R.
print (?hello?)
end program.

The output says to check to see if R essentials was installed properly. I don?t know what I am doing wrong. Please help!!

Thank you.

Katherine Newton
Katherine Newton, M.A.
Doctoral Candidate
The University of Akron
Department of Sociology
Olin Hall 275






	[[alternative HTML version deleted]]


From rbaer at atsu.edu  Mon Jan  8 14:31:25 2018
From: rbaer at atsu.edu (Robert Baer)
Date: Mon, 8 Jan 2018 07:31:25 -0600
Subject: [R-SIG-Mac] SPSS 25 and R plug-in, R essentials
In-Reply-To: <DAF43804-2CD1-4D7E-BBCB-63396BF0EB84@zips.uakron.edu>
References: <DAF43804-2CD1-4D7E-BBCB-63396BF0EB84@zips.uakron.edu>
Message-ID: <284eb30f-e5b0-da08-ac53-dfd1790d78de@atsu.edu>

This is the wrong place to ask this type of question.? You need to ask 
SPSS support about this.? This list is for supporting R on MacOS.

Rob Baer


On 1/7/2018 8:02 PM, Katherine Newton wrote:
> Good evening,
>
> I have followed the instructions online on how to install the R extension for SPSS 25 and everything seems to be ok until I test it with the command:
> begin program R.
> print (?hello?)
> end program.
>
> The output says to check to see if R essentials was installed properly. I don?t know what I am doing wrong. Please help!!
>
> Thank you.
>
> Katherine Newton
> Katherine Newton, M.A.
> Doctoral Candidate
> The University of Akron
> Department of Sociology
> Olin Hall 275
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 


--
Robert W. Baer, Ph.D.
Professor of Physiology
Kirksville College of Osteopathic Medicine
A T Still University of Health Sciences
800 W. Jefferson St
Kirksville, MO 63501
660-626-2321 Department
660-626-2965 FAX


From bogaso.christofer at gmail.com  Wed Jan 10 18:18:06 2018
From: bogaso.christofer at gmail.com (Christofer Bogaso)
Date: Wed, 10 Jan 2018 22:48:06 +0530
Subject: [R-SIG-Mac] Opening single Terminal window and running syntax
	sequentially from R
Message-ID: <CA+dpOJn0DrzNFMOnABRp3ZPLuaNJauDeDShOJJT6ULWtzY-RDg@mail.gmail.com>

Hi,

I have an .app file saved in Harddisk, which I want to run from R. So
below is the code which I use:

system("open '.../My_File.app'")

However, if I run above code multiple times (sequentially) then each
time a new Terminal window opens that make my system cluttered.

So I wonder if there is any way to use a single Terminal window and
run above code sequentially there only. R should search if any
Terminal window is already open and then run syntax on that Terminal
window only.

Any pointer will be highly appreciated.

Thanks,


From marc_schwartz at me.com  Wed Jan 10 18:39:36 2018
From: marc_schwartz at me.com (Marc Schwartz)
Date: Wed, 10 Jan 2018 12:39:36 -0500
Subject: [R-SIG-Mac] Opening single Terminal window and running syntax
 sequentially from R
In-Reply-To: <CA+dpOJn0DrzNFMOnABRp3ZPLuaNJauDeDShOJJT6ULWtzY-RDg@mail.gmail.com>
References: <CA+dpOJn0DrzNFMOnABRp3ZPLuaNJauDeDShOJJT6ULWtzY-RDg@mail.gmail.com>
Message-ID: <0093ECB4-FB36-471F-8D10-D60DB3BD02B1@me.com>

> On Jan 10, 2018, at 12:18 PM, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
> 
> Hi,
> 
> I have an .app file saved in Harddisk, which I want to run from R. So
> below is the code which I use:
> 
> system("open '.../My_File.app'")
> 
> However, if I run above code multiple times (sequentially) then each
> time a new Terminal window opens that make my system cluttered.
> 
> So I wonder if there is any way to use a single Terminal window and
> run above code sequentially there only. R should search if any
> Terminal window is already open and then run syntax on that Terminal
> window only.
> 
> Any pointer will be highly appreciated.
> 
> Thanks,


Hi,

My initial reaction is that this is outside of R per se and more specific to macOS in terms of how the application is opened at the CLI, runs and then is exited/closed, before the next instance is run.

I would do a Google search on keywords along the lines of "macOS scripting" and/or "macOS open command".

One possibility would be to use the '-W' option for open, which theoretically will force the initial call to wait for the first application instance to be closed/exited before returning.

For example, compare the behaviors of:

  system("open -a TextEdit")

versus:

  system("open -W -a TextEdit")

from an R terminal session.

So, depending upon your actual workflow requirements, you may wish to consider using the system() function with a different call, or perhaps create a shell script that can be called via system(), rather than the actual single command, where the shell script can contain a sequence of CLI commands that are relevant to your workflow.

Regards,

Marc Schwartz


From macqueen1 at llnl.gov  Thu Jan 11 18:18:41 2018
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Thu, 11 Jan 2018 17:18:41 +0000
Subject: [R-SIG-Mac] Opening single Terminal window and running syntax
 sequentially from R
In-Reply-To: <0093ECB4-FB36-471F-8D10-D60DB3BD02B1@me.com>
References: <CA+dpOJn0DrzNFMOnABRp3ZPLuaNJauDeDShOJJT6ULWtzY-RDg@mail.gmail.com>
 <0093ECB4-FB36-471F-8D10-D60DB3BD02B1@me.com>
Message-ID: <94E691EC-C41B-4974-9FEB-5DBDCE4A10E4@llnl.gov>

I would tend to agree that this is outside of R, unless the My_File.app is intended to run an R script.

However, Terminal has a Preference setting that specifies whether its windows close when the shell exits. I believe the default is to not close. Try changing it.

-Don

--
Don MacQueen
Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062
Lab cell 925-724-7509
 
 

On 1/10/18, 9:39 AM, "R-SIG-Mac on behalf of Marc Schwartz" <r-sig-mac-bounces at r-project.org on behalf of marc_schwartz at me.com> wrote:

    > On Jan 10, 2018, at 12:18 PM, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
    > 
    > Hi,
    > 
    > I have an .app file saved in Harddisk, which I want to run from R. So
    > below is the code which I use:
    > 
    > system("open '.../My_File.app'")
    > 
    > However, if I run above code multiple times (sequentially) then each
    > time a new Terminal window opens that make my system cluttered.
    > 
    > So I wonder if there is any way to use a single Terminal window and
    > run above code sequentially there only. R should search if any
    > Terminal window is already open and then run syntax on that Terminal
    > window only.
    > 
    > Any pointer will be highly appreciated.
    > 
    > Thanks,
    
    
    Hi,
    
    My initial reaction is that this is outside of R per se and more specific to macOS in terms of how the application is opened at the CLI, runs and then is exited/closed, before the next instance is run.
    
    I would do a Google search on keywords along the lines of "macOS scripting" and/or "macOS open command".
    
    One possibility would be to use the '-W' option for open, which theoretically will force the initial call to wait for the first application instance to be closed/exited before returning.
    
    For example, compare the behaviors of:
    
      system("open -a TextEdit")
    
    versus:
    
      system("open -W -a TextEdit")
    
    from an R terminal session.
    
    So, depending upon your actual workflow requirements, you may wish to consider using the system() function with a different call, or perhaps create a shell script that can be called via system(), rather than the actual single command, where the shell script can contain a sequence of CLI commands that are relevant to your workflow.
    
    Regards,
    
    Marc Schwartz
    
    _______________________________________________
    R-SIG-Mac mailing list
    R-SIG-Mac at r-project.org
    https://stat.ethz.ch/mailman/listinfo/r-sig-mac
    


From mspinola10 at gmail.com  Thu Jan 11 18:26:41 2018
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Thu, 11 Jan 2018 11:26:41 -0600
Subject: [R-SIG-Mac] Updating some packages fails
Message-ID: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>

Dear list members,

When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
some packages, as "sf", fails:

> install.packages("sf")

  There is a binary version available but the source version is later:
   binary source needs_compilation
sf  0.5-5  0.6-0              TRUE

Do you want to install from sources the package which needs compilation?
y/n: y

installing the source package ?sf?

trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
==================================================
downloaded 7.1 MB

Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
  unknown timezone 'default/America/Costa_Rica'
* installing *source* package ?sf? ...
** package ?sf? successfully unpacked and MD5 sums checked
configure: CC: clang
configure: CXX: clang++
checking for gdal-config... no
no
configure: error: gdal-config not found or not executable.
ERROR: configuration failed for package ?sf?
* removing
?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
* restoring previous
?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
Warning in install.packages :
  installation of package ?sf? had non-zero exit status

The downloaded source packages are in
?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/downloaded_packages?
>


Any solution to this problem?

Manuel

-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From lee at truthfromdata.com  Thu Jan 11 18:40:42 2018
From: lee at truthfromdata.com (Lee)
Date: Thu, 11 Jan 2018 12:40:42 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
Message-ID: <e866703b-045a-46f4-fdc3-a28efc093607@truthfromdata.com>

To build sf from source you need the GDAL library.? The easiest way to 
install GDAL, as well as GEOS and PROJ, on a mac is with the framework 
from Kyng Chaos which you can find here: 
http://www.kyngchaos.com/software/frameworks

They are also available on Homebrew; brew search for gdal, proj and geos.

Assuming you install the frameworks from KyngChaos in the default 
locations, you can use the following R script to build sf from source:

    sf_config_args <- c(
    "--with-gdal-config=/Library/Frameworks/GDAL.Framework/Versions/2.1/unix/bin/gdal-config",
    "--with-geos-config=/Library/Frameworks/GEOS.Framework/Versions/3/unix/bin/geos-config",
    "--with-proj-include=/Library/Frameworks/PROJ.framework/Versions/4/unix/include",
    "--with-proj-lib=/Library/Frameworks/PROJ.framework/Versions/4/unix/lib",
    "--with-proj-share=/Library/Frameworks/PROJ.framework/Versions/4/unix/share/proj"
    )
    install.packages("sf", configure.args = sf_config_args)

Adjust the paths if you install GDAL, PROJ and GEOS to different locations.

Lee

On 1/11/18 12:26 PM, Manuel Sp?nola wrote:
> Dear list members,
>
> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> some packages, as "sf", fails:
>
>> install.packages("sf")
>    There is a binary version available but the source version is later:
>     binary source needs_compilation
> sf  0.5-5  0.6-0              TRUE
>
> Do you want to install from sources the package which needs compilation?
> y/n: y
>
> installing the source package ?sf?
>
> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> ==================================================
> downloaded 7.1 MB
>
> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
>    unknown timezone 'default/America/Costa_Rica'
> * installing *source* package ?sf? ...
> ** package ?sf? successfully unpacked and MD5 sums checked
> configure: CC: clang
> configure: CXX: clang++
> checking for gdal-config... no
> no
> configure: error: gdal-config not found or not executable.
> ERROR: configuration failed for package ?sf?
> * removing
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> * restoring previous
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> Warning in install.packages :
>    installation of package ?sf? had non-zero exit status
>
> The downloaded source packages are in
> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/downloaded_packages?
>
> Any solution to this problem?
>
> Manuel
>


	[[alternative HTML version deleted]]


From simon.urbanek at R-project.org  Thu Jan 11 19:17:43 2018
From: simon.urbanek at R-project.org (Simon Urbanek)
Date: Thu, 11 Jan 2018 13:17:43 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
Message-ID: <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>

Manuel,

the archiving on CRAN has changed recently which broke the updates so recently the update for macOS packages have been suspended. Hence some most recent binaries is not available yet - it should be up by tomorrow.

Cheers,
Simon



> On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> 
> Dear list members,
> 
> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> some packages, as "sf", fails:
> 
>> install.packages("sf")
> 
>  There is a binary version available but the source version is later:
>   binary source needs_compilation
> sf  0.5-5  0.6-0              TRUE
> 
> Do you want to install from sources the package which needs compilation?
> y/n: y
> 
> installing the source package ?sf?
> 
> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> ==================================================
> downloaded 7.1 MB
> 
> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
>  unknown timezone 'default/America/Costa_Rica'
> * installing *source* package ?sf? ...
> ** package ?sf? successfully unpacked and MD5 sums checked
> configure: CC: clang
> configure: CXX: clang++
> checking for gdal-config... no
> no
> configure: error: gdal-config not found or not executable.
> ERROR: configuration failed for package ?sf?
> * removing
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> * restoring previous
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> Warning in install.packages :
>  installation of package ?sf? had non-zero exit status
> 
> The downloaded source packages are in
> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/downloaded_packages?
>> 
> 
> 
> Any solution to this problem?
> 
> Manuel
> 
> -- 
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From mspinola10 at gmail.com  Thu Jan 11 21:12:47 2018
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Thu, 11 Jan 2018 14:12:47 -0600
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
Message-ID: <CABkCotTMduH9jEajNg030fcsb748bMewhmEAquRTSve2Bv_UOQ@mail.gmail.com>

Thank you very much Lee and Simon.

Manuel

2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:

> Manuel,
>
> the archiving on CRAN has changed recently which broke the updates so
> recently the update for macOS packages have been suspended. Hence some most
> recent binaries is not available yet - it should be up by tomorrow.
>
> Cheers,
> Simon
>
>
>
> > On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com>
> wrote:
> >
> > Dear list members,
> >
> > When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> > some packages, as "sf", fails:
> >
> >> install.packages("sf")
> >
> >  There is a binary version available but the source version is later:
> >   binary source needs_compilation
> > sf  0.5-5  0.6-0              TRUE
> >
> > Do you want to install from sources the package which needs compilation?
> > y/n: y
> >
> > installing the source package ?sf?
> >
> > trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> > Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> > ==================================================
> > downloaded 7.1 MB
> >
> > Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
> >  unknown timezone 'default/America/Costa_Rica'
> > * installing *source* package ?sf? ...
> > ** package ?sf? successfully unpacked and MD5 sums checked
> > configure: CC: clang
> > configure: CXX: clang++
> > checking for gdal-config... no
> > no
> > configure: error: gdal-config not found or not executable.
> > ERROR: configuration failed for package ?sf?
> > * removing
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > * restoring previous
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > Warning in install.packages :
> >  installation of package ?sf? had non-zero exit status
> >
> > The downloaded source packages are in
> > ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
> downloaded_packages?
> >>
> >
> >
> > Any solution to this problem?
> >
> > Manuel
> >
> > --
> > *Manuel Sp?nola, Ph.D.*
> > Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> > Universidad Nacional
> > Apartado 1350-3000
> > Heredia
> > COSTA RICA
> > mspinola at una.cr <mspinola at una.ac.cr>
> > mspinola10 at gmail.com
> > Tel?fono: (506) 8706 - 4662
> > Personal website: Lobito de r?o <https://sites.google.com/
> site/lobitoderio/>
> > Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From mspinola10 at gmail.com  Mon Jan 15 17:25:39 2018
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Mon, 15 Jan 2018 10:25:39 -0600
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
Message-ID: <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>

I am still having problems updating some packages, for example,

sf
Hmisc
rms
mgcv
RcmdrMisc

Same messages that I showed in my first email.

Manuel


2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:

> Manuel,
>
> the archiving on CRAN has changed recently which broke the updates so
> recently the update for macOS packages have been suspended. Hence some most
> recent binaries is not available yet - it should be up by tomorrow.
>
> Cheers,
> Simon
>
>
>
> > On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com>
> wrote:
> >
> > Dear list members,
> >
> > When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> > some packages, as "sf", fails:
> >
> >> install.packages("sf")
> >
> >  There is a binary version available but the source version is later:
> >   binary source needs_compilation
> > sf  0.5-5  0.6-0              TRUE
> >
> > Do you want to install from sources the package which needs compilation?
> > y/n: y
> >
> > installing the source package ?sf?
> >
> > trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> > Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> > ==================================================
> > downloaded 7.1 MB
> >
> > Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
> >  unknown timezone 'default/America/Costa_Rica'
> > * installing *source* package ?sf? ...
> > ** package ?sf? successfully unpacked and MD5 sums checked
> > configure: CC: clang
> > configure: CXX: clang++
> > checking for gdal-config... no
> > no
> > configure: error: gdal-config not found or not executable.
> > ERROR: configuration failed for package ?sf?
> > * removing
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > * restoring previous
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > Warning in install.packages :
> >  installation of package ?sf? had non-zero exit status
> >
> > The downloaded source packages are in
> > ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
> downloaded_packages?
> >>
> >
> >
> > Any solution to this problem?
> >
> > Manuel
> >
> > --
> > *Manuel Sp?nola, Ph.D.*
> > Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> > Universidad Nacional
> > Apartado 1350-3000
> > Heredia
> > COSTA RICA
> > mspinola at una.cr <mspinola at una.ac.cr>
> > mspinola10 at gmail.com
> > Tel?fono: (506) 8706 - 4662
> > Personal website: Lobito de r?o <https://sites.google.com/
> site/lobitoderio/>
> > Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Mon Jan 15 17:40:09 2018
From: btupper at bigelow.org (Ben Tupper)
Date: Mon, 15 Jan 2018 11:40:09 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
 <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
Message-ID: <8C661BB7-FE04-4BDD-99B2-7A8A86E76E09@bigelow.org>

Hi,

sf (and many other spatial packages) depend upon gdal (http://www.gdal.org/ <http://www.gdal.org/>) being installed on your platform.  Your message says it can't find the gdal-config utility, "checking for gdal-config... no".  You can install it following these instructions...

https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries <https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries>

I'm not sure about the other packages you list.

Cheers,
Ben



> On Jan 15, 2018, at 11:25 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> 
> I am still having problems updating some packages, for example,
> 
> sf
> Hmisc
> rms
> mgcv
> RcmdrMisc
> 
> Same messages that I showed in my first email.
> 
> Manuel
> 
> 
> 2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:
> 
>> Manuel,
>> 
>> the archiving on CRAN has changed recently which broke the updates so
>> recently the update for macOS packages have been suspended. Hence some most
>> recent binaries is not available yet - it should be up by tomorrow.
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com>
>> wrote:
>>> 
>>> Dear list members,
>>> 
>>> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
>>> some packages, as "sf", fails:
>>> 
>>>> install.packages("sf")
>>> 
>>> There is a binary version available but the source version is later:
>>>  binary source needs_compilation
>>> sf  0.5-5  0.6-0              TRUE
>>> 
>>> Do you want to install from sources the package which needs compilation?
>>> y/n: y
>>> 
>>> installing the source package ?sf?
>>> 
>>> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
>>> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
>>> ==================================================
>>> downloaded 7.1 MB
>>> 
>>> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
>>> unknown timezone 'default/America/Costa_Rica'
>>> * installing *source* package ?sf? ...
>>> ** package ?sf? successfully unpacked and MD5 sums checked
>>> configure: CC: clang
>>> configure: CXX: clang++
>>> checking for gdal-config... no
>>> no
>>> configure: error: gdal-config not found or not executable.
>>> ERROR: configuration failed for package ?sf?
>>> * removing
>>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>>> * restoring previous
>>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>>> Warning in install.packages :
>>> installation of package ?sf? had non-zero exit status
>>> 
>>> The downloaded source packages are in
>>> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
>> downloaded_packages?
>>>> 
>>> 
>>> 
>>> Any solution to this problem?
>>> 
>>> Manuel
>>> 
>>> --
>>> *Manuel Sp?nola, Ph.D.*
>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>> Universidad Nacional
>>> Apartado 1350-3000
>>> Heredia
>>> COSTA RICA
>>> mspinola at una.cr <mspinola at una.ac.cr>
>>> mspinola10 at gmail.com
>>> Tel?fono: (506) 8706 - 4662
>>> Personal website: Lobito de r?o <https://sites.google.com/
>> site/lobitoderio/>
>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>> 
>>>      [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> 
> 
> 
> -- 
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecocast Reports: http://seascapemodeling.org/ecocast.html
Tick Reports: https://report.bigelow.org/tick/
Jellyfish Reports: https://jellyfish.bigelow.org/jellyfish/




	[[alternative HTML version deleted]]


From mspinola10 at gmail.com  Tue Jan 16 00:03:11 2018
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Mon, 15 Jan 2018 17:03:11 -0600
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <8C661BB7-FE04-4BDD-99B2-7A8A86E76E09@bigelow.org>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
 <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
 <8C661BB7-FE04-4BDD-99B2-7A8A86E76E09@bigelow.org>
Message-ID: <CABkCotSjxsqtS9FL+XTutOuKeWFkVcWkgsmZugrL=RCQ_xLPPg@mail.gmail.com>

Thank you very much Ben.

But I am trying to make an update, not a first time installation.  The
older sf version is running fine.

Manuel

2018-01-15 10:40 GMT-06:00 Ben Tupper <btupper at bigelow.org>:

> Hi,
>
> sf (and many other spatial packages) depend upon gdal (
> http://www.gdal.org/) being installed on your platform.  Your message
> says it can't find the gdal-config utility, "checking for gdal-config...
> no".  You can install it following these instructions...
>
> https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries
>
> I'm not sure about the other packages you list.
>
> Cheers,
> Ben
>
>
>
> On Jan 15, 2018, at 11:25 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>
> I am still having problems updating some packages, for example,
>
> sf
> Hmisc
> rms
> mgcv
> RcmdrMisc
>
> Same messages that I showed in my first email.
>
> Manuel
>
>
> 2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:
>
> Manuel,
>
> the archiving on CRAN has changed recently which broke the updates so
> recently the update for macOS packages have been suspended. Hence some most
> recent binaries is not available yet - it should be up by tomorrow.
>
> Cheers,
> Simon
>
>
>
> On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com>
>
> wrote:
>
>
> Dear list members,
>
> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> some packages, as "sf", fails:
>
> install.packages("sf")
>
>
> There is a binary version available but the source version is later:
>  binary source needs_compilation
> sf  0.5-5  0.6-0              TRUE
>
> Do you want to install from sources the package which needs compilation?
> y/n: y
>
> installing the source package ?sf?
>
> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> ==================================================
> downloaded 7.1 MB
>
> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
> unknown timezone 'default/America/Costa_Rica'
> * installing *source* package ?sf? ...
> ** package ?sf? successfully unpacked and MD5 sums checked
> configure: CC: clang
> configure: CXX: clang++
> checking for gdal-config... no
> no
> configure: error: gdal-config not found or not executable.
> ERROR: configuration failed for package ?sf?
> * removing
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> * restoring previous
> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> Warning in install.packages :
> installation of package ?sf? had non-zero exit status
>
> The downloaded source packages are in
> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
>
> downloaded_packages?
>
>
>
>
> Any solution to this problem?
>
> Manuel
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/
>
> site/lobitoderio/>
>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>      [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>
>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.cr <mspinola at una.ac.cr>
> mspinola10 at gmail.com
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/
> site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive
> <https://maps.google.com/?q=60+Bigelow+Drive&entry=gmail&source=g>, P.O.
> Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecocast Reports: http://seascapemodeling.org/ecocast.html
> Tick Reports: https://report.bigelow.org/tick/
> Jellyfish Reports: https://jellyfish.bigelow.org/jellyfish/
>
>
>
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.cr <mspinola at una.ac.cr>
mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Jan 16 00:46:39 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 15 Jan 2018 18:46:39 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotSjxsqtS9FL+XTutOuKeWFkVcWkgsmZugrL=RCQ_xLPPg@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
 <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
 <8C661BB7-FE04-4BDD-99B2-7A8A86E76E09@bigelow.org>
 <CABkCotSjxsqtS9FL+XTutOuKeWFkVcWkgsmZugrL=RCQ_xLPPg@mail.gmail.com>
Message-ID: <7095f612-b900-1e21-2c38-cc7e4acbb6a4@gmail.com>

On 15/01/2018 6:03 PM, Manuel Sp?nola wrote:
> Thank you very much Ben.
> 
> But I am trying to make an update, not a first time installation.  The
> older sf version is running fine.

Building from source needs more from your system than installing a 
prebuilt binary.  If you aren't willing or able to follow Ben's 
instructions, you'll just have to wait until Simon's binary build makes 
it onto CRAN.

Duncan Murdoch

> 
> Manuel
> 
> 2018-01-15 10:40 GMT-06:00 Ben Tupper <btupper at bigelow.org>:
> 
>> Hi,
>>
>> sf (and many other spatial packages) depend upon gdal (
>> http://www.gdal.org/) being installed on your platform.  Your message
>> says it can't find the gdal-config utility, "checking for gdal-config...
>> no".  You can install it following these instructions...
>>
>> https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries
>>
>> I'm not sure about the other packages you list.
>>
>> Cheers,
>> Ben
>>
>>
>>
>> On Jan 15, 2018, at 11:25 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>>
>> I am still having problems updating some packages, for example,
>>
>> sf
>> Hmisc
>> rms
>> mgcv
>> RcmdrMisc
>>
>> Same messages that I showed in my first email.
>>
>> Manuel
>>
>>
>> 2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:
>>
>> Manuel,
>>
>> the archiving on CRAN has changed recently which broke the updates so
>> recently the update for macOS packages have been suspended. Hence some most
>> recent binaries is not available yet - it should be up by tomorrow.
>>
>> Cheers,
>> Simon
>>
>>
>>
>> On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com>
>>
>> wrote:
>>
>>
>> Dear list members,
>>
>> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
>> some packages, as "sf", fails:
>>
>> install.packages("sf")
>>
>>
>> There is a binary version available but the source version is later:
>>   binary source needs_compilation
>> sf  0.5-5  0.6-0              TRUE
>>
>> Do you want to install from sources the package which needs compilation?
>> y/n: y
>>
>> installing the source package ?sf?
>>
>> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
>> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
>> ==================================================
>> downloaded 7.1 MB
>>
>> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
>> unknown timezone 'default/America/Costa_Rica'
>> * installing *source* package ?sf? ...
>> ** package ?sf? successfully unpacked and MD5 sums checked
>> configure: CC: clang
>> configure: CXX: clang++
>> checking for gdal-config... no
>> no
>> configure: error: gdal-config not found or not executable.
>> ERROR: configuration failed for package ?sf?
>> * removing
>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>> * restoring previous
>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>> Warning in install.packages :
>> installation of package ?sf? had non-zero exit status
>>
>> The downloaded source packages are in
>> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
>>
>> downloaded_packages?
>>
>>
>>
>>
>> Any solution to this problem?
>>
>> Manuel
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.cr <mspinola at una.ac.cr>
>> mspinola10 at gmail.com
>> Tel?fono: (506) 8706 - 4662
>> Personal website: Lobito de r?o <https://sites.google.com/
>>
>> site/lobitoderio/>
>>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>>       [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>>
>>
>>
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.cr <mspinola at una.ac.cr>
>> mspinola10 at gmail.com
>> Tel?fono: (506) 8706 - 4662
>> Personal website: Lobito de r?o <https://sites.google.com/
>> site/lobitoderio/>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>>
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive
>> <https://maps.google.com/?q=60+Bigelow+Drive&entry=gmail&source=g>, P.O.
>> Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>>
>> Ecocast Reports: http://seascapemodeling.org/ecocast.html
>> Tick Reports: https://report.bigelow.org/tick/
>> Jellyfish Reports: https://jellyfish.bigelow.org/jellyfish/
>>
>>
>>
>>
> 
>


From btupper at bigelow.org  Tue Jan 16 01:18:52 2018
From: btupper at bigelow.org (Ben Tupper)
Date: Mon, 15 Jan 2018 19:18:52 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotSjxsqtS9FL+XTutOuKeWFkVcWkgsmZugrL=RCQ_xLPPg@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
 <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
 <8C661BB7-FE04-4BDD-99B2-7A8A86E76E09@bigelow.org>
 <CABkCotSjxsqtS9FL+XTutOuKeWFkVcWkgsmZugrL=RCQ_xLPPg@mail.gmail.com>
Message-ID: <0AA60E16-9700-4AC6-862A-028E08CFFED1@bigelow.org>

Hi,

That does sound frustrating - have you tried the following from a terminal (not R console)?

$ which gdal-config
/usr/local/bin/gdal-config

And then from within R?

> Sys.which("gdal-config")
                 gdal-config 
"/usr/local/bin/gdal-config" 


Ben

 
> On Jan 15, 2018, at 6:03 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> 
> Thank you very much Ben.
> 
> But I am trying to make an update, not a first time installation.  The older sf version is running fine.
> 
> Manuel
> 
> 2018-01-15 10:40 GMT-06:00 Ben Tupper <btupper at bigelow.org <mailto:btupper at bigelow.org>>:
> Hi,
> 
> sf (and many other spatial packages) depend upon gdal (http://www.gdal.org/ <http://www.gdal.org/>) being installed on your platform.  Your message says it can't find the gdal-config utility, "checking for gdal-config... no".  You can install it following these instructions...
> 
> https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries <https://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries>
> 
> I'm not sure about the other packages you list.
> 
> Cheers,
> Ben
> 
> 
> 
>> On Jan 15, 2018, at 11:25 AM, Manuel Sp?nola <mspinola10 at gmail.com <mailto:mspinola10 at gmail.com>> wrote:
>> 
>> I am still having problems updating some packages, for example,
>> 
>> sf
>> Hmisc
>> rms
>> mgcv
>> RcmdrMisc
>> 
>> Same messages that I showed in my first email.
>> 
>> Manuel
>> 
>> 
>> 2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org <mailto:simon.urbanek at r-project.org>>:
>> 
>>> Manuel,
>>> 
>>> the archiving on CRAN has changed recently which broke the updates so
>>> recently the update for macOS packages have been suspended. Hence some most
>>> recent binaries is not available yet - it should be up by tomorrow.
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> 
>>> 
>>>> On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com <mailto:mspinola10 at gmail.com>>
>>> wrote:
>>>> 
>>>> Dear list members,
>>>> 
>>>> When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
>>>> some packages, as "sf", fails:
>>>> 
>>>>> install.packages("sf")
>>>> 
>>>> There is a binary version available but the source version is later:
>>>>  binary source needs_compilation
>>>> sf  0.5-5  0.6-0              TRUE
>>>> 
>>>> Do you want to install from sources the package which needs compilation?
>>>> y/n: y
>>>> 
>>>> installing the source package ?sf?
>>>> 
>>>> trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz <https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz>'
>>>> Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
>>>> ==================================================
>>>> downloaded 7.1 MB
>>>> 
>>>> Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
>>>> unknown timezone 'default/America/Costa_Rica'
>>>> * installing *source* package ?sf? ...
>>>> ** package ?sf? successfully unpacked and MD5 sums checked
>>>> configure: CC: clang
>>>> configure: CXX: clang++
>>>> checking for gdal-config... no
>>>> no
>>>> configure: error: gdal-config not found or not executable.
>>>> ERROR: configuration failed for package ?sf?
>>>> * removing
>>>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>>>> * restoring previous
>>>> ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
>>>> Warning in install.packages :
>>>> installation of package ?sf? had non-zero exit status
>>>> 
>>>> The downloaded source packages are in
>>>> ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/
>>> downloaded_packages?
>>>>> 
>>>> 
>>>> 
>>>> Any solution to this problem?
>>>> 
>>>> Manuel
>>>> 
>>>> --
>>>> *Manuel Sp?nola, Ph.D.*
>>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>>> Universidad Nacional
>>>> Apartado 1350-3000
>>>> Heredia
>>>> COSTA RICA
>>>> mspinola at una.cr <mailto:mspinola at una.cr> <mspinola at una.ac.cr <mailto:mspinola at una.ac.cr>>
>>>> mspinola10 at gmail.com <mailto:mspinola10 at gmail.com>
>>>> Tel?fono: (506) 8706 - 4662
>>>> Personal website: Lobito de r?o <https://sites.google.com/ <https://sites.google.com/>
>>> site/lobitoderio/>
>>>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/ <http://www.icomvis.una.ac.cr/>>
>>>> 
>>>>      [[alternative HTML version deleted]]
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>
>>> 
>>> 
>> 
>> 
>> -- 
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.cr <mailto:mspinola at una.cr> <mspinola at una.ac.cr <mailto:mspinola at una.ac.cr>>
>> mspinola10 at gmail.com <mailto:mspinola10 at gmail.com>
>> Tel?fono: (506) 8706 - 4662
>> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/ <https://sites.google.com/site/lobitoderio/>>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/ <http://www.icomvis.una.ac.cr/>>
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac <https://stat.ethz.ch/mailman/listinfo/r-sig-mac>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive <https://maps.google.com/?q=60+Bigelow+Drive&entry=gmail&source=g>, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org <http://www.bigelow.org/>
> 
> Ecocast Reports: http://seascapemodeling.org/ecocast.html <http://seascapemodeling.org/ecocast.html>
> Tick Reports: https://report.bigelow.org/tick/ <https://report.bigelow.org/tick/>
> Jellyfish Reports: https://jellyfish.bigelow.org/jellyfish/ <https://jellyfish.bigelow.org/jellyfish/>
> 
> 
> 
> 
> 
> -- 
> Manuel Sp?nola, Ph.D. 
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre 
> Universidad Nacional 
> Apartado 1350-3000 
> Heredia 
> COSTA RICA 
> mspinola at una.cr <mailto:mspinola at una.ac.cr> 
> mspinola10 at gmail.com <mailto:mspinola10 at gmail.com> 
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/> 
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecocast Reports: http://seascapemodeling.org/ecocast.html
Tick Reports: https://report.bigelow.org/tick/
Jellyfish Reports: https://jellyfish.bigelow.org/jellyfish/




	[[alternative HTML version deleted]]


From simon.urbanek at r-project.org  Tue Jan 16 01:26:17 2018
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 15 Jan 2018 19:26:17 -0500
Subject: [R-SIG-Mac] Updating some packages fails
In-Reply-To: <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
References: <CABkCotQSNXEcO-JPoA+od2+riBVFCQpmL8GhUfPP03wbfKAMVQ@mail.gmail.com>
 <C911EAE0-EED9-40C2-BA62-18D006B9EBE6@R-project.org>
 <CABkCotTfyT5b=uJkZ0t85-HiU4C-p8vakmm2_SSeaMJSR+sxPA@mail.gmail.com>
Message-ID: <EDCF208C-60BE-40A9-B97D-DF3DA2701EA1@r-project.org>

Manuel,

apologies for the inconvenience - in addition to the original problem the intermediate server that hosts the packages ran out of disk space - it should be all fixed now. Not all packages have been built yet, but a significant portion (packages are built roughly by they reverse-dependencies so most important ones should be through). The back-log should be cleared by next morning.

If you still don't see updated packages, please use
http://r.research.att.com
as your mirror temporarily until all mirrors are synced up.

Thanks,
Simon



> On Jan 15, 2018, at 11:25 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> 
> I am still having problems updating some packages, for example,
> 
> sf
> Hmisc
> rms
> mgcv
> RcmdrMisc
> 
> Same messages that I showed in my first email. 
> 
> Manuel
> 
> 
> 2018-01-11 12:17 GMT-06:00 Simon Urbanek <simon.urbanek at r-project.org>:
> Manuel,
> 
> the archiving on CRAN has changed recently which broke the updates so recently the update for macOS packages have been suspended. Hence some most recent binaries is not available yet - it should be up by tomorrow.
> 
> Cheers,
> Simon
> 
> 
> 
> > On Jan 11, 2018, at 12:26 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> >
> > Dear list members,
> >
> > When trying updating some packages in MacOS High Sierra 10.13 (R 3.4.2)
> > some packages, as "sf", fails:
> >
> >> install.packages("sf")
> >
> >  There is a binary version available but the source version is later:
> >   binary source needs_compilation
> > sf  0.5-5  0.6-0              TRUE
> >
> > Do you want to install from sources the package which needs compilation?
> > y/n: y
> >
> > installing the source package ?sf?
> >
> > trying URL 'https://cran.rstudio.com/src/contrib/sf_0.6-0.tar.gz'
> > Content type 'application/x-gzip' length 7399611 bytes (7.1 MB)
> > ==================================================
> > downloaded 7.1 MB
> >
> > Warning in strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", tz = tz) :
> >  unknown timezone 'default/America/Costa_Rica'
> > * installing *source* package ?sf? ...
> > ** package ?sf? successfully unpacked and MD5 sums checked
> > configure: CC: clang
> > configure: CXX: clang++
> > checking for gdal-config... no
> > no
> > configure: error: gdal-config not found or not executable.
> > ERROR: configuration failed for package ?sf?
> > * removing
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > * restoring previous
> > ?/Library/Frameworks/R.framework/Versions/3.4/Resources/library/sf?
> > Warning in install.packages :
> >  installation of package ?sf? had non-zero exit status
> >
> > The downloaded source packages are in
> > ?/private/var/folders/gf/vwlbzml90wv7cs2r4v00wg_m0000gn/T/RtmpbmvcCh/downloaded_packages?
> >>
> >
> >
> > Any solution to this problem?
> >
> > Manuel
> >
> > --
> > *Manuel Sp?nola, Ph.D.*
> > Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> > Universidad Nacional
> > Apartado 1350-3000
> > Heredia
> > COSTA RICA
> > mspinola at una.cr <mspinola at una.ac.cr>
> > mspinola10 at gmail.com
> > Tel?fono: (506) 8706 - 4662
> > Personal website: Lobito de r?o <https://sites.google.com/site/lobitoderio/>
> > Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Mac mailing list
> > R-SIG-Mac at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> 
> 
> -- 
> Manuel Sp?nola, Ph.D. 
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre 
> Universidad Nacional 
> Apartado 1350-3000 
> Heredia 
> COSTA RICA 
> mspinola at una.cr 
> mspinola10 at gmail.com 
> Tel?fono: (506) 8706 - 4662
> Personal website: Lobito de r?o 
> Institutional website: ICOMVIS


From wccsnow at gmail.com  Fri Jan 19 01:51:46 2018
From: wccsnow at gmail.com (Wei-Chen Chen)
Date: Thu, 18 Jan 2018 19:51:46 -0500
Subject: [R-SIG-Mac] Fwd: Need an appropriate way for setting rpath.
In-Reply-To: <CAB2DcasNSg=JkYLqK0QDxV6Vaki_EOON=vW3ad1LTphnSc8hNA@mail.gmail.com>
References: <CAB2DcasNSg=JkYLqK0QDxV6Vaki_EOON=vW3ad1LTphnSc8hNA@mail.gmail.com>
Message-ID: <CAB2DcavLqAjNEOQWTYcAKKyfX7_Cr+Xd7VuB6kDfojL38+R2SQ@mail.gmail.com>

Dear List Members,

I knew linking with other shared library in mac may be tricky, but I
thought it may save some space and worth a try.

The messages below are from a CRAN check recently from "
https://www.r-project.org/nosvn/R.check/r-release-osx-x86_64/JuniperKernel-
00install.txt". It obtained the correct paths (to libzmq.5.dylib) from a
package pbdZMQ, then set them for compiling and linking to the target
package JuniperKernel. However, the results at "install_name_tool" showed
that the path to the shared library is not what it said at linking time.
Therefore, later on at the run time the dyn.load() will not be able to find
the shared library.

The questions are:
1) How did this happen?
2) What path and what clang flags I should use in this case?
3) Is there an easy way to resolve this issue? (e.g. Would it work by
adding pbdZMQ to the "Depends:"?)

Sincerely,
Wei-Chen Chen


* installing *source* package ???JuniperKernel??? ...
** package ???JuniperKernel??? successfully unpacked and MD5 sums checked

************** Results of JuniperKernel package configure **************

>> RSCRIPT = /Library/Frameworks/R.framework/Resources/bin/Rscript
>> PBD_ZMQ = /Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ
>> ZMQ_CPPFLAGS = -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
>> ZMQ_LDFLAGS = -L"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs" -lzmq.5

************************************************************************

** libs
clang++ -std=gnu++11
-I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
-I../inst/include/ -I.
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
-I/usr/local/include   -fPIC  -Wall -g -O2 -c RcppExports.cpp -o
RcppExports.o
clang++ -std=gnu++11
-I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
-I../inst/include/ -I.
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
-I/usr/local/include   -fPIC  -Wall -g -O2 -c juniper.cpp -o juniper.o
clang++ -std=gnu++11 -dynamiclib -Wl,-headerpad_max_install_names
-undefined dynamic_lookup -single_module -multiply_defined suppress
-L/Library/Frameworks/R.framework/Resources/lib -L/usr/local/lib -o
JuniperKernel.so RcppExports.o juniper.o
-L/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs
-lzmq.5 -F/Library/Frameworks/R.framework/.. -framework R
-Wl,-framework -Wl,CoreFoundation
installing via 'install.libs.R' to
/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel

Before install_name_tool (in install.libs.R):
[1] "/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so:"
[2] "\tJuniperKernel.so (compatibility version 0.0.0, current version
0.0.0)"
[3] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
(compatibility version 7.0.0, current version 7.2.0)"
[4] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libR.dylib
(compatibility version 3.4.0, current version 3.4.3)"
[5] "\t/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
(compatibility version 150.0.0, current version 1259.11.0)"
[6] "\t/usr/local/clang4/lib/libc++.1.dylib (compatibility version
1.0.0, current version 1.0.0)"
[7] "\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
current version 1226.10.1)"
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded
Error: package or namespace load failed for ???JuniperKernel??? in
dyn.load(file, DLLpath = DLLpath, ...):
 unable to load shared object
'/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so':
  dlopen(/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so,
6): Library not loaded:
/Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
  Referenced from:
/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so
  Reason: image not found
Error: loading failed
Execution halted
ERROR: loading failed
* removing ???/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel???

	[[alternative HTML version deleted]]


From r at dune.urbanek.info  Tue Jan 23 19:48:52 2018
From: r at dune.urbanek.info (Simon Urbanek)
Date: Tue, 23 Jan 2018 13:48:52 -0500
Subject: [R-SIG-Mac] .libPaths
In-Reply-To: <40C81BF2-D0A5-44FF-AFF0-9ACC639973B0@gmail.com>
References: <40C81BF2-D0A5-44FF-AFF0-9ACC639973B0@gmail.com>
Message-ID: <8ABB07FB-A131-42C7-8650-5F91FFDA35A1@dune.urbanek.info>

Disable the option in Startup (in case it's enabled), but also delete the
/Users/mjh/Library/R/3.4
directory if you don't want to use it. Once it exists, it will be automatically picked up by R.

Cheers,
Simon




> On Dec 25, 2017, at 1:11 PM, Michael Hall <mik3hall at gmail.com> wrote:
> 
> I seem to have somehow changed this so that for install.packages my user location is always selected in preference to the system location.
> Since I may at some point access packages from an application not connected to my user I would rather this not be the case. 
> What I now get is?
> 
> .libPaths()
> [1] "/Users/mjh/Library/R/3.4/library"                               "/Library/Frameworks/R.framework/Versions/3.4/Resources/library"
>> install.packages("NOSUCH")
> Installing package into ?/Users/mjh/Library/R/3.4/library?
> (as ?lib? is unspecified)
> Warning message:
> package ?NOSUCH? is not available (for R version 3.4.3) 
> 
> So everything is default installed into my user location. This didn?t used to be the case, but I do not remember what I may of done to permanently change it and so far I can?t figure out how to permanently undo it.
> I have looked at the R Startup command, the OS X app preferences, OS X faq, environment variables, the system Resource folder, no .Rprofile is there and I didn?t figure out what be causing the setting in Renviron. 
> 
> How do I permanently remove the user directory from .libPaths?
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From r at dune.urbanek.info  Tue Jan 23 19:54:14 2018
From: r at dune.urbanek.info (Simon Urbanek)
Date: Tue, 23 Jan 2018 13:54:14 -0500
Subject: [R-SIG-Mac] Need an appropriate way for setting rpath.
In-Reply-To: <CAB2DcavLqAjNEOQWTYcAKKyfX7_Cr+Xd7VuB6kDfojL38+R2SQ@mail.gmail.com>
References: <CAB2DcasNSg=JkYLqK0QDxV6Vaki_EOON=vW3ad1LTphnSc8hNA@mail.gmail.com>
 <CAB2DcavLqAjNEOQWTYcAKKyfX7_Cr+Xd7VuB6kDfojL38+R2SQ@mail.gmail.com>
Message-ID: <96B13629-8EA9-4AAE-93E3-4750BA4BB240@dune.urbanek.info>

Generally, you cannot link directly to a shared library in another package. You can access *routines* in another package using the LinkingTo: API (see R-ext 5.4.3), but not a library. You can also use static libraries on another packages (see R-ext 5.8) - but never a shared library.

Cheers,
Simon


> On Jan 18, 2018, at 7:51 PM, Wei-Chen Chen <wccsnow at gmail.com> wrote:
> 
> Dear List Members,
> 
> I knew linking with other shared library in mac may be tricky, but I
> thought it may save some space and worth a try.
> 
> The messages below are from a CRAN check recently from "
> https://www.r-project.org/nosvn/R.check/r-release-osx-x86_64/JuniperKernel-
> 00install.txt". It obtained the correct paths (to libzmq.5.dylib) from a
> package pbdZMQ, then set them for compiling and linking to the target
> package JuniperKernel. However, the results at "install_name_tool" showed
> that the path to the shared library is not what it said at linking time.
> Therefore, later on at the run time the dyn.load() will not be able to find
> the shared library.
> 
> The questions are:
> 1) How did this happen?
> 2) What path and what clang flags I should use in this case?
> 3) Is there an easy way to resolve this issue? (e.g. Would it work by
> adding pbdZMQ to the "Depends:"?)
> 
> Sincerely,
> Wei-Chen Chen
> 
> 
> * installing *source* package ???JuniperKernel??? ...
> ** package ???JuniperKernel??? successfully unpacked and MD5 sums checked
> 
> ************** Results of JuniperKernel package configure **************
> 
>>> RSCRIPT = /Library/Frameworks/R.framework/Resources/bin/Rscript
>>> PBD_ZMQ = /Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ
>>> ZMQ_CPPFLAGS = -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
>>> ZMQ_LDFLAGS = -L"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs" -lzmq.5
> 
> ************************************************************************
> 
> ** libs
> clang++ -std=gnu++11
> -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
> -I../inst/include/ -I.
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
> -I/usr/local/include   -fPIC  -Wall -g -O2 -c RcppExports.cpp -o
> RcppExports.o
> clang++ -std=gnu++11
> -I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
> -I../inst/include/ -I.
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
> -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
> -I/usr/local/include   -fPIC  -Wall -g -O2 -c juniper.cpp -o juniper.o
> clang++ -std=gnu++11 -dynamiclib -Wl,-headerpad_max_install_names
> -undefined dynamic_lookup -single_module -multiply_defined suppress
> -L/Library/Frameworks/R.framework/Resources/lib -L/usr/local/lib -o
> JuniperKernel.so RcppExports.o juniper.o
> -L/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs
> -lzmq.5 -F/Library/Frameworks/R.framework/.. -framework R
> -Wl,-framework -Wl,CoreFoundation
> installing via 'install.libs.R' to
> /Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel
> 
> Before install_name_tool (in install.libs.R):
> [1] "/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so:"
> [2] "\tJuniperKernel.so (compatibility version 0.0.0, current version
> 0.0.0)"
> [3] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
> (compatibility version 7.0.0, current version 7.2.0)"
> [4] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libR.dylib
> (compatibility version 3.4.0, current version 3.4.3)"
> [5] "\t/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
> (compatibility version 150.0.0, current version 1259.11.0)"
> [6] "\t/usr/local/clang4/lib/libc++.1.dylib (compatibility version
> 1.0.0, current version 1.0.0)"
> [7] "\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
> current version 1226.10.1)"
> ** R
> ** inst
> ** preparing package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** testing if installed package can be loaded
> Error: package or namespace load failed for ???JuniperKernel??? in
> dyn.load(file, DLLpath = DLLpath, ...):
> unable to load shared object
> '/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so':
>  dlopen(/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so,
> 6): Library not loaded:
> /Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
>  Referenced from:
> /Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so
>  Reason: image not found
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing ???/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel???
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From balamut2 at illinois.edu  Tue Jan 30 21:54:07 2018
From: balamut2 at illinois.edu (Balamuta, James Joseph)
Date: Tue, 30 Jan 2018 20:54:07 +0000
Subject: [R-SIG-Mac] R 3.4.3 binaries
In-Reply-To: <360F03DF-38F2-4DE3-BD2F-784FC4C40F7D@illinois.edu>
References: <3093F34C-D593-4147-ADBE-51821F626062@helsinki.fi>
 <D916BC44-BF4D-45E3-831A-01ED9C0CFD96@gmail.com>
 <E741A067-ED73-4835-A792-ABAB84F3018F@illinois.edu>
 <32F707DF-4ACC-46C5-B3B4-328CB54A5BBB@dune.urbanek.info>
 <360F03DF-38F2-4DE3-BD2F-784FC4C40F7D@illinois.edu>
Message-ID: <18A1B5E7-9329-4859-8BB6-671B0AF7ADA0@illinois.edu>

Greetings and Salutations Simon,

I just wanted to elevate this e-mail once more as I'm sure many of us would be willing to help; but, we're just not sure about the best way to go about it. If you could provide guidance, I'm sure we could more actively contribute in a positive way.

Sincerely,

JJB

?On 12/18/17, 12:02 AM, "R-SIG-Mac on behalf of Balamuta, James Joseph" <r-sig-mac-bounces at r-project.org on behalf of balamut2 at illinois.edu> wrote:

    Greetings and Salutations Simon,
    
    Thanks for the response. 
    
    > If you want to help, a good start would be to start contributing constructively.
    
    I have no issue with spending time to fix different issues. I?ve written at length about solutions to issues that have arisen in relation to compiled code with macOS and actively work to support community packages.
    
    However, I?m not sure how R/CRAN processes patches, bug tickets, or general help.
    
    c.f. macOS toolchain documentation bug
    
    https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=17331
    
    If you could answer a few quick questions for me, I?ll try to start making improvements:
    
    1. Is there a contributing document that describes the procedure regarding patch submission? 
    a. I assume this would govern: https://svn.r-project.org/R/ 
    2. If I wanted to update the macOS CRAN page, where is that repository? 
    3. To coordinate or propose changes before implementing them, is there a good place to post?
    
    
    Sincerely,
    
    JJB
    
    On 12/17/17, 11:40 PM, "Simon Urbanek" <r at dune.urbanek.info> wrote:
    
        Of course everything is a public repository (all of R and CRAN is) and you can always submit a patch - but very few people do. We can only address issues that are known. The toolchain is well documented as well both on the CRAN page as well as in the manuals. If you don't bother to read either, there is very little we can do about it. The Fortran compiler you refer to is still provided for the Mavericks builds which are only few months old. If anyone has suggestions for improvements, we're more than happy to accomodate them, but unfortunately no one has been willing to put the effort into it - idle complaints are of no help at all. If you want to help, a good start would be to start contributing constructively.
        
        Cheers,
        Simon
        
        
        
        > On 7/12/2017, at 6:21 AM, Balamuta, James Joseph <balamut2 at illinois.edu> wrote:
        > 
        > Greetings and Salutations All,
        > 
        > First off, I want to say I really appreciate all the work that goes into making R available on macOS. I realize that this is a time intensive process. However, this is now the second consecutive time the macOS binary release has lagged behind other platforms. As a result, would it be possible to add another maintainer? Even more so, could we please update the macOS section of CRAN to reflect the present status of the build? Some information is severely outdated. In particular, on the tools page, there still is a link to gfortran-4.2.3 ? which hasn?t been used since R 3.0.0 (?) --  and an installer for the custom compiler clang4 toolchain has yet to appear. If there is a public repository or a means to submit a patch to address these issues I would be more than happy to help since the current setup greatly impacts being able to introduce students to HPC and interfacing with external libraries. 
        > 
        > Sincerely,
        > 
        > JJB
        > 
        > On 12/6/17, 4:22 AM, "R-SIG-Mac on behalf of peter dalgaard" <r-sig-mac-bounces at r-project.org on behalf of pdalgd at gmail.com> wrote:
        > 
        >    I would guess that either Uwe/CRAN is swamped or Simon is traveling to NZ, or both... 
        > 
        >    -pd
        > 
        >> On 6 Dec 2017, at 10:26 , Federico Calboli <federico.calboli at helsinki.fi> wrote:
        >> 
        >> Hi All,
        >> 
        >> I know that I can get the latest and greatest binaries from http://r.research.att.com/ but I am puzzled why there are still no OSX R 3.4.3 binaries on CRAN.  The Windows installer has been up a few days already.  Is there anything I am missing concerning this delay?  
        >> 
        >> Cheers
        >> 
        >> F
        >> 
        >> _______________________________________________
        >> R-SIG-Mac mailing list
        >> R-SIG-Mac at r-project.org
        >> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
        > 
        >    -- 
        >    Peter Dalgaard, Professor,
        >    Center for Statistics, Copenhagen Business School
        >    Solbjerg Plads 3, 2000 Frederiksberg, Denmark
        >    Phone: (+45)38153501
        >    Office: A 4.23
        >    Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
        > 
        >    _______________________________________________
        >    R-SIG-Mac mailing list
        >    R-SIG-Mac at r-project.org
        >    https://stat.ethz.ch/mailman/listinfo/r-sig-mac
        > 
        > 
        > _______________________________________________
        > R-SIG-Mac mailing list
        > R-SIG-Mac at r-project.org
        > https://stat.ethz.ch/mailman/listinfo/r-sig-mac
        
        
    
    _______________________________________________
    R-SIG-Mac mailing list
    R-SIG-Mac at r-project.org
    https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From marc_grt at yahoo.fr  Wed Jan 31 11:22:49 2018
From: marc_grt at yahoo.fr (Marc Girondot)
Date: Wed, 31 Jan 2018 11:22:49 +0100
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel
Message-ID: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>

Dear Experts,

I use now r-3.5 devel as it is stable (from http://r.research.att.com , 
version (2018/01/30, r74185) ) but I have a problem with compilation of 
rJava package.

In short (all the explanations are bellow):

If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get 
this error: ld: library not found for -lomp

If I use clang from xcode, I get this error: clang: error: unsupported 
option '-fopenmp'

If I use clang 5.0.1, I get this error: ld: library not found for -lomp

Any idea to have rJava in r-devel ?

Thanks a lot

Marc



First I ran:

sudo R CMD javareconf

I have the Java version???? : 1.8.0_162

I need to compile it from source but it failed with clang4 reporting an 
error.

I try various origin of clang:

at the beginning of the compilation, it said:

checking for gcc... /usr/local/clang4/bin/clang

I tried several version of clang:

belinda:local marcgirondot$ 
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang 
--version
Apple LLVM version 9.0.0 (clang-900.0.39.2)
Target: x86_64-apple-darwin17.3.0
Thread model: posix
InstalledDir: 
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin

or (same version installed by: brew install llvm )

belinda:local marcgirondot$ 
/Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
clang version 5.0.1 (tags/RELEASE_501/final)
Target: x86_64-apple-darwin17.3.0
Thread model: posix
InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin

or

belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
clang version 4.0.0 (tags/RELEASE_400/final)
Target: x86_64-apple-darwin17.3.0
Thread model: posix
InstalledDir: /usr/local/clang4/bin

If I use the former, I get this error:
/usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework JavaVM 
-fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. 
-framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
ld: library not found for -lomp
clang-4.0: error: linker command failed with exit code 1 (use -v to see 
invocation)
make[2]: *** [libjri.jnilib] Error 1
make[1]: *** [src/JRI.jar] Error 2
make: *** [jri] Error 2
ERROR: compilation failed for package ?rJava?

Then I tried more recent versions:

I make a symbolic link to clang 5.0.1 or the one within xcode:
cd /usr/local
sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4

I get this error: (after running sudo R and within R: 
install.packages("rJava")
/usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework JavaVM 
-fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. 
-framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
ld: library not found for -lomp
clang-5.0: error: linker command failed with exit code 1 (use -v to see 
invocation)
make[2]: *** [libjri.jnilib] Error 1
make[1]: *** [src/JRI.jar] Error 2
make: *** [jri] Error 2
ERROR: compilation failed for package ?rJava?


If I make the symbolic link to
cd /usr/local
sudo ln -s 
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr 
clang4

I get this error: (after running sudo R and within R: 
install.packages("rJava")
/usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework JavaVM 
-fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. 
-framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
clang: error: unsupported option '-fopenmp'
make[2]: *** [libjri.jnilib] Error 1
make[1]: *** [src/JRI.jar] Error 2
make: *** [jri] Error 2
ERROR: compilation failed for package ?rJava?


From keith.ohara at nyu.edu  Wed Jan 31 11:38:14 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 31 Jan 2018 05:38:14 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel
In-Reply-To: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
Message-ID: <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>

Apple?s LLVM doesn?t support OpenMP, which explains the second error.

How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:

/opt/local/lib/libomp/libomp.dylib



> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
> 
> Dear Experts,
> 
> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
> 
> In short (all the explanations are bellow):
> 
> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
> 
> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
> 
> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
> 
> Any idea to have rJava in r-devel ?
> 
> Thanks a lot
> 
> Marc
> 
> 
> 
> First I ran:
> 
> sudo R CMD javareconf
> 
> I have the Java version     : 1.8.0_162
> 
> I need to compile it from source but it failed with clang4 reporting an error.
> 
> I try various origin of clang:
> 
> at the beginning of the compilation, it said:
> 
> checking for gcc... /usr/local/clang4/bin/clang
> 
> I tried several version of clang:
> 
> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
> Apple LLVM version 9.0.0 (clang-900.0.39.2)
> Target: x86_64-apple-darwin17.3.0
> Thread model: posix
> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
> 
> or (same version installed by: brew install llvm )
> 
> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
> clang version 5.0.1 (tags/RELEASE_501/final)
> Target: x86_64-apple-darwin17.3.0
> Thread model: posix
> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
> 
> or
> 
> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
> clang version 4.0.0 (tags/RELEASE_400/final)
> Target: x86_64-apple-darwin17.3.0
> Thread model: posix
> InstalledDir: /usr/local/clang4/bin
> 
> If I use the former, I get this error:
> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
> ld: library not found for -lomp
> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
> make[2]: *** [libjri.jnilib] Error 1
> make[1]: *** [src/JRI.jar] Error 2
> make: *** [jri] Error 2
> ERROR: compilation failed for package ?rJava?
> 
> Then I tried more recent versions:
> 
> I make a symbolic link to clang 5.0.1 or the one within xcode:
> cd /usr/local
> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
> 
> I get this error: (after running sudo R and within R: install.packages("rJava")
> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
> ld: library not found for -lomp
> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
> make[2]: *** [libjri.jnilib] Error 1
> make[1]: *** [src/JRI.jar] Error 2
> make: *** [jri] Error 2
> ERROR: compilation failed for package ?rJava?
> 
> 
> If I make the symbolic link to
> cd /usr/local
> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
> 
> I get this error: (after running sudo R and within R: install.packages("rJava")
> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
> clang: error: unsupported option '-fopenmp'
> make[2]: *** [libjri.jnilib] Error 1
> make[1]: *** [src/JRI.jar] Error 2
> make: *** [jri] Error 2
> ERROR: compilation failed for package ?rJava?
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From keith.ohara at nyu.edu  Wed Jan 31 11:52:02 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 31 Jan 2018 05:52:02 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel
In-Reply-To: <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
Message-ID: <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>

Sorry, ignore the installation question, I missed the ?brew install? line. 

Try adding a symbolic link from the brew install of libomp to /usr/local/lib.



> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
> 
> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
> 
> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
> 
> /opt/local/lib/libomp/libomp.dylib
> 
> 
> 
>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>> 
>> Dear Experts,
>> 
>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>> 
>> In short (all the explanations are bellow):
>> 
>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>> 
>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>> 
>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>> 
>> Any idea to have rJava in r-devel ?
>> 
>> Thanks a lot
>> 
>> Marc
>> 
>> 
>> 
>> First I ran:
>> 
>> sudo R CMD javareconf
>> 
>> I have the Java version     : 1.8.0_162
>> 
>> I need to compile it from source but it failed with clang4 reporting an error.
>> 
>> I try various origin of clang:
>> 
>> at the beginning of the compilation, it said:
>> 
>> checking for gcc... /usr/local/clang4/bin/clang
>> 
>> I tried several version of clang:
>> 
>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>> Target: x86_64-apple-darwin17.3.0
>> Thread model: posix
>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>> 
>> or (same version installed by: brew install llvm )
>> 
>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>> clang version 5.0.1 (tags/RELEASE_501/final)
>> Target: x86_64-apple-darwin17.3.0
>> Thread model: posix
>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>> 
>> or
>> 
>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>> clang version 4.0.0 (tags/RELEASE_400/final)
>> Target: x86_64-apple-darwin17.3.0
>> Thread model: posix
>> InstalledDir: /usr/local/clang4/bin
>> 
>> If I use the former, I get this error:
>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>> ld: library not found for -lomp
>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>> make[2]: *** [libjri.jnilib] Error 1
>> make[1]: *** [src/JRI.jar] Error 2
>> make: *** [jri] Error 2
>> ERROR: compilation failed for package ?rJava?
>> 
>> Then I tried more recent versions:
>> 
>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>> cd /usr/local
>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>> 
>> I get this error: (after running sudo R and within R: install.packages("rJava")
>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>> ld: library not found for -lomp
>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>> make[2]: *** [libjri.jnilib] Error 1
>> make[1]: *** [src/JRI.jar] Error 2
>> make: *** [jri] Error 2
>> ERROR: compilation failed for package ?rJava?
>> 
>> 
>> If I make the symbolic link to
>> cd /usr/local
>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>> 
>> I get this error: (after running sudo R and within R: install.packages("rJava")
>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>> clang: error: unsupported option '-fopenmp'
>> make[2]: *** [libjri.jnilib] Error 1
>> make[1]: *** [src/JRI.jar] Error 2
>> make: *** [jri] Error 2
>> ERROR: compilation failed for package ?rJava?
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From marc_grt at yahoo.fr  Wed Jan 31 14:03:52 2018
From: marc_grt at yahoo.fr (Marc Girondot)
Date: Wed, 31 Jan 2018 14:03:52 +0100
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [SOLVED]
In-Reply-To: <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
Message-ID: <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>

I have found a solution based on the proposition of Keith. Thanks a lot

############

First I have made some cleaning because I had pieces of clang in many 
places.

Then with a clean version I installed 
clang-4.0.0-darwin15.6-Release.tar.gz using the version in
http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz

Note that it produced an error at the end when I run the command:
sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
The error is:
tar: Error exit delayed from previous errors.

But it seems to be ok

then I create the link as propose by Keith:
cd /usr/local/lib
sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib

And it works perfectly if the install.packages("rJava") is ran as root: 
sudo R

######################

Now, let try with clang 5.0.1 from homebrew.

First I delete all tracks of previous installation of clang4:
sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
# I use this trick to enter the root password firsttime; after it does 
not ask within the loop
for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
 ?? sudo rm -f /$file;
done

# Remove empty _folders_ associated with the binary
for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
 ?? sudo rmdir -p /$file;
done

Then I install llvm with homebrew:
brew install llvm

in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib 
and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.

But I see one in:
/Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib

Better to use this one:
cd /usr/local/lib
sudo ln -s 
/Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib 
libomp.dylib


And the compilation ran correctly.

Thanks a lot !

Marc

Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit?:
> Sorry, ignore the installation question, I missed the ?brew install? line.
>
> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>
>
>
>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>
>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>
>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>
>> /opt/local/lib/libomp/libomp.dylib
>>
>>
>>
>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>
>>> Dear Experts,
>>>
>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>
>>> In short (all the explanations are bellow):
>>>
>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>
>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>
>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>
>>> Any idea to have rJava in r-devel ?
>>>
>>> Thanks a lot
>>>
>>> Marc
>>>
>>>
>>>
>>> First I ran:
>>>
>>> sudo R CMD javareconf
>>>
>>> I have the Java version     : 1.8.0_162
>>>
>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>
>>> I try various origin of clang:
>>>
>>> at the beginning of the compilation, it said:
>>>
>>> checking for gcc... /usr/local/clang4/bin/clang
>>>
>>> I tried several version of clang:
>>>
>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>> Target: x86_64-apple-darwin17.3.0
>>> Thread model: posix
>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>
>>> or (same version installed by: brew install llvm )
>>>
>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>> Target: x86_64-apple-darwin17.3.0
>>> Thread model: posix
>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>
>>> or
>>>
>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>> Target: x86_64-apple-darwin17.3.0
>>> Thread model: posix
>>> InstalledDir: /usr/local/clang4/bin
>>>
>>> If I use the former, I get this error:
>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>> ld: library not found for -lomp
>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>> make[2]: *** [libjri.jnilib] Error 1
>>> make[1]: *** [src/JRI.jar] Error 2
>>> make: *** [jri] Error 2
>>> ERROR: compilation failed for package ?rJava?
>>>
>>> Then I tried more recent versions:
>>>
>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>> cd /usr/local
>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>
>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>> ld: library not found for -lomp
>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>> make[2]: *** [libjri.jnilib] Error 1
>>> make[1]: *** [src/JRI.jar] Error 2
>>> make: *** [jri] Error 2
>>> ERROR: compilation failed for package ?rJava?
>>>
>>>
>>> If I make the symbolic link to
>>> cd /usr/local
>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>
>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>> clang: error: unsupported option '-fopenmp'
>>> make[2]: *** [libjri.jnilib] Error 1
>>> make[1]: *** [src/JRI.jar] Error 2
>>> make: *** [jri] Error 2
>>> ERROR: compilation failed for package ?rJava?
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From marc.girondot at u-psud.fr  Wed Jan 31 14:17:09 2018
From: marc.girondot at u-psud.fr (Marc Girondot)
Date: Wed, 31 Jan 2018 14:17:09 +0100
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
Message-ID: <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>

Sorry... bad news. It works only if R is ran as root. If R is ran as 
non-root user:

 > library(rJava)
Erreur : package or namespace load failed for ?rJava?:
 ?.onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
 ? appel : dyn.load(file, DLLpath = DLLpath, ...)
 ? erreur : impossible de charger l'objet partag? 
'/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 
6): Library not loaded: @rpath/libjvm.dylib
 ? Referenced from: 
/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
 ? Reason: image not found

I will continue to investigate.

Sorry for this wrong news !

Marc


Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit?:
> I have found a solution based on the proposition of Keith. Thanks a lot
>
> ############
>
> First I have made some cleaning because I had pieces of clang in many 
> places.
>
> Then with a clean version I installed 
> clang-4.0.0-darwin15.6-Release.tar.gz using the version in
> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>
> Note that it produced an error at the end when I run the command:
> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
> The error is:
> tar: Error exit delayed from previous errors.
>
> But it seems to be ok
>
> then I create the link as propose by Keith:
> cd /usr/local/lib
> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>
> And it works perfectly if the install.packages("rJava") is ran as 
> root: sudo R
>
> ######################
>
> Now, let try with clang 5.0.1 from homebrew.
>
> First I delete all tracks of previous installation of clang4:
> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
> # I use this trick to enter the root password firsttime; after it does 
> not ask within the loop
> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
> ?? sudo rm -f /$file;
> done
>
> # Remove empty _folders_ associated with the binary
> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
> ?? sudo rmdir -p /$file;
> done
>
> Then I install llvm with homebrew:
> brew install llvm
>
> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib 
> and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>
> But I see one in:
> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>
> Better to use this one:
> cd /usr/local/lib
> sudo ln -s 
> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib 
> libomp.dylib
>
>
> And the compilation ran correctly.
>
> Thanks a lot !
>
> Marc
>
> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit?:
>> Sorry, ignore the installation question, I missed the ?brew install? 
>> line.
>>
>> Try adding a symbolic link from the brew install of libomp to 
>> /usr/local/lib.
>>
>>
>>
>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>
>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>
>>> How did you install clang-5.0.1? If you installed using MacPorts, 
>>> then you might need to create a symbolic link to libomp in 
>>> /usr/local/lib. Check if the following exists:
>>>
>>> /opt/local/lib/libomp/libomp.dylib
>>>
>>>
>>>
>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac 
>>>> <r-sig-mac at r-project.org> wrote:
>>>>
>>>> Dear Experts,
>>>>
>>>> I use now r-3.5 devel as it is stable (from 
>>>> http://r.research.att.com , version (2018/01/30, r74185) ) but I 
>>>> have a problem with compilation of rJava package.
>>>>
>>>> In short (all the explanations are bellow):
>>>>
>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I 
>>>> get this error: ld: library not found for -lomp
>>>>
>>>> If I use clang from xcode, I get this error: clang: error: 
>>>> unsupported option '-fopenmp'
>>>>
>>>> If I use clang 5.0.1, I get this error: ld: library not found for 
>>>> -lomp
>>>>
>>>> Any idea to have rJava in r-devel ?
>>>>
>>>> Thanks a lot
>>>>
>>>> Marc
>>>>
>>>>
>>>>
>>>> First I ran:
>>>>
>>>> sudo R CMD javareconf
>>>>
>>>> I have the Java version???? : 1.8.0_162
>>>>
>>>> I need to compile it from source but it failed with clang4 
>>>> reporting an error.
>>>>
>>>> I try various origin of clang:
>>>>
>>>> at the beginning of the compilation, it said:
>>>>
>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>
>>>> I tried several version of clang:
>>>>
>>>> belinda:local marcgirondot$ 
>>>> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang 
>>>> --version
>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>> Target: x86_64-apple-darwin17.3.0
>>>> Thread model: posix
>>>> InstalledDir: 
>>>> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>
>>>> or (same version installed by: brew install llvm )
>>>>
>>>> belinda:local marcgirondot$ 
>>>> /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang 
>>>> --version
>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>> Target: x86_64-apple-darwin17.3.0
>>>> Thread model: posix
>>>> InstalledDir: 
>>>> /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>
>>>> or
>>>>
>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>> Target: x86_64-apple-darwin17.3.0
>>>> Thread model: posix
>>>> InstalledDir: /usr/local/clang4/bin
>>>>
>>>> If I use the former, I get this error:
>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
>>>> Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework 
>>>> JavaVM -fopenmp -L/usr/local/lib 
>>>> -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma 
>>>> -lbz2 -lz -licucore -lm -liconv
>>>> ld: library not found for -lomp
>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to 
>>>> see invocation)
>>>> make[2]: *** [libjri.jnilib] Error 1
>>>> make[1]: *** [src/JRI.jar] Error 2
>>>> make: *** [jri] Error 2
>>>> ERROR: compilation failed for package ?rJava?
>>>>
>>>> Then I tried more recent versions:
>>>>
>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>> cd /usr/local
>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin 
>>>> clang4
>>>>
>>>> I get this error: (after running sudo R and within R: 
>>>> install.packages("rJava")
>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
>>>> Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework 
>>>> JavaVM -fopenmp -L/usr/local/lib 
>>>> -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma 
>>>> -lbz2 -lz -licucore -lm -liconv
>>>> ld: library not found for -lomp
>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to 
>>>> see invocation)
>>>> make[2]: *** [libjri.jnilib] Error 1
>>>> make[1]: *** [src/JRI.jar] Error 2
>>>> make: *** [jri] Error 2
>>>> ERROR: compilation failed for package ?rJava?
>>>>
>>>>
>>>> If I make the symbolic link to
>>>> cd /usr/local
>>>> sudo ln -s 
>>>> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr 
>>>> clang4
>>>>
>>>> I get this error: (after running sudo R and within R: 
>>>> install.packages("rJava")
>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o 
>>>> Rcallbacks.o Rinit.o globals.o rjava.o? -dynamiclib -framework 
>>>> JavaVM -fopenmp -L/usr/local/lib 
>>>> -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma 
>>>> -lbz2 -lz -licucore -lm -liconv
>>>> clang: error: unsupported option '-fopenmp'
>>>> make[2]: *** [libjri.jnilib] Error 1
>>>> make[1]: *** [src/JRI.jar] Error 2
>>>> make: *** [jri] Error 2
>>>> ERROR: compilation failed for package ?rJava?
>>>>
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


-- 
__________________________________________________________
Marc Girondot, Pr

Laboratoire Ecologie, Syst?matique et Evolution
Equipe de Conservation des Populations et des Communaut?s
CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
B?timent 362
91405 Orsay Cedex, France

Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
e-mail: marc.girondot at u-psud.fr
Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
Skype: girondot


From keith.ohara at nyu.edu  Wed Jan 31 14:39:44 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 31 Jan 2018 08:39:44 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
Message-ID: <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>

Seems odd that R can?t find libjvm outside of sudo. 

From R, run

Sys.getenv()

and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib

> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
> 
> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
> 
> > library(rJava)
> Erreur : package or namespace load failed for ?rJava?:
>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>   Reason: image not found
> 
> I will continue to investigate.
> 
> Sorry for this wrong news !
> 
> Marc
> 
> 
> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>> I have found a solution based on the proposition of Keith. Thanks a lot
>> 
>> ############
>> 
>> First I have made some cleaning because I had pieces of clang in many places.
>> 
>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>> 
>> Note that it produced an error at the end when I run the command:
>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>> The error is:
>> tar: Error exit delayed from previous errors.
>> 
>> But it seems to be ok
>> 
>> then I create the link as propose by Keith:
>> cd /usr/local/lib
>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>> 
>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>> 
>> ######################
>> 
>> Now, let try with clang 5.0.1 from homebrew.
>> 
>> First I delete all tracks of previous installation of clang4:
>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>    sudo rm -f /$file;
>> done
>> 
>> # Remove empty _folders_ associated with the binary
>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>    sudo rmdir -p /$file;
>> done
>> 
>> Then I install llvm with homebrew:
>> brew install llvm
>> 
>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>> 
>> But I see one in:
>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>> 
>> Better to use this one:
>> cd /usr/local/lib
>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>> 
>> 
>> And the compilation ran correctly.
>> 
>> Thanks a lot !
>> 
>> Marc
>> 
>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>> 
>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>> 
>>> 
>>> 
>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>> 
>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>> 
>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>> 
>>>> /opt/local/lib/libomp/libomp.dylib
>>>> 
>>>> 
>>>> 
>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>> 
>>>>> Dear Experts,
>>>>> 
>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>> 
>>>>> In short (all the explanations are bellow):
>>>>> 
>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>> 
>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>> 
>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>> 
>>>>> Any idea to have rJava in r-devel ?
>>>>> 
>>>>> Thanks a lot
>>>>> 
>>>>> Marc
>>>>> 
>>>>> 
>>>>> 
>>>>> First I ran:
>>>>> 
>>>>> sudo R CMD javareconf
>>>>> 
>>>>> I have the Java version     : 1.8.0_162
>>>>> 
>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>> 
>>>>> I try various origin of clang:
>>>>> 
>>>>> at the beginning of the compilation, it said:
>>>>> 
>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>> 
>>>>> I tried several version of clang:
>>>>> 
>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>> Target: x86_64-apple-darwin17.3.0
>>>>> Thread model: posix
>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>> 
>>>>> or (same version installed by: brew install llvm )
>>>>> 
>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>> Target: x86_64-apple-darwin17.3.0
>>>>> Thread model: posix
>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>> 
>>>>> or
>>>>> 
>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>> Target: x86_64-apple-darwin17.3.0
>>>>> Thread model: posix
>>>>> InstalledDir: /usr/local/clang4/bin
>>>>> 
>>>>> If I use the former, I get this error:
>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>> ld: library not found for -lomp
>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>> make: *** [jri] Error 2
>>>>> ERROR: compilation failed for package ?rJava?
>>>>> 
>>>>> Then I tried more recent versions:
>>>>> 
>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>> cd /usr/local
>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>> 
>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>> ld: library not found for -lomp
>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>> make: *** [jri] Error 2
>>>>> ERROR: compilation failed for package ?rJava?
>>>>> 
>>>>> 
>>>>> If I make the symbolic link to
>>>>> cd /usr/local
>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>> 
>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>> clang: error: unsupported option '-fopenmp'
>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>> make: *** [jri] Error 2
>>>>> ERROR: compilation failed for package ?rJava?
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> -- 
> __________________________________________________________
> Marc Girondot, Pr
> 
> Laboratoire Ecologie, Syst?matique et Evolution
> Equipe de Conservation des Populations et des Communaut?s
> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
> B?timent 362
> 91405 Orsay Cedex, France
> 
> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
> e-mail: marc.girondot at u-psud.fr
> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
> Skype: girondot
> 


From marc.girondot at u-psud.fr  Wed Jan 31 16:52:44 2018
From: marc.girondot at u-psud.fr (Marc Girondot)
Date: Wed, 31 Jan 2018 16:52:44 +0100
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
 <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
Message-ID: <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>

Thanks for your help:

Here are some results; First in terminal:

belinda:~ marcgirondot$ locate libjvm.dylib
/Applications/Xcode.app/Contents/Applications/Application 
Loader.app/Contents/itms/java/lib/server/libjvm.dylib
/Library/Internet 
Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/server/libjvm.dylib
/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/libjvm.dylib
/Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/jre/lib/server/libjvm.dylib
/Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre/lib/server/libjvm.dylib
/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server/libjvm.dylib

Now in R as non-root:

 > Sys.getenv()
DYLD_FALLBACK_LIBRARY_PATH
/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/lib/server

The path of DYLD_FALLBACK_LIBRARY_PATH is wrong. This folder does not exist.

And in R as root
 > Sys.getenv()
DYLD_FALLBACK_LIBRARY_PATH
/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server

The path is correct

Strange... but no solution still

Marc


Le 31/01/2018 ? 14:39, Keith O'Hara a ?crit?:
> Seems odd that R can?t find libjvm outside of sudo.
>
>  From R, run
>
> Sys.getenv()
>
> and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib
>
>> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>
>> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
>>
>>> library(rJava)
>> Erreur : package or namespace load failed for ?rJava?:
>>   .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>>    appel : dyn.load(file, DLLpath = DLLpath, ...)
>>    erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>>    Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>>    Reason: image not found
>>
>> I will continue to investigate.
>>
>> Sorry for this wrong news !
>>
>> Marc
>>
>>
>> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>>> I have found a solution based on the proposition of Keith. Thanks a lot
>>>
>>> ############
>>>
>>> First I have made some cleaning because I had pieces of clang in many places.
>>>
>>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>>>
>>> Note that it produced an error at the end when I run the command:
>>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>>> The error is:
>>> tar: Error exit delayed from previous errors.
>>>
>>> But it seems to be ok
>>>
>>> then I create the link as propose by Keith:
>>> cd /usr/local/lib
>>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>>>
>>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>>>
>>> ######################
>>>
>>> Now, let try with clang 5.0.1 from homebrew.
>>>
>>> First I delete all tracks of previous installation of clang4:
>>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>     sudo rm -f /$file;
>>> done
>>>
>>> # Remove empty _folders_ associated with the binary
>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>     sudo rmdir -p /$file;
>>> done
>>>
>>> Then I install llvm with homebrew:
>>> brew install llvm
>>>
>>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>>>
>>> But I see one in:
>>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>>>
>>> Better to use this one:
>>> cd /usr/local/lib
>>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>>>
>>>
>>> And the compilation ran correctly.
>>>
>>> Thanks a lot !
>>>
>>> Marc
>>>
>>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>>>
>>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>>>
>>>>
>>>>
>>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>>>
>>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>>>
>>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>>>
>>>>> /opt/local/lib/libomp/libomp.dylib
>>>>>
>>>>>
>>>>>
>>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>
>>>>>> Dear Experts,
>>>>>>
>>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>>>
>>>>>> In short (all the explanations are bellow):
>>>>>>
>>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>>>
>>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>>>
>>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>>>
>>>>>> Any idea to have rJava in r-devel ?
>>>>>>
>>>>>> Thanks a lot
>>>>>>
>>>>>> Marc
>>>>>>
>>>>>>
>>>>>>
>>>>>> First I ran:
>>>>>>
>>>>>> sudo R CMD javareconf
>>>>>>
>>>>>> I have the Java version     : 1.8.0_162
>>>>>>
>>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>>>
>>>>>> I try various origin of clang:
>>>>>>
>>>>>> at the beginning of the compilation, it said:
>>>>>>
>>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>>>
>>>>>> I tried several version of clang:
>>>>>>
>>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>> Thread model: posix
>>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>>>
>>>>>> or (same version installed by: brew install llvm )
>>>>>>
>>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>> Thread model: posix
>>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>>>
>>>>>> or
>>>>>>
>>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>> Thread model: posix
>>>>>> InstalledDir: /usr/local/clang4/bin
>>>>>>
>>>>>> If I use the former, I get this error:
>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>> ld: library not found for -lomp
>>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>> make: *** [jri] Error 2
>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>
>>>>>> Then I tried more recent versions:
>>>>>>
>>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>>> cd /usr/local
>>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>>>
>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>> ld: library not found for -lomp
>>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>> make: *** [jri] Error 2
>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>
>>>>>>
>>>>>> If I make the symbolic link to
>>>>>> cd /usr/local
>>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>>>
>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>> clang: error: unsupported option '-fopenmp'
>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>> make: *** [jri] Error 2
>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-SIG-Mac mailing list
>>>>>> R-SIG-Mac at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>> -- 
>> __________________________________________________________
>> Marc Girondot, Pr
>>
>> Laboratoire Ecologie, Syst?matique et Evolution
>> Equipe de Conservation des Populations et des Communaut?s
>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>> B?timent 362
>> 91405 Orsay Cedex, France
>>
>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>> e-mail: marc.girondot at u-psud.fr
>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>> Skype: girondot
>>

-- 
__________________________________________________________
Marc Girondot, Pr

Laboratoire Ecologie, Syst?matique et Evolution
Equipe de Conservation des Populations et des Communaut?s
CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
B?timent 362
91405 Orsay Cedex, France

Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
e-mail: marc.girondot at u-psud.fr
Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
Skype: girondot


From simon.urbanek at R-project.org  Wed Jan 31 19:49:17 2018
From: simon.urbanek at R-project.org (Simon Urbanek)
Date: Wed, 31 Jan 2018 13:49:17 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
 <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
 <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>
Message-ID: <CEC95927-313A-4E4C-9C21-24D0E5F28E02@R-project.org>

It means that you are likely setting JAVA_HOME incorrectly in your user account. Don't set JAVA_HOME - you'll only likely break things by doing so.

Cheers,
Simon



> On Jan 31, 2018, at 10:52 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
> 
> Thanks for your help:
> 
> Here are some results; First in terminal:
> 
> belinda:~ marcgirondot$ locate libjvm.dylib
> /Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/itms/java/lib/server/libjvm.dylib
> /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/server/libjvm.dylib
> /Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/libjvm.dylib
> /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/jre/lib/server/libjvm.dylib
> /Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre/lib/server/libjvm.dylib
> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server/libjvm.dylib
> 
> Now in R as non-root:
> 
> > Sys.getenv()
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/lib/server
> 
> The path of DYLD_FALLBACK_LIBRARY_PATH is wrong. This folder does not exist.
> 
> And in R as root
> > Sys.getenv()
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> The path is correct
> 
> Strange... but no solution still
> 
> Marc
> 
> 
> Le 31/01/2018 ? 14:39, Keith O'Hara a ?crit :
>> Seems odd that R can?t find libjvm outside of sudo.
>> 
>> From R, run
>> 
>> Sys.getenv()
>> 
>> and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib
>> 
>>> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>> 
>>> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
>>> 
>>>> library(rJava)
>>> Erreur : package or namespace load failed for ?rJava?:
>>>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>>>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>>>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
>>> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>>>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>>>   Reason: image not found
>>> 
>>> I will continue to investigate.
>>> 
>>> Sorry for this wrong news !
>>> 
>>> Marc
>>> 
>>> 
>>> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>>>> I have found a solution based on the proposition of Keith. Thanks a lot
>>>> 
>>>> ############
>>>> 
>>>> First I have made some cleaning because I had pieces of clang in many places.
>>>> 
>>>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>>>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>>>> 
>>>> Note that it produced an error at the end when I run the command:
>>>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>>>> The error is:
>>>> tar: Error exit delayed from previous errors.
>>>> 
>>>> But it seems to be ok
>>>> 
>>>> then I create the link as propose by Keith:
>>>> cd /usr/local/lib
>>>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>>>> 
>>>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>>>> 
>>>> ######################
>>>> 
>>>> Now, let try with clang 5.0.1 from homebrew.
>>>> 
>>>> First I delete all tracks of previous installation of clang4:
>>>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>>>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>    sudo rm -f /$file;
>>>> done
>>>> 
>>>> # Remove empty _folders_ associated with the binary
>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>    sudo rmdir -p /$file;
>>>> done
>>>> 
>>>> Then I install llvm with homebrew:
>>>> brew install llvm
>>>> 
>>>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>>>> 
>>>> But I see one in:
>>>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>>>> 
>>>> Better to use this one:
>>>> cd /usr/local/lib
>>>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>>>> 
>>>> 
>>>> And the compilation ran correctly.
>>>> 
>>>> Thanks a lot !
>>>> 
>>>> Marc
>>>> 
>>>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>>>> 
>>>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>>>> 
>>>>> 
>>>>> 
>>>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>>>> 
>>>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>>>> 
>>>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>>>> 
>>>>>> /opt/local/lib/libomp/libomp.dylib
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>> 
>>>>>>> Dear Experts,
>>>>>>> 
>>>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>>>> 
>>>>>>> In short (all the explanations are bellow):
>>>>>>> 
>>>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>>>> 
>>>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>>>> 
>>>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>>>> 
>>>>>>> Any idea to have rJava in r-devel ?
>>>>>>> 
>>>>>>> Thanks a lot
>>>>>>> 
>>>>>>> Marc
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> First I ran:
>>>>>>> 
>>>>>>> sudo R CMD javareconf
>>>>>>> 
>>>>>>> I have the Java version     : 1.8.0_162
>>>>>>> 
>>>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>>>> 
>>>>>>> I try various origin of clang:
>>>>>>> 
>>>>>>> at the beginning of the compilation, it said:
>>>>>>> 
>>>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>>>> 
>>>>>>> I tried several version of clang:
>>>>>>> 
>>>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>> Thread model: posix
>>>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>>>> 
>>>>>>> or (same version installed by: brew install llvm )
>>>>>>> 
>>>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>> Thread model: posix
>>>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>>>> 
>>>>>>> or
>>>>>>> 
>>>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>> Thread model: posix
>>>>>>> InstalledDir: /usr/local/clang4/bin
>>>>>>> 
>>>>>>> If I use the former, I get this error:
>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>> ld: library not found for -lomp
>>>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>> make: *** [jri] Error 2
>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>> 
>>>>>>> Then I tried more recent versions:
>>>>>>> 
>>>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>>>> cd /usr/local
>>>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>>>> 
>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>> ld: library not found for -lomp
>>>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>> make: *** [jri] Error 2
>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>> 
>>>>>>> 
>>>>>>> If I make the symbolic link to
>>>>>>> cd /usr/local
>>>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>>>> 
>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>> clang: error: unsupported option '-fopenmp'
>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>> make: *** [jri] Error 2
>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Mac mailing list
>>>>>>> R-SIG-Mac at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>> 
>>> -- 
>>> __________________________________________________________
>>> Marc Girondot, Pr
>>> 
>>> Laboratoire Ecologie, Syst?matique et Evolution
>>> Equipe de Conservation des Populations et des Communaut?s
>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>> B?timent 362
>>> 91405 Orsay Cedex, France
>>> 
>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>> e-mail: marc.girondot at u-psud.fr
>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>> Skype: girondot
>>> 
> 
> -- 
> __________________________________________________________
> Marc Girondot, Pr
> 
> Laboratoire Ecologie, Syst?matique et Evolution
> Equipe de Conservation des Populations et des Communaut?s
> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
> B?timent 362
> 91405 Orsay Cedex, France
> 
> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
> e-mail: marc.girondot at u-psud.fr
> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
> Skype: girondot
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From marc.girondot at u-psud.fr  Wed Jan 31 20:48:55 2018
From: marc.girondot at u-psud.fr (Marc Girondot)
Date: Wed, 31 Jan 2018 20:48:55 +0100
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <CEC95927-313A-4E4C-9C21-24D0E5F28E02@R-project.org>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
 <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
 <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>
 <CEC95927-313A-4E4C-9C21-24D0E5F28E02@R-project.org>
Message-ID: <2f9d945a-3760-31c1-ac9e-d0b856987db2@u-psud.fr>

Hi Simon,

Half solution ! Thanks !

I remove JAVA_HOME and when R is ran as root or non-root in terminal, 
rJava package can be loaded. Great !

But in Rstudio, I have still a problem (see bellow).

Any suggestion ?

Thanks

Marc

 > library(rJava)
Erreur : package or namespace load failed for ?rJava?:
 ?.onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
 ? appel : dyn.load(file, DLLpath = DLLpath, ...)
 ? erreur : impossible de charger l'objet partag? 
'/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 
6): Library not loaded: @rpath/libjvm.dylib
 ? Referenced from: 
/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
 ? Reason: image not found


Here are the Sys.getenv() in the 3 cases (terminal R, root or not, and 
Rstudio):
Rstudio

DYLD_FALLBACK_LIBRARY_PATH
/Library/Frameworks/R.framework/Resources/lib:/Library/Frameworks/R.framework/Resources/lib:/Users/marcgirondot/lib:/usr/local/lib:/usr/lib::::
DYLD_LIBRARY_PATH
/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server

R (in terminal, non-root)

DYLD_FALLBACK_LIBRARY_PATH
/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server

R (in terminal, root)

DYLD_FALLBACK_LIBRARY_PATH
/Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server



Le 31/01/2018 ? 19:49, Simon Urbanek a ?crit?:
> It means that you are likely setting JAVA_HOME incorrectly in your user account. Don't set JAVA_HOME - you'll only likely break things by doing so.
>
> Cheers,
> Simon
>
>
>
>> On Jan 31, 2018, at 10:52 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>
>> Thanks for your help:
>>
>> Here are some results; First in terminal:
>>
>> belinda:~ marcgirondot$ locate libjvm.dylib
>> /Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/itms/java/lib/server/libjvm.dylib
>> /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/server/libjvm.dylib
>> /Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/libjvm.dylib
>> /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>> /Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>
>> Now in R as non-root:
>>
>>> Sys.getenv()
>> DYLD_FALLBACK_LIBRARY_PATH
>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/lib/server
>>
>> The path of DYLD_FALLBACK_LIBRARY_PATH is wrong. This folder does not exist.
>>
>> And in R as root
>>> Sys.getenv()
>> DYLD_FALLBACK_LIBRARY_PATH
>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
>>
>> The path is correct
>>
>> Strange... but no solution still
>>
>> Marc
>>
>>
>> Le 31/01/2018 ? 14:39, Keith O'Hara a ?crit :
>>> Seems odd that R can?t find libjvm outside of sudo.
>>>
>>>  From R, run
>>>
>>> Sys.getenv()
>>>
>>> and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib
>>>
>>>> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>>>
>>>> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
>>>>
>>>>> library(rJava)
>>>> Erreur : package or namespace load failed for ?rJava?:
>>>>   .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>>>>    appel : dyn.load(file, DLLpath = DLLpath, ...)
>>>>    erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
>>>> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>>>>    Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>>>>    Reason: image not found
>>>>
>>>> I will continue to investigate.
>>>>
>>>> Sorry for this wrong news !
>>>>
>>>> Marc
>>>>
>>>>
>>>> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>>>>> I have found a solution based on the proposition of Keith. Thanks a lot
>>>>>
>>>>> ############
>>>>>
>>>>> First I have made some cleaning because I had pieces of clang in many places.
>>>>>
>>>>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>>>>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>>>>>
>>>>> Note that it produced an error at the end when I run the command:
>>>>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>>>>> The error is:
>>>>> tar: Error exit delayed from previous errors.
>>>>>
>>>>> But it seems to be ok
>>>>>
>>>>> then I create the link as propose by Keith:
>>>>> cd /usr/local/lib
>>>>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>>>>>
>>>>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>>>>>
>>>>> ######################
>>>>>
>>>>> Now, let try with clang 5.0.1 from homebrew.
>>>>>
>>>>> First I delete all tracks of previous installation of clang4:
>>>>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>>>>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>     sudo rm -f /$file;
>>>>> done
>>>>>
>>>>> # Remove empty _folders_ associated with the binary
>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>     sudo rmdir -p /$file;
>>>>> done
>>>>>
>>>>> Then I install llvm with homebrew:
>>>>> brew install llvm
>>>>>
>>>>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>>>>>
>>>>> But I see one in:
>>>>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>>>>>
>>>>> Better to use this one:
>>>>> cd /usr/local/lib
>>>>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>>>>>
>>>>>
>>>>> And the compilation ran correctly.
>>>>>
>>>>> Thanks a lot !
>>>>>
>>>>> Marc
>>>>>
>>>>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>>>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>>>>>
>>>>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>>>>>
>>>>>>
>>>>>>
>>>>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>>>>>
>>>>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>>>>>
>>>>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>>>>>
>>>>>>> /opt/local/lib/libomp/libomp.dylib
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>>>
>>>>>>>> Dear Experts,
>>>>>>>>
>>>>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>>>>>
>>>>>>>> In short (all the explanations are bellow):
>>>>>>>>
>>>>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>>>>>
>>>>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>>>>>
>>>>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>>>>>
>>>>>>>> Any idea to have rJava in r-devel ?
>>>>>>>>
>>>>>>>> Thanks a lot
>>>>>>>>
>>>>>>>> Marc
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>> First I ran:
>>>>>>>>
>>>>>>>> sudo R CMD javareconf
>>>>>>>>
>>>>>>>> I have the Java version     : 1.8.0_162
>>>>>>>>
>>>>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>>>>>
>>>>>>>> I try various origin of clang:
>>>>>>>>
>>>>>>>> at the beginning of the compilation, it said:
>>>>>>>>
>>>>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>>>>>
>>>>>>>> I tried several version of clang:
>>>>>>>>
>>>>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>> Thread model: posix
>>>>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>>>>>
>>>>>>>> or (same version installed by: brew install llvm )
>>>>>>>>
>>>>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>> Thread model: posix
>>>>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>>>>>
>>>>>>>> or
>>>>>>>>
>>>>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>> Thread model: posix
>>>>>>>> InstalledDir: /usr/local/clang4/bin
>>>>>>>>
>>>>>>>> If I use the former, I get this error:
>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>> ld: library not found for -lomp
>>>>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>> make: *** [jri] Error 2
>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>
>>>>>>>> Then I tried more recent versions:
>>>>>>>>
>>>>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>>>>> cd /usr/local
>>>>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>>>>>
>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>> ld: library not found for -lomp
>>>>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>> make: *** [jri] Error 2
>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>
>>>>>>>>
>>>>>>>> If I make the symbolic link to
>>>>>>>> cd /usr/local
>>>>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>>>>>
>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>> clang: error: unsupported option '-fopenmp'
>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>> make: *** [jri] Error 2
>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Mac mailing list
>>>>>>>> R-SIG-Mac at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>> -- 
>>>> __________________________________________________________
>>>> Marc Girondot, Pr
>>>>
>>>> Laboratoire Ecologie, Syst?matique et Evolution
>>>> Equipe de Conservation des Populations et des Communaut?s
>>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>>> B?timent 362
>>>> 91405 Orsay Cedex, France
>>>>
>>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>>> e-mail: marc.girondot at u-psud.fr
>>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>>> Skype: girondot
>>>>
>> -- 
>> __________________________________________________________
>> Marc Girondot, Pr
>>
>> Laboratoire Ecologie, Syst?matique et Evolution
>> Equipe de Conservation des Populations et des Communaut?s
>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>> B?timent 362
>> 91405 Orsay Cedex, France
>>
>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>> e-mail: marc.girondot at u-psud.fr
>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>> Skype: girondot
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


-- 
__________________________________________________________
Marc Girondot, Pr

Laboratoire Ecologie, Syst?matique et Evolution
Equipe de Conservation des Populations et des Communaut?s
CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
B?timent 362
91405 Orsay Cedex, France

Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
e-mail: marc.girondot at u-psud.fr
Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
Skype: girondot


From keith.ohara at nyu.edu  Wed Jan 31 22:39:06 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 31 Jan 2018 16:39:06 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <2f9d945a-3760-31c1-ac9e-d0b856987db2@u-psud.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
 <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
 <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>
 <CEC95927-313A-4E4C-9C21-24D0E5F28E02@R-project.org>
 <2f9d945a-3760-31c1-ac9e-d0b856987db2@u-psud.fr>
Message-ID: <2FEDC7EA-601F-45DC-BE55-8794C14CDCBE@nyu.edu>

Looks like something is overriding R's ldpaths settings. (R_JAVA_LD_LIBRARY_PATH should be exported with DYLD_FALLBACK_LIBRARY_PATH.)

Do you have any old .Renviron files lying around? Particularly in your home directory (~)

> On Jan 31, 2018, at 2:48 PM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
> 
> Hi Simon,
> 
> Half solution ! Thanks !
> 
> I remove JAVA_HOME and when R is ran as root or non-root in terminal, rJava package can be loaded. Great !
> 
> But in Rstudio, I have still a problem (see bellow).
> 
> Any suggestion ?
> 
> Thanks
> 
> Marc
> 
> > library(rJava)
> Erreur : package or namespace load failed for ?rJava?:
>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>   Reason: image not found
> 
> 
> Here are the Sys.getenv() in the 3 cases (terminal R, root or not, and Rstudio):
> Rstudio
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Frameworks/R.framework/Resources/lib:/Users/marcgirondot/lib:/usr/local/lib:/usr/lib::::
> DYLD_LIBRARY_PATH
> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> R (in terminal, non-root)
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> R (in terminal, root)
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> 
> 
> Le 31/01/2018 ? 19:49, Simon Urbanek a ?crit :
>> It means that you are likely setting JAVA_HOME incorrectly in your user account. Don't set JAVA_HOME - you'll only likely break things by doing so.
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> On Jan 31, 2018, at 10:52 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>> 
>>> Thanks for your help:
>>> 
>>> Here are some results; First in terminal:
>>> 
>>> belinda:~ marcgirondot$ locate libjvm.dylib
>>> /Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/itms/java/lib/server/libjvm.dylib
>>> /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> 
>>> Now in R as non-root:
>>> 
>>>> Sys.getenv()
>>> DYLD_FALLBACK_LIBRARY_PATH
>>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/lib/server
>>> 
>>> The path of DYLD_FALLBACK_LIBRARY_PATH is wrong. This folder does not exist.
>>> 
>>> And in R as root
>>>> Sys.getenv()
>>> DYLD_FALLBACK_LIBRARY_PATH
>>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
>>> 
>>> The path is correct
>>> 
>>> Strange... but no solution still
>>> 
>>> Marc
>>> 
>>> 
>>> Le 31/01/2018 ? 14:39, Keith O'Hara a ?crit :
>>>> Seems odd that R can?t find libjvm outside of sudo.
>>>> 
>>>> From R, run
>>>> 
>>>> Sys.getenv()
>>>> 
>>>> and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib
>>>> 
>>>>> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>>>> 
>>>>> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
>>>>> 
>>>>>> library(rJava)
>>>>> Erreur : package or namespace load failed for ?rJava?:
>>>>>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>>>>>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>>>>>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
>>>>> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>>>>>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>>>>>   Reason: image not found
>>>>> 
>>>>> I will continue to investigate.
>>>>> 
>>>>> Sorry for this wrong news !
>>>>> 
>>>>> Marc
>>>>> 
>>>>> 
>>>>> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>>>>>> I have found a solution based on the proposition of Keith. Thanks a lot
>>>>>> 
>>>>>> ############
>>>>>> 
>>>>>> First I have made some cleaning because I had pieces of clang in many places.
>>>>>> 
>>>>>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>>>>>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>>>>>> 
>>>>>> Note that it produced an error at the end when I run the command:
>>>>>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>>>>>> The error is:
>>>>>> tar: Error exit delayed from previous errors.
>>>>>> 
>>>>>> But it seems to be ok
>>>>>> 
>>>>>> then I create the link as propose by Keith:
>>>>>> cd /usr/local/lib
>>>>>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>>>>>> 
>>>>>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>>>>>> 
>>>>>> ######################
>>>>>> 
>>>>>> Now, let try with clang 5.0.1 from homebrew.
>>>>>> 
>>>>>> First I delete all tracks of previous installation of clang4:
>>>>>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>>>>>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>>    sudo rm -f /$file;
>>>>>> done
>>>>>> 
>>>>>> # Remove empty _folders_ associated with the binary
>>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>>    sudo rmdir -p /$file;
>>>>>> done
>>>>>> 
>>>>>> Then I install llvm with homebrew:
>>>>>> brew install llvm
>>>>>> 
>>>>>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>>>>>> 
>>>>>> But I see one in:
>>>>>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>>>>>> 
>>>>>> Better to use this one:
>>>>>> cd /usr/local/lib
>>>>>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>>>>>> 
>>>>>> 
>>>>>> And the compilation ran correctly.
>>>>>> 
>>>>>> Thanks a lot !
>>>>>> 
>>>>>> Marc
>>>>>> 
>>>>>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>>>>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>>>>>> 
>>>>>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>>>>>> 
>>>>>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>>>>>> 
>>>>>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>>>>>> 
>>>>>>>> /opt/local/lib/libomp/libomp.dylib
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>>>> 
>>>>>>>>> Dear Experts,
>>>>>>>>> 
>>>>>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>>>>>> 
>>>>>>>>> In short (all the explanations are bellow):
>>>>>>>>> 
>>>>>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>>>>>> 
>>>>>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>>>>>> 
>>>>>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>>>>>> 
>>>>>>>>> Any idea to have rJava in r-devel ?
>>>>>>>>> 
>>>>>>>>> Thanks a lot
>>>>>>>>> 
>>>>>>>>> Marc
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> First I ran:
>>>>>>>>> 
>>>>>>>>> sudo R CMD javareconf
>>>>>>>>> 
>>>>>>>>> I have the Java version     : 1.8.0_162
>>>>>>>>> 
>>>>>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>>>>>> 
>>>>>>>>> I try various origin of clang:
>>>>>>>>> 
>>>>>>>>> at the beginning of the compilation, it said:
>>>>>>>>> 
>>>>>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>>>>>> 
>>>>>>>>> I tried several version of clang:
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>>>>>> 
>>>>>>>>> or (same version installed by: brew install llvm )
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>>>>>> 
>>>>>>>>> or
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /usr/local/clang4/bin
>>>>>>>>> 
>>>>>>>>> If I use the former, I get this error:
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> ld: library not found for -lomp
>>>>>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> Then I tried more recent versions:
>>>>>>>>> 
>>>>>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>>>>>> cd /usr/local
>>>>>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>>>>>> 
>>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> ld: library not found for -lomp
>>>>>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> If I make the symbolic link to
>>>>>>>>> cd /usr/local
>>>>>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>>>>>> 
>>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> clang: error: unsupported option '-fopenmp'
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> R-SIG-Mac mailing list
>>>>>>>>> R-SIG-Mac at r-project.org
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>> _______________________________________________
>>>>>> R-SIG-Mac mailing list
>>>>>> R-SIG-Mac at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>> -- 
>>>>> __________________________________________________________
>>>>> Marc Girondot, Pr
>>>>> 
>>>>> Laboratoire Ecologie, Syst?matique et Evolution
>>>>> Equipe de Conservation des Populations et des Communaut?s
>>>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>>>> B?timent 362
>>>>> 91405 Orsay Cedex, France
>>>>> 
>>>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>>>> e-mail: marc.girondot at u-psud.fr
>>>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>>>> Skype: girondot
>>>>> 
>>> -- 
>>> __________________________________________________________
>>> Marc Girondot, Pr
>>> 
>>> Laboratoire Ecologie, Syst?matique et Evolution
>>> Equipe de Conservation des Populations et des Communaut?s
>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>> B?timent 362
>>> 91405 Orsay Cedex, France
>>> 
>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>> e-mail: marc.girondot at u-psud.fr
>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>> Skype: girondot
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> -- 
> __________________________________________________________
> Marc Girondot, Pr
> 
> Laboratoire Ecologie, Syst?matique et Evolution
> Equipe de Conservation des Populations et des Communaut?s
> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
> B?timent 362
> 91405 Orsay Cedex, France
> 
> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
> e-mail: marc.girondot at u-psud.fr
> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
> Skype: girondot
> 


From simon.urbanek at r-project.org  Wed Jan 31 22:44:46 2018
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 31 Jan 2018 16:44:46 -0500
Subject: [R-SIG-Mac] rJava compilation on R 3.5 devel [NOt completely
 SOLVED]
In-Reply-To: <2f9d945a-3760-31c1-ac9e-d0b856987db2@u-psud.fr>
References: <655e6baf-da67-731b-62b6-c3de954fa897@yahoo.fr>
 <0E3FDCBC-ADA9-45C5-9BC5-FDE6D5AED11E@nyu.edu>
 <AE1074C5-2260-4C13-9203-E79327F6CADB@nyu.edu>
 <a6e5b062-ec70-afdb-4c74-27b5f4b60583@yahoo.fr>
 <462e1a64-3406-077a-cbcb-cff9ce90cde9@u-psud.fr>
 <EFE8F37B-9380-4822-951B-4485F813D620@nyu.edu>
 <57aed820-1f90-f8bb-859b-3b8299205c71@u-psud.fr>
 <CEC95927-313A-4E4C-9C21-24D0E5F28E02@R-project.org>
 <2f9d945a-3760-31c1-ac9e-d0b856987db2@u-psud.fr>
Message-ID: <F5066B84-BEFE-435E-8F7B-1231A240009B@r-project.org>

RStudio is not R, so you'll have ask ask their support how they pick up Java settings. As you can see they are not taking the correct settings from R so it may be a bug in RStudio.

Cheers,
Simon




> On Jan 31, 2018, at 2:48 PM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
> 
> Hi Simon,
> 
> Half solution ! Thanks !
> 
> I remove JAVA_HOME and when R is ran as root or non-root in terminal, rJava package can be loaded. Great !
> 
> But in Rstudio, I have still a problem (see bellow).
> 
> Any suggestion ?
> 
> Thanks
> 
> Marc
> 
> > library(rJava)
> Erreur : package or namespace load failed for ?rJava?:
>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>   Reason: image not found
> 
> 
> Here are the Sys.getenv() in the 3 cases (terminal R, root or not, and Rstudio):
> Rstudio
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Frameworks/R.framework/Resources/lib:/Users/marcgirondot/lib:/usr/local/lib:/usr/lib::::
> DYLD_LIBRARY_PATH
> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> R (in terminal, non-root)
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> R (in terminal, root)
> 
> DYLD_FALLBACK_LIBRARY_PATH
> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
> 
> 
> 
> Le 31/01/2018 ? 19:49, Simon Urbanek a ?crit :
>> It means that you are likely setting JAVA_HOME incorrectly in your user account. Don't set JAVA_HOME - you'll only likely break things by doing so.
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>>> On Jan 31, 2018, at 10:52 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>> 
>>> Thanks for your help:
>>> 
>>> Here are some results; First in terminal:
>>> 
>>> belinda:~ marcgirondot$ locate libjvm.dylib
>>> /Applications/Xcode.app/Contents/Applications/Application Loader.app/Contents/itms/java/lib/server/libjvm.dylib
>>> /Library/Internet Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Libraries/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_144.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> /Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server/libjvm.dylib
>>> 
>>> Now in R as non-root:
>>> 
>>>> Sys.getenv()
>>> DYLD_FALLBACK_LIBRARY_PATH
>>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/lib/server
>>> 
>>> The path of DYLD_FALLBACK_LIBRARY_PATH is wrong. This folder does not exist.
>>> 
>>> And in R as root
>>>> Sys.getenv()
>>> DYLD_FALLBACK_LIBRARY_PATH
>>> /Library/Frameworks/R.framework/Resources/lib:/Library/Java/JavaVirtualMachines/jdk1.8.0_162.jdk/Contents/Home/jre/lib/server
>>> 
>>> The path is correct
>>> 
>>> Strange... but no solution still
>>> 
>>> Marc
>>> 
>>> 
>>> Le 31/01/2018 ? 14:39, Keith O'Hara a ?crit :
>>>> Seems odd that R can?t find libjvm outside of sudo.
>>>> 
>>>> From R, run
>>>> 
>>>> Sys.getenv()
>>>> 
>>>> and check your DYLD_LIBRARY_PATH and DYLD_FALLBACK_LIBRARY_PATH variables. Should be ?[..]/Home/jre/lib/server? in there somewhere. Check those paths for libjvm.dylib
>>>> 
>>>>> On Jan 31, 2018, at 8:17 AM, Marc Girondot <marc.girondot at u-psud.fr> wrote:
>>>>> 
>>>>> Sorry... bad news. It works only if R is ran as root. If R is ran as non-root user:
>>>>> 
>>>>>> library(rJava)
>>>>> Erreur : package or namespace load failed for ?rJava?:
>>>>>  .onLoad a ?chou? dans loadNamespace() pour 'rJava', d?tails :
>>>>>   appel : dyn.load(file, DLLpath = DLLpath, ...)
>>>>>   erreur : impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so':
>>>>> dlopen(/Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so, 6): Library not loaded: @rpath/libjvm.dylib
>>>>>   Referenced from: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rJava/libs/rJava.so
>>>>>   Reason: image not found
>>>>> 
>>>>> I will continue to investigate.
>>>>> 
>>>>> Sorry for this wrong news !
>>>>> 
>>>>> Marc
>>>>> 
>>>>> 
>>>>> Le 31/01/2018 ? 14:03, Marc Girondot via R-SIG-Mac a ?crit :
>>>>>> I have found a solution based on the proposition of Keith. Thanks a lot
>>>>>> 
>>>>>> ############
>>>>>> 
>>>>>> First I have made some cleaning because I had pieces of clang in many places.
>>>>>> 
>>>>>> Then with a clean version I installed clang-4.0.0-darwin15.6-Release.tar.gz using the version in
>>>>>> http://r.research.att.com/libs/clang-4.0.0-darwin15.6-Release.tar.gz
>>>>>> 
>>>>>> Note that it produced an error at the end when I run the command:
>>>>>> sudo tar xvzf clang-4.0.0-darwin15.6-Release.tar.gz -C /
>>>>>> The error is:
>>>>>> tar: Error exit delayed from previous errors.
>>>>>> 
>>>>>> But it seems to be ok
>>>>>> 
>>>>>> then I create the link as propose by Keith:
>>>>>> cd /usr/local/lib
>>>>>> sudo ln -s /usr/local/clang4/lib/libomp.dylib libomp.dylib
>>>>>> 
>>>>>> And it works perfectly if the install.packages("rJava") is ran as root: sudo R
>>>>>> 
>>>>>> ######################
>>>>>> 
>>>>>> Now, let try with clang 5.0.1 from homebrew.
>>>>>> 
>>>>>> First I delete all tracks of previous installation of clang4:
>>>>>> sudo cd <folder where is clang-4.0.0-darwin15.6-Release.tar.gz)>
>>>>>> # I use this trick to enter the root password firsttime; after it does not ask within the loop
>>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>>    sudo rm -f /$file;
>>>>>> done
>>>>>> 
>>>>>> # Remove empty _folders_ associated with the binary
>>>>>> for file in $(tar tfz clang-4.0.0-darwin15.6-Release.tar.gz); do
>>>>>>    sudo rmdir -p /$file;
>>>>>> done
>>>>>> 
>>>>>> Then I install llvm with homebrew:
>>>>>> brew install llvm
>>>>>> 
>>>>>> in /usr/local/opt/llvm/lib there is no libomp.dylib but libgomp.dylib and libiomp5.dylib. I don't know if I can use it instead of libomp.dylib.
>>>>>> 
>>>>>> But I see one in:
>>>>>> /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib
>>>>>> 
>>>>>> Better to use this one:
>>>>>> cd /usr/local/lib
>>>>>> sudo ln -s /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libomp.dylib libomp.dylib
>>>>>> 
>>>>>> 
>>>>>> And the compilation ran correctly.
>>>>>> 
>>>>>> Thanks a lot !
>>>>>> 
>>>>>> Marc
>>>>>> 
>>>>>> Le 31/01/2018 ? 11:52, Keith O'Hara a ?crit :
>>>>>>> Sorry, ignore the installation question, I missed the ?brew install? line.
>>>>>>> 
>>>>>>> Try adding a symbolic link from the brew install of libomp to /usr/local/lib.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>>> On Jan 31, 2018, at 5:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>>>>>>>> 
>>>>>>>> Apple?s LLVM doesn?t support OpenMP, which explains the second error.
>>>>>>>> 
>>>>>>>> How did you install clang-5.0.1? If you installed using MacPorts, then you might need to create a symbolic link to libomp in /usr/local/lib. Check if the following exists:
>>>>>>>> 
>>>>>>>> /opt/local/lib/libomp/libomp.dylib
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>>> On Jan 31, 2018, at 5:22 AM, Marc Girondot via R-SIG-Mac <r-sig-mac at r-project.org> wrote:
>>>>>>>>> 
>>>>>>>>> Dear Experts,
>>>>>>>>> 
>>>>>>>>> I use now r-3.5 devel as it is stable (from http://r.research.att.com , version (2018/01/30, r74185) ) but I have a problem with compilation of rJava package.
>>>>>>>>> 
>>>>>>>>> In short (all the explanations are bellow):
>>>>>>>>> 
>>>>>>>>> If I use clang 4.0.0 from here: http://r.research.att.com/libs/, I get this error: ld: library not found for -lomp
>>>>>>>>> 
>>>>>>>>> If I use clang from xcode, I get this error: clang: error: unsupported option '-fopenmp'
>>>>>>>>> 
>>>>>>>>> If I use clang 5.0.1, I get this error: ld: library not found for -lomp
>>>>>>>>> 
>>>>>>>>> Any idea to have rJava in r-devel ?
>>>>>>>>> 
>>>>>>>>> Thanks a lot
>>>>>>>>> 
>>>>>>>>> Marc
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> First I ran:
>>>>>>>>> 
>>>>>>>>> sudo R CMD javareconf
>>>>>>>>> 
>>>>>>>>> I have the Java version     : 1.8.0_162
>>>>>>>>> 
>>>>>>>>> I need to compile it from source but it failed with clang4 reporting an error.
>>>>>>>>> 
>>>>>>>>> I try various origin of clang:
>>>>>>>>> 
>>>>>>>>> at the beginning of the compilation, it said:
>>>>>>>>> 
>>>>>>>>> checking for gcc... /usr/local/clang4/bin/clang
>>>>>>>>> 
>>>>>>>>> I tried several version of clang:
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version
>>>>>>>>> Apple LLVM version 9.0.0 (clang-900.0.39.2)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
>>>>>>>>> 
>>>>>>>>> or (same version installed by: brew install llvm )
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin/clang --version
>>>>>>>>> clang version 5.0.1 (tags/RELEASE_501/final)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin/bin
>>>>>>>>> 
>>>>>>>>> or
>>>>>>>>> 
>>>>>>>>> belinda:local marcgirondot$ /usr/local/clang4/bin/clang --version
>>>>>>>>> clang version 4.0.0 (tags/RELEASE_400/final)
>>>>>>>>> Target: x86_64-apple-darwin17.3.0
>>>>>>>>> Thread model: posix
>>>>>>>>> InstalledDir: /usr/local/clang4/bin
>>>>>>>>> 
>>>>>>>>> If I use the former, I get this error:
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> ld: library not found for -lomp
>>>>>>>>> clang-4.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> Then I tried more recent versions:
>>>>>>>>> 
>>>>>>>>> I make a symbolic link to clang 5.0.1 or the one within xcode:
>>>>>>>>> cd /usr/local
>>>>>>>>> sudo ln -s /Applications/clang+llvm-5.0.1-final-x86_64-apple-darwin clang4
>>>>>>>>> 
>>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> ld: library not found for -lomp
>>>>>>>>> clang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> If I make the symbolic link to
>>>>>>>>> cd /usr/local
>>>>>>>>> sudo ln -s /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr clang4
>>>>>>>>> 
>>>>>>>>> I get this error: (after running sudo R and within R: install.packages("rJava")
>>>>>>>>> /usr/local/clang4/bin/clang -o libjri.jnilib Rengine.o jri.o Rcallbacks.o Rinit.o globals.o rjava.o  -dynamiclib -framework JavaVM -fopenmp -L/usr/local/lib -F/Library/Frameworks/R.framework/.. -framework R -lpcre -llzma -lbz2 -lz -licucore -lm -liconv
>>>>>>>>> clang: error: unsupported option '-fopenmp'
>>>>>>>>> make[2]: *** [libjri.jnilib] Error 1
>>>>>>>>> make[1]: *** [src/JRI.jar] Error 2
>>>>>>>>> make: *** [jri] Error 2
>>>>>>>>> ERROR: compilation failed for package ?rJava?
>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> R-SIG-Mac mailing list
>>>>>>>>> R-SIG-Mac at r-project.org
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>>> _______________________________________________
>>>>>> R-SIG-Mac mailing list
>>>>>> R-SIG-Mac at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>>> -- 
>>>>> __________________________________________________________
>>>>> Marc Girondot, Pr
>>>>> 
>>>>> Laboratoire Ecologie, Syst?matique et Evolution
>>>>> Equipe de Conservation des Populations et des Communaut?s
>>>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>>>> B?timent 362
>>>>> 91405 Orsay Cedex, France
>>>>> 
>>>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>>>> e-mail: marc.girondot at u-psud.fr
>>>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>>>> Skype: girondot
>>>>> 
>>> -- 
>>> __________________________________________________________
>>> Marc Girondot, Pr
>>> 
>>> Laboratoire Ecologie, Syst?matique et Evolution
>>> Equipe de Conservation des Populations et des Communaut?s
>>> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
>>> B?timent 362
>>> 91405 Orsay Cedex, France
>>> 
>>> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
>>> e-mail: marc.girondot at u-psud.fr
>>> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
>>> Skype: girondot
>>> 
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> 
> -- 
> __________________________________________________________
> Marc Girondot, Pr
> 
> Laboratoire Ecologie, Syst?matique et Evolution
> Equipe de Conservation des Populations et des Communaut?s
> CNRS, AgroParisTech et Universit? Paris-Sud 11 , UMR 8079
> B?timent 362
> 91405 Orsay Cedex, France
> 
> Tel:  33 1 (0)1.69.15.72.30   Fax: 33 1 (0)1.69.15.73.53
> e-mail: marc.girondot at u-psud.fr
> Web: http://www.ese.u-psud.fr/epc/conservation/Marc.html
> Skype: girondot
> 


From wccsnow at gmail.com  Thu Jan 18 02:00:42 2018
From: wccsnow at gmail.com (Wei-Chen Chen)
Date: Thu, 18 Jan 2018 01:00:42 -0000
Subject: [R-SIG-Mac] Need an appropriate way for setting rpath.
Message-ID: <CAB2DcasNSg=JkYLqK0QDxV6Vaki_EOON=vW3ad1LTphnSc8hNA@mail.gmail.com>

Dear List Members,

I know linking with other shared library in mac may be tricky, but I think
it may save some space and worth a try.

The messages below are from a CRAN check recently from "
https://www.r-project.org/nosvn/R.check/r-release-osx-x86_64/JuniperKernel-00install.txt".
It obtained the correct paths (to libzmq.5.dylib) from a package pbdZMQ,
then set them for compiling and linking to the target package
JuniperKernel. However, the results before "install_name_tool" showed that
the path to the shared library is not what it said at linking time.
Therefore, later on at the run time the dyn.load() will not be able to find
the shared library.

The questions are:
1) How did this happen?
2) What path and what clang flags I should use in this case?
3) Is there an easy way to resolve this issue? (e.g. Would it work by
adding pbdZMQ to the "Depends:"?)

Sincerely,
Wei-Chen Chen


* installing *source* package ???JuniperKernel??? ...
** package ???JuniperKernel??? successfully unpacked and MD5 sums checked

************** Results of JuniperKernel package configure **************

>> RSCRIPT = /Library/Frameworks/R.framework/Resources/bin/Rscript
>> PBD_ZMQ = /Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ
>> ZMQ_CPPFLAGS = -I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
>> ZMQ_LDFLAGS = -L"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs" -lzmq.5

************************************************************************

** libs
clang++ -std=gnu++11
-I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
-I../inst/include/ -I.
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
-I/usr/local/include   -fPIC  -Wall -g -O2 -c RcppExports.cpp -o
RcppExports.o
clang++ -std=gnu++11
-I/Library/Frameworks/R.framework/Resources/include -DNDEBUG
-I../inst/include/ -I.
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/zmq/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/Rcpp/include"
-I"/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/gdtools/include"
-I/usr/local/include   -fPIC  -Wall -g -O2 -c juniper.cpp -o juniper.o
clang++ -std=gnu++11 -dynamiclib -Wl,-headerpad_max_install_names
-undefined dynamic_lookup -single_module -multiply_defined suppress
-L/Library/Frameworks/R.framework/Resources/lib -L/usr/local/lib -o
JuniperKernel.so RcppExports.o juniper.o
-L/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/Rlib/3.4/pbdZMQ/libs
-lzmq.5 -F/Library/Frameworks/R.framework/.. -framework R
-Wl,-framework -Wl,CoreFoundation
installing via 'install.libs.R' to
/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel

Before install_name_tool (in install.libs.R):
[1] "/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so:"
[2] "\tJuniperKernel.so (compatibility version 0.0.0, current version
0.0.0)"
[3] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
(compatibility version 7.0.0, current version 7.2.0)"
[4] "\t/Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libR.dylib
(compatibility version 3.4.0, current version 3.4.3)"
[5] "\t/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
(compatibility version 150.0.0, current version 1259.11.0)"
[6] "\t/usr/local/clang4/lib/libc++.1.dylib (compatibility version
1.0.0, current version 1.0.0)"
[7] "\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0,
current version 1226.10.1)"
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded
Error: package or namespace load failed for ???JuniperKernel??? in
dyn.load(file, DLLpath = DLLpath, ...):
 unable to load shared object
'/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so':
  dlopen(/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so,
6): Library not loaded:
/Library/Frameworks/R.framework/Versions/3.4/Resources/library/pbdZMQ/libs/libzmq.5.dylib
  Referenced from:
/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel/libs/JuniperKernel.so
  Reason: image not found
Error: loading failed
Execution halted
ERROR: loading failed
* removing ???/Volumes/SSD-Data/Builds/R-dev-web/QA/Simon/packages/el-capitan-x86_64/results/3.4/JuniperKernel.Rcheck/JuniperKernel???

	[[alternative HTML version deleted]]


From gulotty at uchicago.edu  Wed Jan 24 17:21:12 2018
From: gulotty at uchicago.edu (Robert Gulotty)
Date: Wed, 24 Jan 2018 16:21:12 -0000
Subject: [R-SIG-Mac] R App crashes when opening files,
 navigating within open file pane
Message-ID: <6E4B84D5-23E8-4A1A-956C-337CC8A67396@uchicago.edu>

Hello,

I am using macOS High Sierra, 10.13.2 (17C205)  with R.App GUI 1.70 (7463) x86_64-apple-darwin15.6.0  R version 3.4.3

R hangs when I try to open a .R script in finder, even if R has been running.  It also hangs every time I use the File Open menu to select a file.  It either crashes when I try to navigate from folder to folder within the open file interface, or upon selecting a file.   This has been the case for several updates of macOS, and through several versions of R and across two computers.  I have uninstalled and reinstalled the R app, R, and the various suggested tools for Mac OSX.

R studio does not exhibit this behavior/

-Robert Gulotty

