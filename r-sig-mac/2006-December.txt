From 947herby at mail.ee  Sat Dec  2 17:57:57 2006
From: 947herby at mail.ee ((270) 818-7244 Krista )
Date: Sat, 2 Dec 2006 18:57:57 +0200
Subject: [R-SIG-Mac] Get your Dpiloma {}fast and easy today!
Message-ID: <48259113578025.EC13DB0625@8GUI>

In just 2 years you can have a masters degree from a nationalu niversity. 
A better job, more income and a better life can all be yours in just 2 years. 


No books to buy, no classes to go to, and no entrance exams. 

Learn in your own home ta your own pace. We supply all the study materials, all you have to do is study and complete 2 tests per month. 

Telephone Us Anytime +1   (270) 818-7244
Online Now

-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=







arrows and now he would watch them die in the marshes outside Carrhae,Offered  to  fall on his sword, though his hand was shaking the way itthe  wreck  of his armies. Rufus's deep rumble set about disposing thedrew  in  his  cheeks,  making  a  sucking  sound.  Amazing anyone hadarchers  to  run  out  of  arrows. When such flights grew sparser, thedogs,  he thought, as curs fight on the paving stones, who fought over


From w.northcott at unsw.edu.au  Mon Dec  4 10:42:49 2006
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Mon, 4 Dec 2006 20:42:49 +1100
Subject: [R-SIG-Mac] Building R-2.4 on MacOS X
In-Reply-To: <mailman.7.1138532402.23395.r-sig-mac@stat.math.ethz.ch>
References: <mailman.7.1138532402.23395.r-sig-mac@stat.math.ethz.ch>
Message-ID: <8FD41C66-66AE-40CA-9466-F946E9CB9F8E@unsw.edu.au>

I am helping Martyn Plummer to keep JAGS running on MacOS X.  For  
those who don't know, JAGS is an MCMC package which reproduces most  
of the functionality of BUGS.  It is written in C++ and uses the  
standalone libRmath.  The intention is that at some point it will  
become an R package.

As part of my effort to correct the build problems of JAGS when using  
R-2.4.0 I have been making universal builds of R-2.4.0 from source  
with MacOS X 10.4.8 and Xcode 2.4.1.  I am using the grfortran  
compiler included in the CRAN binary.  I have a number of questions  
from these.

1.  The CRAN binary contains a library libBlasVeclib.dylib.   
Following the build method in 'The MacOS X R FAQ' this library is not  
built.  What is the library for and would it be worth building?

2.  I am not happy putting the R compiler directory (/usr/local/ 
gcc4.0/bin) up the front of the path because it effectively replaces  
the default gcc and g++.  I have made the builds by setting F77=/usr/ 
local/gcc4.0/bin/gfortran and letting the Apple compilers do the C  
and C++ code.  The resulting binaries pass 'make check-all' on both  
ppc and i386 with no failures.  Is there any point using the R  
supplied gcc and g++?

3.  Building JAGS we often have problems at the linking stage with  
many multiply defined symbols.  These are due to libtool including  
libraries (libgcc_s and libSystem) which are already included by the  
system.  I submitted a patch suggestion to the autoconf maintainers  
to get rid of these problems by similar methods to that used for  
libcrt*.  These have been accepted and are in the autoconf cvs  
sources but not yet released.
m4/R.m4 line 826 includes an exclusion which implements the changes  
to exclude libcrt* which are now implemented in released versions of  
autoconf.  The upcoming changes to exclude libgcc* and libSystem can  
be implemented by adding '| -lgcc* | -lSystem' to the above  
referenced line.  ( of course one needs to run 'aclocal -I m4' and  
autoconf after the change)  My binary is built with this change and  
it works without problem.

Thanks for any help
Bill Northcott


From bourgon at ebi.ac.uk  Mon Dec  4 12:56:43 2006
From: bourgon at ebi.ac.uk (Richard Bourgon)
Date: Mon, 4 Dec 2006 11:56:43 +0000
Subject: [R-SIG-Mac] system() from R.app
In-Reply-To: <B38D756A-1233-497F-A4D5-FEBB582210D3@unimi.it>
References: <99F44D6A-8EFD-45A6-869B-439AC34DAC37@unive.it>
	<B38D756A-1233-497F-A4D5-FEBB582210D3@unimi.it>
Message-ID: <FF59DE78-0713-4F4D-9625-819E7F5B303A@ebi.ac.uk>

You can set environmental variables which GUI apps, including R.app,  
will see in

   ~/.MacOSX/environment.plist

(Create the directory and file if they don't already exist.)

- R

On 30 Nov 2006, at 09:15, stefano iacus wrote:

> Nicola,
> yes, R.app does not have the same env vars sets of the shell. This,
> indeed, applies to all GUI app under OS X. It is possible to set env
> vars at OS X level. There is a plist file somewhere. I don't remember
> the details because I never use it.
>
> In your case latex is not the the current path used by R.app
>
> You can check it using
> path <- Sys.getenv("PATH")
> path
>
> in my case latex is under /usr/local/teTeX/bin/powerpc-apple-darwin-
> current (a "which latex" or env in the shell will tell) so
>
> new.path <- paste(path,":/usr/local/teTeX/bin/powerpc-apple-darwin-
> current", sep="")
>
> and add latex path using
>
> Sys.putenv("PATH"= new.path)
> now latex should work.
>
>
> stefano
>
>
> On 30/nov/06, at 17:58, nicola sartori wrote:
>
>> Dear all,
>>
>> I have a question on the use of system(command) from R.app:
>> if I try, for instance, to do:
>>
>> system("latex foo.tex")
>>
>> I get the following output in the console:
>>
>> /bin/sh: line 1: latex: command not found
>>
>> While if I do the same thing running R from the terminal (or xterm
>> under X11) it works just fine.
>> I guess the reason is that, when in the terminal, the path is set by
>> my shell init file (which, incidentally, is bash) while this doesn't
>> happen when in R.app.
>> By the way, running latex is not a big issue: I can get the right
>> path from options(), but for other commands the problem will still be
>> there
>>
>> Is there a workaround for this?
>>
>> Thanks in advance for any help.
>>
>> Best,
>> Nicola
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Mon Dec  4 16:43:05 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 4 Dec 2006 10:43:05 -0500
Subject: [R-SIG-Mac] Building R-2.4 on MacOS X
In-Reply-To: <8FD41C66-66AE-40CA-9466-F946E9CB9F8E@unsw.edu.au>
References: <mailman.7.1138532402.23395.r-sig-mac@stat.math.ethz.ch>
	<8FD41C66-66AE-40CA-9466-F946E9CB9F8E@unsw.edu.au>
Message-ID: <21D22D86-BDF1-485C-8009-4EB6E878A0C9@r-project.org>

Bill,

On Dec 4, 2006, at 4:42 AM, Bill Northcott wrote:

> I am helping Martyn Plummer to keep JAGS running on MacOS X.  For
> [...]
> 1.  The CRAN binary contains a library libBlasVeclib.dylib.
> Following the build method in 'The MacOS X R FAQ' this library is  
> not built.  What is the library for and would it be worth building?
>

R can be configured to use various BLAS implementations. One of  
changes in 2.4.0 is that this can be done by switching libRblas.dylib  
(e.g. via softlink). The CRAN binary comes with two BLAS  
implementations - one using vecLib (libRblas.vecLib.dylib) and the  
internal R one (libRblas.0.dylib). They have been produced in two  
separate builds. This is equivalent to configuring R with --with- 
blas='-framework vecLib' and --without-blas respectively. The  
libRblas.dylib is a symlink which can be changed depending on which  
implementation you want to use.


> 2.  I am not happy putting the R compiler directory (/usr/local/   
> gcc4.0/bin) up the front of the path because it effectively  
> replaces  the default gcc and g++.

That was the point, actually. All Apple versions of gcc up to most  
recent Xcode update had a serious bug that was producing invalid code  
- trashing the stack and leading to segfaults (on Intel Macs).


>   I have made the builds by setting F77=/usr/local/gcc4.0/bin/ 
> gfortran and letting the Apple compilers do the C and C++ code.   
> The resulting binaries pass 'make check-all' on both ppc and i386  
> with no failures.  Is there any point using the R supplied gcc and g 
> ++?
>

See above. Xcode 2.4.1 seems to have fixed that bug, so it should be  
possible to use the Apple compiler now. However, note that its ABI is  
incompatible with the FSF 4.0.3 version, so you won't be able to use  
any binary CRAN packages. For R 2.5.0 we should be (hopefully) able  
to switch back to Apple gcc, but given that Xcode 2.4.1 is not the  
default (and it's binary-incompatible), we can't do it yet.


> 3.  Building JAGS we often have problems at the linking stage with  
> many multiply defined symbols.  These are due to libtool including  
> libraries (libgcc_s and libSystem) which are already included by  
> the system.  I submitted a patch suggestion to the autoconf  
> maintainers to get rid of these problems by similar methods to that  
> used for libcrt*.  These have been accepted and are in the autoconf  
> cvs sources but not yet released.
> m4/R.m4 line 826 includes an exclusion which implements the changes  
> to exclude libcrt* which are now implemented in released versions  
> of autoconf.  The upcoming changes to exclude libgcc* and libSystem  
> can be implemented by adding '| -lgcc* | -lSystem' to the above  
> referenced line.  ( of course one needs to run 'aclocal -I m4' and  
> autoconf after the change)  My binary is built with this change and  
> it works without problem.
>

Thanks, I'll have a look.

Cheers,
Simon


From w.northcott at unsw.edu.au  Mon Dec  4 23:21:01 2006
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Tue, 5 Dec 2006 09:21:01 +1100
Subject: [R-SIG-Mac] Building R-2.4 on MacOS X
In-Reply-To: <21D22D86-BDF1-485C-8009-4EB6E878A0C9@r-project.org>
References: <mailman.7.1138532402.23395.r-sig-mac@stat.math.ethz.ch>
	<8FD41C66-66AE-40CA-9466-F946E9CB9F8E@unsw.edu.au>
	<21D22D86-BDF1-485C-8009-4EB6E878A0C9@r-project.org>
Message-ID: <0CC753BF-FF1E-483E-A56A-2C036E97DFBE@unsw.edu.au>

On 05/12/2006, at 2:43 AM, Simon Urbanek wrote:
>> 1.  The CRAN binary contains a library libBlasVeclib.dylib.
>> Following the build method in 'The MacOS X R FAQ' this library is  
>> not built.  What is the library for and would it be worth building?
>>
>
> R can be configured to use various BLAS implementations. One of  
> changes in 2.4.0 is that this can be done by switching  
> libRblas.dylib (e.g. via softlink). The CRAN binary comes with two  
> BLAS implementations - one using vecLib (libRblas.vecLib.dylib) and  
> the internal R one (libRblas.0.dylib). They have been produced in  
> two separate builds. This is equivalent to configuring R with -- 
> with-blas='-framework vecLib' and --without-blas respectively. The  
> libRblas.dylib is a symlink which can be changed depending on which  
> implementation you want to use.

Do you have any numbers about which is currently the better performer  
on the various MacOS paltforms?

Cheers
Bill


From simon.urbanek at r-project.org  Mon Dec  4 23:44:58 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 4 Dec 2006 17:44:58 -0500
Subject: [R-SIG-Mac] Building R-2.4 on MacOS X
In-Reply-To: <0CC753BF-FF1E-483E-A56A-2C036E97DFBE@unsw.edu.au>
References: <mailman.7.1138532402.23395.r-sig-mac@stat.math.ethz.ch>
	<8FD41C66-66AE-40CA-9466-F946E9CB9F8E@unsw.edu.au>
	<21D22D86-BDF1-485C-8009-4EB6E878A0C9@r-project.org>
	<0CC753BF-FF1E-483E-A56A-2C036E97DFBE@unsw.edu.au>
Message-ID: <DEF5357A-D0D8-468C-80C6-A7C37C12971C@r-project.org>


On Dec 4, 2006, at 5:21 PM, Bill Northcott wrote:

> On 05/12/2006, at 2:43 AM, Simon Urbanek wrote:
>>> 1.  The CRAN binary contains a library libBlasVeclib.dylib.
>>> Following the build method in 'The MacOS X R FAQ' this library is  
>>> not built.  What is the library for and would it be worth building?
>>>
>>
>> R can be configured to use various BLAS implementations. One of  
>> changes in 2.4.0 is that this can be done by switching  
>> libRblas.dylib (e.g. via softlink). The CRAN binary comes with two  
>> BLAS implementations - one using vecLib (libRblas.vecLib.dylib)  
>> and the internal R one (libRblas.0.dylib). They have been produced  
>> in two separate builds. This is equivalent to configuring R with -- 
>> with-blas='-framework vecLib' and --without-blas respectively. The  
>> libRblas.dylib is a symlink which can be changed depending on  
>> which implementation you want to use.
>
> Do you have any numbers about which is currently the better  
> performer on the various MacOS paltforms?
>

vecLib is often faster, especially on multi-core or multi-CPU  
machines (both Intel and PPC) and for larger problems. However, the  
performance is task-specific. For small data sizes Doug Bates had  
some examples that were much slower with vecLib - that's why I have  
opted to ship CRAN binary with vecLib by default, but left it to the  
user to switch to internal BLAS if desired. (The performance  
degradation has to do with malloc - there is a small range of  
allocation sizes that doesn't perform well on OS X and vecLib gets  
hit by that if you happen to fall into that range. This has been  
discussed on the list some time ago.).

Cheers,
Simon


From j.abellan at imperial.ac.uk  Wed Dec  6 11:39:07 2006
From: j.abellan at imperial.ac.uk (Abellan Andres, Juanjo)
Date: Wed, 6 Dec 2006 10:39:07 -0000
Subject: [R-SIG-Mac] *** caught segfault *** error
Message-ID: <4DD45B74A8451945B25DBA200A1A769C0168AA03@icex1.ic.ac.uk>

Dear R for Mac users,

I use R 2.4.0 on an iMac running Mac OS X 10.4.8, with a 2.16GHz  
Intel Core 2 Duo and 2GB 667 MHz DDR2 SDRAM.

I get an error below whenever I try to plot a map from a shapefile  
imported into R; I've tried packages shapefiles and spdep, and two  
different shapefiles, and get the error in all 4 combinations.

The shapefile is imported correctly, and I get the error only when I  
try to plot the map. I specifically use commands

 > library(spdep)
Loading required package: tripack
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
Loading required package: SparseM
Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
Loading required package: boot
 > library(maptools)
 > sessionInfo()
R version 2.4.0 (2006-10-03)
i386-apple-darwin8.8.1

locale:
es_ES.UTF-8/es_ES.UTF-8/es_ES.UTF-8/C/es_ES.UTF-8/es_ES.UTF-8

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
"datasets"  "base"

other attached packages:
    spdep     boot  SparseM maptools       sp  foreign  tripack
"0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"

 > district.shp <-
read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/ 
districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > plot(district.shp)

*** caught segfault ***
address 0xc00006d5, cause 'memory not mapped'

Traceback:
1: polygon(theMap$Shapes[[ii]]$verts, col = fg[i], border = ol,     ...)
2: plot.Map(district.shp)
3: plot(district.shp)
4: plot(district.shp)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

I saw that plot.Map is deprecated, so I converted the shapefile into  
a polygon list, and then tried to plot it, but still got the error:

 > library(spdep)
Loading required package: tripack
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
Loading required package: SparseM
Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
Loading required package: boot
 > library(maptools)
 > district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/ 
districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > district.pl <- Map2poly(district.shp, as.character(district.shp$att 
$DISTRICT_2))
 > plot(district.pl)

*** caught segfault ***
address 0xc0000165, cause 'memory not mapped'

Traceback:
1: polygon(coords[pFrom[i]:pTo[i], ], border = border, xpd = xpd,      
density = density, angle = angle)
2: polygonholes(x[[j]], border = border, xpd = xpd, density = density 
[j],     angle = angle[j], pbg = pbg, forcefill = forcefill)
3: plot.polylist(district.pl)
4: plot(district.pl)
5: plot(district.pl)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:


I also get the same error when I use library shapefiles to import the  
shp file and then try to plot the polygons myself; these are the  
commands I run:

 > library(shapefiles)
 > districts.shp <- read.shapefile("~/Documents/SAHSU/MD/data/ 
carthography/districts_ok")

Attaching package: 'foreign'


	The following object(s) are masked from package:shapefiles :

	 read.dbf

	The following object(s) are masked from package:shapefiles :

	 write.dbf

 > ndistricts <- length(districts.shp$shp$shp)
 > keys <- districts.shp$dbf$dbf$DISTRICT_2
 > vertices <- list()
 > for(i in 1:ndistricts){
+ vertices[[i]] <- districts.shp$shp$shp[[i]]$points
+ }
 >
 > districts.map <- list(codigo=keys, vertices=vertices)#,  
nombre=wardnames)
 >
 > xymin <- apply(t(sapply(districts.map$vertices, apply, 2, min)), 2,
min)
 > xymax <- apply(t(sapply(districts.map$vertices, apply, 2, max)), 2,
max)
 > corners <- expand.grid(xymin, xymax)
 >
 > # Plotting the corners and then adding polygons one by one.
 > par(pty="s")
 > plot(rbind(xymin, xymax), type="n")
 > for (i in 1:ndistricts){
+     polygon(x=districts.map$vertices[[i]][,1],
y=districts.map$vertices[[i]][,2])
+ }

*** caught segfault ***
address 0xc00009d8, cause 'memory not mapped'

Traceback:
1: polygon(x = districts.map$vertices[[i]][, 1], y = districts.map 
$vertices[[i]][,     2])

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

In all above cases, I can generate a postscript file though. I.e. the
sequence of commands

 >districts.shp <-
read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > postscript("~/Documents/SAHSU/MD/data/Carthography/districts_ok.eps")
 > plot(districts.shp)
Warning message:
'plot.Map' is deprecated.
Use 'plot.Spatial' instead.
See help("Deprecated") and help("maptools-deprecated").
 > dev.off()
null device
           1

works fine, and the postscript file with the map is created.

The same commands work fine using R terminal instead of R.app. So the
error only happens in R.app when generating the map to be seen on teh
screen. They also work fine in my laptop (Intel Pentium 4 CPU 2.00 GHz,
with 512 MB RAM), where I use R v2.2.1 on Windows XP Home Edition v2002.

A colleague of mine's reproduced the error using R.app on the following
machine:

   System Version:	Mac OS X 10.4.8 (8N1051)
   Kernel Version:	Darwin 8.8.2
Hardware Overview:
       Machine Name: Mac
       Machine Model: MacBookPro2,2
       Processor Name: Intel Core 2 Duo
       Processor Speed: 2.33 GHz
       Number Of Processors: 1
       Total Number Of Cores: 2
       L2 Cache (per processor): 4 MB
       Memory: 2 GB
       Bus Speed: 667 MHz


 > sessionInfo()
R version 2.4.0 (2006-10-03)
i386-apple-darwin8.8.1

locale:
en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"
[6] "datasets"  "base"

other attached packages:
    spdep     boot  SparseM maptools       sp  foreign  tripack
"0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"



The offending shapefile was generated with ArcGIS 9.0 running on Windows
XP. It  
can be can be found in www.uv.es/~abellan/districts_ok.zip.

Any ideas of what may cause the error?

Many thanks,

Juanjo Abellan
Research Associate in Statistics
Department of Epidemiology and Public Health
Imperial College London


From j.abellan at imperial.ac.uk  Wed Dec  6 11:59:03 2006
From: j.abellan at imperial.ac.uk (Abellan Andres, Juanjo)
Date: Wed, 6 Dec 2006 10:59:03 -0000
Subject: [R-SIG-Mac] FW: *** caught segfault *** error
Message-ID: <4DD45B74A8451945B25DBA200A1A769C0168AA06@icex1.ic.ac.uk>

Dear all,

I forgot to mention that Roger Bivand, who developed package maptools,
wrote a special function for me to  determine which polygon caused the
error. The error happens on the 256th polygon, and he suspects this is a
signal that the loop index is running in a variable of the wrong size
(in an unsigned byte 0-255) ? I guess the question is could I run a
debugger with R.app to actually trap the error.

Many thanks.

Juanjo


-----Original Message-----
From: Abellan Andres, Juanjo 
Sent: 06 December 2006 10:39
To: 'r-sig-mac at stat.math.ethz.ch'
Cc: 'Roger Bivand'; Turro, Ernest
Subject: *** caught segfault *** error


Dear R for Mac users,

I use R 2.4.0 on an iMac running Mac OS X 10.4.8, with a 2.16GHz  
Intel Core 2 Duo and 2GB 667 MHz DDR2 SDRAM.

I get an error below whenever I try to plot a map from a shapefile  
imported into R; I've tried packages shapefiles and spdep, and two  
different shapefiles, and get the error in all 4 combinations.

The shapefile is imported correctly, and I get the error only when I  
try to plot the map. I specifically use commands

 > library(spdep)
Loading required package: tripack
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
Loading required package: SparseM
Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
Loading required package: boot
 > library(maptools)
 > sessionInfo()
R version 2.4.0 (2006-10-03)
i386-apple-darwin8.8.1

locale:
es_ES.UTF-8/es_ES.UTF-8/es_ES.UTF-8/C/es_ES.UTF-8/es_ES.UTF-8

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
"datasets"  "base"

other attached packages:
    spdep     boot  SparseM maptools       sp  foreign  tripack
"0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"

 > district.shp <-
read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/ 
districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > plot(district.shp)

*** caught segfault ***
address 0xc00006d5, cause 'memory not mapped'

Traceback:
1: polygon(theMap$Shapes[[ii]]$verts, col = fg[i], border = ol,     ...)
2: plot.Map(district.shp)
3: plot(district.shp)
4: plot(district.shp)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

I saw that plot.Map is deprecated, so I converted the shapefile into  
a polygon list, and then tried to plot it, but still got the error:

 > library(spdep)
Loading required package: tripack
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
Loading required package: SparseM
Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
Loading required package: boot
 > library(maptools)
 > district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/ 
districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > district.pl <- Map2poly(district.shp, as.character(district.shp$att 
$DISTRICT_2))
 > plot(district.pl)

*** caught segfault ***
address 0xc0000165, cause 'memory not mapped'

Traceback:
1: polygon(coords[pFrom[i]:pTo[i], ], border = border, xpd = xpd,      
density = density, angle = angle)
2: polygonholes(x[[j]], border = border, xpd = xpd, density = density 
[j],     angle = angle[j], pbg = pbg, forcefill = forcefill)
3: plot.polylist(district.pl)
4: plot(district.pl)
5: plot(district.pl)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:


I also get the same error when I use library shapefiles to import the  
shp file and then try to plot the polygons myself; these are the  
commands I run:

 > library(shapefiles)
 > districts.shp <- read.shapefile("~/Documents/SAHSU/MD/data/ 
carthography/districts_ok")

Attaching package: 'foreign'


	The following object(s) are masked from package:shapefiles :

	 read.dbf

	The following object(s) are masked from package:shapefiles :

	 write.dbf

 > ndistricts <- length(districts.shp$shp$shp)
 > keys <- districts.shp$dbf$dbf$DISTRICT_2
 > vertices <- list()
 > for(i in 1:ndistricts){
+ vertices[[i]] <- districts.shp$shp$shp[[i]]$points
+ }
 >
 > districts.map <- list(codigo=keys, vertices=vertices)#,  
nombre=wardnames)
 >
 > xymin <- apply(t(sapply(districts.map$vertices, apply, 2, min)), 2,
min)
 > xymax <- apply(t(sapply(districts.map$vertices, apply, 2, max)), 2,
max)
 > corners <- expand.grid(xymin, xymax)
 >
 > # Plotting the corners and then adding polygons one by one.
 > par(pty="s")
 > plot(rbind(xymin, xymax), type="n")
 > for (i in 1:ndistricts){
+     polygon(x=districts.map$vertices[[i]][,1],
y=districts.map$vertices[[i]][,2])
+ }

*** caught segfault ***
address 0xc00009d8, cause 'memory not mapped'

Traceback:
1: polygon(x = districts.map$vertices[[i]][, 1], y = districts.map 
$vertices[[i]][,     2])

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

In all above cases, I can generate a postscript file though. I.e. the
sequence of commands

 >districts.shp <-
read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
Shapefile type: Polygon, (5), # of Shapes: 354
 > postscript("~/Documents/SAHSU/MD/data/Carthography/districts_ok.eps")
 > plot(districts.shp)
Warning message:
'plot.Map' is deprecated.
Use 'plot.Spatial' instead.
See help("Deprecated") and help("maptools-deprecated").
 > dev.off()
null device
           1

works fine, and the postscript file with the map is created.

The same commands work fine using R terminal instead of R.app. So the
error only happens in R.app when generating the map to be seen on teh
screen. They also work fine in my laptop (Intel Pentium 4 CPU 2.00 GHz,
with 512 MB RAM), where I use R v2.2.1 on Windows XP Home Edition v2002.

A colleague of mine's reproduced the error using R.app on the following
machine:

   System Version:	Mac OS X 10.4.8 (8N1051)
   Kernel Version:	Darwin 8.8.2
Hardware Overview:
       Machine Name: Mac
       Machine Model: MacBookPro2,2
       Processor Name: Intel Core 2 Duo
       Processor Speed: 2.33 GHz
       Number Of Processors: 1
       Total Number Of Cores: 2
       L2 Cache (per processor): 4 MB
       Memory: 2 GB
       Bus Speed: 667 MHz


 > sessionInfo()
R version 2.4.0 (2006-10-03)
i386-apple-darwin8.8.1

locale:
en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"
[6] "datasets"  "base"

other attached packages:
    spdep     boot  SparseM maptools       sp  foreign  tripack
"0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"



The offending shapefile was generated with ArcGIS 9.0 running on Windows
XP. It  
can be can be found in www.uv.es/~abellan/districts_ok.zip.

Any ideas of what may cause the error?

Many thanks,

Juanjo Abellan
Research Associate in Statistics
Department of Epidemiology and Public Health
Imperial College London


From ernest.turro at ic.ac.uk  Wed Dec  6 13:45:13 2006
From: ernest.turro at ic.ac.uk (Ernest Turro)
Date: Wed, 6 Dec 2006 12:45:13 +0000
Subject: [R-SIG-Mac] *** caught segfault *** error
In-Reply-To: <4DD45B74A8451945B25DBA200A1A769C0168AA06@icex1.ic.ac.uk>
References: <4DD45B74A8451945B25DBA200A1A769C0168AA06@icex1.ic.ac.uk>
Message-ID: <C937AC8E-F971-4C08-A2C4-02342861821E@ic.ac.uk>

Dear all,

I have tried plotting Juanjo's offending shape file using X11.app and  
it works fine. It seems therefore that the problem is related to  
Quartz as opposed to the non-GUI R code.

Best,

Ernest Turro

On 6 Dec 2006, at 10:59, Abellan Andres, Juanjo wrote:

> Dear all,
>
> I forgot to mention that Roger Bivand, who developed package maptools,
> wrote a special function for me to  determine which polygon caused the
> error. The error happens on the 256th polygon, and he suspects this  
> is a
> signal that the loop index is running in a variable of the wrong size
> (in an unsigned byte 0-255) ? I guess the question is could I run a
> debugger with R.app to actually trap the error.
>
> Many thanks.
>
> Juanjo
>
>
> -----Original Message-----
> From: Abellan Andres, Juanjo
> Sent: 06 December 2006 10:39
> To: 'r-sig-mac at stat.math.ethz.ch'
> Cc: 'Roger Bivand'; Turro, Ernest
> Subject: *** caught segfault *** error
>
>
> Dear R for Mac users,
>
> I use R 2.4.0 on an iMac running Mac OS X 10.4.8, with a 2.16GHz
> Intel Core 2 Duo and 2GB 667 MHz DDR2 SDRAM.
>
> I get an error below whenever I try to plot a map from a shapefile
> imported into R; I've tried packages shapefiles and spdep, and two
> different shapefiles, and get the error in all 4 combinations.
>
> The shapefile is imported correctly, and I get the error only when I
> try to plot the map. I specifically use commands
>
>> library(spdep)
> Loading required package: tripack
> Loading required package: maptools
> Loading required package: foreign
> Loading required package: sp
> Loading required package: SparseM
> Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
> Loading required package: boot
>> library(maptools)
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> i386-apple-darwin8.8.1
>
> locale:
> es_ES.UTF-8/es_ES.UTF-8/es_ES.UTF-8/C/es_ES.UTF-8/es_ES.UTF-8
>
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"
> "datasets"  "base"
>
> other attached packages:
>     spdep     boot  SparseM maptools       sp  foreign  tripack
> "0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"
>
>> district.shp <-
> read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
> Shapefile type: Polygon, (5), # of Shapes: 354
>> district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/
> districts_ok.shp")
> Shapefile type: Polygon, (5), # of Shapes: 354
>> plot(district.shp)
>
> *** caught segfault ***
> address 0xc00006d5, cause 'memory not mapped'
>
> Traceback:
> 1: polygon(theMap$Shapes[[ii]]$verts, col = fg[i], border =  
> ol,     ...)
> 2: plot.Map(district.shp)
> 3: plot(district.shp)
> 4: plot(district.shp)
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
>
> I saw that plot.Map is deprecated, so I converted the shapefile into
> a polygon list, and then tried to plot it, but still got the error:
>
>> library(spdep)
> Loading required package: tripack
> Loading required package: maptools
> Loading required package: foreign
> Loading required package: sp
> Loading required package: SparseM
> Package SparseM (0.71) loaded.  To cite, see citation("SparseM")
> Loading required package: boot
>> library(maptools)
>> district.shp <- read.shape("~/Documents/SAHSU/MD/data/Carthography/
> districts_ok.shp")
> Shapefile type: Polygon, (5), # of Shapes: 354
>> district.pl <- Map2poly(district.shp, as.character(district.shp$att
> $DISTRICT_2))
>> plot(district.pl)
>
> *** caught segfault ***
> address 0xc0000165, cause 'memory not mapped'
>
> Traceback:
> 1: polygon(coords[pFrom[i]:pTo[i], ], border = border, xpd = xpd,
> density = density, angle = angle)
> 2: polygonholes(x[[j]], border = border, xpd = xpd, density = density
> [j],     angle = angle[j], pbg = pbg, forcefill = forcefill)
> 3: plot.polylist(district.pl)
> 4: plot(district.pl)
> 5: plot(district.pl)
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
>
>
> I also get the same error when I use library shapefiles to import the
> shp file and then try to plot the polygons myself; these are the
> commands I run:
>
>> library(shapefiles)
>> districts.shp <- read.shapefile("~/Documents/SAHSU/MD/data/
> carthography/districts_ok")
>
> Attaching package: 'foreign'
>
>
> 	The following object(s) are masked from package:shapefiles :
>
> 	 read.dbf
>
> 	The following object(s) are masked from package:shapefiles :
>
> 	 write.dbf
>
>> ndistricts <- length(districts.shp$shp$shp)
>> keys <- districts.shp$dbf$dbf$DISTRICT_2
>> vertices <- list()
>> for(i in 1:ndistricts){
> + vertices[[i]] <- districts.shp$shp$shp[[i]]$points
> + }
>>
>> districts.map <- list(codigo=keys, vertices=vertices)#,
> nombre=wardnames)
>>
>> xymin <- apply(t(sapply(districts.map$vertices, apply, 2, min)), 2,
> min)
>> xymax <- apply(t(sapply(districts.map$vertices, apply, 2, max)), 2,
> max)
>> corners <- expand.grid(xymin, xymax)
>>
>> # Plotting the corners and then adding polygons one by one.
>> par(pty="s")
>> plot(rbind(xymin, xymax), type="n")
>> for (i in 1:ndistricts){
> +     polygon(x=districts.map$vertices[[i]][,1],
> y=districts.map$vertices[[i]][,2])
> + }
>
> *** caught segfault ***
> address 0xc00009d8, cause 'memory not mapped'
>
> Traceback:
> 1: polygon(x = districts.map$vertices[[i]][, 1], y = districts.map
> $vertices[[i]][,     2])
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
>
> In all above cases, I can generate a postscript file though. I.e. the
> sequence of commands
>
>> districts.shp <-
> read.shape("~/Documents/SAHSU/MD/data/Carthography/districts_ok.shp")
> Shapefile type: Polygon, (5), # of Shapes: 354
>> postscript("~/Documents/SAHSU/MD/data/Carthography/districts_ok.eps")
>> plot(districts.shp)
> Warning message:
> 'plot.Map' is deprecated.
> Use 'plot.Spatial' instead.
> See help("Deprecated") and help("maptools-deprecated").
>> dev.off()
> null device
>            1
>
> works fine, and the postscript file with the map is created.
>
> The same commands work fine using R terminal instead of R.app. So the
> error only happens in R.app when generating the map to be seen on teh
> screen. They also work fine in my laptop (Intel Pentium 4 CPU 2.00  
> GHz,
> with 512 MB RAM), where I use R v2.2.1 on Windows XP Home Edition  
> v2002.
>
> A colleague of mine's reproduced the error using R.app on the  
> following
> machine:
>
>    System Version:	Mac OS X 10.4.8 (8N1051)
>    Kernel Version:	Darwin 8.8.2
> Hardware Overview:
>        Machine Name: Mac
>        Machine Model: MacBookPro2,2
>        Processor Name: Intel Core 2 Duo
>        Processor Speed: 2.33 GHz
>        Number Of Processors: 1
>        Total Number Of Cores: 2
>        L2 Cache (per processor): 4 MB
>        Memory: 2 GB
>        Bus Speed: 667 MHz
>
>
>> sessionInfo()
> R version 2.4.0 (2006-10-03)
> i386-apple-darwin8.8.1
>
> locale:
> en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"
> [6] "datasets"  "base"
>
> other attached packages:
>     spdep     boot  SparseM maptools       sp  foreign  tripack
> "0.3-32" "1.2-26"   "0.71"  "0.6-3"  "0.9-4" "0.8-17" "1.2-10"
>
>
>
> The offending shapefile was generated with ArcGIS 9.0 running on  
> Windows
> XP. It
> can be can be found in www.uv.es/~abellan/districts_ok.zip.
>
> Any ideas of what may cause the error?
>
> Many thanks,
>
> Juanjo Abellan
> Research Associate in Statistics
> Department of Epidemiology and Public Health
> Imperial College London


From rkoenker at uiuc.edu  Wed Dec  6 14:43:36 2006
From: rkoenker at uiuc.edu (roger koenker)
Date: Wed, 6 Dec 2006 07:43:36 -0600
Subject: [R-SIG-Mac] rgl window problem
Message-ID: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>

I've recently installed rgl on a:

R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
powerpc-apple-darwin8.7.0

system, from source and everything seemed to be ok, the package
loads without complaints, however  trying to run any of the examples
produces the usual window, but no plotting occurs.  The window
is blank, and moving the cursor over the window gives the dreaded
spinning pinwheel of cluelessness.

Can anyone suggest a strategy for further diagnosis?
Thanks,
Roger

url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Champaign, IL 61820


From murdoch at stats.uwo.ca  Wed Dec  6 15:08:16 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 06 Dec 2006 09:08:16 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
Message-ID: <4576CED0.2050905@stats.uwo.ca>

On 12/6/2006 8:43 AM, roger koenker wrote:
> I've recently installed rgl on a:
> 
> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
> powerpc-apple-darwin8.7.0
> 
> system, from source and everything seemed to be ok, the package
> loads without complaints, however  trying to run any of the examples
> produces the usual window, but no plotting occurs.  The window
> is blank, and moving the cursor over the window gives the dreaded
> spinning pinwheel of cluelessness.
> 
> Can anyone suggest a strategy for further diagnosis?

This sounds as though you are running from the console rather than 
R.app, but have built rgl (or downloaded a copy built) to use AGL in 
Carbon rather than X11.  That doesn't work.  AGL calls only work from R.app.

If someone knows a nice run-time test for whether Carbon will work I'd 
put it in to at least give a meaningful error message.  I'd really 
prefer it to fall back to trying X11 in that case, but that looks much 
harder:  for an OSX newbie like me, I think the AGL/X11 decision needs 
to be done at link time, not run time.  (On Windows I'd load the 
appropriate OpenGL .dll when the package loaded, and do all the calls 
indirectly.  But I don't know how to do this on OSX.)

If my assumption in the first paragraph is wrong, please let me know. 
And if "Carbon" is the wrong name for the graphics system that supports 
the standard Mac GUI and AGL, I wouldn't mind hearing that either.

Duncan Murdoch


From stefano.iacus at unimi.it  Wed Dec  6 15:51:26 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Wed, 06 Dec 2006 23:51:26 +0900
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <4576CED0.2050905@stats.uwo.ca>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
Message-ID: <DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>

we usually use .Platform$GUI to check if we are under R.app or under  
the console
Un R.app .Platform$GUI="AQUA", under terminal it is set to "X11" (if  
R is built with X11 support, which is the case of CRAN binary)

stefano
p.s. and this is Cocoa not Carbon. The OS X GUI itself is called AQUA  
though. Both Cocoa and Carbon are layers between the system and the  
AQUA GUI. So, definitely AQUA but not Carbon.


On 06/dic/06, at 23:08, Duncan Murdoch wrote:

> On 12/6/2006 8:43 AM, roger koenker wrote:
>> I've recently installed rgl on a:
>>
>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>> powerpc-apple-darwin8.7.0
>>
>> system, from source and everything seemed to be ok, the package
>> loads without complaints, however  trying to run any of the examples
>> produces the usual window, but no plotting occurs.  The window
>> is blank, and moving the cursor over the window gives the dreaded
>> spinning pinwheel of cluelessness.
>>
>> Can anyone suggest a strategy for further diagnosis?
>
> This sounds as though you are running from the console rather than
> R.app, but have built rgl (or downloaded a copy built) to use AGL in
> Carbon rather than X11.  That doesn't work.  AGL calls only work  
> from R.app.
>
> If someone knows a nice run-time test for whether Carbon will work I'd
> put it in to at least give a meaningful error message.  I'd really
> prefer it to fall back to trying X11 in that case, but that looks much
> harder:  for an OSX newbie like me, I think the AGL/X11 decision needs
> to be done at link time, not run time.  (On Windows I'd load the
> appropriate OpenGL .dll when the package loaded, and do all the calls
> indirectly.  But I don't know how to do this on OSX.)
>
> If my assumption in the first paragraph is wrong, please let me know.
> And if "Carbon" is the wrong name for the graphics system that  
> supports
> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>
> Duncan Murdoch
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From murdoch at stats.uwo.ca  Wed Dec  6 16:14:30 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 06 Dec 2006 10:14:30 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
Message-ID: <4576DE56.9070302@stats.uwo.ca>

On 12/6/2006 9:51 AM, stefano iacus wrote:
> we usually use .Platform$GUI to check if we are under R.app or under  
> the console
> Un R.app .Platform$GUI="AQUA", under terminal it is set to "X11" (if  
> R is built with X11 support, which is the case of CRAN binary)
> 
> stefano
> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called AQUA  
> though. Both Cocoa and Carbon are layers between the system and the  
> AQUA GUI. So, definitely AQUA but not Carbon.

Thanks.  I'll see if I can put in a test based on .Platform$GUI.

Duncan Murdoch
> 
> 
> On 06/dic/06, at 23:08, Duncan Murdoch wrote:
> 
>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>> I've recently installed rgl on a:
>>>
>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>> powerpc-apple-darwin8.7.0
>>>
>>> system, from source and everything seemed to be ok, the package
>>> loads without complaints, however  trying to run any of the examples
>>> produces the usual window, but no plotting occurs.  The window
>>> is blank, and moving the cursor over the window gives the dreaded
>>> spinning pinwheel of cluelessness.
>>>
>>> Can anyone suggest a strategy for further diagnosis?
>>
>> This sounds as though you are running from the console rather than
>> R.app, but have built rgl (or downloaded a copy built) to use AGL in
>> Carbon rather than X11.  That doesn't work.  AGL calls only work  
>> from R.app.
>>
>> If someone knows a nice run-time test for whether Carbon will work I'd
>> put it in to at least give a meaningful error message.  I'd really
>> prefer it to fall back to trying X11 in that case, but that looks much
>> harder:  for an OSX newbie like me, I think the AGL/X11 decision needs
>> to be done at link time, not run time.  (On Windows I'd load the
>> appropriate OpenGL .dll when the package loaded, and do all the calls
>> indirectly.  But I don't know how to do this on OSX.)
>>
>> If my assumption in the first paragraph is wrong, please let me know.
>> And if "Carbon" is the wrong name for the graphics system that  
>> supports
>> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Wed Dec  6 17:10:01 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 6 Dec 2006 11:10:01 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <4576CED0.2050905@stats.uwo.ca>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
Message-ID: <04E94E22-903A-4A95-A19D-34C1EC92A530@r-project.org>


On Dec 6, 2006, at 9:08 AM, Duncan Murdoch wrote:

> On 12/6/2006 8:43 AM, roger koenker wrote:
>> I've recently installed rgl on a:
>>
>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>> powerpc-apple-darwin8.7.0
>>
>> system, from source and everything seemed to be ok, the package
>> loads without complaints, however  trying to run any of the examples
>> produces the usual window, but no plotting occurs.  The window
>> is blank, and moving the cursor over the window gives the dreaded
>> spinning pinwheel of cluelessness.
>>
>> Can anyone suggest a strategy for further diagnosis?
>
> This sounds as though you are running from the console rather than  
> R.app, but have built rgl (or downloaded a copy built) to use AGL  
> in Carbon rather than X11.  That doesn't work.  AGL calls only work  
> from R.app.
>
> If someone knows a nice run-time test for whether Carbon will work  
> I'd put it in to at least give a meaningful error message.  I'd  
> really prefer it to fall back to trying X11 in that case, but that  
> looks much harder:  for an OSX newbie like me, I think the AGL/X11  
> decision needs to be done at link time, not run time.  (On Windows  
> I'd load the appropriate OpenGL .dll when the package loaded, and  
> do all the calls indirectly.  But I don't know how to do this on OSX.)
>

This works analogously - you can use dlopen as on other unix  
platforms (this is what R does) for the indirect calls. I assume that  
you need to load different code for each UI anyway, so you can make  
that separation at any level, it doesn't have to be the GL level. You  
could, for example, compile two libs for rgl and load the  
corresponding one in First.Lib or friends. That IMHO the most simple  
solution and it works on any platform.


> If my assumption in the first paragraph is wrong, please let me  
> know. And if "Carbon" is the wrong name for the graphics system  
> that supports the standard Mac GUI and AGL, I wouldn't mind hearing  
> that either.
>

Carbon = compatibility library for OS9 code to work in OS X
Cocoa = OO application environment for programming for Mac OS X
Aqua = name of user interface used in Mac OS X
Quartz = graphics system in Mac OS X based of PDF drawing model (also  
the name of the R graphics device that uses that system)
R.app = name of the Mac OS X GUI

Strictly speaking AGL is a part of Cocoa, but what you want to detect  
is the R.app GUI. In fact this is not the entire story, because you  
wouldn't mind using AGL if some Cocoa program links R, so  
using .Platform$GUI for that seems reasonable enough (yes, AQUA here  
actually means Cocoa).

In R we have a mess, because "Aqua" was the name of an ancient  
attempt for an OS X GUI that we scraped long time ago. Unfortunately  
the name "aqua" is still in R for historical reasons and it is used  
in several distinct meanings (somewhere it means Mac OS X platform,  
elsewhere it means Cocoa,...), none of them being actually Aqua. (I  
was trying to fix it before, but there is a lot of ancient code still  
wedged in) - however, I hope this mess will go away in time for 2.5.0.

Cheers,
Simon


From rkoenker at uiuc.edu  Wed Dec  6 17:09:58 2006
From: rkoenker at uiuc.edu (roger koenker)
Date: Wed, 6 Dec 2006 10:09:58 -0600
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <4576DE56.9070302@stats.uwo.ca>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca>
Message-ID: <A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>

I'm still a bit lost...  It is true that I'm still using X11 to run R  
but I would
be happy to use the GUI -- in fact I have used it a bit from my laptop
for teaching purposes, but on my desktop I'm in need of building
packages from source and haven't managed to see my way clear
to using the binary versions that Simon is providing.  So ....

I tried just downloading the GUI from  Simon's ATT page.  When
this starts up, I get:


Error in checkConflicts(value) : unimplemented type 'character' in  
'asLogical'
Error in seq_along(specs) : argument is not interpretable as logical
Error in gzfile(file) : invalid 'encoding' argument
[Workspace restored from /Users/roger/.RData]

and library(rgl)  doesn't produce any messages, but neither does it  
do anything
in response to example(suface3d) except return a prompt.  This also  
happens
with other packages:  no complaints on loading, but no response from   
attempts
to use the package, and search indicates that the packages aren't in  
the search
list.  When R starts up it says it is running:

	R version 2.4.0 Under development (unstable) (2006-08-16 r38905)

but this isn't the version that I'm running from my X11 windows...as  
noted below.

url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Champaign, IL 61820


On Dec 6, 2006, at 9:14 AM, Duncan Murdoch wrote:

> On 12/6/2006 9:51 AM, stefano iacus wrote:
>> we usually use .Platform$GUI to check if we are under R.app or  
>> under  the console
>> Un R.app .Platform$GUI="AQUA", under terminal it is set to  
>> "X11" (if  R is built with X11 support, which is the case of CRAN  
>> binary)
>> stefano
>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called  
>> AQUA  though. Both Cocoa and Carbon are layers between the system  
>> and the  AQUA GUI. So, definitely AQUA but not Carbon.
>
> Thanks.  I'll see if I can put in a test based on .Platform$GUI.
>
> Duncan Murdoch
>> On 06/dic/06, at 23:08, Duncan Murdoch wrote:
>>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>>> I've recently installed rgl on a:
>>>>
>>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>>> powerpc-apple-darwin8.7.0
>>>>
>>>> system, from source and everything seemed to be ok, the package
>>>> loads without complaints, however  trying to run any of the  
>>>> examples
>>>> produces the usual window, but no plotting occurs.  The window
>>>> is blank, and moving the cursor over the window gives the dreaded
>>>> spinning pinwheel of cluelessness.
>>>>
>>>> Can anyone suggest a strategy for further diagnosis?
>>>
>>> This sounds as though you are running from the console rather than
>>> R.app, but have built rgl (or downloaded a copy built) to use AGL in
>>> Carbon rather than X11.  That doesn't work.  AGL calls only work   
>>> from R.app.
>>>
>>> If someone knows a nice run-time test for whether Carbon will  
>>> work I'd
>>> put it in to at least give a meaningful error message.  I'd really
>>> prefer it to fall back to trying X11 in that case, but that looks  
>>> much
>>> harder:  for an OSX newbie like me, I think the AGL/X11 decision  
>>> needs
>>> to be done at link time, not run time.  (On Windows I'd load the
>>> appropriate OpenGL .dll when the package loaded, and do all the  
>>> calls
>>> indirectly.  But I don't know how to do this on OSX.)
>>>
>>> If my assumption in the first paragraph is wrong, please let me  
>>> know.
>>> And if "Carbon" is the wrong name for the graphics system that   
>>> supports
>>> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>>>
>>> Duncan Murdoch
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From stefano.iacus at unimi.it  Wed Dec  6 17:43:17 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Thu, 07 Dec 2006 01:43:17 +0900
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca>
	<A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>
Message-ID: <ECAD4DD8-AD7D-4E7F-91FA-F218B288E7BA@unimi.it>

Roger,
with CRAN binary of R 2.4.0 + rgl (from cran as well), it works for  
me in Aqua. I mean from inside the R.app.

As said, it cannot work from the shell nor under xterm with cran  
version of rgl, unless you build rgl by forcing the build against X11  
OpenGL instead of Cocoa OpenGL.

the error at startup look like some problem with your .RData

stefano


stefano

On 07/dic/06, at 01:09, roger koenker wrote:

> I'm still a bit lost...  It is true that I'm still using X11 to run R
> but I would
> be happy to use the GUI -- in fact I have used it a bit from my laptop
> for teaching purposes, but on my desktop I'm in need of building
> packages from source and haven't managed to see my way clear
> to using the binary versions that Simon is providing.  So ....
>
> I tried just downloading the GUI from  Simon's ATT page.  When
> this starts up, I get:
>
>
> Error in checkConflicts(value) : unimplemented type 'character' in
> 'asLogical'
> Error in seq_along(specs) : argument is not interpretable as logical
> Error in gzfile(file) : invalid 'encoding' argument
> [Workspace restored from /Users/roger/.RData]
>
> and library(rgl)  doesn't produce any messages, but neither does it
> do anything
> in response to example(suface3d) except return a prompt.  This also
> happens
> with other packages:  no complaints on loading, but no response from
> attempts
> to use the package, and search indicates that the packages aren't in
> the search
> list.  When R starts up it says it is running:
>
> 	R version 2.4.0 Under development (unstable) (2006-08-16 r38905)
>
> but this isn't the version that I'm running from my X11 windows...as
> noted below.
>
> url:    www.econ.uiuc.edu/~roger            Roger Koenker
> email    rkoenker at uiuc.edu            Department of Economics
> vox:     217-333-4558                University of Illinois
> fax:       217-244-6678                Champaign, IL 61820
>
>
> On Dec 6, 2006, at 9:14 AM, Duncan Murdoch wrote:
>
>> On 12/6/2006 9:51 AM, stefano iacus wrote:
>>> we usually use .Platform$GUI to check if we are under R.app or
>>> under  the console
>>> Un R.app .Platform$GUI="AQUA", under terminal it is set to
>>> "X11" (if  R is built with X11 support, which is the case of CRAN
>>> binary)
>>> stefano
>>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called
>>> AQUA  though. Both Cocoa and Carbon are layers between the system
>>> and the  AQUA GUI. So, definitely AQUA but not Carbon.
>>
>> Thanks.  I'll see if I can put in a test based on .Platform$GUI.
>>
>> Duncan Murdoch
>>> On 06/dic/06, at 23:08, Duncan Murdoch wrote:
>>>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>>>> I've recently installed rgl on a:
>>>>>
>>>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>>>> powerpc-apple-darwin8.7.0
>>>>>
>>>>> system, from source and everything seemed to be ok, the package
>>>>> loads without complaints, however  trying to run any of the
>>>>> examples
>>>>> produces the usual window, but no plotting occurs.  The window
>>>>> is blank, and moving the cursor over the window gives the dreaded
>>>>> spinning pinwheel of cluelessness.
>>>>>
>>>>> Can anyone suggest a strategy for further diagnosis?
>>>>
>>>> This sounds as though you are running from the console rather than
>>>> R.app, but have built rgl (or downloaded a copy built) to use  
>>>> AGL in
>>>> Carbon rather than X11.  That doesn't work.  AGL calls only work
>>>> from R.app.
>>>>
>>>> If someone knows a nice run-time test for whether Carbon will
>>>> work I'd
>>>> put it in to at least give a meaningful error message.  I'd really
>>>> prefer it to fall back to trying X11 in that case, but that looks
>>>> much
>>>> harder:  for an OSX newbie like me, I think the AGL/X11 decision
>>>> needs
>>>> to be done at link time, not run time.  (On Windows I'd load the
>>>> appropriate OpenGL .dll when the package loaded, and do all the
>>>> calls
>>>> indirectly.  But I don't know how to do this on OSX.)
>>>>
>>>> If my assumption in the first paragraph is wrong, please let me
>>>> know.
>>>> And if "Carbon" is the wrong name for the graphics system that
>>>> supports
>>>> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From rkoenker at uiuc.edu  Wed Dec  6 19:07:19 2006
From: rkoenker at uiuc.edu (roger koenker)
Date: Wed, 6 Dec 2006 12:07:19 -0600
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <ECAD4DD8-AD7D-4E7F-91FA-F218B288E7BA@unimi.it>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca>
	<A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>
	<ECAD4DD8-AD7D-4E7F-91FA-F218B288E7BA@unimi.it>
Message-ID: <9521F6FF-E28F-4432-A539-3B19DACC9A0B@uiuc.edu>

Yes, I can confirm that this works now for me too.  Now if I can just  
figure
out how to get back to my 2.5.0 version for package development I'll be
happy.  I vaguely recall a tutorial by Simon about how to keep multiple
versions in play -- I'll try to track that down.  Thanks for the help.


url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Champaign, IL 61820


On Dec 6, 2006, at 10:43 AM, stefano iacus wrote:

> Roger,
> with CRAN binary of R 2.4.0 + rgl (from cran as well), it works for  
> me in Aqua. I mean from inside the R.app.
>
> As said, it cannot work from the shell nor under xterm with cran  
> version of rgl, unless you build rgl by forcing the build against  
> X11 OpenGL instead of Cocoa OpenGL.
>
> the error at startup look like some problem with your .RData
>
> stefano
>
>
> stefano
>
> On 07/dic/06, at 01:09, roger koenker wrote:
>
>> I'm still a bit lost...  It is true that I'm still using X11 to run R
>> but I would
>> be happy to use the GUI -- in fact I have used it a bit from my  
>> laptop
>> for teaching purposes, but on my desktop I'm in need of building
>> packages from source and haven't managed to see my way clear
>> to using the binary versions that Simon is providing.  So ....
>>
>> I tried just downloading the GUI from  Simon's ATT page.  When
>> this starts up, I get:
>>
>>
>> Error in checkConflicts(value) : unimplemented type 'character' in
>> 'asLogical'
>> Error in seq_along(specs) : argument is not interpretable as logical
>> Error in gzfile(file) : invalid 'encoding' argument
>> [Workspace restored from /Users/roger/.RData]
>>
>> and library(rgl)  doesn't produce any messages, but neither does it
>> do anything
>> in response to example(suface3d) except return a prompt.  This also
>> happens
>> with other packages:  no complaints on loading, but no response from
>> attempts
>> to use the package, and search indicates that the packages aren't in
>> the search
>> list.  When R starts up it says it is running:
>>
>> 	R version 2.4.0 Under development (unstable) (2006-08-16 r38905)
>>
>> but this isn't the version that I'm running from my X11 windows...as
>> noted below.
>>
>> url:    www.econ.uiuc.edu/~roger            Roger Koenker
>> email    rkoenker at uiuc.edu            Department of Economics
>> vox:     217-333-4558                University of Illinois
>> fax:       217-244-6678                Champaign, IL 61820
>>
>>
>> On Dec 6, 2006, at 9:14 AM, Duncan Murdoch wrote:
>>
>>> On 12/6/2006 9:51 AM, stefano iacus wrote:
>>>> we usually use .Platform$GUI to check if we are under R.app or
>>>> under  the console
>>>> Un R.app .Platform$GUI="AQUA", under terminal it is set to
>>>> "X11" (if  R is built with X11 support, which is the case of CRAN
>>>> binary)
>>>> stefano
>>>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called
>>>> AQUA  though. Both Cocoa and Carbon are layers between the system
>>>> and the  AQUA GUI. So, definitely AQUA but not Carbon.
>>>
>>> Thanks.  I'll see if I can put in a test based on .Platform$GUI.
>>>
>>> Duncan Murdoch
>>>> On 06/dic/06, at 23:08, Duncan Murdoch wrote:
>>>>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>>>>> I've recently installed rgl on a:
>>>>>>
>>>>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>>>>> powerpc-apple-darwin8.7.0
>>>>>>
>>>>>> system, from source and everything seemed to be ok, the package
>>>>>> loads without complaints, however  trying to run any of the
>>>>>> examples
>>>>>> produces the usual window, but no plotting occurs.  The window
>>>>>> is blank, and moving the cursor over the window gives the dreaded
>>>>>> spinning pinwheel of cluelessness.
>>>>>>
>>>>>> Can anyone suggest a strategy for further diagnosis?
>>>>>
>>>>> This sounds as though you are running from the console rather than
>>>>> R.app, but have built rgl (or downloaded a copy built) to use  
>>>>> AGL in
>>>>> Carbon rather than X11.  That doesn't work.  AGL calls only work
>>>>> from R.app.
>>>>>
>>>>> If someone knows a nice run-time test for whether Carbon will
>>>>> work I'd
>>>>> put it in to at least give a meaningful error message.  I'd really
>>>>> prefer it to fall back to trying X11 in that case, but that looks
>>>>> much
>>>>> harder:  for an OSX newbie like me, I think the AGL/X11 decision
>>>>> needs
>>>>> to be done at link time, not run time.  (On Windows I'd load the
>>>>> appropriate OpenGL .dll when the package loaded, and do all the
>>>>> calls
>>>>> indirectly.  But I don't know how to do this on OSX.)
>>>>>
>>>>> If my assumption in the first paragraph is wrong, please let me
>>>>> know.
>>>>> And if "Carbon" is the wrong name for the graphics system that
>>>>> supports
>>>>> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Mac mailing list
>>>>> R-SIG-Mac at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>


From simon.urbanek at r-project.org  Wed Dec  6 19:19:24 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 6 Dec 2006 13:19:24 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca>
	<A6685F0F-9D4D-402C-A7CC-16EE33147105@uiuc.edu>
Message-ID: <11DFB926-A464-48CC-BB80-3E3AD02D218B@r-project.org>


On Dec 6, 2006, at 11:09 AM, roger koenker wrote:

> I'm still a bit lost...  It is true that I'm still using X11 to run R
> but I would
> be happy to use the GUI -- in fact I have used it a bit from my laptop
> for teaching purposes, but on my desktop I'm in need of building
> packages from source and haven't managed to see my way clear
> to using the binary versions that Simon is providing.  So ....
>
> I tried just downloading the GUI from  Simon's ATT page.  When
> this starts up, I get:
>
>
> Error in checkConflicts(value) : unimplemented type 'character' in
> 'asLogical'
> Error in seq_along(specs) : argument is not interpretable as logical
> Error in gzfile(file) : invalid 'encoding' argument
> [Workspace restored from /Users/roger/.RData]
>
> and library(rgl)  doesn't produce any messages, but neither does it
> do anything
> in response to example(suface3d) except return a prompt.  This also
> happens
> with other packages:  no complaints on loading, but no response from
> attempts
> to use the package, and search indicates that the packages aren't in
> the search
> list.  When R starts up it says it is running:
>
> 	R version 2.4.0 Under development (unstable) (2006-08-16 r38905)
>
> but this isn't the version that I'm running from my X11 windows...as
> noted below.
>

Oh, wow, your system is a mess ;). You appear to have at least two  
different versions of R on your system and neither of them is the  
CRAN build, so you are be pretty much on your own :P. In addition, it  
seems as if you have custom packages installed in ~/Library/R as  
well, which adds to the chaos, because they don't know about the  
concept of R versions and thus break very often (I suspect this is  
where your errors at start time come from).

Now to your actual problem - it seems that you want to run R-devel  
instead of R 2.4.0 (if you don't, just install R 2.4.0 from CRAN and  
everyone's happy). In that case, you must also run R.app (the GUI)  
suitable for R-devel. Running R.app built for R 2.4 won't work. I  
have just noticed that the R.app failed to build for R-devel due to  
an API change, so that's why it was not available from my page. I  
have now fixed that problem and the GUI should be available for R- 
devel as well.

Cheers,
Simon


> url:    www.econ.uiuc.edu/~roger            Roger Koenker
> email    rkoenker at uiuc.edu            Department of Economics
> vox:     217-333-4558                University of Illinois
> fax:       217-244-6678                Champaign, IL 61820
>
>
> On Dec 6, 2006, at 9:14 AM, Duncan Murdoch wrote:
>
>> On 12/6/2006 9:51 AM, stefano iacus wrote:
>>> we usually use .Platform$GUI to check if we are under R.app or
>>> under  the console
>>> Un R.app .Platform$GUI="AQUA", under terminal it is set to
>>> "X11" (if  R is built with X11 support, which is the case of CRAN
>>> binary)
>>> stefano
>>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called
>>> AQUA  though. Both Cocoa and Carbon are layers between the system
>>> and the  AQUA GUI. So, definitely AQUA but not Carbon.
>>
>> Thanks.  I'll see if I can put in a test based on .Platform$GUI.
>>
>> Duncan Murdoch
>>> On 06/dic/06, at 23:08, Duncan Murdoch wrote:
>>>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>>>> I've recently installed rgl on a:
>>>>>
>>>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>>>> powerpc-apple-darwin8.7.0
>>>>>
>>>>> system, from source and everything seemed to be ok, the package
>>>>> loads without complaints, however  trying to run any of the
>>>>> examples
>>>>> produces the usual window, but no plotting occurs.  The window
>>>>> is blank, and moving the cursor over the window gives the dreaded
>>>>> spinning pinwheel of cluelessness.
>>>>>
>>>>> Can anyone suggest a strategy for further diagnosis?
>>>>
>>>> This sounds as though you are running from the console rather than
>>>> R.app, but have built rgl (or downloaded a copy built) to use  
>>>> AGL in
>>>> Carbon rather than X11.  That doesn't work.  AGL calls only work
>>>> from R.app.
>>>>
>>>> If someone knows a nice run-time test for whether Carbon will
>>>> work I'd
>>>> put it in to at least give a meaningful error message.  I'd really
>>>> prefer it to fall back to trying X11 in that case, but that looks
>>>> much
>>>> harder:  for an OSX newbie like me, I think the AGL/X11 decision
>>>> needs
>>>> to be done at link time, not run time.  (On Windows I'd load the
>>>> appropriate OpenGL .dll when the package loaded, and do all the
>>>> calls
>>>> indirectly.  But I don't know how to do this on OSX.)
>>>>
>>>> If my assumption in the first paragraph is wrong, please let me
>>>> know.
>>>> And if "Carbon" is the wrong name for the graphics system that
>>>> supports
>>>> the standard Mac GUI and AGL, I wouldn't mind hearing that either.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> _______________________________________________
>>>> R-SIG-Mac mailing list
>>>> R-SIG-Mac at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>


From murdoch at stats.uwo.ca  Wed Dec  6 19:22:38 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 06 Dec 2006 13:22:38 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <04E94E22-903A-4A95-A19D-34C1EC92A530@r-project.org>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<04E94E22-903A-4A95-A19D-34C1EC92A530@r-project.org>
Message-ID: <45770A6E.2040700@stats.uwo.ca>

On 12/6/2006 11:10 AM, Simon Urbanek wrote:
> On Dec 6, 2006, at 9:08 AM, Duncan Murdoch wrote:
> 
>> On 12/6/2006 8:43 AM, roger koenker wrote:
>>> I've recently installed rgl on a:
>>>
>>> R version 2.5.0 Under development (unstable) (2006-09-10 r39242)
>>> powerpc-apple-darwin8.7.0
>>>
>>> system, from source and everything seemed to be ok, the package
>>> loads without complaints, however  trying to run any of the examples
>>> produces the usual window, but no plotting occurs.  The window
>>> is blank, and moving the cursor over the window gives the dreaded
>>> spinning pinwheel of cluelessness.
>>>
>>> Can anyone suggest a strategy for further diagnosis?
>>
>> This sounds as though you are running from the console rather than  
>> R.app, but have built rgl (or downloaded a copy built) to use AGL  
>> in Carbon rather than X11.  That doesn't work.  AGL calls only work  
>> from R.app.
>>
>> If someone knows a nice run-time test for whether Carbon will work  
>> I'd put it in to at least give a meaningful error message.  I'd  
>> really prefer it to fall back to trying X11 in that case, but that  
>> looks much harder:  for an OSX newbie like me, I think the AGL/X11  
>> decision needs to be done at link time, not run time.  (On Windows  
>> I'd load the appropriate OpenGL .dll when the package loaded, and  
>> do all the calls indirectly.  But I don't know how to do this on OSX.)
>>
> 
> This works analogously - you can use dlopen as on other unix  
> platforms (this is what R does) for the indirect calls. I assume that  
> you need to load different code for each UI anyway, so you can make  
> that separation at any level, it doesn't have to be the GL level. You  
> could, for example, compile two libs for rgl and load the  
> corresponding one in First.Lib or friends. That IMHO the most simple  
> solution and it works on any platform.

That's a great suggestion, much easier than what I was thinking.  Thanks!

Duncan

>> If my assumption in the first paragraph is wrong, please let me  
>> know. And if "Carbon" is the wrong name for the graphics system  
>> that supports the standard Mac GUI and AGL, I wouldn't mind hearing  
>> that either.
>>
> 
> Carbon = compatibility library for OS9 code to work in OS X
> Cocoa = OO application environment for programming for Mac OS X
> Aqua = name of user interface used in Mac OS X
> Quartz = graphics system in Mac OS X based of PDF drawing model (also  
> the name of the R graphics device that uses that system)
> R.app = name of the Mac OS X GUI
> 
> Strictly speaking AGL is a part of Cocoa, but what you want to detect  
> is the R.app GUI. In fact this is not the entire story, because you  
> wouldn't mind using AGL if some Cocoa program links R, so  
> using .Platform$GUI for that seems reasonable enough (yes, AQUA here  
> actually means Cocoa).
> 
> In R we have a mess,  because "Aqua" was the name of an ancient
> attempt for an OS X GUI that we scraped long time ago. Unfortunately  
> the name "aqua" is still in R for historical reasons and it is used  
> in several distinct meanings (somewhere it means Mac OS X platform,  
> elsewhere it means Cocoa,...), none of them being actually Aqua. (I  
> was trying to fix it before, but there is a lot of ancient code still  
> wedged in) - however, I hope this mess will go away in time for 2.5.0.
> 
> Cheers,
> Simon
>


From murdoch at stats.uwo.ca  Fri Dec  8 17:03:45 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 08 Dec 2006 11:03:45 -0500
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <4576DE56.9070302@stats.uwo.ca>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>	<4576CED0.2050905@stats.uwo.ca>	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca>
Message-ID: <45798CE1.7020805@stats.uwo.ca>

On 12/6/2006 10:14 AM, Duncan Murdoch wrote:
> On 12/6/2006 9:51 AM, stefano iacus wrote:
>> we usually use .Platform$GUI to check if we are under R.app or under  
>> the console
>> Un R.app .Platform$GUI="AQUA", under terminal it is set to "X11" (if  
>> R is built with X11 support, which is the case of CRAN binary)
>>
>> stefano
>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called AQUA  
>> though. Both Cocoa and Carbon are layers between the system and the  
>> AQUA GUI. So, definitely AQUA but not Carbon.
> 
> Thanks.  I'll see if I can put in a test based on .Platform$GUI.

I've done this now, and uploaded version 0.69 to CRAN.  This should also 
fix the "no update on resize" bug in OSX.

I haven't put in Simon's suggestion for supporting both X11 and Cocoa in 
one build by using multiple libraries yet, but it's on my todo list.
It looks a little messy, since now the decision on whether to support 
X11 or Cocoa is done at configure time.  Does anyone know of examples of 
packages that do the equivalent of two builds, with different configure 
options?

Duncan Murdoch


From stefano.iacus at unimi.it  Sat Dec  9 01:48:59 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Sat, 09 Dec 2006 09:48:59 +0900
Subject: [R-SIG-Mac] rgl window problem
In-Reply-To: <45798CE1.7020805@stats.uwo.ca>
References: <87356B8A-2CEA-4F69-9727-12039561A3B6@uiuc.edu>
	<4576CED0.2050905@stats.uwo.ca>
	<DCFEE2E6-B99B-434C-9658-6B596C459EB7@unimi.it>
	<4576DE56.9070302@stats.uwo.ca> <45798CE1.7020805@stats.uwo.ca>
Message-ID: <FFC0F3B9-2C5B-4711-A4DB-51793D2FE3B2@unimi.it>


On 09/dic/06, at 01:03, Duncan Murdoch wrote:

> On 12/6/2006 10:14 AM, Duncan Murdoch wrote:
>> On 12/6/2006 9:51 AM, stefano iacus wrote:
>>> we usually use .Platform$GUI to check if we are under R.app or under
>>> the console
>>> Un R.app .Platform$GUI="AQUA", under terminal it is set to "X11" (if
>>> R is built with X11 support, which is the case of CRAN binary)
>>>
>>> stefano
>>> p.s. and this is Cocoa not Carbon. The OS X GUI itself is called  
>>> AQUA
>>> though. Both Cocoa and Carbon are layers between the system and the
>>> AQUA GUI. So, definitely AQUA but not Carbon.
>>
>> Thanks.  I'll see if I can put in a test based on .Platform$GUI.
>
> I've done this now, and uploaded version 0.69 to CRAN.  This should  
> also
> fix the "no update on resize" bug in OSX.
>
> I haven't put in Simon's suggestion for supporting both X11 and  
> Cocoa in
> one build by using multiple libraries yet, but it's on my todo list.
> It looks a little messy, since now the decision on whether to support
> X11 or Cocoa is done at configure time.  Does anyone know of  
> examples of
> packages that do the equivalent of two builds, with different  
> configure
> options?

I'm not aware of this and rgl is quite peculiar in this respect  
because on OS X we have two versions of GL.
Maybe, if you succeed the approach should be used for tcltk  package  
as well. We still don't get AquaTclTk to work properly with R.app  
because of event loop problems and we still use X11/TclTk, but Jan  
shown that Aqua/TclTk works if you run R from the CMD line.
stefano



>
> Duncan Murdoch
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From smckinney at bccrc.ca  Sat Dec  9 02:23:50 2006
From: smckinney at bccrc.ca (Steven McKinney)
Date: Fri, 8 Dec 2006 17:23:50 -0800
Subject: [R-SIG-Mac] Bug/Feature request in OS X GUI
References: <m2zmc4kqz7.fsf@ziti.local>
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0235FA34@crcmail1.BCCRC.CA>


Thanks much for fixing the focus issue
referred to by Seth below.

Could this also be done for dev.off()
and graphics.off()?

When I turn off a graphics device, focus
does not return to the R command prompt
window (not sure where it goes).

Best

Steven McKinney

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney at bccrc.ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C. 
V5Z 1L3
Canada




-----Original Message-----
From: r-sig-mac-bounces at stat.math.ethz.ch on behalf of Seth Falcon
Sent: Tue 10/10/2006 10:42 AM
To: r-sig-mac at stat.math.ethz.ch
Subject: [R-SIG-Mac] Bug/Feature request in OS X GUI
 
Hi,

When you ask for help on a topic that does not exist, a popup box
tells you "Help topic not found" and when you click OK, the focus goes
nowhere.

It would be much better, IMO, if after clicking OK, the focus went
back to the R command promt window.

+ seth

_______________________________________________
R-SIG-Mac mailing list
R-SIG-Mac at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From murdoch at stats.uwo.ca  Mon Dec 11 02:27:05 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 10 Dec 2006 20:27:05 -0500
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <20061211011940.17CBC77AA@lists.neoscientists.net>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
Message-ID: <457CB3E9.7010009@stats.uwo.ca>

I've just committed some changes to rgl to allow it to install two 
versions of its shared library on Mac OSX, one
for AGL and one for X11.  The build process ended up kind of messy, and 
I'm not sure it will work on ppc or other different Mac platforms.

This hasn't been sent to CRAN yet, but I've put a temporary build on my 
own web page at

http://www.stats.uwo.ca/faculty/murdoch/temp/rgl_0.69.535.tar.gz

Could someone else try installing this, and confirm it works 
transparently both in the GUI and from the console?

Thanks to Simon for inspiring this and providing some advice (though I 
couldn't get his cleaner solution to work; not sure why not).

Duncan Murdoch


From stefano.iacus at unimi.it  Mon Dec 11 02:51:43 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Mon, 11 Dec 2006 10:51:43 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <457CB3E9.7010009@stats.uwo.ca>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
Message-ID: <9A17B884-9309-4192-870A-7471983B7671@unimi.it>

It builds fine on PCC and apparently the two libs are in the  
installed directory.
The only problem is that both on X11 term and on R.app always the  
X11 .dll is taken, so no AGL for me any more.
I don't see any conditionals on .Platform$GUI in the loading of the  
library though.
stefano


On 11/dic/06, at 10:27, Duncan Murdoch wrote:

> I've just committed some changes to rgl to allow it to install two
> versions of its shared library on Mac OSX, one
> for AGL and one for X11.  The build process ended up kind of messy,  
> and
> I'm not sure it will work on ppc or other different Mac platforms.
>
> This hasn't been sent to CRAN yet, but I've put a temporary build  
> on my
> own web page at
>
> http://www.stats.uwo.ca/faculty/murdoch/temp/rgl_0.69.535.tar.gz
>
> Could someone else try installing this, and confirm it works
> transparently both in the GUI and from the console?
>
> Thanks to Simon for inspiring this and providing some advice (though I
> couldn't get his cleaner solution to work; not sure why not).
>
> Duncan Murdoch
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From jago at mclink.it  Mon Dec 11 02:56:58 2006
From: jago at mclink.it (stefano iacus)
Date: Mon, 11 Dec 2006 10:56:58 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <9A17B884-9309-4192-870A-7471983B7671@unimi.it>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
Message-ID: <DA929CE0-20E6-4A12-9118-E97A011D8649@mclink.it>

and, for the standard  shell (i.e. not under xterm), I can open and  
plot on a  x11() device but during  demo(rgl)

 > rgl.open()
Error in rgl.open() : rgl.open failed
 > rgl.open

stefano

On 11/dic/06, at 10:51, stefano iacus wrote:

> It builds fine on PCC and apparently the two libs are in the
> installed directory.
> The only problem is that both on X11 term and on R.app always the
> X11 .dll is taken, so no AGL for me any more.
> I don't see any conditionals on .Platform$GUI in the loading of the
> library though.
> stefano
>
>
> On 11/dic/06, at 10:27, Duncan Murdoch wrote:
>
>> I've just committed some changes to rgl to allow it to install two
>> versions of its shared library on Mac OSX, one
>> for AGL and one for X11.  The build process ended up kind of messy,
>> and
>> I'm not sure it will work on ppc or other different Mac platforms.
>>
>> This hasn't been sent to CRAN yet, but I've put a temporary build
>> on my
>> own web page at
>>
>> http://www.stats.uwo.ca/faculty/murdoch/temp/rgl_0.69.535.tar.gz
>>
>> Could someone else try installing this, and confirm it works
>> transparently both in the GUI and from the console?
>>
>> Thanks to Simon for inspiring this and providing some advice  
>> (though I
>> couldn't get his cleaner solution to work; not sure why not).
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From murdoch at stats.uwo.ca  Mon Dec 11 12:49:54 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 11 Dec 2006 06:49:54 -0500
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <9A17B884-9309-4192-870A-7471983B7671@unimi.it>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
Message-ID: <457D45E2.4090704@stats.uwo.ca>

On 12/10/2006 8:51 PM, stefano iacus wrote:
> It builds fine on PCC and apparently the two libs are in the  
> installed directory.
> The only problem is that both on X11 term and on R.app always the  
> X11 .dll is taken, so no AGL for me any more.
> I don't see any conditionals on .Platform$GUI in the loading of the  
> library though.

It's in the .onLoad function in zzz.R:

   if ( .Platform$OS.type == "unix" ) {
     unixos <- system("uname",intern=TRUE)
     if ( unixos == "Darwin" ) {
       # For MacOS X we have to remove /usr/X11R6/lib from the 
DYLD_LIBRARY_PATH
       # because it would override Apple's OpenGL framework
 
Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv("DYLD_LIBRARY_PATH")))
       if ( .Platform$GUI == "AQUA" &&
            file.exists(system.file("libs", "aglrgl.so", package = 
"rgl"))) {
         initValue <- 1
         rgl <<- "aglrgl"
       }
     }
   }

Does the lib get a different name or sit somewhere else on that system? 
  I have the file.exists test in case someone has configured not to 
build the AGL version, but maybe the filename is wrong.  Do you know a 
safe test to see if the lib exists?

On 12/10/2006 8:56 PM, stefano iacus wrote:
 > and, for the standard  shell (i.e. not under xterm), I can open and
 > plot on a  x11() device but during  demo(rgl)
 >
 >  > rgl.open()
 > Error in rgl.open() : rgl.open failed
 >  > rgl.open

The initialization is currently done in .onLoad, and if it fails, no 
additional attempts are made.  I'll see if it's safe to try again.

By the way, did you manually set DISPLAY before you opened the x11 
device?  I get an error in the standard shell when I try that, but 
Sys.putenv fixes it.

Duncan Murdoch


From stefano.iacus at unimi.it  Mon Dec 11 13:12:43 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Mon, 11 Dec 2006 21:12:43 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <457D45E2.4090704@stats.uwo.ca>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
Message-ID: <4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>

Duncan,
I see now. On PPC you should use

    file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))

and, under intel,

    file.exists(system.file("libs/i386", "aglrgl.so", package ="rgl"))

instead of just

    file.exists(system.file("libs", "aglrgl.so", package ="rgl"))

i.e.
    file.exists(system.file(file.path("libs",.Platform$r_arch),  
"aglrgl.so", package ="rgl"))


And yes, you have to explicitly set the DISPLAY var under the shell  
unless you use xterm.

I have only one doubt, which I'm going to verify: if you override the  
DYLD_LIBRARY_PATH var there should be potential problems with tcltk  
which is still x11.

stefano



On 11/dic/06, at 20:49, Duncan Murdoch wrote:

> On 12/10/2006 8:51 PM, stefano iacus wrote:
>> It builds fine on PCC and apparently the two libs are in the
>> installed directory.
>> The only problem is that both on X11 term and on R.app always the
>> X11 .dll is taken, so no AGL for me any more.
>> I don't see any conditionals on .Platform$GUI in the loading of the
>> library though.
>
> It's in the .onLoad function in zzz.R:
>
>    if ( .Platform$OS.type == "unix" ) {
>      unixos <- system("uname",intern=TRUE)
>      if ( unixos == "Darwin" ) {
>        # For MacOS X we have to remove /usr/X11R6/lib from the
> DYLD_LIBRARY_PATH
>        # because it would override Apple's OpenGL framework
>
> Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv 
> ("DYLD_LIBRARY_PATH")))
>        if ( .Platform$GUI == "AQUA" &&
>             file.exists(system.file("libs", "aglrgl.so", package =
> "rgl"))) {
>          initValue <- 1
>          rgl <<- "aglrgl"
>        }
>      }
>    }
>
> Does the lib get a different name or sit somewhere else on that  
> system?
>   I have the file.exists test in case someone has configured not to
> build the AGL version, but maybe the filename is wrong.  Do you know a
> safe test to see if the lib exists?
>
> On 12/10/2006 8:56 PM, stefano iacus wrote:
>> and, for the standard  shell (i.e. not under xterm), I can open and
>> plot on a  x11() device but during  demo(rgl)
>>
>>> rgl.open()
>> Error in rgl.open() : rgl.open failed
>>> rgl.open
>
> The initialization is currently done in .onLoad, and if it fails, no
> additional attempts are made.  I'll see if it's safe to try again.
>
> By the way, did you manually set DISPLAY before you opened the x11
> device?  I get an error in the standard shell when I try that, but
> Sys.putenv fixes it.
>
> Duncan Murdoch
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From jago at mclink.it  Mon Dec 11 13:21:29 2006
From: jago at mclink.it (stefano iacus)
Date: Mon, 11 Dec 2006 21:21:29 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
Message-ID: <E9B1B57B-A66D-434A-8894-9C3D65E16B11@mclink.it>

Duncan,
using

>    file.exists(system.file(file.path("libs",.Platform$r_arch),   
> "aglrgl.so", package ="rgl"))

works perfectly for me on ppc. The correct version of the GL is taken  
from R.app and xterm/shell
Maybe you can test on i386

stefano



On 11/dic/06, at 21:12, stefano iacus wrote:

> Duncan,
> I see now. On PPC you should use
>
>     file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))
>
> and, under intel,
>
>     file.exists(system.file("libs/i386", "aglrgl.so", package ="rgl"))
>
> instead of just
>
>     file.exists(system.file("libs", "aglrgl.so", package ="rgl"))
>
> i.e.
>     file.exists(system.file(file.path("libs",.Platform$r_arch),
> "aglrgl.so", package ="rgl"))
>
>
> And yes, you have to explicitly set the DISPLAY var under the shell
> unless you use xterm.
>
> I have only one doubt, which I'm going to verify: if you override the
> DYLD_LIBRARY_PATH var there should be potential problems with tcltk
> which is still x11.
>
> stefano
>
>
>
> On 11/dic/06, at 20:49, Duncan Murdoch wrote:
>
>> On 12/10/2006 8:51 PM, stefano iacus wrote:
>>> It builds fine on PCC and apparently the two libs are in the
>>> installed directory.
>>> The only problem is that both on X11 term and on R.app always the
>>> X11 .dll is taken, so no AGL for me any more.
>>> I don't see any conditionals on .Platform$GUI in the loading of the
>>> library though.
>>
>> It's in the .onLoad function in zzz.R:
>>
>>    if ( .Platform$OS.type == "unix" ) {
>>      unixos <- system("uname",intern=TRUE)
>>      if ( unixos == "Darwin" ) {
>>        # For MacOS X we have to remove /usr/X11R6/lib from the
>> DYLD_LIBRARY_PATH
>>        # because it would override Apple's OpenGL framework
>>
>> Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv
>> ("DYLD_LIBRARY_PATH")))
>>        if ( .Platform$GUI == "AQUA" &&
>>             file.exists(system.file("libs", "aglrgl.so", package =
>> "rgl"))) {
>>          initValue <- 1
>>          rgl <<- "aglrgl"
>>        }
>>      }
>>    }
>>
>> Does the lib get a different name or sit somewhere else on that
>> system?
>>   I have the file.exists test in case someone has configured not to
>> build the AGL version, but maybe the filename is wrong.  Do you  
>> know a
>> safe test to see if the lib exists?
>>
>> On 12/10/2006 8:56 PM, stefano iacus wrote:
>>> and, for the standard  shell (i.e. not under xterm), I can open and
>>> plot on a  x11() device but during  demo(rgl)
>>>
>>>> rgl.open()
>>> Error in rgl.open() : rgl.open failed
>>>> rgl.open
>>
>> The initialization is currently done in .onLoad, and if it fails, no
>> additional attempts are made.  I'll see if it's safe to try again.
>>
>> By the way, did you manually set DISPLAY before you opened the x11
>> device?  I get an error in the standard shell when I try that, but
>> Sys.putenv fixes it.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From jago at mclink.it  Mon Dec 11 13:22:01 2006
From: jago at mclink.it (stefano iacus)
Date: Mon, 11 Dec 2006 21:22:01 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
Message-ID: <9901D56E-4BEC-4535-9BCE-14D8FC1463E6@mclink.it>

I forgot to mention, no problem with x11 tcltk.
stefano

On 11/dic/06, at 21:12, stefano iacus wrote:

> Duncan,
> I see now. On PPC you should use
>
>     file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))
>
> and, under intel,
>
>     file.exists(system.file("libs/i386", "aglrgl.so", package ="rgl"))
>
> instead of just
>
>     file.exists(system.file("libs", "aglrgl.so", package ="rgl"))
>
> i.e.
>     file.exists(system.file(file.path("libs",.Platform$r_arch),
> "aglrgl.so", package ="rgl"))
>
>
> And yes, you have to explicitly set the DISPLAY var under the shell
> unless you use xterm.
>
> I have only one doubt, which I'm going to verify: if you override the
> DYLD_LIBRARY_PATH var there should be potential problems with tcltk
> which is still x11.
>
> stefano
>
>
>
> On 11/dic/06, at 20:49, Duncan Murdoch wrote:
>
>> On 12/10/2006 8:51 PM, stefano iacus wrote:
>>> It builds fine on PCC and apparently the two libs are in the
>>> installed directory.
>>> The only problem is that both on X11 term and on R.app always the
>>> X11 .dll is taken, so no AGL for me any more.
>>> I don't see any conditionals on .Platform$GUI in the loading of the
>>> library though.
>>
>> It's in the .onLoad function in zzz.R:
>>
>>    if ( .Platform$OS.type == "unix" ) {
>>      unixos <- system("uname",intern=TRUE)
>>      if ( unixos == "Darwin" ) {
>>        # For MacOS X we have to remove /usr/X11R6/lib from the
>> DYLD_LIBRARY_PATH
>>        # because it would override Apple's OpenGL framework
>>
>> Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv
>> ("DYLD_LIBRARY_PATH")))
>>        if ( .Platform$GUI == "AQUA" &&
>>             file.exists(system.file("libs", "aglrgl.so", package =
>> "rgl"))) {
>>          initValue <- 1
>>          rgl <<- "aglrgl"
>>        }
>>      }
>>    }
>>
>> Does the lib get a different name or sit somewhere else on that
>> system?
>>   I have the file.exists test in case someone has configured not to
>> build the AGL version, but maybe the filename is wrong.  Do you  
>> know a
>> safe test to see if the lib exists?
>>
>> On 12/10/2006 8:56 PM, stefano iacus wrote:
>>> and, for the standard  shell (i.e. not under xterm), I can open and
>>> plot on a  x11() device but during  demo(rgl)
>>>
>>>> rgl.open()
>>> Error in rgl.open() : rgl.open failed
>>>> rgl.open
>>
>> The initialization is currently done in .onLoad, and if it fails, no
>> additional attempts are made.  I'll see if it's safe to try again.
>>
>> By the way, did you manually set DISPLAY before you opened the x11
>> device?  I get an error in the standard shell when I try that, but
>> Sys.putenv fixes it.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From tim.cole at ich.ucl.ac.uk  Mon Dec 11 17:23:56 2006
From: tim.cole at ich.ucl.ac.uk (Tim Cole)
Date: Mon, 11 Dec 2006 16:23:56 +0000
Subject: [R-SIG-Mac] Installing packages from .gz files
Message-ID: <p06240832c1a3319ed171@[192.168.11.3]>

I've been given an updated version of the gamlss package as a .tar.gz 
file, but I'm struggling to install it with the package installer. I 
specify Local Binary Package at the top, but when I Install and 
select the file I get errors whichever of the three possible files I 
point to - the .tar.gz file or .tar file or the gamlss folder. What 
am I doing wrong?

The .gz file error is:
Error in gzfile(file, "r") : unable to open connection
In addition: Warning message:
cannot open compressed file 'gamlss_1.4-6.tar.gz/DESCRIPTION'

Thanks,
Tim Cole
-- 
Tim.Cole at ich.ucl.ac.uk   Phone +44(0)20 7905 2666  Fax +44(0)20 7905 2381
Paed Epidemiology & Biostats, Institute of Child Health, London WC1N 1EH, UK


From webmaster at xen.net  Mon Dec 11 23:13:53 2006
From: webmaster at xen.net (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Mon, 11 Dec 2006 23:13:53 +0100
Subject: [R-SIG-Mac] locale
Message-ID: <29DD5247-34CE-45CF-BE6F-4F137AFC735C@xen.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20061211/e0f4109c/attachment.pl 

From khansen at stat.Berkeley.EDU  Tue Dec 12 03:39:29 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Mon, 11 Dec 2006 18:39:29 -0800
Subject: [R-SIG-Mac] Rgraphviz installation problem
In-Reply-To: <m2u042uksh.fsf@ziti.local>
References: <3E6393BD-E42F-40B7-BCC3-195B5964D024@virginia.edu>
	<7A6655A8-FF3D-4624-BB16-178440FF580A@r-project.org>
	<39B1A49B-0EF5-4DEA-9EC0-02FE34D627FB@virginia.edu>
	<804DC610-9F27-4A15-A069-6B1164E09C43@r-project.org>
	<m264gqni2t.fsf@ziti.fhcrc.org>
	<78ED7093-4E61-4BD1-A524-576338F6655E@virginia.edu>
	<m2u049iu2p.fsf@ziti.fhcrc.org>
	<41427A3B-62E7-4766-A6C3-827FF7DE9BD3@virginia.edu>
	<FA4D023F-051E-4277-98B9-698B45712598@mac.com>
	<m2u0469mgx.fsf@ziti.fhcrc.org>
	<788D20EE-5DB2-4E8D-B02F-1C63E979DF23@r-project.org>
	<m21wra9kzn.fsf@ziti.fhcrc.org>
	<87E997E2-E76B-4F46-BE4B-4D69ADE93B43@mac.com>
	<m2u042uksh.fsf@ziti.local>
Message-ID: <C299E8D1-A136-4090-ACFB-97E1FB2D7319@stat.berkeley.edu>

I will revive this old thread due to me having recently spend  
considerable time in the internals of (R)Graphviz. So someone besides  
me might benefit from all that time :)

Essentially the conclusions are
1) There is a bug in Graphviz 2.4, 2.6 and 2.8 that makes it  
impossible to layout a graph with singleton nodes (nodes with any  
edges), using the "neato" layout machinery. This is - from the point  
of view of Graphviz - a special case, so it is not surprising that it  
might not work. For strange reasons this bug was not present in 2.5  
and 2.7 (odd numbers are devel versions). The reason why the OP had  
problems is that the vignette uses a random graph with a 0.2  
probability of including an edge, which usually leads to a graph with  
singleton nodes. Rgraphviz checks for versions 2.4 and 2.6 but was  
not updated after 2.8 was released. At least I have this problem on  
PPC and posters have reported the problem on Intel. The problem  
exists in Simon's binary version using the cmd line tools, so it is a  
Graphviz issue. Unless you have special needs (singleton nodes,  
unconnected graphs) it might be easiest to use Simon's binary.

2) The old version of Rgraphviz does not work with 2.10 and 2.12 (the  
newest version). I have (just) submitted a path that should make it  
workable with newer versions. It might take some time to appear.

Here is a quick lowdown on how to get Graphviz working on your system  
if you intend to compile from source.

* Do not use any optimization. Well, at least -O2 leads to broken  
binaries on PPC. This is due to some alignment issues (so just  
disabling some of the alignment optimizations might make it  
workable). This may or may not be a problem on Intel as well. The  
code compiles, the layout just gets messed up (run an example, it is  
easy to see, trust me :)

* You may avoid installing pkgconfig if you install Rgraphviz from  
source and use
   --config-args="--with-graphviz=/usr/local"
(if you have installed Graphviz in /usr/local).

* If you are using i-installer for TeX'ing you might have installed  
libpng using this program. Unfortunately, i-installer's version of  
libpng does not include a version which permits dynamic linking to  
the library per default. In order to get this you should set  
IL2DYLIBS=Keep when you install the package - for details see the i- 
installer release notes for libpng - this one took me a while to  
discover... Missing the dynamic version will result in a linking  
error so just try to compile it and see...

* With these settings it appears it works out of the box.  
Specifically I used the 4.0.3 version of GCC supplied with the CRAN  
binary of R and I configured using the following commands
PATH=/usr/local/gcc4.0/bin:$PATH
export PATH
CC="/usr/local/gcc4.0/bin/gcc-4.0 -arch ppc"
export CC
CFLAGS="-g -O0 -std=gnu99"
export CFLAGS
LDFLAGS="-L/usr/local/lib"
export LDFLAGS
CPPFLAGS="-I/usr/local/include"
export CPPFLAGS
CXX="g++-4.0 -arch ppc"
export CXX
CXXFLAGS="-g -O0"
export CXXFLAGS
CPP="gcc-4.0 -arch ppc -E"
export CPP
CXXCPP="g++-4.0 -arch ppc -E"
export CXXCPP
F77="gfortran-4.0 -arch ppc"
export F77
FFLAGS="-g -O0"
export FFLAGS

./configure --prefix=/usr/local \
    --mandir=/usr/local/share/man

make
sudo make install

Kasper


On Aug 24, 2006, at 10:05 AM, Seth Falcon wrote:

> Rob J Goedman <goedman at mac.com> writes:
>
>> Seth,
>>
>> Quite the contrary, most (all?) of the mails I've seen are on ppc.
>
> Yep, I was completely wrong on that one.
>
> As you demonstrated in a private mail, the issue appears to be with
> graphviz 2.8 on OS X (ppc _and_ intel).
>
> I was able to run the test script using Rgraphviz and a 2.7 devel
> version of graphviz (not sure how to get a hold of this).
>
> At any rate, we will be communicating with the graphviz team to report
> this.
>
> Sorry for the inconvenience, folks, but if the problem really is in
> graphviz itself, there isn't too much we can do...
>
> + seth
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From w.northcott at unsw.edu.au  Tue Dec 12 05:41:15 2006
From: w.northcott at unsw.edu.au (Bill Northcott)
Date: Tue, 12 Dec 2006 15:41:15 +1100
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <mailman.1035.1165891196.7140.r-sig-mac@stat.math.ethz.ch>
References: <mailman.1035.1165891196.7140.r-sig-mac@stat.math.ethz.ch>
Message-ID: <37CA7A0F-3046-4B2F-AD64-9A455B4CC34E@unsw.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-sig-mac/attachments/20061212/3bf9fa05/attachment.pl 

From simon.urbanek at r-project.org  Tue Dec 12 05:46:05 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 11 Dec 2006 23:46:05 -0500
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
Message-ID: <3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>


On Dec 11, 2006, at 7:12 AM, stefano iacus wrote:

> Duncan,
> I see now. On PPC you should use
>
>     file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))
>
> and, under intel,
>
>     file.exists(system.file("libs/i386", "aglrgl.so", package ="rgl"))
>
> instead of just
>
>     file.exists(system.file("libs", "aglrgl.so", package ="rgl"))
>
> i.e.
>     file.exists(system.file(file.path("libs",.Platform$r_arch),
> "aglrgl.so", package ="rgl"))
>

you can drop the file.path there i.e.
system.file("libs",.Platform$r_arch,"aglrgl.so", package ="rgl")

and yes, everyone should be careful when using libs, because multi- 
arch builds are now more common (not just on Macs).


> And yes, you have to explicitly set the DISPLAY var under the shell  
> unless you use xterm.
>
> I have only one doubt, which I'm going to verify: if you override the
> DYLD_LIBRARY_PATH var there should be potential problems with tcltk
> which is still x11.
>

Nope - the line is in fact a noop in current versions of R, because  
we no longer set DYLD_LIBRARY_PATH anymore (it was causing too much  
trouble).

Cheers,
Simon

BTW: this is the second message I didn't get from Duncan - is there  
some filtering in place?

>
>
>
> On 11/dic/06, at 20:49, Duncan Murdoch wrote:
>
>> On 12/10/2006 8:51 PM, stefano iacus wrote:
>>> It builds fine on PCC and apparently the two libs are in the
>>> installed directory.
>>> The only problem is that both on X11 term and on R.app always the
>>> X11 .dll is taken, so no AGL for me any more.
>>> I don't see any conditionals on .Platform$GUI in the loading of the
>>> library though.
>>
>> It's in the .onLoad function in zzz.R:
>>
>>    if ( .Platform$OS.type == "unix" ) {
>>      unixos <- system("uname",intern=TRUE)
>>      if ( unixos == "Darwin" ) {
>>        # For MacOS X we have to remove /usr/X11R6/lib from the
>> DYLD_LIBRARY_PATH
>>        # because it would override Apple's OpenGL framework
>>
>> Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv
>> ("DYLD_LIBRARY_PATH")))
>>        if ( .Platform$GUI == "AQUA" &&
>>             file.exists(system.file("libs", "aglrgl.so", package =
>> "rgl"))) {
>>          initValue <- 1
>>          rgl <<- "aglrgl"
>>        }
>>      }
>>    }
>>
>> Does the lib get a different name or sit somewhere else on that
>> system?
>>   I have the file.exists test in case someone has configured not to
>> build the AGL version, but maybe the filename is wrong.  Do you  
>> know a
>> safe test to see if the lib exists?
>>
>> On 12/10/2006 8:56 PM, stefano iacus wrote:
>>> and, for the standard  shell (i.e. not under xterm), I can open and
>>> plot on a  x11() device but during  demo(rgl)
>>>
>>>> rgl.open()
>>> Error in rgl.open() : rgl.open failed
>>>> rgl.open
>>
>> The initialization is currently done in .onLoad, and if it fails, no
>> additional attempts are made.  I'll see if it's safe to try again.
>>
>> By the way, did you manually set DISPLAY before you opened the x11
>> device?  I get an error in the standard shell when I try that, but
>> Sys.putenv fixes it.
>>
>> Duncan Murdoch
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>


From stefano.iacus at unimi.it  Tue Dec 12 05:55:19 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Tue, 12 Dec 2006 13:55:19 +0900
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
	<3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>
Message-ID: <93EE0C25-25D2-415A-8532-CD3602FE2217@unimi.it>


On 12/dic/06, at 13:46, Simon Urbanek wrote:

>
> On Dec 11, 2006, at 7:12 AM, stefano iacus wrote:
>
>> Duncan,
>> I see now. On PPC you should use
>>
>>     file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))
>>
>> and, under intel,
>>
>>     file.exists(system.file("libs/i386", "aglrgl.so", package  
>> ="rgl"))
>>
>> instead of just
>>
>>     file.exists(system.file("libs", "aglrgl.so", package ="rgl"))
>>
>> i.e.
>>     file.exists(system.file(file.path("libs",.Platform$r_arch),
>> "aglrgl.so", package ="rgl"))
>>
>
> you can drop the file.path there i.e.
> system.file("libs",.Platform$r_arch,"aglrgl.so", package ="rgl")
>
> and yes, everyone should be careful when using libs, because multi- 
> arch builds are now more common (not just on Macs).
>
>
>> And yes, you have to explicitly set the DISPLAY var under the  
>> shell unless you use xterm.
>>
>> I have only one doubt, which I'm going to verify: if you override the
>> DYLD_LIBRARY_PATH var there should be potential problems with tcltk
>> which is still x11.
>>
>
> Nope - the line is in fact a noop in current versions of R, because  
> we no longer set DYLD_LIBRARY_PATH anymore (it was causing too much  
> trouble).
>
> Cheers,
> Simon
>
> BTW: this is the second message I didn't get from Duncan - is there  
> some filtering in place?

not on r-sig-mac, if this is what you meant.
stefano


From murdoch at stats.uwo.ca  Tue Dec 12 06:22:36 2006
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 12 Dec 2006 00:22:36 -0500
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
	<3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>
Message-ID: <457E3C9C.2000104@stats.uwo.ca>

Simon Urbanek wrote:
> On Dec 11, 2006, at 7:12 AM, stefano iacus wrote:
>
>   
>> Duncan,
>> I see now. On PPC you should use
>>
>>     file.exists(system.file("libs/ppc", "aglrgl.so", package ="rgl"))
>>
>> and, under intel,
>>
>>     file.exists(system.file("libs/i386", "aglrgl.so", package ="rgl"))
>>
>> instead of just
>>
>>     file.exists(system.file("libs", "aglrgl.so", package ="rgl"))
>>
>> i.e.
>>     file.exists(system.file(file.path("libs",.Platform$r_arch),
>> "aglrgl.so", package ="rgl"))
>>
>>     
>
> you can drop the file.path there i.e.
> system.file("libs",.Platform$r_arch,"aglrgl.so", package ="rgl")
>
> and yes, everyone should be careful when using libs, because multi- 
> arch builds are now more common (not just on Macs).
>   

When I do the builds here, I don't get the .Platform$r_arch in the 
path.   (I'm just doing R CMD build, R CMD install *.tar.gz).
So I'll put in a test that looks for the lib in both locations.
>
>   
>> And yes, you have to explicitly set the DISPLAY var under the shell  
>> unless you use xterm.
>>
>> I have only one doubt, which I'm going to verify: if you override the
>> DYLD_LIBRARY_PATH var there should be potential problems with tcltk
>> which is still x11.
>>
>>     
>
> Nope - the line is in fact a noop in current versions of R, because  
> we no longer set DYLD_LIBRARY_PATH anymore (it was causing too much  
> trouble).
>
> Cheers,
> Simon
>
> BTW: this is the second message I didn't get from Duncan - is there  
> some filtering in place?
>   
I don't know, but the rgl-devel address doesn't seem to be working for 
me.  "neoscientists.net" has recently undergone a lot of renovations, 
and that address may have been messed up.

Bill was questioning the DYLD_LIBRARY_PATH line as well.  I don't really 
know the purpose of it beyond what the comment says:  Daniel put it in 
place a couple of years ago when he added Darwin support.  We currently 
only require R 1.9.0 or better, so I'd rather leave it there if it's 
harmless in current R.

I've just put 
http://www.stats.uwo.ca/faculty/murdoch/temp/rgl_0.69.536.tar.gz online; 
it contains the revised test.  I've also
documented the dangerous function rgl.init(), which redoes the 
initialization (in case you forgot to start X first, this gives
you a second chance).  It's dangerous, because if you have any open rgl 
windows when you call it, they'll be orphaned.  There
might be memory leaks even in other cases, but I'm not going to take the 
time to track them down.

Duncan Murdoch
>   
>>
>> On 11/dic/06, at 20:49, Duncan Murdoch wrote:
>>
>>     
>>> On 12/10/2006 8:51 PM, stefano iacus wrote:
>>>       
>>>> It builds fine on PCC and apparently the two libs are in the
>>>> installed directory.
>>>> The only problem is that both on X11 term and on R.app always the
>>>> X11 .dll is taken, so no AGL for me any more.
>>>> I don't see any conditionals on .Platform$GUI in the loading of the
>>>> library though.
>>>>         
>>> It's in the .onLoad function in zzz.R:
>>>
>>>    if ( .Platform$OS.type == "unix" ) {
>>>      unixos <- system("uname",intern=TRUE)
>>>      if ( unixos == "Darwin" ) {
>>>        # For MacOS X we have to remove /usr/X11R6/lib from the
>>> DYLD_LIBRARY_PATH
>>>        # because it would override Apple's OpenGL framework
>>>
>>> Sys.putenv("DYLD_LIBRARY_PATH"=gsub("/usr/X11R6/lib","",Sys.getenv
>>> ("DYLD_LIBRARY_PATH")))
>>>        if ( .Platform$GUI == "AQUA" &&
>>>             file.exists(system.file("libs", "aglrgl.so", package =
>>> "rgl"))) {
>>>          initValue <- 1
>>>          rgl <<- "aglrgl"
>>>        }
>>>      }
>>>    }
>>>
>>> Does the lib get a different name or sit somewhere else on that
>>> system?
>>>   I have the file.exists test in case someone has configured not to
>>> build the AGL version, but maybe the filename is wrong.  Do you  
>>> know a
>>> safe test to see if the lib exists?
>>>
>>> On 12/10/2006 8:56 PM, stefano iacus wrote:
>>>       
>>>> and, for the standard  shell (i.e. not under xterm), I can open and
>>>> plot on a  x11() device but during  demo(rgl)
>>>>
>>>>         
>>>>> rgl.open()
>>>>>           
>>>> Error in rgl.open() : rgl.open failed
>>>>         
>>>>> rgl.open
>>>>>           
>>> The initialization is currently done in .onLoad, and if it fails, no
>>> additional attempts are made.  I'll see if it's safe to try again.
>>>
>>> By the way, did you manually set DISPLAY before you opened the x11
>>> device?  I get an error in the standard shell when I try that, but
>>> Sys.putenv fixes it.
>>>
>>> Duncan Murdoch
>>>
>>> _______________________________________________
>>> R-SIG-Mac mailing list
>>> R-SIG-Mac at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>>
>>>       
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>>
>>


From walton.green at yale.edu  Tue Dec 12 16:23:32 2006
From: walton.green at yale.edu (Walton A. Green)
Date: Tue, 12 Dec 2006 10:23:32 -0500 (EST)
Subject: [R-SIG-Mac] Installing packages from .gz files
In-Reply-To: <mailman.1035.1165891196.7140.r-sig-mac@stat.math.ethz.ch>
References: <mailman.1035.1165891196.7140.r-sig-mac@stat.math.ethz.ch>
Message-ID: <Pine.LNX.4.63.0612121002480.16568@ajax.its.yale.edu>


Tim,

Are you sure it is a binary package? Try a source install (or look in 
the uncompressed version of the package to see whether the gamlss/R/ 
directory is full of R code or has binary files with extensions .rdb and 
.rdx) You might also check permissions to make sure R has admin authority 
to install it system-wide (assuming that's where you want it), e.g. by 
clicking the lock at the top of the R interpreter window and 
authenticating. You definitely want to point at the .tar.gz file, not the 
uncompressed versions and I assume you have gunzip and tar (man gunzip and 
man tar should give you their help pages respectively in a terminal 
window if they are correctly installed). Otherwise I'm not sure what the 
problem is.

Walton

> Date: Mon, 11 Dec 2006 16:23:56 +0000
> From: Tim Cole <tim.cole at ich.ucl.ac.uk>
> Subject: [R-SIG-Mac] Installing packages from .gz files
> To: r-sig-mac at stat.math.ethz.ch
> Cc: Mikis Stasinopoulos <d.stasinopoulos at londonmet.ac.uk>
> Message-ID: <p06240832c1a3319ed171@[192.168.11.3]>
> Content-Type: text/plain; charset=us-ascii; format=flowed

> I've been given an updated version of the gamlss package as a .tar.gz
> file, but I'm struggling to install it with the package installer. I
> specify Local Binary Package at the top, but when I Install and
> select the file I get errors whichever of the three possible files I
> point to - the .tar.gz file or .tar file or the gamlss folder. What
> am I doing wrong?

> The .gz file error is:
> Error in gzfile(file, "r") : unable to open connection
> In addition: Warning message:
> cannot open compressed file 'gamlss_1.4-6.tar.gz/DESCRIPTION'

> Thanks,
> Tim Cole
> -- 
> Tim.Cole at ich.ucl.ac.uk   Phone +44(0)20 7905 2666  Fax +44(0)20 7905 
2381
> Paed Epidemiology & Biostats, Institute of Child Health, London WC1N 
1EH, UK

######################## .signature ########################
# Walton A. Green                    walton.green at yale.edu #
# 139 Caulkinstown Road     P. O. Box 208109, Yale Station #
# Sharon, Connecticut 06069   New Haven, Connecticut 06520 #
# (860) 364-5100                            (203) 640-8122 #
#################### 60 characters wide ####################


From tim.cole at ich.ucl.ac.uk  Wed Dec 13 00:13:23 2006
From: tim.cole at ich.ucl.ac.uk (Tim Cole)
Date: Tue, 12 Dec 2006 23:13:23 +0000
Subject: [R-SIG-Mac] Installing packages from .gz files
Message-ID: <p06240848c1a4e5ef6239@[192.168.11.3]>

Thanks to Paul Roebuck and Walton A. Green, I now realise it is a 
Source Package not a Binary Package, and I install the .tar.gz file, 
but I still get this error when I Install:

WARNING: ignoring environment value of R_HOME
* Installing *source* package 'gamlss' ...
** libs
** arch - ppc
** Removing 
'/Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss'
** Restoring previous 
'/Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss'
/Library/Frameworks/R.framework/Resources/bin/SHLIB: line 1: make: 
command not found
chmod: 
/Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss/libs/ppc/*: 
No such file or directory
ERROR: compilation failed for package 'gamlss'

This happens with the package installer or from the command line, and 
authenticating makes no difference. Why is the make command not found?

Tim

At 16:23 +0000 11/12/06, Tim Cole wrote:
>I've been given an updated version of the gamlss package as a 
>.tar.gz file, but I'm struggling to install it with the package 
>installer. I specify Local Binary Package at the top, but when I 
>Install and select the file I get errors whichever of the three 
>possible files I point to - the .tar.gz file or .tar file or the 
>gamlss folder. What am I doing wrong?
>
>The .gz file error is:
>Error in gzfile(file, "r") : unable to open connection
>In addition: Warning message:
>cannot open compressed file 'gamlss_1.4-6.tar.gz/DESCRIPTION'
>
>Thanks,
>Tim Cole

-- 
Tim.Cole at ich.ucl.ac.uk   Phone +44(0)20 7905 2666  Fax +44(0)20 7905 2381
Paed Epidemiology & Biostats, Institute of Child Health, London WC1N 1EH, UK


From khansen at stat.Berkeley.EDU  Wed Dec 13 01:02:00 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Tue, 12 Dec 2006 16:02:00 -0800
Subject: [R-SIG-Mac] Installing packages from .gz files
In-Reply-To: <p06240848c1a4e5ef6239@[192.168.11.3]>
References: <p06240848c1a4e5ef6239@[192.168.11.3]>
Message-ID: <E7654507-E190-4B04-8222-998DB8DDF789@stat.berkeley.edu>

You need to install the following
1) The developer tools from the Tiger DVD. You have a bunch of  
options regarding what to install - for now I would just select  
everything unless you are low on space
2) Install the tools from the CRAN binary of R. You do that by  
downloading the binary and starting to install R as usual. Under the  
installation process you can at one time choose "customize". A window  
pops up allowing you to select amongst others Gcc-4.0.3 and a Tcltk  
framework. Select everything.

That should give you make as well as a C compiler.

Kasper

On Dec 12, 2006, at 3:13 PM, Tim Cole wrote:

> Thanks to Paul Roebuck and Walton A. Green, I now realise it is a
> Source Package not a Binary Package, and I install the .tar.gz file,
> but I still get this error when I Install:
>
> WARNING: ignoring environment value of R_HOME
> * Installing *source* package 'gamlss' ...
> ** libs
> ** arch - ppc
> ** Removing
> '/Library/Frameworks/R.framework/Versions/2.4/Resources/library/ 
> gamlss'
> ** Restoring previous
> '/Library/Frameworks/R.framework/Versions/2.4/Resources/library/ 
> gamlss'
> /Library/Frameworks/R.framework/Resources/bin/SHLIB: line 1: make:
> command not found
> chmod:
> /Library/Frameworks/R.framework/Versions/2.4/Resources/library/ 
> gamlss/libs/ppc/*:
> No such file or directory
> ERROR: compilation failed for package 'gamlss'
>
> This happens with the package installer or from the command line, and
> authenticating makes no difference. Why is the make command not found?
>
> Tim
>
> At 16:23 +0000 11/12/06, Tim Cole wrote:
>> I've been given an updated version of the gamlss package as a
>> .tar.gz file, but I'm struggling to install it with the package
>> installer. I specify Local Binary Package at the top, but when I
>> Install and select the file I get errors whichever of the three
>> possible files I point to - the .tar.gz file or .tar file or the
>> gamlss folder. What am I doing wrong?
>>
>> The .gz file error is:
>> Error in gzfile(file, "r") : unable to open connection
>> In addition: Warning message:
>> cannot open compressed file 'gamlss_1.4-6.tar.gz/DESCRIPTION'
>>
>> Thanks,
>> Tim Cole
>
> -- 
> Tim.Cole at ich.ucl.ac.uk   Phone +44(0)20 7905 2666  Fax +44(0)20  
> 7905 2381
> Paed Epidemiology & Biostats, Institute of Child Health, London  
> WC1N 1EH, UK
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From byron.ellis at gmail.com  Wed Dec 13 01:05:37 2006
From: byron.ellis at gmail.com (Byron Ellis)
Date: Tue, 12 Dec 2006 16:05:37 -0800
Subject: [R-SIG-Mac] Installing packages from .gz files
In-Reply-To: <p06240848c1a4e5ef6239@192.168.11.3>
References: <p06240848c1a4e5ef6239@192.168.11.3>
Message-ID: <7098abec0612121605m6cd9a9d0se53e330dbf0bdb4c@mail.gmail.com>

Have you installed the Developer's Tools? Is make otherwise available
from Terminal?

On 12/12/06, Tim Cole <tim.cole at ich.ucl.ac.uk> wrote:
> Thanks to Paul Roebuck and Walton A. Green, I now realise it is a
> Source Package not a Binary Package, and I install the .tar.gz file,
> but I still get this error when I Install:
>
> WARNING: ignoring environment value of R_HOME
> * Installing *source* package 'gamlss' ...
> ** libs
> ** arch - ppc
> ** Removing
> '/Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss'
> ** Restoring previous
> '/Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss'
> /Library/Frameworks/R.framework/Resources/bin/SHLIB: line 1: make:
> command not found
> chmod:
> /Library/Frameworks/R.framework/Versions/2.4/Resources/library/gamlss/libs/ppc/*:
> No such file or directory
> ERROR: compilation failed for package 'gamlss'
>
> This happens with the package installer or from the command line, and
> authenticating makes no difference. Why is the make command not found?
>
> Tim
>
> At 16:23 +0000 11/12/06, Tim Cole wrote:
> >I've been given an updated version of the gamlss package as a
> >.tar.gz file, but I'm struggling to install it with the package
> >installer. I specify Local Binary Package at the top, but when I
> >Install and select the file I get errors whichever of the three
> >possible files I point to - the .tar.gz file or .tar file or the
> >gamlss folder. What am I doing wrong?
> >
> >The .gz file error is:
> >Error in gzfile(file, "r") : unable to open connection
> >In addition: Warning message:
> >cannot open compressed file 'gamlss_1.4-6.tar.gz/DESCRIPTION'
> >
> >Thanks,
> >Tim Cole
>
> --
> Tim.Cole at ich.ucl.ac.uk   Phone +44(0)20 7905 2666  Fax +44(0)20 7905 2381
> Paed Epidemiology & Biostats, Institute of Child Health, London WC1N 1EH, UK
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From goedman at mac.com  Wed Dec 13 21:03:12 2006
From: goedman at mac.com (Rob J Goedman)
Date: Wed, 13 Dec 2006 12:03:12 -0800
Subject: [R-SIG-Mac] X11
Message-ID: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>

Hi,

Just wondering about X11 on Intel Macs. My new machine came without  
the X11 app
and I have not been able to find it on any of the supplied disks or  
the Apple site (there
is an installer for ppc (X11user.dmg) and a universal X11 upgrade  
(X11Update2006.dmg).
Neither will allow me to install X11.

Any ideas?

Thanks,
Rob


From deleeuw at stat.ucla.edu  Wed Dec 13 21:10:25 2006
From: deleeuw at stat.ucla.edu (Jan de Leeuw)
Date: Wed, 13 Dec 2006 12:10:25 -0800
Subject: [R-SIG-Mac] X11
In-Reply-To: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
References: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
Message-ID: <9AF6102F-3A86-46BD-9263-7E9860BE1BBF@stat.ucla.edu>

There have been a number of recent X11 updates (improved GL support)
on the Apple Developer site. It is on my Tiger/Leopard install disks,
don;t know why it's not on yours.

On Dec 13, 2006, at 12:03 , Rob J Goedman wrote:

> Hi,
>
> Just wondering about X11 on Intel Macs. My new machine came without
> the X11 app
> and I have not been able to find it on any of the supplied disks or
> the Apple site (there
> is an installer for ppc (X11user.dmg) and a universal X11 upgrade
> (X11Update2006.dmg).
> Neither will allow me to install X11.
>
> Any ideas?
>
> Thanks,
> Rob
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>

==========================================================
Jan de Leeuw, 11667 Steinhoff Rd, Frazier Park, CA 93225
home 661-245-1725 skype 661-347-0667 global 254-381-4905
.mac: jdeleeuw +++  aim: deleeuwjan +++ skype: j_deleeuw
==========================================================
                Many nights on the road
       and not dead yet ---
                the end of autumn.       (Basho 1644-1694)


From kbroman at jhsph.edu  Wed Dec 13 21:17:28 2006
From: kbroman at jhsph.edu (Karl W Broman)
Date: Wed, 13 Dec 2006 15:17:28 -0500
Subject: [R-SIG-Mac] X11
In-Reply-To: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
References: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
Message-ID: <E8316406-184C-46FE-9A4E-76A52D6D7D68@jhsph.edu>

I think if you use the Mac OS X install disk and choose
"Install Mac OS X and bundled software" and restart, then
select "Customize", and then select X11 and deselect the others,
you can install X11.

karl
----------
Karl W. Broman                  phone   410-614-9408
Department of Biostatistics     fax     410-955-0958
Johns Hopkins University        email   kbroman at jhsph.edu
http://www.biostat.jhsph.edu/~kbroman


On Dec 13, 2006, at 3:03 PM, Rob J Goedman wrote:

> Hi,
>
> Just wondering about X11 on Intel Macs. My new machine came without
> the X11 app
> and I have not been able to find it on any of the supplied disks or
> the Apple site (there
> is an installer for ppc (X11user.dmg) and a universal X11 upgrade
> (X11Update2006.dmg).
> Neither will allow me to install X11.
>
> Any ideas?
>
> Thanks,
> Rob
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From goedman at mac.com  Wed Dec 13 22:21:12 2006
From: goedman at mac.com (Rob J Goedman)
Date: Wed, 13 Dec 2006 13:21:12 -0800
Subject: [R-SIG-Mac] X11
In-Reply-To: <E8316406-184C-46FE-9A4E-76A52D6D7D68@jhsph.edu>
References: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
	<E8316406-184C-46FE-9A4E-76A52D6D7D68@jhsph.edu>
Message-ID: <9E34727E-AFB0-4F1F-AC4B-E1429047FCF9@mac.com>

Thanks Jan and Karl,

It is indeed on the 1st install disk. Took slightly more than an hour
to get it installed. A friend at Apple is checking if this can't be
simplified somehow.

Thanks again,
Rob


On Dec 13, 2006, at 12:17 PM, Karl W Broman wrote:

> I think if you use the Mac OS X install disk and choose
> "Install Mac OS X and bundled software" and restart, then
> select "Customize", and then select X11 and deselect the others,
> you can install X11.
>
> karl
> ----------
> Karl W. Broman                  phone   410-614-9408
> Department of Biostatistics     fax     410-955-0958
> Johns Hopkins University        email   kbroman at jhsph.edu
> http://www.biostat.jhsph.edu/~kbroman
>
>
> On Dec 13, 2006, at 12:10 PM, Jan de Leeuw wrote:
>> There have been a number of recent X11 updates (improved GL support)
>> on the Apple Developer site. It is on my Tiger/Leopard install disks,
>> don;t know why it's not on yours.
>>
>
>
> On Dec 13, 2006, at 3:03 PM, Rob J Goedman wrote:
>
>> Hi,
>>
>> Just wondering about X11 on Intel Macs. My new machine came without
>> the X11 app
>> and I have not been able to find it on any of the supplied disks or
>> the Apple site (there
>> is an installer for ppc (X11user.dmg) and a universal X11 upgrade
>> (X11Update2006.dmg).
>> Neither will allow me to install X11.
>>
>> Any ideas?
>>
>> Thanks,
>> Rob
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From stefano.iacus at unimi.it  Thu Dec 14 02:40:36 2006
From: stefano.iacus at unimi.it (stefano iacus)
Date: Thu, 14 Dec 2006 10:40:36 +0900
Subject: [R-SIG-Mac] X11
In-Reply-To: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
References: <24F0D830-DB7F-4AAF-B834-EC2B3C28FB39@mac.com>
Message-ID: <4EF14AE0-1668-4A24-ABB1-0D36C2A4FE92@unimi.it>

Did you check inside Applications/Installer or something like this.
Usually on pre-installed system, this is where you find additional  
installers.
X11.app in never installed by default.
stefano

On 14/dic/06, at 05:03, Rob J Goedman wrote:

> Hi,
>
> Just wondering about X11 on Intel Macs. My new machine came without
> the X11 app
> and I have not been able to find it on any of the supplied disks or
> the Apple site (there
> is an installer for ppc (X11user.dmg) and a universal X11 upgrade
> (X11Update2006.dmg).
> Neither will allow me to install X11.
>
> Any ideas?
>
> Thanks,
> Rob
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From andrea.mestriner at gmail.com  Thu Dec 14 12:28:59 2006
From: andrea.mestriner at gmail.com (Andrea Mestriner)
Date: Thu, 14 Dec 2006 12:28:59 +0100
Subject: [R-SIG-Mac] Connection problem with RMySQL
Message-ID: <38373cc50612140328i290febacjc805bc746f8fb121@mail.gmail.com>

Hi,

I hope eveyone can help me. I use DBI and RMySQL library to connect R
2.4 from my iBook G4 to a MySQL db. The problem is that if I connect R
to my remote Linux Server thwe connect is ok, but when i try to
connect to offline db (RMySQL of my iBook) R get a crash.

The connection command is:

MySQL(max.con=16, fetch.default.rec=500, force.reload=F)
m<-dbDriver("MySQL")
connessione<-dbConnect(m,user="reteinterna",password="reikem",host="127.0.0.1",dbname="data")

The error message is:

*** caught bus error ***
address 0x54, cause 'invalid alignment'

Traceback:
1: .Call("RS_MySQL_newConnection", drvID, con.params, groups,
default.file, PACKAGE= . MySQLPKgName)
2: mysqlNewConnection(drv, ...)
3: .class1(object)
4: .class1(object)
5: is(object, Cl)
6: .valueClassTest(standardGeneric("dbConnect"),"DBIConnection","dbConnect")
7: dbConnect(m,user="reteinterna",password="reikem",host="127.0.0.1",dbname="data")

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace


What's the problem?

Thanks,

Andrea


From chabotd at globetrotter.net  Thu Dec 14 14:19:45 2006
From: chabotd at globetrotter.net (Denis Chabot)
Date: Thu, 14 Dec 2006 08:19:45 -0500
Subject: [R-SIG-Mac] X11
In-Reply-To: <mailman.21.1166094007.5402.r-sig-mac@stat.math.ethz.ch>
References: <mailman.21.1166094007.5402.r-sig-mac@stat.math.ethz.ch>
Message-ID: <579E39B7-F0D3-4ABD-8EB9-E90D4307DDAE@globetrotter.net>

Maybe a job for Pacifist
http://www.charlessoft.com/

Denis
Le 06-12-14 ? 06:00, r-sig-mac-request at stat.math.ethz.ch a ?crit :

>
> Thanks Jan and Karl,
>
> It is indeed on the 1st install disk. Took slightly more than an hour
> to get it installed. A friend at Apple is checking if this can't be
> simplified somehow.
>
> Thanks again,
> Rob
>


From daj025 at gmail.com  Thu Dec 14 14:51:38 2006
From: daj025 at gmail.com (David James)
Date: Thu, 14 Dec 2006 08:51:38 -0500
Subject: [R-SIG-Mac] Connection problem with RMySQL
In-Reply-To: <38373cc50612140328i290febacjc805bc746f8fb121@mail.gmail.com>
References: <38373cc50612140328i290febacjc805bc746f8fb121@mail.gmail.com>
Message-ID: <74c69e370612140551o3d92a3et1067264bf2d2e247@mail.gmail.com>

Hi,

This is a bug in RMySQL that I'll be fixing in the next couple of days.  If
you need to fix it right now, contact me offline for details.

Regards,

--
David

On 12/14/06, Andrea Mestriner <andrea.mestriner at gmail.com> wrote:
> Hi,
>
> I hope eveyone can help me. I use DBI and RMySQL library to connect R
> 2.4 from my iBook G4 to a MySQL db. The problem is that if I connect R
> to my remote Linux Server thwe connect is ok, but when i try to
> connect to offline db (RMySQL of my iBook) R get a crash.
>
> The connection command is:
>
> MySQL(max.con=16, fetch.default.rec=500, force.reload=F)
> m<-dbDriver("MySQL")
> connessione<-dbConnect(m,user="reteinterna",password="reikem",host="127.0.0.1",dbname="data")
>
> The error message is:
>
> *** caught bus error ***
> address 0x54, cause 'invalid alignment'
>
> Traceback:
> 1: .Call("RS_MySQL_newConnection", drvID, con.params, groups,
> default.file, PACKAGE= . MySQLPKgName)
> 2: mysqlNewConnection(drv, ...)
> 3: .class1(object)
> 4: .class1(object)
> 5: is(object, Cl)
> 6: .valueClassTest(standardGeneric("dbConnect"),"DBIConnection","dbConnect")
> 7: dbConnect(m,user="reteinterna",password="reikem",host="127.0.0.1",dbname="data")
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
>
>
> What's the problem?
>
> Thanks,
>
> Andrea
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From rjohnson at ncifcrf.gov  Thu Dec 14 15:11:31 2006
From: rjohnson at ncifcrf.gov (Randall C Johnson [Contr.])
Date: Thu, 14 Dec 2006 09:11:31 -0500
Subject: [R-SIG-Mac] X11
In-Reply-To: <579E39B7-F0D3-4ABD-8EB9-E90D4307DDAE@globetrotter.net>
Message-ID: <C1A6C5C3.E1AB%rjohnson@ncifcrf.gov>

I ran 'Optional Installs.mpkg' on install disk 1, and it didn't seem to take
that long. It took me awhile to realize this was an option since you have to
scroll down to the bottom of the window, but it seemed to be fairly simple
once I got that far.


On 12/14/06 8:19 AM, "Denis Chabot" <chabotd at globetrotter.net> wrote:

> Maybe a job for Pacifist
> http://www.charlessoft.com/
> 
> Denis
> Le 06-12-14 ? 06:00, r-sig-mac-request at stat.math.ethz.ch a ?crit :
> 
>> 
>> Thanks Jan and Karl,
>> 
>> It is indeed on the 1st install disk. Took slightly more than an hour
>> to get it installed. A friend at Apple is checking if this can't be
>> simplified somehow.
>> 
>> Thanks again,
>> Rob
>> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Randall C Johnson
Bioinformatics Analyst
SAIC-Frederick, Inc (Contractor)
Laboratory of Genomic Diversity
NCI-Frederick, P.O. Box B
Bldg 560, Rm 11-85
Frederick, MD 21702
Phone: (301) 846-1304
Fax: (301) 846-1686
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


From goedman at mac.com  Thu Dec 14 19:53:35 2006
From: goedman at mac.com (Rob J Goedman)
Date: Thu, 14 Dec 2006 10:53:35 -0800
Subject: [R-SIG-Mac] X11
In-Reply-To: <C1A6C5C3.E1AB%rjohnson@ncifcrf.gov>
References: <C1A6C5C3.E1AB%rjohnson@ncifcrf.gov>
Message-ID: <6B167A40-F8CA-4E51-AFBE-EB2E419D5136@mac.com>

Yip, someone at Apple also came back indicating that is what Optional  
Installs
is designed for. You have to select 'customize' and select the X11  
(last)
option in the list.

Thanks for all the replies, I'll add it to the FAQ for Mac OS,
Rob



On Dec 14, 2006, at 6:11 AM, Randall C Johnson [Contr.] wrote:

> I ran 'Optional Installs.mpkg' on install disk 1, and it didn't  
> seem to take
> that long. It took me awhile to realize this was an option since  
> you have to
> scroll down to the bottom of the window, but it seemed to be fairly  
> simple
> once I got that far.
>
>
> On 12/14/06 8:19 AM, "Denis Chabot" <chabotd at globetrotter.net> wrote:
>
>> Maybe a job for Pacifist
>> http://www.charlessoft.com/
>>
>> Denis
>> Le 06-12-14 ? 06:00, r-sig-mac-request at stat.math.ethz.ch a ?crit :
>>
>>>
>>> Thanks Jan and Karl,
>>>
>>> It is indeed on the 1st install disk. Took slightly more than an  
>>> hour
>>> to get it installed. A friend at Apple is checking if this can't be
>>> simplified somehow.
>>>
>>> Thanks again,
>>> Rob
>>>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>>
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Randall C Johnson
> Bioinformatics Analyst
> SAIC-Frederick, Inc (Contractor)
> Laboratory of Genomic Diversity
> NCI-Frederick, P.O. Box B
> Bldg 560, Rm 11-85
> Frederick, MD 21702
> Phone: (301) 846-1304
> Fax: (301) 846-1686
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From simon.urbanek at r-project.org  Fri Dec 15 14:57:23 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 15 Dec 2006 08:57:23 -0500
Subject: [R-SIG-Mac] X11
In-Reply-To: <579E39B7-F0D3-4ABD-8EB9-E90D4307DDAE@globetrotter.net>
References: <mailman.21.1166094007.5402.r-sig-mac@stat.math.ethz.ch>
	<579E39B7-F0D3-4ABD-8EB9-E90D4307DDAE@globetrotter.net>
Message-ID: <78AC3446-425F-406F-8911-4871D8984807@r-project.org>

I missed the original e-mail, but I'm assuming this is about  
installing X11.

This is very simple and it's described in the R for Mac OS X FAQ:

1) Insert Mac OS X  Disk 1 that came with your Mac
2) <Ctrl>-Click [=right button click] on "Install Bundled Software  
Only", select "Show Original"
3) double-click on "X11User.pkg"

If you have a retail version of OS X, replace 2) by
2) Go to System/Installation/Packages

The X11User.pkg is all you need to run X11.

Cheers,
Simon

On Dec 14, 2006, at 8:19 AM, Denis Chabot wrote:

> Maybe a job for Pacifist
> http://www.charlessoft.com/
>
> Denis
> Le 06-12-14 ? 06:00, r-sig-mac-request at stat.math.ethz.ch a ?crit :
>
>>
>> Thanks Jan and Karl,
>>
>> It is indeed on the 1st install disk. Took slightly more than an hour
>> to get it installed. A friend at Apple is checking if this can't be
>> simplified somehow.
>>
>> Thanks again,
>> Rob
>>
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>


From ess28 at cornell.edu  Sat Dec 16 18:43:41 2006
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Sat, 16 Dec 2006 12:43:41 -0500
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
Message-ID: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>

Hello all,

I get the following error when trying to compile some Fortran code to  
a shared object using R CMD SHLIB:

R CMD SHLIB test3.f
gfortran-4.0 -arch ppc   -fPIC  -g -O2 -c test3.f -o test3.o
gcc-4.0 -arch ppc -dynamiclib -Wl,-macosx_version_min -Wl,10.3 - 
undefined dynamic_lookup -single_module -multiply_defined suppress -L/ 
usr/local/lib -o test3.so test3.o -L/Library/Frameworks/R.framework/ 
Resources/lib/ppc -lRlapack -L/Library/Frameworks/R.framework/ 
Resources/lib/ppc -lRblas -lgfortran -lgcc_s -lSystemStubs -lmx - 
lSystem -lgfortran -lgcc_s -lSystemStubs -lmx -lSystem -L/Library/ 
Frameworks/R.framework/Resources/lib/ppc -lR -dylib_file  
libRblas.dylib:/Library/Frameworks/R.framework/Resources/lib/ppc/ 
libRblas.dylib
/usr/bin/libtool: unknown option character `m' in: -macosx_version_min
Usage: /usr/bin/libtool -static [-] file [...] [-filelist listfile 
[,dirname]] [-arch_only arch] [-sacLT]
Usage: /usr/bin/libtool -dynamic [-] file [...] [-filelist listfile 
[,dirname]] [-arch_only arch] [-o output] [-install_name name] [- 
compatibility_version #] [-current_version #] [-seg1addr 0x#] [- 
segs_read_only_addr 0x#] [-segs_read_write_addr 0x#] [-seg_addr_table  
<filename>] [-seg_addr_table_filename <file_system_path>] [-all_load]  
[-noall_load]
make: *** [test3.so] Error 1

It looks like it's having some trouble with libtool, but I don't know  
what it means. I have installed
- the Apple developer tools
- the gcc included with the R installer
- g77 from hpc.sourceforge.net

Am I perhaps missing something, or is something improperly configured?

Thanks,
Emmanuel


From simon.urbanek at r-project.org  Sat Dec 16 22:25:18 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 16 Dec 2006 16:25:18 -0500
Subject: [R-SIG-Mac] rgl revisions to allow dual install
In-Reply-To: <457E3C9C.2000104@stats.uwo.ca>
References: <20061211011940.17CBC77AA@lists.neoscientists.net>
	<457CB3E9.7010009@stats.uwo.ca>
	<9A17B884-9309-4192-870A-7471983B7671@unimi.it>
	<457D45E2.4090704@stats.uwo.ca>
	<4A0CA8CD-92D6-493D-9501-0581B7E48B38@unimi.it>
	<3D3B15DC-B76B-4693-ABEE-0F8AEC48D77F@r-project.org>
	<457E3C9C.2000104@stats.uwo.ca>
Message-ID: <DDA16270-290A-47B0-8B77-4212541F14D7@r-project.org>


On Dec 12, 2006, at 12:22 AM, Duncan Murdoch wrote:

> Simon Urbanek wrote:
>>
>> you can drop the file.path there i.e.
>> system.file("libs",.Platform$r_arch,"aglrgl.so", package ="rgl")
>>
>> and yes, everyone should be careful when using libs, because  
>> multi- arch builds are now more common (not just on Macs).
>>
>
> When I do the builds here, I don't get the .Platform$r_arch in the  
> path.

.. then you have single-arch build and  .Platform$r_arch should be ''  
and thus the path is still ok - that's what I was trying to say ...


>   (I'm just doing R CMD build, R CMD install *.tar.gz).
> So I'll put in a test that looks for the lib in both locations.
>>
>> BTW: this is the second message I didn't get from Duncan - is  
>> there  some filtering in place?
>>
> I don't know, but the rgl-devel address doesn't seem to be working  
> for me.  "neoscientists.net" has recently undergone a lot of  
> renovations, and that address may have been messed up.
>

It may be possibly combination of several things - I just got a few  
mails from R-SIG-Mac with a 3-day lag ..


> Bill was questioning the DYLD_LIBRARY_PATH line as well.  I don't  
> really know the purpose of it beyond what the comment says:  Daniel  
> put it in place a couple of years ago when he added Darwin  
> support.  We currently only require R 1.9.0 or better, so I'd  
> rather leave it there if it's harmless in current R.
>

It was actually my patch long time ago - it was necessary when  
DYLD_LIBRARY_PATH contained /usr/X11R6/lib [because that is what we  
do on other unices] which was throwing off the proper library lookup.  
We have fixed R since, so it is no longer needed. (FWIW unlike  
LD_LIBRARY_PATH it is actually effective immediately so the change  
really mattered).



> I've just put http://www.stats.uwo.ca/faculty/murdoch/temp/ 
> rgl_0.69.536.tar.gz online; it contains the revised test.  I've  
> also documented the dangerous function rgl.init(), which redoes the  
> initialization (in case you forgot to start X first, this gives you  
> a second chance).  It's dangerous, because if you have any open rgl  
> windows when you call it, they'll be orphaned.  There might be  
> memory leaks even in other cases, but I'm not going to take the  
> time to track them down.
>

Great job, thanks! It works as advertized (even universal build seems  
to be ok).

Thanks,
Simon


From elw at stderr.org  Sun Dec 17 00:50:40 2006
From: elw at stderr.org (elw at stderr.org)
Date: Sat, 16 Dec 2006 17:50:40 -0600 (CST)
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
Message-ID: <Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>



> I get the following error when trying to compile some Fortran code to a 
> shared object using R CMD SHLIB:
>
> R CMD SHLIB test3.f
> gfortran-4.0 -arch ppc   -fPIC  -g -O2 -c test3.f -o test3.o
> gcc-4.0 -arch ppc -dynamiclib -Wl,-macosx_version_min -Wl,10.3 -

> It looks like it's having some trouble with libtool, but I don't know
> what it means. I have installed
> - the Apple developer tools
> - the gcc included with the R installer
> - g77 from hpc.sourceforge.net

where'd that gfortran come from?  last time i checked, apple wasn't 
shipping a fortran compiler... have things changed, on that front?

--e


From ess28 at cornell.edu  Sun Dec 17 02:55:48 2006
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Sat, 16 Dec 2006 20:55:48 -0500
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
	<Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
Message-ID: <F2DB953C-5C39-4356-AC90-EC9A0B9F40EC@cornell.edu>


On Dec 16, 2006, at 6:50 PM, elw at stderr.org wrote:

>
>
>> I get the following error when trying to compile some Fortran code  
>> to a shared object using R CMD SHLIB:
>>
>> R CMD SHLIB test3.f
>> gfortran-4.0 -arch ppc   -fPIC  -g -O2 -c test3.f -o test3.o
>> gcc-4.0 -arch ppc -dynamiclib -Wl,-macosx_version_min -Wl,10.3 -
>
>> It looks like it's having some trouble with libtool, but I don't know
>> what it means. I have installed
>> - the Apple developer tools
>> - the gcc included with the R installer
>> - g77 from hpc.sourceforge.net
>
> where'd that gfortran come from?  last time i checked, apple wasn't  
> shipping a fortran compiler... have things changed, on that front?
>

I think the gfortran is what was installed by the R 2.4.0 installer  
package. After installing it, I noticed that I didn't have a g77 yet,  
so I downloaded the one from hpc.sourceforge.net. Hm, is there some  
reason that R CMD SHLIB is calling gfortran instead of g77?

> --e


From khansen at stat.Berkeley.EDU  Sun Dec 17 05:55:31 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Sun, 17 Dec 2006 05:55:31 +0100
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <F2DB953C-5C39-4356-AC90-EC9A0B9F40EC@cornell.edu>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
	<Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
	<F2DB953C-5C39-4356-AC90-EC9A0B9F40EC@cornell.edu>
Message-ID: <052CD80B-4337-4156-B47A-1B756C66D0C3@stat.berkeley.edu>


On Dec 17, 2006, at 2:55 AM, Emmanuel Sharef wrote:

>
> On Dec 16, 2006, at 6:50 PM, elw at stderr.org wrote:
>
>>
>>
>>> I get the following error when trying to compile some Fortran code
>>> to a shared object using R CMD SHLIB:
>>>
>>> R CMD SHLIB test3.f
>>> gfortran-4.0 -arch ppc   -fPIC  -g -O2 -c test3.f -o test3.o
>>> gcc-4.0 -arch ppc -dynamiclib -Wl,-macosx_version_min -Wl,10.3 -
>>
>>> It looks like it's having some trouble with libtool, but I don't  
>>> know
>>> what it means. I have installed
>>> - the Apple developer tools
>>> - the gcc included with the R installer
>>> - g77 from hpc.sourceforge.net
>>
>> where'd that gfortran come from?  last time i checked, apple wasn't
>> shipping a fortran compiler... have things changed, on that front?
>>
>
> I think the gfortran is what was installed by the R 2.4.0 installer
> package. After installing it, I noticed that I didn't have a g77 yet,
> so I downloaded the one from hpc.sourceforge.net. Hm, is there some
> reason that R CMD SHLIB is calling gfortran instead of g77?

I remember an old post by Simon saying that essentially you need  
gfortran for gcc 4 and g77 for gcc 3. So based on that old remark (I  
know next to nothing about Fortran compilers) you are potentially  
doing something dangerous. The good thing is that due to the paths  
settings in R, your g77 does not get used at all, and if it was  
installed in /usr/local as usual, I fail to see how it could affect  
the R compilation unless you have done fishy stuff - at least if you  
are using the CRAN binary. If not, then I am not sure your PATH gets  
set correctly.... which may mix up versions.

That does not really explain why you get the error you get. It seems  
to complain about the -macos.. flag given to the linker. The exact  
same flag appears in the CRAN version, so I fail to see what is wrong.

So unless some of the gurus can quickly identify what is going wrong,  
I think you need to provide some details about your R installation.  
If you are able to, feel free to put up the code somewhere. I would  
not mind running it to see if I get the same error.

Kasper


>> --e
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From khansen at stat.Berkeley.EDU  Sun Dec 17 10:16:22 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Sun, 17 Dec 2006 10:16:22 +0100
Subject: [R-SIG-Mac] adding -Wall
Message-ID: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>

Hi

I am using the CRAN binary of R.

For package development I would like to compile with the -Wall flag.  
What is the best way to add this? Should I just edit
   R.Framework/Resources/ppc/etc/Makeconf
(I am on a G4), and add it to the CFLAGS, CXXFLAGS, FFLAGS variables.  
Or is there a better way, where I do not modify the files in the  
framework?

Btw: any reason why this is not enabled by default

Kasper


From roebuck at mdanderson.org  Sun Dec 17 12:35:38 2006
From: roebuck at mdanderson.org (Paul Roebuck)
Date: Sun, 17 Dec 2006 05:35:38 -0600 (CST)
Subject: [R-SIG-Mac] adding -Wall
In-Reply-To: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
References: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
Message-ID: <Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>

On Sun, 17 Dec 2006, Kasper Daniel Hansen wrote:

> For package development I would like to compile
> with the -Wall flag. What is the best way to add
> this? Should I just edit
>    R.Framework/Resources/ppc/etc/Makeconf
> (I am on a G4), and add it to the CFLAGS, CXXFLAGS,
> FFLAGS variables.
> Or is there a better way, where I do not modify the
> files in the framework?
>
> BTW: any reason why this is not enabled by default

I'd leave the Framework Makeconf alone. It is not enabled
by default because GCC is not guaranteed to be the compiler
for CC.

I'd recommend adding it to PKG_CFLAGS, PKG_CXXFLAGS,
and/or PKG_FFLAGS in your package's Makevars file while
developing the package and remove it prior to release.
Be aware R CMD check will start giving you nonportable
warnings; live with it unless you really feel like going
the configure script route.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From roebuck at mdanderson.org  Sun Dec 17 12:41:41 2006
From: roebuck at mdanderson.org (Paul Roebuck)
Date: Sun, 17 Dec 2006 05:41:41 -0600 (CST)
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
Message-ID: <Pine.OSF.4.58.0612170537370.17641@wotan.mdacc.tmc.edu>

On Sat, 16 Dec 2006, Emmanuel Sharef wrote:

> I get the following error when trying to compile some Fortran code to
> a shared object using R CMD SHLIB:
>
> R CMD SHLIB test3.f
> gfortran-4.0 -arch ppc   -fPIC  -g -O2 -c test3.f -o test3.o
> gcc-4.0 -arch ppc -dynamiclib -Wl,-macosx_version_min -Wl,10.3 -
> undefined dynamic_lookup -single_module -multiply_defined suppress -L/
> usr/local/lib -o test3.so test3.o -L/Library/Frameworks/R.framework/
> Resources/lib/ppc -lRlapack -L/Library/Frameworks/R.framework/
> Resources/lib/ppc -lRblas -lgfortran -lgcc_s -lSystemStubs -lmx -
> lSystem -lgfortran -lgcc_s -lSystemStubs -lmx -lSystem -L/Library/
> Frameworks/R.framework/Resources/lib/ppc -lR -dylib_file
> libRblas.dylib:/Library/Frameworks/R.framework/Resources/lib/ppc/
> libRblas.dylib
> /usr/bin/libtool: unknown option character `m' in: -macosx_version_min
> Usage: /usr/bin/libtool -static [-] file [...] [-filelist listfile
> [,dirname]] [-arch_only arch] [-sacLT]
> Usage: /usr/bin/libtool -dynamic [-] file [...] [-filelist listfile
> [,dirname]] [-arch_only arch] [-o output] [-install_name name] [-
> compatibility_version #] [-current_version #] [-seg1addr 0x#] [-
> segs_read_only_addr 0x#] [-segs_read_write_addr 0x#] [-seg_addr_table
> <filename>] [-seg_addr_table_filename <file_system_path>] [-all_load]
> [-noall_load]
> make: *** [test3.so] Error 1
>
> It looks like it's having some trouble with libtool, but I don't know
> what it means. I have installed
> - the Apple developer tools
> - the gcc included with the R installer
> - g77 from hpc.sourceforge.net
>
> Am I perhaps missing something, or is something improperly configured?

What version of Xcode did you install? The current version
is 2.4.1.

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From khansen at stat.Berkeley.EDU  Sun Dec 17 13:18:32 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Sun, 17 Dec 2006 13:18:32 +0100
Subject: [R-SIG-Mac] adding -Wall
In-Reply-To: <Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>
References: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
	<Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>
Message-ID: <A973BE5A-1DB8-450F-B95F-589576BF7C61@stat.berkeley.edu>


On Dec 17, 2006, at 12:35 PM, Paul Roebuck wrote:

> On Sun, 17 Dec 2006, Kasper Daniel Hansen wrote:
>
>> For package development I would like to compile
>> with the -Wall flag. What is the best way to add
>> this? Should I just edit
>>    R.Framework/Resources/ppc/etc/Makeconf
>> (I am on a G4), and add it to the CFLAGS, CXXFLAGS,
>> FFLAGS variables.
>> Or is there a better way, where I do not modify the
>> files in the framework?
>>
>> BTW: any reason why this is not enabled by default
>
> I'd leave the Framework Makeconf alone. It is not enabled
> by default because GCC is not guaranteed to be the compiler
> for CC.

I can understand that it is not enabled per default if I just  
configured R myself. But here we are talking about the CRAN binary.  
For that specific case I think it is reasonable to assume that a user  
will/should use the gcc shipping with the binary. There are other  
specific changes for the CRAN binary like the fact that the PATH  
variable is set.

> I'd recommend adding it to PKG_CFLAGS, PKG_CXXFLAGS,
> and/or PKG_FFLAGS in your package's Makevars file while
> developing the package and remove it prior to release.

Well, that is a solution. A bit irritating, if you are checking many  
packages, but reasonable I guess.

> Be aware R CMD check will start giving you nonportable
> warnings; live with it unless you really feel like going
> the configure script route.

Eh? I don't get this.

Kasper

> ----------------------------------------------------------
> SIGSIG -- signature too long (core dumped)
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From ess28 at cornell.edu  Sun Dec 17 15:45:12 2006
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Sun, 17 Dec 2006 09:45:12 -0500
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <Pine.OSF.4.58.0612170537370.17641@wotan.mdacc.tmc.edu>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
	<Pine.OSF.4.58.0612170537370.17641@wotan.mdacc.tmc.edu>
Message-ID: <70486F8E-8548-4FAE-B2A4-E2A3BD6634BD@cornell.edu>


On Dec 17, 2006, at 6:41 AM, Paul Roebuck wrote:

> On Sat, 16 Dec 2006, Emmanuel Sharef wrote:
>
>> I get the following error when trying to compile some Fortran code to
>> a shared object using R CMD SHLIB:
>>
>> Am I perhaps missing something, or is something improperly  
>> configured?
>
> What version of Xcode did you install? The current version
> is 2.4.1.

Thank you Paul, you are brilliant! I had installed Xcode 2.0 from my  
old Tiger installation CD and assumed it would be updated to the  
latest version via Software Update. It doesn't do that...
Going to Apple's website and downloading the latest Xcode fixed the  
problem.

Thanks to everyone who replied for all your help!

>
> ----------------------------------------------------------
> SIGSIG -- signature too long (core dumped)
>


From sfalcon at fhcrc.org  Mon Dec 18 16:14:27 2006
From: sfalcon at fhcrc.org (Seth Falcon)
Date: Mon, 18 Dec 2006 07:14:27 -0800
Subject: [R-SIG-Mac] adding -Wall
In-Reply-To: <Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu> (Paul
	Roebuck's message of "Sun, 17 Dec 2006 05:35:38 -0600 (CST)")
References: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
	<Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>
Message-ID: <m23b7d44oc.fsf@ziti.local>

Paul Roebuck <roebuck at mdanderson.org> writes:

> On Sun, 17 Dec 2006, Kasper Daniel Hansen wrote:
>
>> For package development I would like to compile
>> with the -Wall flag. What is the best way to add
>> this? Should I just edit
>>    R.Framework/Resources/ppc/etc/Makeconf
>> (I am on a G4), and add it to the CFLAGS, CXXFLAGS,
>> FFLAGS variables.
>> Or is there a better way, where I do not modify the
>> files in the framework?
>>
>> BTW: any reason why this is not enabled by default
>
> I'd leave the Framework Makeconf alone. It is not enabled
> by default because GCC is not guaranteed to be the compiler
> for CC.

? For the OSX _binary_, the compiler better be known in advance --
unless Simon et al are using some sort of quantum compiler ;-)

It is called Makeconf, afterall, so editing it seems sensible to me.
Changing PKG_* vars is inconvenient if you work on many packages, want
to see warnings in other people's packages, and work on many projects
at once since the probability of forgetting to fix it for a release is
non-zero.

My $0.02

+ seth


From simon.urbanek at r-project.org  Mon Dec 18 17:10:41 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 18 Dec 2006 11:10:41 -0500
Subject: [R-SIG-Mac] adding -Wall
In-Reply-To: <m23b7d44oc.fsf@ziti.local>
References: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
	<Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>
	<m23b7d44oc.fsf@ziti.local>
Message-ID: <84E0DD9C-C3B8-415D-8DF2-3F8B21D299DC@r-project.org>


On Dec 18, 2006, at 10:14 AM, Seth Falcon wrote:

> Paul Roebuck <roebuck at mdanderson.org> writes:
>
>> On Sun, 17 Dec 2006, Kasper Daniel Hansen wrote:
>>
>>> For package development I would like to compile
>>> with the -Wall flag. What is the best way to add
>>> this?

Probably the easiest [courtesy of Kurt]:

mkdir ~/.R
echo "CFLAGS=-g -O2 -Wall -pedantic" > ~/.R/Makevars


>>> Should I just edit
>>>    R.Framework/Resources/ppc/etc/Makeconf
>>> (I am on a G4), and add it to the CFLAGS, CXXFLAGS,
>>> FFLAGS variables.
>>> Or is there a better way, where I do not modify the
>>> files in the framework?
>>>
>>> BTW: any reason why this is not enabled by default
>>
>> I'd leave the Framework Makeconf alone. It is not enabled
>> by default because GCC is not guaranteed to be the compiler
>> for CC.
>
> ? For the OSX _binary_, the compiler better be known in advance --
> unless Simon et al are using some sort of quantum compiler ;-)
>

... sometimes I have the feeling we do ;) [especially after spending  
a night to track down compiler bugs]


Cheers,
Simon


From simon.urbanek at r-project.org  Mon Dec 18 17:18:59 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 18 Dec 2006 11:18:59 -0500
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
	<Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
Message-ID: <0B026699-3FE8-427D-B58C-2F35C073D159@r-project.org>


On Dec 16, 2006, at 6:50 PM, elw at stderr.org wrote:

> /usr/bin/libtool: unknown option character `m' in: -macosx_version_min
>

Please update your Xcode - your libtool is too old.

(Exactly the same question was answered here:
http://www.mail-archive.com/r-sig-mac at stat.math.ethz.ch/msg01220.html
)

Cheers,
Simon


From ess28 at cornell.edu  Mon Dec 18 18:12:24 2006
From: ess28 at cornell.edu (Emmanuel Sharef)
Date: Mon, 18 Dec 2006 12:12:24 -0500
Subject: [R-SIG-Mac] Making Fortran shared objects on Mac
In-Reply-To: <0B026699-3FE8-427D-B58C-2F35C073D159@r-project.org>
References: <3DDFBE8E-59B7-4BF1-AB5E-0B1506DCE144@cornell.edu>
	<Pine.LNX.4.64.0612161748150.6328@illuminati.stderr.org>
	<0B026699-3FE8-427D-B58C-2F35C073D159@r-project.org>
Message-ID: <9592DF61-5483-4BB4-A039-62F00F3F3568@cornell.edu>

On Dec 18, 2006, at 11:18 AM, Simon Urbanek wrote:

>
> On Dec 16, 2006, at 6:50 PM, elw at stderr.org wrote:
>
>> /usr/bin/libtool: unknown option character `m' in: - 
>> macosx_version_min
>>
>
> Please update your Xcode - your libtool is too old.
>
> (Exactly the same question was answered here:
> http://www.mail-archive.com/r-sig-mac at stat.math.ethz.ch/msg01220.html
> )
>

Yes, Paul Roebuck pointed this out yesterday -- the problem is  
resolved. Thank you all again for your help!

- Emmanuel


From khansen at stat.Berkeley.EDU  Tue Dec 19 00:24:43 2006
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Tue, 19 Dec 2006 00:24:43 +0100
Subject: [R-SIG-Mac] adding -Wall
In-Reply-To: <84E0DD9C-C3B8-415D-8DF2-3F8B21D299DC@r-project.org>
References: <502B840D-BB3C-423C-920B-C3E7E99432A8@stat.berkeley.edu>
	<Pine.OSF.4.58.0612170510460.17641@wotan.mdacc.tmc.edu>
	<m23b7d44oc.fsf@ziti.local>
	<84E0DD9C-C3B8-415D-8DF2-3F8B21D299DC@r-project.org>
Message-ID: <231EEE97-96B5-4347-A121-E1EA0D16FD35@stat.Berkeley.EDU>

Thanks for the help, I thought there would be some smart way of doing  
it... (I also sent by a private email to Paul by accident, which is  
superfluous now)

Kasper

On Dec 18, 2006, at 5:10 PM, Simon Urbanek wrote:

>
> On Dec 18, 2006, at 10:14 AM, Seth Falcon wrote:
>
>> Paul Roebuck <roebuck at mdanderson.org> writes:
>>
>>> On Sun, 17 Dec 2006, Kasper Daniel Hansen wrote:
>>>
>>>> For package development I would like to compile
>>>> with the -Wall flag. What is the best way to add
>>>> this?
>
> Probably the easiest [courtesy of Kurt]:
>
> mkdir ~/.R
> echo "CFLAGS=-g -O2 -Wall -pedantic" > ~/.R/Makevars
>
>
>>>> Should I just edit
>>>>    R.Framework/Resources/ppc/etc/Makeconf
>>>> (I am on a G4), and add it to the CFLAGS, CXXFLAGS,
>>>> FFLAGS variables.
>>>> Or is there a better way, where I do not modify the
>>>> files in the framework?
>>>>
>>>> BTW: any reason why this is not enabled by default
>>>
>>> I'd leave the Framework Makeconf alone. It is not enabled
>>> by default because GCC is not guaranteed to be the compiler
>>> for CC.
>>
>> ? For the OSX _binary_, the compiler better be known in advance --
>> unless Simon et al are using some sort of quantum compiler ;-)
>>
>
> ... sometimes I have the feeling we do ;) [especially after  
> spending a night to track down compiler bugs]
>
>
> Cheers,
> Simon
>
>


From Beyerj at students.uni-marburg.de  Thu Dec 21 20:37:19 2006
From: Beyerj at students.uni-marburg.de (J=?ISO-8859-1?B?9g==?=rg Beyer)
Date: Thu, 21 Dec 2006 20:37:19 +0100
Subject: [R-SIG-Mac] Problems with definitions of S4-generics
Message-ID: <C1B0A0FF.20FA%Beyerj@students.uni-marburg.de>

Hello all, 

I installed R 2.4.1 yesterday (coming from 2.2.1), and made an interesting
observation today, which may be a simple coincidence, or related to R 2.4.1.

Platform: 
Mac G4/400 PCI (Oct. 1999, PPC-architecture)
Mac OS 10.4.8
R 2.4.1 for Mac OS X (CRAN binary, 2006-12-19) w/ R.app 1.18


Problem-intro:
The file "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" contains code
that constructs and registers a S4-style generic function, *but only if the
function does not exist, to avoid unnecessary computations.*
This is the stub to test whether or not a S4-Generic is present:
  if ( ! isGeneric( <nameOfS4generic> )) {
    <setGeneric ...>
  } 

The code itself has worked without problems with R 2.2.1 -- the code is not
the problem. 
Okay, let's start. The function in this example is "cleanDataset"; to
demonstrate the problem, I'm using a second S4-generic here, it is named
"removeFactors". 


#### Fist the correct part
## Source the code and build the S4-generic
> source( "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" )


## Do some tests to see if the generic is present,
## and have a look at some details
> isGeneric( "cleanDataset" )
[1] TRUE


> findFunction( "cleanDataset" )
[[1]]
<environment: R_GlobalEnv>


> cleanDataset
nonstandardGenericFunction for "cleanDataset" defined from package
".GlobalEnv"

function (object)
{
    standardGeneric("cleanDataset")
}
<environment: 0x293bbb8>
Methods may be defined for arguments: object


> getGeneric( "cleanDataset" )
## same result as above



#### Now what I suspect is a bug
## Delete the S4-generic (and all its methods, if any)
## and repeat the "forensic" test calls
> removeGeneric( "cleanDataset" )
[1] TRUE


# The following is as expected...
## [I'm trying here to re-translate the message from German back
## to English, so please don't be irritated if there are any differences]
> cleanDataset
Error: object "cleanDataset" not found


# Oops, but what's that?
> getGeneric( "cleanDataset" )
nonstandardGenericFunction for "cleanDataset" defined from package
".GlobalEnv"

function (object) 
{
    standardGeneric("cleanDataset")
}
<environment: 0x19be228>
Methods may be defined for arguments: object


## Why not try to remove it a second time?
> removeGeneric( "cleanDataset" )
[1] FALSE
Warning message:
generic function "cleanDataset" not found for removal in:
removeGeneric("cleanDataset")


# Another test to see if there is a function definition somewhere
# Weird ... 
> isGeneric( "cleanDataset" )
[1] TRUE


# Okay, let's see, where it is
# Ah, registered, but nowhere ...
> findFunction( "cleanDatasets" )
list()


# Just to be sure, test another generic (which I know is *present
# and working*)   Okay, as expected...
> findFunction( "removeFactors" )
[[1]]
<environment: R_GlobalEnv>




#### Consequence: 
# Because my code first tests whether a generic is present or not
# (see above), re-sourcing the definition code leads to nothing
> source( "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" )
> cleanDataset
Error: object "cleanDataset" not found



When I skip testing the existence of a generic, everything works as
expected, of course.
Deleting and redefining generic functions this way never caused problems
under R 2.2.1 (I'm developing with this code since six months, the helper
functions have been called over and over again), but I don't have explicit
results for the above tests and R 2.2.1.

Running the above test case in R.app or from the terminal makes no
difference. At the moment, I can't see a reason why R should do what it
obviously does here, but I may have misunderstood something essential.

Some comments may be helpful.
Thanks for your interest.

Cheers

J?rg


From simon.urbanek at r-project.org  Thu Dec 21 21:24:59 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 21 Dec 2006 15:24:59 -0500
Subject: [R-SIG-Mac] Problems with definitions of S4-generics
In-Reply-To: <C1B0A0FF.20FA%Beyerj@students.uni-marburg.de>
References: <C1B0A0FF.20FA%Beyerj@students.uni-marburg.de>
Message-ID: <34B6BEEB-1150-4100-9366-600F01185284@r-project.org>

Joerg,

this appears to have nothing to do with the Mac port, so please use  
the appropriate mailing list - R-help or R-devel. Also you should try  
to boil it down to a reproducible example -  sourcing local files  
doesn't help.

Cheers,
Simon

On Dec 21, 2006, at 2:37 PM, J?rg Beyer wrote:

> I installed R 2.4.1 yesterday (coming from 2.2.1), and made an  
> interesting
> observation today, which may be a simple coincidence, or related to  
> R 2.4.1.
> [...]
> The code itself has worked without problems with R 2.2.1 -- the  
> code is not
> the problem.

FWIW: That is a very strong assertion - just because some code worked  
previously doesn't mean that it correct or is supposed to work in a  
recent version.


From byron.ellis at gmail.com  Thu Dec 21 20:51:44 2006
From: byron.ellis at gmail.com (Byron Ellis)
Date: Thu, 21 Dec 2006 11:51:44 -0800
Subject: [R-SIG-Mac] Problems with definitions of S4-generics
In-Reply-To: <C1B0A0FF.20FA%Beyerj@students.uni-marburg.de>
References: <C1B0A0FF.20FA%Beyerj@students.uni-marburg.de>
Message-ID: <7098abec0612211151kfdb39d0m359a9570ed1d508f@mail.gmail.com>

This isn't a Mac problem, this is a moving from 2.2 to 2.4. You'll
probably get better answers on R-devel. My guess would be that a cache
used by methods to store frequently used generics isn't getting
flushed by removeGeneric properly, though a brief glance at the code
suggests that it tries. Your best bet is probably to file a bug report
with a simple example.

On 12/21/06, J?rg Beyer <Beyerj at students.uni-marburg.de> wrote:
> Hello all,
>
> I installed R 2.4.1 yesterday (coming from 2.2.1), and made an interesting
> observation today, which may be a simple coincidence, or related to R 2.4.1.
>
> Platform:
> Mac G4/400 PCI (Oct. 1999, PPC-architecture)
> Mac OS 10.4.8
> R 2.4.1 for Mac OS X (CRAN binary, 2006-12-19) w/ R.app 1.18
>
>
> Problem-intro:
> The file "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" contains code
> that constructs and registers a S4-style generic function, *but only if the
> function does not exist, to avoid unnecessary computations.*
> This is the stub to test whether or not a S4-Generic is present:
>   if ( ! isGeneric( <nameOfS4generic> )) {
>     <setGeneric ...>
>   }
>
> The code itself has worked without problems with R 2.2.1 -- the code is not
> the problem.
> Okay, let's start. The function in this example is "cleanDataset"; to
> demonstrate the problem, I'm using a second S4-generic here, it is named
> "removeFactors".
>
>
> #### Fist the correct part
> ## Source the code and build the S4-generic
> > source( "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" )
>
>
> ## Do some tests to see if the generic is present,
> ## and have a look at some details
> > isGeneric( "cleanDataset" )
> [1] TRUE
>
>
> > findFunction( "cleanDataset" )
> [[1]]
> <environment: R_GlobalEnv>
>
>
> > cleanDataset
> nonstandardGenericFunction for "cleanDataset" defined from package
> ".GlobalEnv"
>
> function (object)
> {
>     standardGeneric("cleanDataset")
> }
> <environment: 0x293bbb8>
> Methods may be defined for arguments: object
>
>
> > getGeneric( "cleanDataset" )
> ## same result as above
>
>
>
> #### Now what I suspect is a bug
> ## Delete the S4-generic (and all its methods, if any)
> ## and repeat the "forensic" test calls
> > removeGeneric( "cleanDataset" )
> [1] TRUE
>
>
> # The following is as expected...
> ## [I'm trying here to re-translate the message from German back
> ## to English, so please don't be irritated if there are any differences]
> > cleanDataset
> Error: object "cleanDataset" not found
>
>
> # Oops, but what's that?
> > getGeneric( "cleanDataset" )
> nonstandardGenericFunction for "cleanDataset" defined from package
> ".GlobalEnv"
>
> function (object)
> {
>     standardGeneric("cleanDataset")
> }
> <environment: 0x19be228>
> Methods may be defined for arguments: object
>
>
> ## Why not try to remove it a second time?
> > removeGeneric( "cleanDataset" )
> [1] FALSE
> Warning message:
> generic function "cleanDataset" not found for removal in:
> removeGeneric("cleanDataset")
>
>
> # Another test to see if there is a function definition somewhere
> # Weird ...
> > isGeneric( "cleanDataset" )
> [1] TRUE
>
>
> # Okay, let's see, where it is
> # Ah, registered, but nowhere ...
> > findFunction( "cleanDatasets" )
> list()
>
>
> # Just to be sure, test another generic (which I know is *present
> # and working*)   Okay, as expected...
> > findFunction( "removeFactors" )
> [[1]]
> <environment: R_GlobalEnv>
>
>
>
>
> #### Consequence:
> # Because my code first tests whether a generic is present or not
> # (see above), re-sourcing the definition code leads to nothing
> > source( "/Volumes/RAMdisk/beyerjoerg/Scripting R/source-0.R" )
> > cleanDataset
> Error: object "cleanDataset" not found
>
>
>
> When I skip testing the existence of a generic, everything works as
> expected, of course.
> Deleting and redefining generic functions this way never caused problems
> under R 2.2.1 (I'm developing with this code since six months, the helper
> functions have been called over and over again), but I don't have explicit
> results for the above tests and R 2.2.1.
>
> Running the above test case in R.app or from the terminal makes no
> difference. At the moment, I can't see a reason why R should do what it
> obviously does here, but I may have misunderstood something essential.
>
> Some comments may be helpful.
> Thanks for your interest.
>
> Cheers
>
> J?rg
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From wuolong at gmail.com  Wed Dec 27 18:57:23 2006
From: wuolong at gmail.com (Michael)
Date: Wed, 27 Dec 2006 11:57:23 -0600
Subject: [R-SIG-Mac] R EPS graphics and PDFs from Word Documents
References: <3144C4F831806648B4FD0BA61219385902923A2C@dhsexcmsg05.intra.dhs.ca.gov>
Message-ID: <cwmz591at8.fsf@bass.biostat.umn.edu>

On  7 Nov 2006, Daniel Smith wrote:

> > 
> > Microsoft Word does not handle EPS nor PDF graphics properly. If you
> > want to embed your graphic in a word document, the best option is to
> > save as jpeg from R. The quality of the figure is good enough.
> > 
> > 
> I have had the best results saving the R graphic as pdf (default), then
> using Apple's Preview program to convert it to png.  When pasted into
> Word or PowerPoint, the png graphic can be resized, opened in Windows,
> etc. and still looks good.

The vector-graphics format recognized by MS Word is EMF/WMF, which
unfortunately can not be easily produced on a Mac. (R for Windows can).

I have found that it is possible to convert a EPS file to a PICT file using
GraphicsConverter.  PICT is the old (pre OS X era, before the conversion to
PDF) vector graphics system on Macs.  Word on Mac seems to deal with PICT
files OK. 

Michael


From kjhealy at arizona.edu  Sat Dec 30 20:32:59 2006
From: kjhealy at arizona.edu (Kieran Healy)
Date: Sat, 30 Dec 2006 12:32:59 -0700
Subject: [R-SIG-Mac] changing default console font in R.app
Message-ID: <FBA1B320-2053-4A1C-9363-2456FCC5132F@arizona.edu>

Hi all,

am I right in thinking that the default font for the R.app console  
cannot be changed? I am running 2.4.1 and R.app 1.18 (4038) on OS X  
10.4.8 (PPC).

The FAQ says you can, by choosing Preferences > Text Windows tab,  
from where "You can change the font size, face and the tab size in  
all the windows including the Console." But this doesn't correspond  
to the preferences window in the current version of R.app. There,  
there is no "Text Windows" pane. Instead the "Console" pane allows  
you to set colors and transparency, but not fonts. The "Format" menu  
does allow the console font to be changed, but this change never  
sticks, even for the duration of the session: any new console input  
immediately causes the font to switch back to the default.

I'm just wondering whether I'm missing anything here, or whether it  
just isn't possible to make this change at present.

Thanks,

Kieran

--
Kieran Healy :: http://www.u.arizona.edu/~kjhealy
Assistant Professor, Sociology Dept, University of Arizona.


