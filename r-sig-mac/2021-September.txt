From du@@@@dr|@n @end|ng |rom un|buc@ro  Sun Sep  5 12:16:56 2021
From: du@@@@dr|@n @end|ng |rom un|buc@ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Sun, 5 Sep 2021 13:16:56 +0300
Subject: [R-SIG-Mac] .libPaths and library directory
Message-ID: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>

Dear All,

My .libPaths for the user defined directory shows:
"/Users/dusadrian/Library/R/x86_64/4.1/library"

and indeed, the command install.packages() does install the packages in
this location.

However, when installing from the RGUI menu, using Packages & Data /
Package installer,
the installation directory is:
"/Users/dusadrian/Library/R/4.1/library"

I don't remember at which exact version this started to happen (it was also
present in 4.1.0), and could not find any particular setting that I should
tweak to make these equal.

This is the R.version result:
               _
platform       x86_64-apple-darwin17.0
arch           x86_64
os             darwin17.0
system         x86_64, darwin17.0
status
major          4
minor          1.1
year           2021
month          08
day            10
svn rev        80725
language       R
version.string R version 4.1.1 (2021-08-10)
nickname       Kick Things

running under MacOS BigSur version 11.5.2

Thanks for any hint,
Adrian

--
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr. 90-92
050663 Bucharest sector 5
Romania
https://adriandusa.eu

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Sun Sep  5 13:08:32 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Sun, 5 Sep 2021 07:08:32 -0400
Subject: [R-SIG-Mac] .libPaths and library directory
In-Reply-To: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
References: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
Message-ID: <b0a41c25-b8f2-8314-6e47-9142ac256fb4@gmail.com>

On 05/09/2021 6:16 a.m., Adrian Du?a wrote:
> Dear All,
> 
> My .libPaths for the user defined directory shows:
> "/Users/dusadrian/Library/R/x86_64/4.1/library"
> 
> and indeed, the command install.packages() does install the packages in
> this location.
> 
> However, when installing from the RGUI menu, using Packages & Data /
> Package installer,
> the installation directory is:
> "/Users/dusadrian/Library/R/4.1/library"

Neither of those is the default library location for a standard install 
of R on a Mac.  The first one looks like it's the default value of 
R_LIBS_USER.  Are you specifying the environment variable R_LIBS?  By 
default, I think

   Sys.getenv("R_LIBS")


will give a blank.

Regarding the install from R.app (which I assume is what you mean by 
RGUI), there is a selection of 4 locations:

  - At System Level (in R framework)
  - At User Level
  - In Other Location
  - As defined by .libPaths()

Which of those are you choosing?

Duncan Murdoch

> 
> I don't remember at which exact version this started to happen (it was also
> present in 4.1.0), and could not find any particular setting that I should
> tweak to make these equal.
> 
> This is the R.version result:
>                 _
> platform       x86_64-apple-darwin17.0
> arch           x86_64
> os             darwin17.0
> system         x86_64, darwin17.0
> status
> major          4
> minor          1.1
> year           2021
> month          08
> day            10
> svn rev        80725
> language       R
> version.string R version 4.1.1 (2021-08-10)
> nickname       Kick Things
> 
> running under MacOS BigSur version 11.5.2
> 
> Thanks for any hint,
> Adrian
> 
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr. 90-92
> 050663 Bucharest sector 5
> Romania
> https://adriandusa.eu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From du@@@@dr|@n @end|ng |rom un|buc@ro  Sun Sep  5 17:21:27 2021
From: du@@@@dr|@n @end|ng |rom un|buc@ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Sun, 5 Sep 2021 18:21:27 +0300
Subject: [R-SIG-Mac] .libPaths and library directory
In-Reply-To: <b0a41c25-b8f2-8314-6e47-9142ac256fb4@gmail.com>
References: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
 <b0a41c25-b8f2-8314-6e47-9142ac256fb4@gmail.com>
Message-ID: <CAJ=0CtB=UXNLR3Hv+4WywB8mY-XBzsEWF0z7VaWynCFHDkwhOA@mail.gmail.com>

On Sun, 5 Sept 2021 at 14:08, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:
>
> [...]
>
> Neither of those is the default library location for a standard install
> of R on a Mac.  The first one looks like it's the default value of
> R_LIBS_USER.  Are you specifying the environment variable R_LIBS?  By
> default, I think
>
>    Sys.getenv("R_LIBS")
>
> will give a blank.


I have the same:
> Sys.getenv("R_LIBS")
[1] ""



>
> Regarding the install from R.app (which I assume is what you mean by
> RGUI), there is a selection of 4 locations:
>
>   - At System Level (in R framework)
>   - At User Level
>   - In Other Location
>   - As defined by .libPaths()

Oh, of course I meant R.app, choosing at user level.
I now see what happens, and choosing by .libPaths() does install in the
correct directory. I was somewhat confused because I've always used "At
User Level" (certainly in the past 10 years or so on MacOS) and only
recently this distinction appeared.

Thanks very much, hope this is useful for anyone having the same confusion,
Adrian


--
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr. 90-92
050663 Bucharest sector 5
Romania
https://adriandusa.eu

	[[alternative HTML version deleted]]


From @|mon@urb@nek @end|ng |rom R-project@org  Mon Sep  6 03:26:51 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Mon, 6 Sep 2021 13:26:51 +1200
Subject: [R-SIG-Mac] .libPaths and library directory
In-Reply-To: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
References: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
Message-ID: <F02C3274-D872-4757-B11F-A0BF1C13F869@R-project.org>


Adrian,

thank you, this is indeed a bug that got unnoticed for a while. Apparently the R defaults and the R GUI got out of sync at some point when the R_LIBS_USER defaults were tweaked in R but the corresponding change has not been made in the GUI.  I suppose the right thing to do would be for the GUI to check R_LIBS_USER.

Cheers,
Simon



> On Sep 5, 2021, at 10:16 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
> 
> Dear All,
> 
> My .libPaths for the user defined directory shows:
> "/Users/dusadrian/Library/R/x86_64/4.1/library"
> 
> and indeed, the command install.packages() does install the packages in
> this location.
> 
> However, when installing from the RGUI menu, using Packages & Data /
> Package installer,
> the installation directory is:
> "/Users/dusadrian/Library/R/4.1/library"
> 
> I don't remember at which exact version this started to happen (it was also
> present in 4.1.0), and could not find any particular setting that I should
> tweak to make these equal.
> 
> This is the R.version result:
>               _
> platform       x86_64-apple-darwin17.0
> arch           x86_64
> os             darwin17.0
> system         x86_64, darwin17.0
> status
> major          4
> minor          1.1
> year           2021
> month          08
> day            10
> svn rev        80725
> language       R
> version.string R version 4.1.1 (2021-08-10)
> nickname       Kick Things
> 
> running under MacOS BigSur version 11.5.2
> 
> Thanks for any hint,
> Adrian
> 
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr. 90-92
> 050663 Bucharest sector 5
> Romania
> https://adriandusa.eu
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From du@@@@dr|@n @end|ng |rom un|buc@ro  Mon Sep  6 08:26:57 2021
From: du@@@@dr|@n @end|ng |rom un|buc@ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Mon, 6 Sep 2021 09:26:57 +0300
Subject: [R-SIG-Mac] .libPaths and library directory
In-Reply-To: <F02C3274-D872-4757-B11F-A0BF1C13F869@R-project.org>
References: <CAJ=0CtDMaC5g92TWrshFjVJpstJKNhFiFyXW-7GCWNQM4tAuQQ@mail.gmail.com>
 <F02C3274-D872-4757-B11F-A0BF1C13F869@R-project.org>
Message-ID: <CAJ=0CtDrA4zY4x2jKfjvZ4BFz9WGHod4-onkd_QRWEVwbj4_pA@mail.gmail.com>

On Mon, 6 Sept 2021 at 04:26, Simon Urbanek <simon.urbanek at r-project.org>
wrote:
>
> Adrian,
>
> thank you, this is indeed a bug that got unnoticed for a while.
Apparently the R defaults and the R GUI got out of sync at some point when
the R_LIBS_USER defaults were tweaked in R but the corresponding change has
not been made in the GUI.  I suppose the right thing to do would be for the
GUI to check R_LIBS_USER.
>

Thanks for confirming, Simon, and great that things will be back to normal
soon.
Best,
Adrian

--
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr. 90-92
050663 Bucharest sector 5
Romania
https://adriandusa.eu

	[[alternative HTML version deleted]]


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Mon Sep  6 09:43:40 2021
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Mon, 6 Sep 2021 07:43:40 +0000
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <CAANT7+W4TsZdvTSCXj2KunpsbBd_bEkxe99J+xw5GQLFeaR7bA@mail.gmail.com>
References: <CAANT7+W4TsZdvTSCXj2KunpsbBd_bEkxe99J+xw5GQLFeaR7bA@mail.gmail.com>
Message-ID: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>

When trying to install library reshape2, I get below messages.  But I do have some other packages which depend upon C compiler (e.g., Rcpp).  How can this problem be fixed?

Thanks,
Naresh

Messages when trying to install reshape2:
> install.packages("reshape2", repos = "https://cran.r-project.org")
Installing package into ?/usr/local/lib/R/4.1/site-library?
(as ?lib? is unspecified)
also installing the dependencies ?stringi?, ?stringr?

trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
==================================================
downloaded 7.2 MB

trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
Content type 'application/x-gzip' length 135777 bytes (132 KB)
==================================================
downloaded 132 KB

trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
Content type 'application/x-gzip' length 37307 bytes (36 KB)
==================================================
downloaded 36 KB

* installing *source* package ?stringi? ...
** package ?stringi? successfully unpacked and MD5 sums checked
** using staged installation
checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
checking for endianness... little
checking for R >= 3.1.0 for C++11 use... yes
checking for R < 3.4.0 for CXX1X flag use... no
checking for cat... /bin/cat
checking for local ICUDT_DIR... icu69/data
checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
checking whether the C compiler works... no
configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
configure: error: C compiler cannot create executables
See `config.log' for more details
ERROR: configuration failed for package ?stringi?
* removing ?/usr/local/lib/R/4.1/site-library/stringi?
ERROR: dependency ?stringi? is not available for package ?stringr?
* removing ?/usr/local/lib/R/4.1/site-library/stringr?
ERROR: dependency ?stringr? is not available for package ?reshape2?
* removing ?/usr/local/lib/R/4.1/site-library/reshape2?

The downloaded source packages are in
	?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
Warning messages:
1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
  installation of package ?stringi? had non-zero exit status
2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
  installation of package ?stringr? had non-zero exit status
3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
  installation of package ?reshape2? had non-zero exit status

My session info:
> sessionInfo()
R version 4.1.1 (2021-08-10)
Platform: x86_64-apple-darwin20.5.0 (64-bit)
Running under: macOS Big Sur 11.5.2

Matrix products: default
BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1 



From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Mon Sep  6 09:49:21 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Mon, 6 Sep 2021 08:49:21 +0100
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
References: <CAANT7+W4TsZdvTSCXj2KunpsbBd_bEkxe99J+xw5GQLFeaR7bA@mail.gmail.com>
 <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <b01d74a4-1e99-9bdd-e91b-91d4f3135132@stats.ox.ac.uk>

On 06/09/2021 08:43, Naresh Gurbuxani wrote:
> When trying to install library reshape2, I get below messages.  But I do have some other packages which depend upon C compiler (e.g., Rcpp).  How can this problem be fixed?

You need to look in the config.log file.  The easiest way to make sure 
that is kept is to download the stringi source tarball, unpack it and 
run R CMD INSTALL stringi .

> 
> Thanks,
> Naresh
> 
> Messages when trying to install reshape2:
>> install.packages("reshape2", repos = "https://cran.r-project.org")
> Installing package into ?/usr/local/lib/R/4.1/site-library?
> (as ?lib? is unspecified)
> also installing the dependencies ?stringi?, ?stringr?
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
> Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
> ==================================================
> downloaded 7.2 MB
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
> Content type 'application/x-gzip' length 135777 bytes (132 KB)
> ==================================================
> downloaded 132 KB
> 
> trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
> Content type 'application/x-gzip' length 37307 bytes (36 KB)
> ==================================================
> downloaded 36 KB
> 
> * installing *source* package ?stringi? ...
> ** package ?stringi? successfully unpacked and MD5 sums checked
> ** using staged installation
> checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
> checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
> checking for endianness... little
> checking for R >= 3.1.0 for C++11 use... yes
> checking for R < 3.4.0 for CXX1X flag use... no
> checking for cat... /bin/cat
> checking for local ICUDT_DIR... icu69/data
> checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
> checking whether the C compiler works... no
> configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
> configure: error: C compiler cannot create executables
> See `config.log' for more details
> ERROR: configuration failed for package ?stringi?
> * removing ?/usr/local/lib/R/4.1/site-library/stringi?
> ERROR: dependency ?stringi? is not available for package ?stringr?
> * removing ?/usr/local/lib/R/4.1/site-library/stringr?
> ERROR: dependency ?stringr? is not available for package ?reshape2?
> * removing ?/usr/local/lib/R/4.1/site-library/reshape2?
> 
> The downloaded source packages are in
> 	?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
> Warning messages:
> 1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>    installation of package ?stringi? had non-zero exit status
> 2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>    installation of package ?stringr? had non-zero exit status
> 3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>    installation of package ?reshape2? had non-zero exit status
> 
> My session info:
>> sessionInfo()
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin20.5.0 (64-bit)
> Running under: macOS Big Sur 11.5.2
> 
> Matrix products: default
> BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From dw|n@em|u@ @end|ng |rom comc@@t@net  Tue Sep  7 06:02:50 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Mon, 6 Sep 2021 21:02:50 -0700
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <3FDAB060-0FCA-4504-B6DF-42D636FC8479@comcast.net>

The   C compiler aka clang is not the same as the C++ compiler. 

Why don?t you install the pre-compiled version.

? 
David

Sent from my iPhone

> On Sep 6, 2021, at 12:44 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> ?When trying to install library reshape2, I get below messages.  But I do have some other packages which depend upon C compiler (e.g., Rcpp).  How can this problem be fixed?
> 
> Thanks,
> Naresh
> 
> Messages when trying to install reshape2:
>> install.packages("reshape2", repos = "https://cran.r-project.org")
> Installing package into ?/usr/local/lib/R/4.1/site-library?
> (as ?lib? is unspecified)
> also installing the dependencies ?stringi?, ?stringr?
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
> Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
> ==================================================
> downloaded 7.2 MB
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
> Content type 'application/x-gzip' length 135777 bytes (132 KB)
> ==================================================
> downloaded 132 KB
> 
> trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
> Content type 'application/x-gzip' length 37307 bytes (36 KB)
> ==================================================
> downloaded 36 KB
> 
> * installing *source* package ?stringi? ...
> ** package ?stringi? successfully unpacked and MD5 sums checked
> ** using staged installation
> checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
> checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
> checking for endianness... little
> checking for R >= 3.1.0 for C++11 use... yes
> checking for R < 3.4.0 for CXX1X flag use... no
> checking for cat... /bin/cat
> checking for local ICUDT_DIR... icu69/data
> checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
> checking whether the C compiler works... no
> configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
> configure: error: C compiler cannot create executables
> See `config.log' for more details
> ERROR: configuration failed for package ?stringi?
> * removing ?/usr/local/lib/R/4.1/site-library/stringi?
> ERROR: dependency ?stringi? is not available for package ?stringr?
> * removing ?/usr/local/lib/R/4.1/site-library/stringr?
> ERROR: dependency ?stringr? is not available for package ?reshape2?
> * removing ?/usr/local/lib/R/4.1/site-library/reshape2?
> 
> The downloaded source packages are in
>    ?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
> Warning messages:
> 1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>  installation of package ?stringi? had non-zero exit status
> 2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>  installation of package ?stringr? had non-zero exit status
> 3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>  installation of package ?reshape2? had non-zero exit status
> 
> My session info:
>> sessionInfo()
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin20.5.0 (64-bit)
> Running under: macOS Big Sur 11.5.2
> 
> Matrix products: default
> BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1 
> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From j|ox @end|ng |rom mcm@@ter@c@  Thu Sep  9 20:03:46 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 9 Sep 2021 14:03:46 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
Message-ID: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>

Dear Simon, Philippe, and list members,

I've encountered some Tcl/Tk-related issues with the Apple silicon arm64 
build of R 4.1.0 for macOS. These issues affect the Rcmdr package, 
although they don't prevent it from working:

(1) Some fonts that are available for the Intel build appear to be 
missing from the arm64 build. Compare the screen shots of the Rcmdr main 
window at 
<https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
(Intel build) and 
<https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
(arm64 build). This problem is purely aesthetic.

(2) The Tcl/Tk Tktable package is apparently absent from the arm64 build 
but still present in the Intel build. The Rcmdr detects its absence and 
suppresses some features (i.e., those requiring the Rcmdr data editor). 
I understand that the Tktable package is problematic and it may have 
been removed intentionally.

The Tcl/Tk Tablelist package would be a reasonable substitute, and were 
it available, I could use it to restore the missing features in the 
Rcmdr. I'm aware that Philippe Grosjean planned to incorporate Tablelist 
in his tcltk2 package, but as far as I know, that plan hasn't yet 
materialized. If I knew how to supply a Tcl/Tk package in an R package, 
I could put Tablelist directly in the Rcmdr.

Any help would be greatly appreciated.

John

-- 
John Fox, Professor Emeritus
McMaster University
Hamilton, Ontario, Canada
web: https://socialsciences.mcmaster.ca/jfox/


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Sep  9 20:59:21 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 9 Sep 2021 19:59:21 +0100
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
Message-ID: <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>

On 09/09/2021 19:03, John Fox wrote:
> Dear Simon, Philippe, and list members,
> 
> I've encountered some Tcl/Tk-related issues with the Apple silicon arm64 
> build of R 4.1.0 for macOS. These issues affect the Rcmdr package, 
> although they don't prevent it from working:
> 
> (1) Some fonts that are available for the Intel build appear to be 
> missing from the arm64 build. Compare the screen shots of the Rcmdr main 
> window at 
> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
> (Intel build) and 
> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
> (arm64 build). This problem is purely aesthetic.

It would be helpful to know what those fonts are.  This is likely to be 
a fontconfig issue and needs to be debugged by name.

> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 build 
> but still present in the Intel build. The Rcmdr detects its absence and 
> suppresses some features (i.e., those requiring the Rcmdr data editor). 
> I understand that the Tktable package is problematic and it may have 
> been removed intentionally.

https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
(apparently the latest version from 2008)
does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
uses 'panic' which should be 'Tcl_Panic'.    (The Intel build appears to 
be much older, 8.6.6.)

I have a patched version: AFAICS it installs entirely into 
/opt/R/arm64/lib I could tar it up and make it available.

I could also send the patch to Simon for future use, but note that 
https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk 
(not the X11 build in the CRAN build of R 4.1.[01]) and which does not 
support Tcl/Tk.




-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From j|ox @end|ng |rom mcm@@ter@c@  Thu Sep  9 22:34:03 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 9 Sep 2021 16:34:03 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
 <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
Message-ID: <5bf02be9-a729-e3fb-ff39-043cd4cb4181@mcmaster.ca>

Dear Brian,

Thank you for responding so quickly. Please see below:
On 2021-09-09 2:59 p.m., Prof Brian Ripley wrote:
> On 09/09/2021 19:03, John Fox wrote:
>> Dear Simon, Philippe, and list members,
>>
>> I've encountered some Tcl/Tk-related issues with the Apple silicon 
>> arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr 
>> package, although they don't prevent it from working:
>>
>> (1) Some fonts that are available for the Intel build appear to be 
>> missing from the arm64 build. Compare the screen shots of the Rcmdr 
>> main window at 
>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
>> (Intel build) and 
>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
>> (arm64 build). This problem is purely aesthetic.
> 
> It would be helpful to know what those fonts are.? This is likely to be 
> a fontconfig issue and needs to be debugged by name.

I query the Tk default and fixed-width fonts via

	tclvalue(.Tcl("font actual TkDefaultFont -family")
	tclvalue(.Tcl("font actual TkFixedFont -family"))

and use those -- in the past, that produced pleasing font choices on all 
platforms. In the macOS Intel build, the resulting font families are 
"Verdana" and "Andale Mono"; in the arm64 build, "helvetica" and 
"courier". Perhaps the Intel and arm64 builds were just configured 
differently.

> 
>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>> build but still present in the Intel build. The Rcmdr detects its 
>> absence and suppresses some features (i.e., those requiring the Rcmdr 
>> data editor). I understand that the Tktable package is problematic and 
>> it may have been removed intentionally.
> 
> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
> (apparently the latest version from 2008)
> does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
> uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build appears to 
> be much older, 8.6.6.)
> 
> I have a patched version: AFAICS it installs entirely into 
> /opt/R/arm64/lib I could tar it up and make it available.
> 
> I could also send the patch to Simon for future use, but note that 
> https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk 
> (not the X11 build in the CRAN build of R 4.1.[01]) and which does not 
> support Tcl/Tk.

I'm sorry, but I don't quite understand that -- perhaps there's a typo 
here? Do you mean to say that an aqua build of Tcl/Tk will replace the 
X11 build after R 4.1.1, and that Tktable will be incompatible with it?

If so, first, I think that an aqua Tcl/Tk would be preferable to the 
current X11 version. If I understand correctly, for example, aqua would 
put Tk menus where Mac users expect them.

Second, given the problems that Tktable seems to be producing, wouldn't 
it be better to make Tablelist available as a substitute? I'm happy to 
rewrite the Rcmdr data editor using Tablelist (actually, it's mostly 
done), and, as I said, if I knew how to incorporate the Tcl/Tk Tablelist 
package in the Rcmdr package (if it's undesirable simply to make it 
available generally), I'd do it.

Best,
  John

> 
> 
> 
>


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Thu Sep  9 22:57:51 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Thu, 9 Sep 2021 21:57:51 +0100
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <5bf02be9-a729-e3fb-ff39-043cd4cb4181@mcmaster.ca>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
 <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
 <5bf02be9-a729-e3fb-ff39-043cd4cb4181@mcmaster.ca>
Message-ID: <47576d7e-8d35-0a63-d7fd-b0879edd7330@stats.ox.ac.uk>

On 09/09/2021 21:34, John Fox wrote:
> Dear Brian,
> 
> Thank you for responding so quickly. Please see below:
> On 2021-09-09 2:59 p.m., Prof Brian Ripley wrote:
>> On 09/09/2021 19:03, John Fox wrote:
>>> Dear Simon, Philippe, and list members,
>>>
>>> I've encountered some Tcl/Tk-related issues with the Apple silicon 
>>> arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr 
>>> package, although they don't prevent it from working:
>>>
>>> (1) Some fonts that are available for the Intel build appear to be 
>>> missing from the arm64 build. Compare the screen shots of the Rcmdr 
>>> main window at 
>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
>>> (Intel build) and 
>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
>>> (arm64 build). This problem is purely aesthetic.
>>
>> It would be helpful to know what those fonts are.? This is likely to 
>> be a fontconfig issue and needs to be debugged by name.
> 
> I query the Tk default and fixed-width fonts via
> 
>  ????tclvalue(.Tcl("font actual TkDefaultFont -family")
>  ????tclvalue(.Tcl("font actual TkFixedFont -family"))
> 
> and use those -- in the past, that produced pleasing font choices on all 
> platforms. In the macOS Intel build, the resulting font families are 
> "Verdana" and "Andale Mono"; in the arm64 build, "helvetica" and 
> "courier". Perhaps the Intel and arm64 builds were just configured 
> differently.

Yes, I think fontconfig was, and that may help Simon dig into this.

>>
>>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>>> build but still present in the Intel build. The Rcmdr detects its 
>>> absence and suppresses some features (i.e., those requiring the Rcmdr 
>>> data editor). I understand that the Tktable package is problematic 
>>> and it may have been removed intentionally.
>>
>> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
>> (apparently the latest version from 2008)
>> does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
>> uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build appears 
>> to be much older, 8.6.6.)
>>
>> I have a patched version: AFAICS it installs entirely into 
>> /opt/R/arm64/lib I could tar it up and make it available.
>>
>> I could also send the patch to Simon for future use, but note that 
>> https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk 
>> (not the X11 build in the CRAN build of R 4.1.[01]) and which does not 
>> support Tcl/Tk.
> 
> I'm sorry, but I don't quite understand that -- perhaps there's a typo 
> here? Do you mean to say that an aqua build of Tcl/Tk will replace the 
> X11 build after R 4.1.1, and that Tktable will be incompatible with it?

There was, so let me expand.

There are two Tk implementations on macOS,

- using aqua, which is included in https://mac.r-project.org/libs-arm64/
- using X11, included in the CRAN distributions of R 4.1.[01] on amd64, 
and always used for Intel. So I do not have access to the details of 
that build.

As I recall, TkTable does not install for the aqua implementation, but 
does (when patched) for the X11 implementation.  My recollection is that 
XQuartz became available for amd64 not long before R 4.0.0 and Simon 
switched to X11 Tk, although pre-releases had aqua Tk.

> If so, first, I think that an aqua Tcl/Tk would be preferable to the 
> current X11 version. If I understand correctly, for example, aqua would 
> put Tk menus where Mac users expect them.

aqua Tk does not work correctly with R.app, and is not supported by 
package tkrplot (which lots of other packages depend on).  Personally I 
usually use aqua Tk in my own builds, but then I only use R.app if 
needed to debug something.

> Second, given the problems that Tktable seems to be producing, wouldn't 
> it be better to make Tablelist available as a substitute? I'm happy to 
> rewrite the Rcmdr data editor using Tablelist (actually, it's mostly 
> done), and, as I said, if I knew how to incorporate the Tcl/Tk Tablelist 
> package in the Rcmdr package (if it's undesirable simply to make it 
> available generally), I'd do it.

That's your choice.  The sources are at 
https://www.nemethi.de/tablelist/tablelist6.15.tar.gz and contain a 
README.txt with a 'How to Install It?'.  At least on a Unix-alike you 
just need to unpack that into somewhere on the Tcl path.  So to 
distribute with an R package, have the  tablelist6.15 dir in inst/ and 
arrange to add the installed location to the Tcl search path with 
tcltk::addTclPath() .  (I don't see why Windows would be different.)


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From j|ox @end|ng |rom mcm@@ter@c@  Thu Sep  9 23:44:06 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 9 Sep 2021 17:44:06 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <7fa9ebb8-94a0-9ad3-5b89-d03d8dfc1e1f@mcmaster.ca>
References: <7fa9ebb8-94a0-9ad3-5b89-d03d8dfc1e1f@mcmaster.ca>
Message-ID: <a6eb6a1e-82e8-5495-c381-5e351c301f2a@mcmaster.ca>


Dear Brian,

Thank you for the additional explanation.

If I understand correctly, the X11 version of Tcl/Tk will continue to be 
distributed with the R CRAN Intel and arm64 builds because it is 
compatible with R.app. If so, the simplest solution is probably to 
distribute the patched TkTable package with these builds, for backwards 
compatibility (perhaps not just for the Rcmdr package).

Your instructions for including tktablelist with the Rcmdr package seem 
clear, and I'll give that a try in case TkTable continues to be 
unavailable in the arm64 build.

Best,
  John

On 2021-09-09 4:57 p.m., Prof Brian Ripley wrote:
> On 09/09/2021 21:34, John Fox wrote:
>> Dear Brian,
>>
>> Thank you for responding so quickly. Please see below:
>> On 2021-09-09 2:59 p.m., Prof Brian Ripley wrote:
>>> On 09/09/2021 19:03, John Fox wrote:
>>>> Dear Simon, Philippe, and list members,
>>>>
>>>> I've encountered some Tcl/Tk-related issues with the Apple silicon 
>>>> arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr 
>>>> package, although they don't prevent it from working:
>>>>
>>>> (1) Some fonts that are available for the Intel build appear to be 
>>>> missing from the arm64 build. Compare the screen shots of the Rcmdr 
>>>> main window at 
>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
>>>> (Intel build) and 
>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
>>>> (arm64 build). This problem is purely aesthetic.
>>>
>>> It would be helpful to know what those fonts are.? This is likely to 
>>> be a fontconfig issue and needs to be debugged by name.
>>
>> I query the Tk default and fixed-width fonts via
>>
>> ?????tclvalue(.Tcl("font actual TkDefaultFont -family")
>> ?????tclvalue(.Tcl("font actual TkFixedFont -family"))
>>
>> and use those -- in the past, that produced pleasing font choices on 
>> all platforms. In the macOS Intel build, the resulting font families 
>> are "Verdana" and "Andale Mono"; in the arm64 build, "helvetica" and 
>> "courier". Perhaps the Intel and arm64 builds were just configured 
>> differently.
> 
> Yes, I think fontconfig was, and that may help Simon dig into this.
> 
>>>
>>>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>>>> build but still present in the Intel build. The Rcmdr detects its 
>>>> absence and suppresses some features (i.e., those requiring the 
>>>> Rcmdr data editor). I understand that the Tktable package is 
>>>> problematic and it may have been removed intentionally.
>>>
>>> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
>>> (apparently the latest version from 2008)
>>> does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
>>> uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build appears 
>>> to be much older, 8.6.6.)
>>>
>>> I have a patched version: AFAICS it installs entirely into 
>>> /opt/R/arm64/lib I could tar it up and make it available.
>>>
>>> I could also send the patch to Simon for future use, but note that 
>>> https://mac.r-project.org/libs-arm64/ contains an aqua build of 
>>> Tcl/Tk (not the X11 build in the CRAN build of R 4.1.[01]) and which 
>>> does not support Tcl/Tk.
>>
>> I'm sorry, but I don't quite understand that -- perhaps there's a typo 
>> here? Do you mean to say that an aqua build of Tcl/Tk will replace the 
>> X11 build after R 4.1.1, and that Tktable will be incompatible with it?
> 
> There was, so let me expand.
> 
> There are two Tk implementations on macOS,
> 
> - using aqua, which is included in https://mac.r-project.org/libs-arm64/
> - using X11, included in the CRAN distributions of R 4.1.[01] on amd64, 
> and always used for Intel. So I do not have access to the details of 
> that build.
> 
> As I recall, TkTable does not install for the aqua implementation, but 
> does (when patched) for the X11 implementation.? My recollection is that 
> XQuartz became available for amd64 not long before R 4.0.0 and Simon 
> switched to X11 Tk, although pre-releases had aqua Tk.
> 
>> If so, first, I think that an aqua Tcl/Tk would be preferable to the 
>> current X11 version. If I understand correctly, for example, aqua 
>> would put Tk menus where Mac users expect them.
> 
> aqua Tk does not work correctly with R.app, and is not supported by 
> package tkrplot (which lots of other packages depend on).? Personally I 
> usually use aqua Tk in my own builds, but then I only use R.app if 
> needed to debug something.
> 
>> Second, given the problems that Tktable seems to be producing, 
>> wouldn't it be better to make Tablelist available as a substitute? I'm 
>> happy to rewrite the Rcmdr data editor using Tablelist (actually, it's 
>> mostly done), and, as I said, if I knew how to incorporate the Tcl/Tk 
>> Tablelist package in the Rcmdr package (if it's undesirable simply to 
>> make it available generally), I'd do it.
> 
> That's your choice.? The sources are at 
> https://www.nemethi.de/tablelist/tablelist6.15.tar.gz and contain a 
> README.txt with a 'How to Install It?'.? At least on a Unix-alike you 
> just need to unpack that into somewhere on the Tcl path.? So to 
> distribute with an R package, have the? tablelist6.15 dir in inst/ and 
> arrange to add the installed location to the Tcl search path with 
> tcltk::addTclPath() .? (I don't see why Windows would be different.)
> 
>


From j|ox @end|ng |rom mcm@@ter@c@  Fri Sep 10 04:54:23 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Thu, 9 Sep 2021 22:54:23 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <E1E97432-4EF7-4562-AED0-065228CAA532@umons.ac.be>
References: <7fa9ebb8-94a0-9ad3-5b89-d03d8dfc1e1f@mcmaster.ca>
 <a6eb6a1e-82e8-5495-c381-5e351c301f2a@mcmaster.ca>
 <E1E97432-4EF7-4562-AED0-065228CAA532@umons.ac.be>
Message-ID: <ca2eaad1-8f5e-5285-ae81-4e429d7bc001@mcmaster.ca>

Dear Philippe,

Thanks for getting back to me.
On 2021-09-09 10:42 p.m., Philippe GROSJEAN wrote:
> Dear John,
> 
> The tcltk2 package on CRAN includes tablelist version 5.5. The latest 
> development version on https://github.com/SciViews/tcltk2 
> <https://github.com/SciViews/tcltk2>?includes tablelist version 6.9. The 
> last version of tcltk2 was not pushed to CRAN yet because many Tcl/Tk 
> packages were updated to higher versions and not everything is 
> completely tested today (I just recently got a Mac M1 machine for 
> testing on this system).
> 
> In the meantime, since I know you really want version 6.9 of tablelist, 
> you can do remotes::install_github(?SciViews/tcltk2 at 25df401?), or 
> inspect the code in tcltk2 to see how to include a pure-Tcl package and 
> place it in Rcmdr (it weights roughly 1Mb).

I coincidentally found your development version of tcltk2 on GitHub and 
installed it earlier this evening.

I may do as you suggest, and temporarily incorporate tablelist directly 
in the Rcmdr package, or just wait until the newest version of tcltk2 is 
sent to CRAN. In the long run, I think that it's more maintainable not 
to duplicate in the Rcmdr resources that are provided by tcltk2.

Best,
  John

> 
> Best,
> 
> Philippe
> ..............................................<?}))><........
>  ?) ) ) ) )
> ( ( ( ( ( ? ?Prof. Philippe Grosjean
>  ?) ) ) ) )
> ( ( ( ( ( ? ?Numerical Ecology
>  ?) ) ) ) ) ? Mons University, Belgium
> ( ( ( ( (
> ..............................................................
> 
>> On 9 Sep 2021, at 23:44, John Fox <jfox at mcmaster.ca 
>> <mailto:jfox at mcmaster.ca>> wrote:
>>
>>
>> Dear Brian,
>>
>> Thank you for the additional explanation.
>>
>> If I understand correctly, the X11 version of Tcl/Tk will continue to 
>> be distributed with the R CRAN Intel and arm64 builds because it is 
>> compatible with R.app. If so, the simplest solution is probably to 
>> distribute the patched TkTable package with these builds, for 
>> backwards compatibility (perhaps not just for the Rcmdr package).
>>
>> Your instructions for including tktablelist with the Rcmdr package 
>> seem clear, and I'll give that a try in case TkTable continues to be 
>> unavailable in the arm64 build.
>>
>> Best,
>> John
>>
>> On 2021-09-09 4:57 p.m., Prof Brian Ripley wrote:
>>> On 09/09/2021 21:34, John Fox wrote:
>>>> Dear Brian,
>>>>
>>>> Thank you for responding so quickly. Please see below:
>>>> On 2021-09-09 2:59 p.m., Prof Brian Ripley wrote:
>>>>> On 09/09/2021 19:03, John Fox wrote:
>>>>>> Dear Simon, Philippe, and list members,
>>>>>>
>>>>>> I've encountered some Tcl/Tk-related issues with the Apple silicon 
>>>>>> arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr 
>>>>>> package, although they don't prevent it from working:
>>>>>>
>>>>>> (1) Some fonts that are available for the Intel build appear to be 
>>>>>> missing from the arm64 build. Compare the screen shots of the 
>>>>>> Rcmdr main window at 
>>>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png 
>>>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png>> 
>>>>>> (Intel build) and 
>>>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png 
>>>>>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png>> 
>>>>>> (arm64 build). This problem is purely aesthetic.
>>>>>
>>>>> It would be helpful to know what those fonts are.? This is likely 
>>>>> to be a fontconfig issue and needs to be debugged by name.
>>>>
>>>> I query the Tk default and fixed-width fonts via
>>>>
>>>> ?????tclvalue(.Tcl("font actual TkDefaultFont -family")
>>>> ?????tclvalue(.Tcl("font actual TkFixedFont -family"))
>>>>
>>>> and use those -- in the past, that produced pleasing font choices on 
>>>> all platforms. In the macOS Intel build, the resulting font families 
>>>> are "Verdana" and "Andale Mono"; in the arm64 build, "helvetica" and 
>>>> "courier". Perhaps the Intel and arm64 builds were just configured 
>>>> differently.
>>> Yes, I think fontconfig was, and that may help Simon dig into this.
>>>>>
>>>>>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>>>>>> build but still present in the Intel build. The Rcmdr detects its 
>>>>>> absence and suppresses some features (i.e., those requiring the 
>>>>>> Rcmdr data editor). I understand that the Tktable package is 
>>>>>> problematic and it may have been removed intentionally.
>>>>>
>>>>> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
>>>>> <https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz> 
>>>>> (apparently the latest version from 2008)
>>>>> does not compile against recent Tcl/Tk (8.6.11 seems to be used): 
>>>>> it uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build 
>>>>> appears to be much older, 8.6.6.)
>>>>>
>>>>> I have a patched version: AFAICS it installs entirely into 
>>>>> /opt/R/arm64/lib I could tar it up and make it available.
>>>>>
>>>>> I could also send the patch to Simon for future use, but note that 
>>>>> https://mac.r-project.org/libs-arm64/ 
>>>>> <https://mac.r-project.org/libs-arm64/> contains an aqua build of 
>>>>> Tcl/Tk (not the X11 build in the CRAN build of R 4.1.[01]) and 
>>>>> which does not support Tcl/Tk.
>>>>
>>>> I'm sorry, but I don't quite understand that -- perhaps there's a 
>>>> typo here? Do you mean to say that an aqua build of Tcl/Tk will 
>>>> replace the X11 build after R 4.1.1, and that Tktable will be 
>>>> incompatible with it?
>>> There was, so let me expand.
>>> There are two Tk implementations on macOS,
>>> - using aqua, which is included in 
>>> https://mac.r-project.org/libs-arm64/ 
>>> <https://mac.r-project.org/libs-arm64/>
>>> - using X11, included in the CRAN distributions of R 4.1.[01] on 
>>> amd64, and always used for Intel. So I do not have access to the 
>>> details of that build.
>>> As I recall, TkTable does not install for the aqua implementation, 
>>> but does (when patched) for the X11 implementation.? My recollection 
>>> is that XQuartz became available for amd64 not long before R 4.0.0 
>>> and Simon switched to X11 Tk, although pre-releases had aqua Tk.
>>>> If so, first, I think that an aqua Tcl/Tk would be preferable to the 
>>>> current X11 version. If I understand correctly, for example, aqua 
>>>> would put Tk menus where Mac users expect them.
>>> aqua Tk does not work correctly with R.app, and is not supported by 
>>> package tkrplot (which lots of other packages depend on).? Personally 
>>> I usually use aqua Tk in my own builds, but then I only use R.app if 
>>> needed to debug something.
>>>> Second, given the problems that Tktable seems to be producing, 
>>>> wouldn't it be better to make Tablelist available as a substitute? 
>>>> I'm happy to rewrite the Rcmdr data editor using Tablelist 
>>>> (actually, it's mostly done), and, as I said, if I knew how to 
>>>> incorporate the Tcl/Tk Tablelist package in the Rcmdr package (if 
>>>> it's undesirable simply to make it available generally), I'd do it.
>>> That's your choice.? The sources are at 
>>> https://www.nemethi.de/tablelist/tablelist6.15.tar.gz 
>>> <https://www.nemethi.de/tablelist/tablelist6.15.tar.gz> and contain a 
>>> README.txt with a 'How to Install It?'.? At least on a Unix-alike you 
>>> just need to unpack that into somewhere on the Tcl path.? So to 
>>> distribute with an R package, have the? tablelist6.15 dir in inst/ 
>>> and arrange to add the installed location to the Tcl search path with 
>>> tcltk::addTclPath() .? (I don't see why Windows would be different.)
>>>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org <mailto:R-SIG-Mac at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>


From Ph|||ppe@GROSJEAN @end|ng |rom umon@@@c@be  Fri Sep 10 04:42:42 2021
From: Ph|||ppe@GROSJEAN @end|ng |rom umon@@@c@be (Philippe GROSJEAN)
Date: Fri, 10 Sep 2021 02:42:42 +0000
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <a6eb6a1e-82e8-5495-c381-5e351c301f2a@mcmaster.ca>
References: <7fa9ebb8-94a0-9ad3-5b89-d03d8dfc1e1f@mcmaster.ca>
 <a6eb6a1e-82e8-5495-c381-5e351c301f2a@mcmaster.ca>
Message-ID: <E1E97432-4EF7-4562-AED0-065228CAA532@umons.ac.be>

Dear John,

The tcltk2 package on CRAN includes tablelist version 5.5. The latest development version on https://github.com/SciViews/tcltk2 includes tablelist version 6.9. The last version of tcltk2 was not pushed to CRAN yet because many Tcl/Tk packages were updated to higher versions and not everything is completely tested today (I just recently got a Mac M1 machine for testing on this system).

In the meantime, since I know you really want version 6.9 of tablelist, you can do remotes::install_github(?SciViews/tcltk2 at 25df401?), or inspect the code in tcltk2 to see how to include a pure-Tcl package and place it in Rcmdr (it weights roughly 1Mb).

Best,

Philippe

..............................................<?}))><........
 ) ) ) ) )
( ( ( ( (    Prof. Philippe Grosjean
 ) ) ) ) )
( ( ( ( (    Numerical Ecology
 ) ) ) ) )   Mons University, Belgium
( ( ( ( (
..............................................................

On 9 Sep 2021, at 23:44, John Fox <jfox at mcmaster.ca<mailto:jfox at mcmaster.ca>> wrote:


Dear Brian,

Thank you for the additional explanation.

If I understand correctly, the X11 version of Tcl/Tk will continue to be distributed with the R CRAN Intel and arm64 builds because it is compatible with R.app. If so, the simplest solution is probably to distribute the patched TkTable package with these builds, for backwards compatibility (perhaps not just for the Rcmdr package).

Your instructions for including tktablelist with the Rcmdr package seem clear, and I'll give that a try in case TkTable continues to be unavailable in the arm64 build.

Best,
John

On 2021-09-09 4:57 p.m., Prof Brian Ripley wrote:
On 09/09/2021 21:34, John Fox wrote:
Dear Brian,

Thank you for responding so quickly. Please see below:
On 2021-09-09 2:59 p.m., Prof Brian Ripley wrote:
On 09/09/2021 19:03, John Fox wrote:
Dear Simon, Philippe, and list members,

I've encountered some Tcl/Tk-related issues with the Apple silicon arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr package, although they don't prevent it from working:

(1) Some fonts that are available for the Intel build appear to be missing from the arm64 build. Compare the screen shots of the Rcmdr main window at <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> (Intel build) and <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> (arm64 build). This problem is purely aesthetic.

It would be helpful to know what those fonts are.  This is likely to be a fontconfig issue and needs to be debugged by name.

I query the Tk default and fixed-width fonts via

     tclvalue(.Tcl("font actual TkDefaultFont -family")
     tclvalue(.Tcl("font actual TkFixedFont -family"))

and use those -- in the past, that produced pleasing font choices on all platforms. In the macOS Intel build, the resulting font families are "Verdana" and "Andale Mono"; in the arm64 build, "helvetica" and "courier". Perhaps the Intel and arm64 builds were just configured differently.
Yes, I think fontconfig was, and that may help Simon dig into this.

(2) The Tcl/Tk Tktable package is apparently absent from the arm64 build but still present in the Intel build. The Rcmdr detects its absence and suppresses some features (i.e., those requiring the Rcmdr data editor). I understand that the Tktable package is problematic and it may have been removed intentionally.

https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz (apparently the latest version from 2008)
does not compile against recent Tcl/Tk (8.6.11 seems to be used): it uses 'panic' which should be 'Tcl_Panic'.    (The Intel build appears to be much older, 8.6.6.)

I have a patched version: AFAICS it installs entirely into /opt/R/arm64/lib I could tar it up and make it available.

I could also send the patch to Simon for future use, but note that https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk (not the X11 build in the CRAN build of R 4.1.[01]) and which does not support Tcl/Tk.

I'm sorry, but I don't quite understand that -- perhaps there's a typo here? Do you mean to say that an aqua build of Tcl/Tk will replace the X11 build after R 4.1.1, and that Tktable will be incompatible with it?
There was, so let me expand.
There are two Tk implementations on macOS,
- using aqua, which is included in https://mac.r-project.org/libs-arm64/
- using X11, included in the CRAN distributions of R 4.1.[01] on amd64, and always used for Intel. So I do not have access to the details of that build.
As I recall, TkTable does not install for the aqua implementation, but does (when patched) for the X11 implementation.  My recollection is that XQuartz became available for amd64 not long before R 4.0.0 and Simon switched to X11 Tk, although pre-releases had aqua Tk.
If so, first, I think that an aqua Tcl/Tk would be preferable to the current X11 version. If I understand correctly, for example, aqua would put Tk menus where Mac users expect them.
aqua Tk does not work correctly with R.app, and is not supported by package tkrplot (which lots of other packages depend on).  Personally I usually use aqua Tk in my own builds, but then I only use R.app if needed to debug something.
Second, given the problems that Tktable seems to be producing, wouldn't it be better to make Tablelist available as a substitute? I'm happy to rewrite the Rcmdr data editor using Tablelist (actually, it's mostly done), and, as I said, if I knew how to incorporate the Tcl/Tk Tablelist package in the Rcmdr package (if it's undesirable simply to make it available generally), I'd do it.
That's your choice.  The sources are at https://www.nemethi.de/tablelist/tablelist6.15.tar.gz and contain a README.txt with a 'How to Install It?'.  At least on a Unix-alike you just need to unpack that into somewhere on the Tcl path.  So to distribute with an R package, have the  tablelist6.15 dir in inst/ and arrange to add the installed location to the Tcl search path with tcltk::addTclPath() .  (I don't see why Windows would be different.)


_______________________________________________
R-SIG-Mac mailing list
R-SIG-Mac at r-project.org<mailto:R-SIG-Mac at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-mac


	[[alternative HTML version deleted]]


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Fri Sep 10 07:54:54 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Fri, 10 Sep 2021 06:54:54 +0100
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
 <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
Message-ID: <728547f4-8fab-8072-a1df-3f05ee8771e3@stats.ox.ac.uk>

On 09/09/2021 19:59, Prof Brian Ripley wrote:
> On 09/09/2021 19:03, John Fox wrote:
>> Dear Simon, Philippe, and list members,

...

>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>> build but still present in the Intel build. The Rcmdr detects its 
>> absence and suppresses some features (i.e., those requiring the Rcmdr 
>> data editor). I understand that the Tktable package is problematic and 
>> it may have been removed intentionally.
> 
> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
> (apparently the latest version from 2008)
> does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
> uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build appears to 
> be much older, 8.6.6.)
> 
> I have a patched version: AFAICS it installs entirely into 
> /opt/R/arm64/lib I could tar it up and make it available.
> 
> I could also send the patch to Simon for future use, but note that 
> https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk 
> (not the X11 build in the CRAN build of R 4.1.[01]) and which does not 
> support Tcl/Tk.

I have put the patch and the tarball at 
https://www.stats.ox.ac.uk/pub/bdr/Tktable/ .

There is a README.txt with installation instructions. But as I have only 
one M1 Mac, they are minimally tested.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From j|ox @end|ng |rom mcm@@ter@c@  Fri Sep 10 13:50:19 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Fri, 10 Sep 2021 07:50:19 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <728547f4-8fab-8072-a1df-3f05ee8771e3@stats.ox.ac.uk>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
 <a5c59732-ca98-5acd-e275-0ee7299fae5a@stats.ox.ac.uk>
 <728547f4-8fab-8072-a1df-3f05ee8771e3@stats.ox.ac.uk>
Message-ID: <2ac3be37-fed6-c999-3de7-a4e7bad8eecd@mcmaster.ca>

Dear Brian,

Thanks for this. When the Tktable package is available in the arm64 
macOS binary, I'll test it.

Best,
  John

On 2021-09-10 1:54 a.m., Prof Brian Ripley wrote:
> On 09/09/2021 19:59, Prof Brian Ripley wrote:
>> On 09/09/2021 19:03, John Fox wrote:
>>> Dear Simon, Philippe, and list members,
> 
> ...
> 
>>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>>> build but still present in the Intel build. The Rcmdr detects its 
>>> absence and suppresses some features (i.e., those requiring the Rcmdr 
>>> data editor). I understand that the Tktable package is problematic 
>>> and it may have been removed intentionally.
>>
>> https://sourceforge.net/projects/tktable/files/tktable/2.10/Tktable2.10.tar.gz 
>> (apparently the latest version from 2008)
>> does not compile against recent Tcl/Tk (8.6.11 seems to be used): it 
>> uses 'panic' which should be 'Tcl_Panic'.??? (The Intel build appears 
>> to be much older, 8.6.6.)
>>
>> I have a patched version: AFAICS it installs entirely into 
>> /opt/R/arm64/lib I could tar it up and make it available.
>>
>> I could also send the patch to Simon for future use, but note that 
>> https://mac.r-project.org/libs-arm64/ contains an aqua build of Tcl/Tk 
>> (not the X11 build in the CRAN build of R 4.1.[01]) and which does not 
>> support Tcl/Tk.
> 
> I have put the patch and the tarball at 
> https://www.stats.ox.ac.uk/pub/bdr/Tktable/ .
> 
> There is a README.txt with installation instructions. But as I have only 
> one M1 Mac, they are minimally tested.
>


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Sat Sep 18 08:20:44 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Sat, 18 Sep 2021 07:20:44 +0100
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
Message-ID: <a84efde7-d7af-8909-c379-4f1625739bc5@stats.ox.ac.uk>

On 09/09/2021 19:03, John Fox wrote:
> Dear Simon, Philippe, and list members,
> 
> I've encountered some Tcl/Tk-related issues with the Apple silicon arm64 
> build of R 4.1.0 for macOS. These issues affect the Rcmdr package, 
> although they don't prevent it from working:
> 
> (1) Some fonts that are available for the Intel build appear to be 
> missing from the arm64 build. Compare the screen shots of the Rcmdr main 
> window at 
> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
> (Intel build) and 
> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
> (arm64 build). This problem is purely aesthetic.
> 
> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 build 
> but still present in the Intel build. The Rcmdr detects its absence and 
> suppresses some features (i.e., those requiring the Rcmdr data editor). 
> I understand that the Tktable package is problematic and it may have 
> been removed intentionally.
> 
> The Tcl/Tk Tablelist package would be a reasonable substitute, and were 
> it available, I could use it to restore the missing features in the 
> Rcmdr. I'm aware that Philippe Grosjean planned to incorporate Tablelist 
> in his tcltk2 package, but as far as I know, that plan hasn't yet 
> materialized. If I knew how to supply a Tcl/Tk package in an R package, 
> I could put Tablelist directly in the Rcmdr.
> 
> Any help would be greatly appreciated.
> 
> John
> 
To close this circle, Simon has provided

https://mac.r-project.org/libs-arm64/tcltk-8.6.11-xft-darwin20.4-arm64.pkg

If you install that, it updates Tk and adds Tktable, solving both 
problems.  (As the Tcl/Tk installation is shared between R versions, 
this will fix 4.1.0 as well as 4.1.1.  It will be incorporated in future 
releases.)




-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From j|ox @end|ng |rom mcm@@ter@c@  Sat Sep 18 14:46:12 2021
From: j|ox @end|ng |rom mcm@@ter@c@ (John Fox)
Date: Sat, 18 Sep 2021 08:46:12 -0400
Subject: [R-SIG-Mac] Tcl/Tk issues in arm64 build of R 4.1.0
In-Reply-To: <24286_1631946075_18I6LEjE025114_a84efde7-d7af-8909-c379-4f1625739bc5@stats.ox.ac.uk>
References: <98e92a9c-7dac-6385-fb8c-90df80592440@mcmaster.ca>
 <24286_1631946075_18I6LEjE025114_a84efde7-d7af-8909-c379-4f1625739bc5@stats.ox.ac.uk>
Message-ID: <798fba5d-866f-4230-321b-21ddc42d9723@mcmaster.ca>

Thank you Brian and Simon for fixing these problems.

Best,
  John


On 2021-09-18 2:20 a.m., Prof Brian Ripley wrote:
> On 09/09/2021 19:03, John Fox wrote:
>> Dear Simon, Philippe, and list members,
>>
>> I've encountered some Tcl/Tk-related issues with the Apple silicon 
>> arm64 build of R 4.1.0 for macOS. These issues affect the Rcmdr 
>> package, although they don't prevent it from working:
>>
>> (1) Some fonts that are available for the Intel build appear to be 
>> missing from the arm64 build. Compare the screen shots of the Rcmdr 
>> main window at 
>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/x86_64-apple-darwin17.0.png> 
>> (Intel build) and 
>> <https://socialsciences.mcmaster.ca/jfox/.Pickup/aarch64-apple-darwin20.png> 
>> (arm64 build). This problem is purely aesthetic.
>>
>> (2) The Tcl/Tk Tktable package is apparently absent from the arm64 
>> build but still present in the Intel build. The Rcmdr detects its 
>> absence and suppresses some features (i.e., those requiring the Rcmdr 
>> data editor). I understand that the Tktable package is problematic and 
>> it may have been removed intentionally.
>>
>> The Tcl/Tk Tablelist package would be a reasonable substitute, and 
>> were it available, I could use it to restore the missing features in 
>> the Rcmdr. I'm aware that Philippe Grosjean planned to incorporate 
>> Tablelist in his tcltk2 package, but as far as I know, that plan 
>> hasn't yet materialized. If I knew how to supply a Tcl/Tk package in 
>> an R package, I could put Tablelist directly in the Rcmdr.
>>
>> Any help would be greatly appreciated.
>>
>> John
>>
> To close this circle, Simon has provided
> 
> https://mac.r-project.org/libs-arm64/tcltk-8.6.11-xft-darwin20.4-arm64.pkg
> 
> If you install that, it updates Tk and adds Tktable, solving both 
> problems.? (As the Tcl/Tk installation is shared between R versions, 
> this will fix 4.1.0 as well as 4.1.1.? It will be incorporated in future 
> releases.)
> 
> 
> 
>


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Sep 23 02:07:33 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 23 Sep 2021 12:07:33 +1200
Subject: [R-SIG-Mac] CRAN Mac Builder based on M1
Message-ID: <23258BEF-34BB-429B-B383-4005D9A29C70@R-project.org>


Dear Mac useRs.

I'm pleased to announce that thanks to the R Foundation and donations from users like you we are now able to offer a CRAN Mac Builder based on M1 hardware which allows package authors that don't have access to a recent Mac to check their package using the same process as CRAN:

https://mac.r-project.org/macbuilder/submit.html

The machine mirrors all CRAN packages nightly and uses the CRAN building and checking system[1] so the results should be as close to the CRAN setup as feasible.
The resources are limited, so do not treat this as a CI setup, but rather as a service for package authors to facilitate checks before CRAN submissions.

The setup is new and experimental, so please contact me for any comments, problem reports or suggestions regarding the Mac Builder.

Cheers,
Simon


[1] - https://svn.r-project.org/R-dev-web/trunk/QA/Simon/packages


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Thu Sep 23 22:34:29 2021
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Thu, 23 Sep 2021 20:34:29 +0000
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <3FDAB060-0FCA-4504-B6DF-42D636FC8479@comcast.net>
References: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
 <3FDAB060-0FCA-4504-B6DF-42D636FC8479@comcast.net>
Message-ID: <BL0PR01MB4036937736321CBBA92D0483FAA39@BL0PR01MB4036.prod.exchangelabs.com>

With some search on the internet, I was able to solve my problem with a small edit in Makevars file. ?When installing data.table, I had added some lines to Makevars file.  These lines were pointing to clang.  The problem was fixed when it was changed to gcc.  

# My Makevars file new
# Successful installation of reshape2 package
VER=-11                                                                            
CC=gcc$(VER)                                                                       
CXX=g++$(VER) 

# My Makevars file old
# These lines were recommended by data.table installation
# Could not install reshape2 package
CC=$(LLVM_LOC)/bin/clang -fopenmp                                                
CXX=$(LLVM_LOC)/bin/clang++ -fopenmp 

Hope this will help some user,
Naresh

From: David Winsemius <dwinsemius at comcast.net>
Sent: Tuesday, September 7, 2021 12:02 AM
To: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
Cc: r-sig-mac at r-project.org Mac <r-sig-mac at r-project.org>
Subject: Re: [R-SIG-Mac] checking whether the C compiler works... no 
?
The?? C compiler aka clang is not the same as the C++ compiler. 

Why don?t you install the pre-compiled version.

? 
David

Sent from my iPhone

> On Sep 6, 2021, at 12:44 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> ?When trying to install library reshape2, I get below messages.? But I do have some other packages which depend upon C compiler (e.g., Rcpp).? How can this problem be fixed?
> 
> Thanks,
> Naresh
> 
> Messages when trying to install reshape2:
>> install.packages("reshape2", repos = "https://cran.r-project.org")
> Installing package into ?/usr/local/lib/R/4.1/site-library?
> (as ?lib? is unspecified)
> also installing the dependencies ?stringi?, ?stringr?
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
> Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
> ==================================================
> downloaded 7.2 MB
> 
> trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
> Content type 'application/x-gzip' length 135777 bytes (132 KB)
> ==================================================
> downloaded 132 KB
> 
> trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
> Content type 'application/x-gzip' length 37307 bytes (36 KB)
> ==================================================
> downloaded 36 KB
> 
> * installing *source* package ?stringi? ...
> ** package ?stringi? successfully unpacked and MD5 sums checked
> ** using staged installation
> checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
> checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
> checking for endianness... little
> checking for R >= 3.1.0 for C++11 use... yes
> checking for R < 3.4.0 for CXX1X flag use... no
> checking for cat... /bin/cat
> checking for local ICUDT_DIR... icu69/data
> checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
> checking whether the C compiler works... no
> configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
> configure: error: C compiler cannot create executables
> See `config.log' for more details
> ERROR: configuration failed for package ?stringi?
> * removing ?/usr/local/lib/R/4.1/site-library/stringi?
> ERROR: dependency ?stringi? is not available for package ?stringr?
> * removing ?/usr/local/lib/R/4.1/site-library/stringr?
> ERROR: dependency ?stringr? is not available for package ?reshape2?
> * removing ?/usr/local/lib/R/4.1/site-library/reshape2?
> 
> The downloaded source packages are in
>??? ?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
> Warning messages:
> 1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>? installation of package ?stringi? had non-zero exit status
> 2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>? installation of package ?stringr? had non-zero exit status
> 3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>? installation of package ?reshape2? had non-zero exit status
> 
> My session info:
>> sessionInfo()
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-apple-darwin20.5.0 (64-bit)
> Running under: macOS Big Sur 11.5.2
> 
> Matrix products: default
> BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base???? 
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1 
> 
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac

From @|mon@urb@nek @end|ng |rom R-project@org  Fri Sep 24 00:10:58 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 24 Sep 2021 10:10:58 +1200
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <BL0PR01MB4036937736321CBBA92D0483FAA39@BL0PR01MB4036.prod.exchangelabs.com>
References: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
 <3FDAB060-0FCA-4504-B6DF-42D636FC8479@comcast.net>
 <BL0PR01MB4036937736321CBBA92D0483FAA39@BL0PR01MB4036.prod.exchangelabs.com>
Message-ID: <EFE8916C-2B4E-4735-BCF5-377D6878CF59@R-project.org>


Before anyone actually follows this, the setup below is quite badly broken so this won't work on any normal Mac. Please do NOT set flags you don't understand even if you googled it somewhere. There is no need to modify Makevars (both versions below are bad - one is forcing locally installed clang the other gcc-11 presumably from Homebrew - neither is compatible with R releases). You should NEVER set CC/CXX in package's Makevars since the compilers have to match what R is using and R will automatically provide the correct setting, so overriding it will only break things.

Cheers,
Simon



> On Sep 24, 2021, at 8:34 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
> 
> With some search on the internet, I was able to solve my problem with a small edit in Makevars file.  When installing data.table, I had added some lines to Makevars file.  These lines were pointing to clang.  The problem was fixed when it was changed to gcc.  
> 
> # My Makevars file new
> # Successful installation of reshape2 package
> VER=-11                                                                            
> CC=gcc$(VER)                                                                       
> CXX=g++$(VER) 
> 
> # My Makevars file old
> # These lines were recommended by data.table installation
> # Could not install reshape2 package
> CC=$(LLVM_LOC)/bin/clang -fopenmp                                                
> CXX=$(LLVM_LOC)/bin/clang++ -fopenmp 
> 
> Hope this will help some user,
> Naresh
> 
> From: David Winsemius <dwinsemius at comcast.net>
> Sent: Tuesday, September 7, 2021 12:02 AM
> To: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
> Cc: r-sig-mac at r-project.org Mac <r-sig-mac at r-project.org>
> Subject: Re: [R-SIG-Mac] checking whether the C compiler works... no 
>  
> The   C compiler aka clang is not the same as the C++ compiler. 
> 
> Why don?t you install the pre-compiled version.
> 
> ? 
> David
> 
> Sent from my iPhone
> 
>> On Sep 6, 2021, at 12:44 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
>> ?When trying to install library reshape2, I get below messages.  But I do have some other packages which depend upon C compiler (e.g., Rcpp).  How can this problem be fixed?
>> 
>> Thanks,
>> Naresh
>> 
>> Messages when trying to install reshape2:
>>> install.packages("reshape2", repos = "https://cran.r-project.org")
>> Installing package into ?/usr/local/lib/R/4.1/site-library?
>> (as ?lib? is unspecified)
>> also installing the dependencies ?stringi?, ?stringr?
>> 
>> trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
>> Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
>> ==================================================
>> downloaded 7.2 MB
>> 
>> trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
>> Content type 'application/x-gzip' length 135777 bytes (132 KB)
>> ==================================================
>> downloaded 132 KB
>> 
>> trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
>> Content type 'application/x-gzip' length 37307 bytes (36 KB)
>> ==================================================
>> downloaded 36 KB
>> 
>> * installing *source* package ?stringi? ...
>> ** package ?stringi? successfully unpacked and MD5 sums checked
>> ** using staged installation
>> checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
>> checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
>> checking for endianness... little
>> checking for R >= 3.1.0 for C++11 use... yes
>> checking for R < 3.4.0 for CXX1X flag use... no
>> checking for cat... /bin/cat
>> checking for local ICUDT_DIR... icu69/data
>> checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
>> checking whether the C compiler works... no
>> configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
>> configure: error: C compiler cannot create executables
>> See `config.log' for more details
>> ERROR: configuration failed for package ?stringi?
>> * removing ?/usr/local/lib/R/4.1/site-library/stringi?
>> ERROR: dependency ?stringi? is not available for package ?stringr?
>> * removing ?/usr/local/lib/R/4.1/site-library/stringr?
>> ERROR: dependency ?stringr? is not available for package ?reshape2?
>> * removing ?/usr/local/lib/R/4.1/site-library/reshape2?
>> 
>> The downloaded source packages are in
>>     ?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
>> Warning messages:
>> 1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?stringi? had non-zero exit status
>> 2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?stringr? had non-zero exit status
>> 3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?reshape2? had non-zero exit status
>> 
>> My session info:
>>> sessionInfo()
>> R version 4.1.1 (2021-08-10)
>> Platform: x86_64-apple-darwin20.5.0 (64-bit)
>> Running under: macOS Big Sur 11.5.2
>> 
>> Matrix products: default
>> BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base     
>> 
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.1 tools_4.1.1 
>> 
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From n@re@h_gurbux@n| @end|ng |rom hotm@||@com  Fri Sep 24 02:43:10 2021
From: n@re@h_gurbux@n| @end|ng |rom hotm@||@com (Naresh Gurbuxani)
Date: Fri, 24 Sep 2021 00:43:10 +0000
Subject: [R-SIG-Mac] checking whether the C compiler works... no
In-Reply-To: <EFE8916C-2B4E-4735-BCF5-377D6878CF59@R-project.org>
References: <BL0PR01MB4036212E54BDE1A6E5B4962FFAD29@BL0PR01MB4036.prod.exchangelabs.com>
 <3FDAB060-0FCA-4504-B6DF-42D636FC8479@comcast.net>
 <BL0PR01MB4036937736321CBBA92D0483FAA39@BL0PR01MB4036.prod.exchangelabs.com>
 <EFE8916C-2B4E-4735-BCF5-377D6878CF59@R-project.org>
Message-ID: <BL0PR01MB403652921B3A1116DC7B093FFAA49@BL0PR01MB4036.prod.exchangelabs.com>

Simon,

Thanks for your warning.  I have commented out all of my Makevars file and my R seems to be working fine.

As I mentioned, I simply followed the advice provide by data.table website.

Naresh

________________________________
From: Simon Urbanek <simon.urbanek at R-project.org>
Sent: Thursday, September 23, 2021 6:10 PM
To: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
Cc: David Winsemius <dwinsemius at comcast.net>; r-sig-mac at r-project.org Mac <r-sig-mac at r-project.org>
Subject: Re: [R-SIG-Mac] checking whether the C compiler works... no

Before anyone actually follows this, the setup below is quite badly broken so this won't work on any normal Mac. Please do NOT set flags you don't understand even if you googled it somewhere. There is no need to modify Makevars (both versions below are bad - one is forcing locally installed clang the other gcc-11 presumably from Homebrew - neither is compatible with R releases). You should NEVER set CC/CXX in package's Makevars since the compilers have to match what R is using and R will automatically provide the correct setting, so overriding it will only break things.

Cheers,
Simon



> On Sep 24, 2021, at 8:34 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
>
> With some search on the internet, I was able to solve my problem with a small edit in Makevars file.  When installing data.table, I had added some lines to Makevars file.  These lines were pointing to clang.  The problem was fixed when it was changed to gcc.
>
> # My Makevars file new
> # Successful installation of reshape2 package
> VER=-11
> CC=gcc$(VER)
> CXX=g++$(VER)
>
> # My Makevars file old
> # These lines were recommended by data.table installation
> # Could not install reshape2 package
> CC=$(LLVM_LOC)/bin/clang -fopenmp
> CXX=$(LLVM_LOC)/bin/clang++ -fopenmp
>
> Hope this will help some user,
> Naresh
>
> From: David Winsemius <dwinsemius at comcast.net>
> Sent: Tuesday, September 7, 2021 12:02 AM
> To: Naresh Gurbuxani <naresh_gurbuxani at hotmail.com>
> Cc: r-sig-mac at r-project.org Mac <r-sig-mac at r-project.org>
> Subject: Re: [R-SIG-Mac] checking whether the C compiler works... no
>
> The   C compiler aka clang is not the same as the C++ compiler.
>
> Why don?t you install the pre-compiled version.
>
> ?
> David
>
> Sent from my iPhone
>
>> On Sep 6, 2021, at 12:44 AM, Naresh Gurbuxani <naresh_gurbuxani at hotmail.com> wrote:
>> ?When trying to install library reshape2, I get below messages.  But I do have some other packages which depend upon C compiler (e.g., Rcpp).  How can this problem be fixed?
>>
>> Thanks,
>> Naresh
>>
>> Messages when trying to install reshape2:
>>> install.packages("reshape2", repos = "https://cran.r-project.org")
>> Installing package into ?/usr/local/lib/R/4.1/site-library?
>> (as ?lib? is unspecified)
>> also installing the dependencies ?stringi?, ?stringr?
>>
>> trying URL 'https://cran.r-project.org/src/contrib/stringi_1.7.4.tar.gz'
>> Content type 'application/x-gzip' length 7599762 bytes (7.2 MB)
>> ==================================================
>> downloaded 7.2 MB
>>
>> trying URL 'https://cran.r-project.org/src/contrib/stringr_1.4.0.tar.gz'
>> Content type 'application/x-gzip' length 135777 bytes (132 KB)
>> ==================================================
>> downloaded 132 KB
>>
>> trying URL 'https://cran.r-project.org/src/contrib/reshape2_1.4.4.tar.gz'
>> Content type 'application/x-gzip' length 37307 bytes (36 KB)
>> ==================================================
>> downloaded 36 KB
>>
>> * installing *source* package ?stringi? ...
>> ** package ?stringi? successfully unpacked and MD5 sums checked
>> ** using staged installation
>> checking for R_HOME... /usr/local/Cellar/r/4.1.1/lib/R
>> checking for R... /usr/local/Cellar/r/4.1.1/lib/R/bin/R
>> checking for endianness... little
>> checking for R >= 3.1.0 for C++11 use... yes
>> checking for R < 3.4.0 for CXX1X flag use... no
>> checking for cat... /bin/cat
>> checking for local ICUDT_DIR... icu69/data
>> checking for gcc... /usr/local/opt/llvm/bin/clang -fopenmp
>> checking whether the C compiler works... no
>> configure: error: in `/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpCOKBRx/R.INSTALL64822d9c75a/stringi':
>> configure: error: C compiler cannot create executables
>> See `config.log' for more details
>> ERROR: configuration failed for package ?stringi?
>> * removing ?/usr/local/lib/R/4.1/site-library/stringi?
>> ERROR: dependency ?stringi? is not available for package ?stringr?
>> * removing ?/usr/local/lib/R/4.1/site-library/stringr?
>> ERROR: dependency ?stringr? is not available for package ?reshape2?
>> * removing ?/usr/local/lib/R/4.1/site-library/reshape2?
>>
>> The downloaded source packages are in
>>     ?/private/var/folders/97/5377j5_d207fshvjz_pz7szw0000gn/T/RtmpDOExfD/downloaded_packages?
>> Warning messages:
>> 1: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?stringi? had non-zero exit status
>> 2: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?stringr? had non-zero exit status
>> 3: In install.packages("reshape2", repos = "https://cran.r-project.org") :
>>   installation of package ?reshape2? had non-zero exit status
>>
>> My session info:
>>> sessionInfo()
>> R version 4.1.1 (2021-08-10)
>> Platform: x86_64-apple-darwin20.5.0 (64-bit)
>> Running under: macOS Big Sur 11.5.2
>>
>> Matrix products: default
>> BLAS/LAPACK: /usr/local/Cellar/openblas/0.3.17/lib/libopenblasp-r0.3.17.dylib
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_4.1.1 tools_4.1.1
>>
>>
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


	[[alternative HTML version deleted]]


From r|p|ey @end|ng |rom @t@t@@ox@@c@uk  Fri Sep 24 17:35:17 2021
From: r|p|ey @end|ng |rom @t@t@@ox@@c@uk (Prof Brian Ripley)
Date: Fri, 24 Sep 2021 16:35:17 +0100
Subject: [R-SIG-Mac] Java 17 builds
Message-ID: <94184dea-d653-c34b-bfc5-d1abd4341f24@stats.ox.ac.uk>

The current version of Java is 17: this has 'long term support' and is 
the first to officially support M1 macs.

Mac-friendly installers are now available from https://adoptium.net for 
Intel (which they call x64) and M1 (aarch64).  Unlike builds available 
from jdk.java.net and Zulu these install into Apple-standard locations 
and so are found by /usr/bin/java.

Not all CRAN packages work with Java 17: there are additional security 
measures and XLConnect excludes it.  The maintainers have been informed 
so hopefully this will change soon.

On Intel I would keep on using Java 11 (also available from Adoptium, 
formerly AdoptOpenJDK).  On M1, the Adoptium build of 17 makes things 
much cleaner.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford


From je|| @end|ng |rom m@th@toronto@edu  Wed Sep 29 20:17:02 2021
From: je|| @end|ng |rom m@th@toronto@edu (Jeffrey Rosenthal)
Date: Wed, 29 Sep 2021 14:17:02 -0400
Subject: [R-SIG-Mac] strange segfault error in R from command-line on Mac
 laptop
Message-ID: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>

Hello.? I often use R from the command-line (i.e. just typing "R") 
within the "Terminal" application on my MacBook Pro laptop.? And 
sometimes I get a sudden strange error "*** caught segfault *** address 
0x10, cause 'memory not mapped'" (after which R allows me to 
abort/exit/etc, but not to continue).? It occurs when using the arrow or 
delete keys (perhaps related to readline?).? After much testing, I have 
found a very simple reproducible minimal example. Namely, if I start R 
from the command line, and then type "plot(0)", and then type any 
character (e.g. "a") and then the delete key, then it always triggers 
this error.? Does this error occur for anyone else?? Any ideas how to 
fix it?

I know that this problem is quite specific to my Mac laptop set-up; it 
does not occur on my iMac nor on my friend's Mac.? On the other hand, I 
did try upgrading R and that did not fix it.? My sessionInfo() output 
follows.? I am *not* saving R history, nor setting R_SAVEHIST, and I do 
*not* have any .Rhistory or .Rapp.history file in my directory.? Thank 
you very much for any suggestions!

--------------------------------------------

> sessionInfo()

R version 4.0.2 (2020-06-22)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:
/Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK:
/Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.0.2

------------------------------------------------
 ??Jeffrey S. Rosenthal
 ??Professor of Statistics, University of Toronto
 ??Web site: http://probability.ca/jeff/


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Sep 29 20:40:06 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 29 Sep 2021 11:40:06 -0700
Subject: [R-SIG-Mac] 
 strange segfault error in R from command-line on Mac laptop
In-Reply-To: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
References: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
Message-ID: <4BA4377C-6B9F-41F3-BC89-AE16B2FEA728@dcn.davis.ca.us>

I cannot address your observed symptoms, but shouldn't you have already upgraded your R to the latest version before asking this?

On September 29, 2021 11:17:02 AM PDT, Jeffrey Rosenthal <jeff at math.toronto.edu> wrote:
>Hello.? I often use R from the command-line (i.e. just typing "R") 
>within the "Terminal" application on my MacBook Pro laptop.? And 
>sometimes I get a sudden strange error "*** caught segfault *** address 
>0x10, cause 'memory not mapped'" (after which R allows me to 
>abort/exit/etc, but not to continue).? It occurs when using the arrow or 
>delete keys (perhaps related to readline?).? After much testing, I have 
>found a very simple reproducible minimal example. Namely, if I start R 
>from the command line, and then type "plot(0)", and then type any 
>character (e.g. "a") and then the delete key, then it always triggers 
>this error.? Does this error occur for anyone else?? Any ideas how to 
>fix it?
>
>I know that this problem is quite specific to my Mac laptop set-up; it 
>does not occur on my iMac nor on my friend's Mac.? On the other hand, I 
>did try upgrading R and that did not fix it.? My sessionInfo() output 
>follows.? I am *not* saving R history, nor setting R_SAVEHIST, and I do 
>*not* have any .Rhistory or .Rapp.history file in my directory.? Thank 
>you very much for any suggestions!
>
>--------------------------------------------
>
>> sessionInfo()
>
>R version 4.0.2 (2020-06-22)
>Platform: x86_64-apple-darwin17.0 (64-bit)
>Running under: macOS Catalina 10.15.7
>
>Matrix products: default
>BLAS:
>/Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
>LAPACK:
>/Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
>
>locale:
>[1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>
>attached base packages:
>[1] stats     graphics  grDevices utils     datasets  methods   base
>
>loaded via a namespace (and not attached):
>[1] compiler_4.0.2
>
>------------------------------------------------
> ??Jeffrey S. Rosenthal
> ??Professor of Statistics, University of Toronto
> ??Web site: http://probability.ca/jeff/
>
>_______________________________________________
>R-SIG-Mac mailing list
>R-SIG-Mac at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-mac

-- 
Sent from my phone. Please excuse my brevity.


From @|mon@urb@nek @end|ng |rom R-project@org  Wed Sep 29 23:24:13 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Thu, 30 Sep 2021 10:24:13 +1300
Subject: [R-SIG-Mac] 
 strange segfault error in R from command-line on Mac laptop
In-Reply-To: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
References: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
Message-ID: <95C4A526-CCBC-4186-ABE2-517190ED40EF@R-project.org>


Jeffrey,

can you send me the crash log, please? (Utilities ->Console->User Reports).

Thanks,
Simon


> On Sep 30, 2021, at 7:17 AM, Jeffrey Rosenthal <jeff at math.toronto.edu> wrote:
> 
> Hello.  I often use R from the command-line (i.e. just typing "R") within the "Terminal" application on my MacBook Pro laptop.  And sometimes I get a sudden strange error "*** caught segfault *** address 0x10, cause 'memory not mapped'" (after which R allows me to abort/exit/etc, but not to continue).  It occurs when using the arrow or delete keys (perhaps related to readline?).  After much testing, I have found a very simple reproducible minimal example. Namely, if I start R from the command line, and then type "plot(0)", and then type any character (e.g. "a") and then the delete key, then it always triggers this error.  Does this error occur for anyone else?  Any ideas how to fix it?
> 
> I know that this problem is quite specific to my Mac laptop set-up; it does not occur on my iMac nor on my friend's Mac.  On the other hand, I did try upgrading R and that did not fix it.  My sessionInfo() output follows.  I am *not* saving R history, nor setting R_SAVEHIST, and I do *not* have any .Rhistory or .Rapp.history file in my directory.  Thank you very much for any suggestions!
> 
> --------------------------------------------
> 
>> sessionInfo()
> 
> R version 4.0.2 (2020-06-22)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Catalina 10.15.7
> 
> Matrix products: default
> BLAS:
> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
> LAPACK:
> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
> 
> locale:
> [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.0.2
> 
> ------------------------------------------------
>   Jeffrey S. Rosenthal
>   Professor of Statistics, University of Toronto
>   Web site: http://probability.ca/jeff/
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


From dw|n@em|u@ @end|ng |rom comc@@t@net  Thu Sep 30 20:02:11 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Thu, 30 Sep 2021 11:02:11 -0700
Subject: [R-SIG-Mac] 
 strange segfault error in R from command-line on Mac laptop
In-Reply-To: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
References: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
Message-ID: <87e028cf-2b2a-8f6f-bff3-78753cbd5587@comcast.net>


On 9/29/21 11:17 AM, Jeffrey Rosenthal wrote:
> Hello. I often use R from the command-line (i.e. just typing "R") 
> within the "Terminal" application on my MacBook Pro laptop.? And 
> sometimes I get a sudden strange error "*** caught segfault *** 
> address 0x10, cause 'memory not mapped'" (after which R allows me to 
> abort/exit/etc, but not to continue).? It occurs when using the arrow 
> or delete keys (perhaps related to readline?).? After much testing, I 
> have found a very simple reproducible minimal example. Namely, if I 
> start R from the command line, and then type "plot(0)", and then type 
> any character (e.g. "a") and then the delete key, then it always 
> triggers this error.? Does this error occur for anyone else?? Any 
> ideas how to fix it?


I would reinstall XQuartz. The `plot(0)` command changes the focus from 
R to XQuartz, so the processing of the typed letter "a" is being handled 
by that system function rather than by R. On my 3 year-old MacAir 
running R 4.1.0 typing a letter with the system focus on a plot window 
produces a mild error tone, as does typing the delete key. (No crash 
after returning focus to the R process by mouse-clicking in the Terminal 
window.


-- 

David

>
> I know that this problem is quite specific to my Mac laptop set-up; it 
> does not occur on my iMac nor on my friend's Mac.? On the other hand, 
> I did try upgrading R and that did not fix it.? My sessionInfo() 
> output follows.? I am *not* saving R history, nor setting R_SAVEHIST, 
> and I do *not* have any .Rhistory or .Rapp.history file in my 
> directory.? Thank you very much for any suggestions!
>
> --------------------------------------------
>
>> sessionInfo()
>
> R version 4.0.2 (2020-06-22)
> Platform: x86_64-apple-darwin17.0 (64-bit)
> Running under: macOS Catalina 10.15.7
>
> Matrix products: default
> BLAS:
> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
> LAPACK:
> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib 
>
>
> locale:
> [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.0.2
>
> ------------------------------------------------
> ??Jeffrey S. Rosenthal
> ??Professor of Statistics, University of Toronto
> ??Web site: http://probability.ca/jeff/
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac


From @|mon@urb@nek @end|ng |rom R-project@org  Thu Sep 30 23:23:16 2021
From: @|mon@urb@nek @end|ng |rom R-project@org (Simon Urbanek)
Date: Fri, 1 Oct 2021 10:23:16 +1300
Subject: [R-SIG-Mac] 
 strange segfault error in R from command-line on Mac laptop
In-Reply-To: <87e028cf-2b2a-8f6f-bff3-78753cbd5587@comcast.net>
References: <c871ea97-6a3e-759f-9923-d3c56f30f623@math.toronto.edu>
 <87e028cf-2b2a-8f6f-bff3-78753cbd5587@comcast.net>
Message-ID: <A71A0FA0-4164-42E3-9FF1-EF18E0366C5D@R-project.org>


David,

Jeffrey said he is using Quartz and that is key here (since that initializes threads in the process). We have been handing this offline and it is a crash in readline. I cannot reproduce it so we're still tracking down the circumstances which as a bit odd (there are suddenly two threads in R that use the console but it is unclear where the second thread comes from and why is it calling the console API).

Cheers,
Simon

 

> On Oct 1, 2021, at 7:02 AM, David Winsemius <dwinsemius at comcast.net> wrote:
> 
> 
> On 9/29/21 11:17 AM, Jeffrey Rosenthal wrote:
>> Hello. I often use R from the command-line (i.e. just typing "R") within the "Terminal" application on my MacBook Pro laptop.  And sometimes I get a sudden strange error "*** caught segfault *** address 0x10, cause 'memory not mapped'" (after which R allows me to abort/exit/etc, but not to continue).  It occurs when using the arrow or delete keys (perhaps related to readline?).  After much testing, I have found a very simple reproducible minimal example. Namely, if I start R from the command line, and then type "plot(0)", and then type any character (e.g. "a") and then the delete key, then it always triggers this error.  Does this error occur for anyone else?  Any ideas how to fix it?
> 
> 
> I would reinstall XQuartz. The `plot(0)` command changes the focus from R to XQuartz, so the processing of the typed letter "a" is being handled by that system function rather than by R. On my 3 year-old MacAir running R 4.1.0 typing a letter with the system focus on a plot window produces a mild error tone, as does typing the delete key. (No crash after returning focus to the R process by mouse-clicking in the Terminal window.
> 
> 
> -- 
> 
> David
> 
>> 
>> I know that this problem is quite specific to my Mac laptop set-up; it does not occur on my iMac nor on my friend's Mac.  On the other hand, I did try upgrading R and that did not fix it.  My sessionInfo() output follows.  I am *not* saving R history, nor setting R_SAVEHIST, and I do *not* have any .Rhistory or .Rapp.history file in my directory.  Thank you very much for any suggestions!
>> 
>> --------------------------------------------
>> 
>>> sessionInfo()
>> 
>> R version 4.0.2 (2020-06-22)
>> Platform: x86_64-apple-darwin17.0 (64-bit)
>> Running under: macOS Catalina 10.15.7
>> 
>> Matrix products: default
>> BLAS:
>> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
>> LAPACK:
>> /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib 
>> 
>> locale:
>> [1] en_CA.UTF-8/en_CA.UTF-8/en_CA.UTF-8/C/en_CA.UTF-8/en_CA.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods base
>> 
>> loaded via a namespace (and not attached):
>> [1] compiler_4.0.2
>> 
>> ------------------------------------------------
>>   Jeffrey S. Rosenthal
>>   Professor of Statistics, University of Toronto
>>   Web site: http://probability.ca/jeff/
>> 
>> _______________________________________________
>> R-SIG-Mac mailing list
>> R-SIG-Mac at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
> 


