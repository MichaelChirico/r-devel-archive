From dw|n@em|u@ @end|ng |rom comc@@t@net  Wed Dec  1 02:22:51 2021
From: dw|n@em|u@ @end|ng |rom comc@@t@net (David Winsemius)
Date: Tue, 30 Nov 2021 17:22:51 -0800
Subject: [R] Degree symbol as axis label superscript [RESOLVED]
In-Reply-To: <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <4f69214-7a32-6eb2-6476-85c164d5bbf@appl-ecosys.com>
 <ce6095c5-c2cb-4bfb-f230-2667613b2dd3@appl-ecosys.com>
 <472ac05b-11ac-f7bc-9e26-1cad38c3b96f@comcast.net>
 <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
Message-ID: <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>


On 11/30/21 1:22 PM, Rich Shepard wrote:
> On Tue, 30 Nov 2021, David Winsemius wrote:
>
>> Really? What was wrong with this?
>> plot(1, 1, xlab=expression(32^degree) )? # the example given on 
>> ?plotmath
>
> David,
>
> Absolutely nothing. When there's no specific degree value in the label
> because the axis represents a range of values there's no digit preceeding
> the ^ symbol.
>
> The axis label is 'Temperature (oC)' with the degree symbol preceeding a
> character, not following a specific digit.


There's nothing special about following a digit. You can have it follow 
anything. Since you were going to need to quote the parentheses anywa, 
then have it superscripted above the level of the paren:


plot(1,1, ylab = expression(Temperature~"("^degree*C*")") ? )

-- 

David.

>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From g@@@uu| @end|ng |rom gm@||@com  Wed Dec  1 02:59:03 2021
From: g@@@uu| @end|ng |rom gm@||@com (ani jaya)
Date: Wed, 1 Dec 2021 10:59:03 +0900
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
Message-ID: <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>

one of my solution :

text(x,y,"\u00B0C", cex=1.1, font=2)

it will produce "?C"

text(x,y,"\u00B3C", cex=1.1, font=2)
it will produce "superscript(3)C"

so basically change the character after the "\u00B..." will produce
the superscript.

Best, Ani

On Wed, Dec 1, 2021 at 4:05 AM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I want to present the temperature on the Y-axis label as 'Water Temperature
> (oC)' with the degree symbol as a superscript.
>
> My web search found a couple of methods; one put the entire example string
> in the axis label, the other is close, but still incorrect.
>
> Source example:
> #define expression with superscript
> x_expression <- expression(x^3 ~ variable ~ label)
> # The example axis label is:
> 'X3 variable label' (with the 3 as a superscript)
>
> My use:
> # Set degree symbol as superscript in plot's y axis:
> y_expression <- expression(^o ~ C)
>
> R's error message:
> Error in source("../scripts/all_temp_plots.r") :
>    ../scripts/all_temp_plots.r:10:28: unexpected '^'
> 9: # Set degree symbol as superscript in plot's y axis:
> 10: y_expression <- expression(^
>                                 ^
>
> What is the proper way to display a degree symbol in a plot's axis label?
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From @v|gro@@ @end|ng |rom ver|zon@net  Wed Dec  1 04:42:35 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Tue, 30 Nov 2021 22:42:35 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
Message-ID: <05fe01d7e665$7afa5330$70eef990$@verizon.net>

Stephen,

Although what is in the STANDARD R distribution can vary several ways, in
general, if you need to add a line like:

library(something)
or
require(something)

and your code does not work unless you have done that, then you can imagine
it is not sort of built in to R as it starts.

Having said that, tons of exceptions may exist that cause R to load in
things on your machine for everyone or just for you without you having to
notice.

I think this forum lately has been deluged with questions about all kinds of
add-on packages and in particular, lots of the ones in the tidyverse.
Clearly the purpose here is not that broad.

But since I use some packages like the tidyverse extensively, and I am far
from alone, I wonder if someday the powers that be realize it is a losing
battle to exclude at least some of it. It would be so nice not having to
include a long list of packages for some programs or somehow arrange that
people using something you shared had installed and loaded them. But there
are too many packages out there of varying quality and usefulness and
popularity with more every day being added. Worse, many are somewhat
incompatible such as having functions with the same names that hide earlier
ones loaded.

Base R doe come with functions like colSums and colMeans and similar row
functions. But as mentioned, a data.frame is a list of vectors and R
supports certain functional programming constructs over lists using things
like:

lapply(df, min)
sapply(df, min)

And actually quite a few ways depending on what info you want back and
whether you insist it be returned as a list or vector or other things . You
can even supply additional arguments that might be needed such as if you
want to ignore any NA values,

lapply(df, min, na.rm=TRUE

The package you looked at it is trying to be fast and uses what looks like
compiled external code but so does lapply.

If this is too bothersome for you, consider making a one-liner function like
this:

mycolMins <- function(df, ...) lapply(df, min, ...)

Once defined, you can use that just fine and not think about it again and I
note this answer (like others) is offering you something in base R that
works fine on data.frames and the like.

You can extend to many similar ideas like this one that calulates the min
unless you over-ride it with max or mean or sd or a bizarre function like
`[` so a call to:

mycolCalc(df, `[`, 3)

Will return exactly the third items in each row!

I find it to be very common for someone these days to do a quick search for
a way to do something in a language like R and not really look to see if it
is a standard way or something special/ Matrices in R are not quite the same
as some other objects like a data.frame or tibble and a package written to
be used on one may (or may not) happen to work with another. Some packages
are carefully written to try to detect what kind of object it gets and when
possible convert it to another. The "apply" function is meant for matrices
but if it sees something else it looks ta the dimensionality and tries to
coerce it with as.matrix or as.array first. As others have noted, this mean
a data.frame containing non-numeric parts may fail or should have any other
columns hidden/removed as in this df that has some non-numeric fields:

> df
i       s   f     b i2
1 1   hello 1.2  TRUE  5
2 2   there 2.3 FALSE  4
3 3 goodbye 3.4  TRUE  3

So a bit more complex one-liner removes any non-numeric columns like this:

> mycolMins(df[, sapply(df, is.numeric)])
$i
[1] 1

$f
[1] 1.2

$i2
[1] 3

Clearly converting that to a matrix while whole would result in everything
being converted to character and a minimum may be elusive.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
DSL via R-help
Sent: Tuesday, November 30, 2021 5:37 PM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: r-help at r-project.org
Subject: Re: [R] Question about Rfast colMins and colMaxs

Oh, you are segmenting standard R from the rest of R.

Well, that part did not come across to me in your original reply. I am not
clear on a standard versus non-standard list. I will look into this aspect
and see what I can learn going forward.


Thanks,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 5:26 PM, Bert Gunter wrote:
> ... but Rfast is *not* a "standard" package, as the rest of the PG 
> excerpt says. So contact the maintainer and ask him/her what they 
> think the best practice should be for their package. As has been 
> pointed out already, it appears to differ from the usual "read it in 
> as a data frame" procedure.
>
> Bert
>
> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL 
> <service at shdawson.com> wrote:
>> Right, R Studio is not R.
>>
>> However, the Rfast package is part of R.
>>
>> https://cran.r-project.org/web/packages/Rfast/index.html
>>
>> So, rephrasing my question...
>> What is the best practice to bring a csv file into R so it can be 
>> accessed by colMaxs and colMins, please?
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>> RStudio is **not** R. In particular, the so-called TidyVerse 
>>> consists of all *non*-standard contributed packages, about which the PG
says:
>>>
>>> "For questions about functions in standard packages distributed with 
>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>> [The link is:
>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>> This gives the list of current _standard_ packages]
>>>
>>> If the question relates to a contributed package , e.g., one 
>>> downloaded from CRAN, try contacting the package maintainer first. 
>>> You can also use find("functionname") and
>>> packageDescription("packagename") to find this information. Only 
>>> send such questions to R-help or R-devel if you get no reply or need 
>>> further assistance. This applies to both requests for help and to 
>>> bug reports."
>>>
>>> Note that RStudio maintains its own help resources at:
>>> https://community.rstudio.com/
>>> This is where questions about the TidyVerse, ggplot, etc. should be
posted.
>>>
>>>
>>>
>>> Bert Gunter
>>>
>>> "The trouble with having an open mind is that people keep coming 
>>> along and sticking things into it."
>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>
>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help 
>>> <r-help at r-project.org> wrote:
>>>> Hi,
>>>>
>>>>
>>>> I am working to understand the Rfast functions of colMins and 
>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>
>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>
>>>> However, I read the instructions listed on page 54 of the PDF 
>>>> saying I need to bring data into R using a matrix. I think read.csv 
>>>> brings the data in as a dataframe. I think colMins is failing 
>>>> because it is looking for a matrix but finds a dataframe.
>>>>
>>>>    > colMaxs(Data)
>>>> Error in colMaxs(Data) :
>>>>      Not compatible with requested type: [type=list; target=double].
>>>>    > colMins(Data, na.rm = TRUE)
>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>      unused argument (na.rm = TRUE)
>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in 
>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>      Not compatible with requested type: [type=list; target=double].
>>>>
>>>> QUESTION
>>>> What is the best practice to bring a csv file into R Studio so it 
>>>> can be accessed by colMaxs and colMins, please?
>>>>
>>>>
>>>> Thanks,
>>>> --
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide 
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Wed Dec  1 04:51:41 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Tue, 30 Nov 2021 22:51:41 -0500
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
Message-ID: <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>

Using the degree character seems perfectly legit to me. The reason I
suggest looking at plotmath is that I think plotmath is easier to read
(that is, if you're escaping your characters with \u), and because for
anything more complicated like set notation, big sums, integrals, you'll
need to get used to plotmath to make your labels. Either way, nice
suggestion, both work perfectly well for this situation

On Tue, Nov 30, 2021, 16:24 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> True, but unnecessary with UTF-8 encodings of unicode (subject to some
> caveats, though):
>
> plot(1:5, runif(5),xlab = "Temp (?F)", ylab = "result")
>
> should work fine, where the ? ("degree") symbol was inserted by the
> symbol insertion facility on my Mac. Windows has something similar.
> See the comments in the plotmath documentation just before the
> examples for more details on this, along with some caveats about the
> need for a suitable display/plot device.
>
> More laboriously, but perhaps more informatively, one can look up
> "unicode code point for degree symbol" to find that it is decimal 176.
> Then R's intToUtf8() function converts this to the UTF-8 encoding that
> **should** display as a "degree" symbol, subject to the above
> referenced caveats.
> Hence:
> > intToUtf8(176)
> [1] "?"  ##degree character
>
> ## So, for example, you can do:
> > degrF <-paste0(intToUtf8(176),"F")
> > degrF
> [1] "?F" ("degrees F")
>
> > plot(1:5, runif(5),xlab = paste0("Temp (", degrF,")"), ylab = "result")
>
> As Andrew said, you can use plotmath to do this, too; it just isn't
> needed for simple insertion of "standard" symbols.
>
> NOTE: As I am far from an expert on all of this, I would appreciate
> clarification or correction of any errors or misstatements in the
> above.
>
> Bert Gunter
>
>
> On Tue, Nov 30, 2021 at 11:34 AM Andrew Simmons <akwsimmo at gmail.com>
> wrote:
> >
> > Excuse my brevity, but take a look at ?plotmath
> >
> > It has tons of tips for making pretty labels
> >
> > On Tue, Nov 30, 2021, 14:05 Rich Shepard <rshepard at appl-ecosys.com>
> wrote:
> >
> > > I want to present the temperature on the Y-axis label as 'Water
> Temperature
> > > (oC)' with the degree symbol as a superscript.
> > >
> > > My web search found a couple of methods; one put the entire example
> string
> > > in the axis label, the other is close, but still incorrect.
> > >
> > > Source example:
> > > #define expression with superscript
> > > x_expression <- expression(x^3 ~ variable ~ label)
> > > # The example axis label is:
> > > 'X3 variable label' (with the 3 as a superscript)
> > >
> > > My use:
> > > # Set degree symbol as superscript in plot's y axis:
> > > y_expression <- expression(^o ~ C)
> > >
> > > R's error message:
> > > Error in source("../scripts/all_temp_plots.r") :
> > >    ../scripts/all_temp_plots.r:10:28: unexpected '^'
> > > 9: # Set degree symbol as superscript in plot's y axis:
> > > 10: y_expression <- expression(^
> > >                                 ^
> > >
> > > What is the proper way to display a degree symbol in a plot's axis
> label?
> > >
> > > Rich
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide
> > > http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  1 05:58:45 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Tue, 30 Nov 2021 20:58:45 -0800
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <CAGxFJbTiVwfLi2_p2Sb+uT3iWPtfUO-8HODuAcpe_tKz+wM3HA@mail.gmail.com>
 <CAPcHnpSAYzpN5iFGQ=4mTfyHNecHszh+uv1r+C_jgW+fd=8ZMg@mail.gmail.com>
Message-ID: <CAGxFJbQFSP8fENiPuYLYXW++iVdB3FQg3L-kfqgvB1pN2Lui6Q@mail.gmail.com>

Yes, but I should acknowledge my ignorance in not realizing that "\u00b0"
(hex 176) is a simpler way to get the character in R without the OS tool
than intToUtf8() .  If you need math notation beyond simple symbol
characters, plotmath is certainly indispensable.

Bert

On Tue, Nov 30, 2021 at 7:51 PM Andrew Simmons <akwsimmo at gmail.com> wrote:

> Using the degree character seems perfectly legit to me. The reason I
> suggest looking at plotmath is that I think plotmath is easier to read
> (that is, if you're escaping your characters with \u), and because for
> anything more complicated like set notation, big sums, integrals, you'll
> need to get used to plotmath to make your labels. Either way, nice
> suggestion, both work perfectly well for this situation
>
> On Tue, Nov 30, 2021, 16:24 Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
>> True, but unnecessary with UTF-8 encodings of unicode (subject to some
>> caveats, though):
>>
>> plot(1:5, runif(5),xlab = "Temp (?F)", ylab = "result")
>>
>> should work fine, where the ? ("degree") symbol was inserted by the
>> symbol insertion facility on my Mac. Windows has something similar.
>> See the comments in the plotmath documentation just before the
>> examples for more details on this, along with some caveats about the
>> need for a suitable display/plot device.
>>
>> More laboriously, but perhaps more informatively, one can look up
>> "unicode code point for degree symbol" to find that it is decimal 176.
>> Then R's intToUtf8() function converts this to the UTF-8 encoding that
>> **should** display as a "degree" symbol, subject to the above
>> referenced caveats.
>> Hence:
>> > intToUtf8(176)
>> [1] "?"  ##degree character
>>
>> ## So, for example, you can do:
>> > degrF <-paste0(intToUtf8(176),"F")
>> > degrF
>> [1] "?F" ("degrees F")
>>
>> > plot(1:5, runif(5),xlab = paste0("Temp (", degrF,")"), ylab = "result")
>>
>> As Andrew said, you can use plotmath to do this, too; it just isn't
>> needed for simple insertion of "standard" symbols.
>>
>> NOTE: As I am far from an expert on all of this, I would appreciate
>> clarification or correction of any errors or misstatements in the
>> above.
>>
>> Bert Gunter
>>
>>
>> On Tue, Nov 30, 2021 at 11:34 AM Andrew Simmons <akwsimmo at gmail.com>
>> wrote:
>> >
>> > Excuse my brevity, but take a look at ?plotmath
>> >
>> > It has tons of tips for making pretty labels
>> >
>> > On Tue, Nov 30, 2021, 14:05 Rich Shepard <rshepard at appl-ecosys.com>
>> wrote:
>> >
>> > > I want to present the temperature on the Y-axis label as 'Water
>> Temperature
>> > > (oC)' with the degree symbol as a superscript.
>> > >
>> > > My web search found a couple of methods; one put the entire example
>> string
>> > > in the axis label, the other is close, but still incorrect.
>> > >
>> > > Source example:
>> > > #define expression with superscript
>> > > x_expression <- expression(x^3 ~ variable ~ label)
>> > > # The example axis label is:
>> > > 'X3 variable label' (with the 3 as a superscript)
>> > >
>> > > My use:
>> > > # Set degree symbol as superscript in plot's y axis:
>> > > y_expression <- expression(^o ~ C)
>> > >
>> > > R's error message:
>> > > Error in source("../scripts/all_temp_plots.r") :
>> > >    ../scripts/all_temp_plots.r:10:28: unexpected '^'
>> > > 9: # Set degree symbol as superscript in plot's y axis:
>> > > 10: y_expression <- expression(^
>> > >                                 ^
>> > >
>> > > What is the proper way to display a degree symbol in a plot's axis
>> label?
>> > >
>> > > Rich
>> > >
>> > > ______________________________________________
>> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > > https://stat.ethz.ch/mailman/listinfo/r-help
>> > > PLEASE do read the posting guide
>> > > http://www.R-project.org/posting-guide.html
>> > > and provide commented, minimal, self-contained, reproducible code.
>> > >
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > ______________________________________________
>> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> > https://stat.ethz.ch/mailman/listinfo/r-help
>> > PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> > and provide commented, minimal, self-contained, reproducible code.
>>
>

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec  1 14:26:17 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 1 Dec 2021 05:26:17 -0800 (PST)
Subject: [R] Degree symbol as axis label superscript [RESOLVED]
In-Reply-To: <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAPcHnpQQU6iM8swfbK1+Zws1BurRKm13tdHNrOVBkuiK81725Q@mail.gmail.com>
 <4f69214-7a32-6eb2-6476-85c164d5bbf@appl-ecosys.com>
 <ce6095c5-c2cb-4bfb-f230-2667613b2dd3@appl-ecosys.com>
 <472ac05b-11ac-f7bc-9e26-1cad38c3b96f@comcast.net>
 <96f2116f-93ef-f261-9ecd-2edcd36a54@appl-ecosys.com>
 <f0a269ea-7bf2-3e57-70fd-88b8c2f2c562@comcast.net>
Message-ID: <47759dac-984c-4b1-1a6b-1f3e22c6a514@appl-ecosys.com>

On Tue, 30 Nov 2021, David Winsemius wrote:

> There's nothing special about following a digit. You can have it follow
> anything. Since you were going to need to quote the parentheses anywa,
> then have it superscripted above the level of the paren:
> plot(1,1, ylab = expression(Temperature~"("^degree*C*")") ? )

Thank you, David. I tried something like that missed the correct quoting.

Regards,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Wed Dec  1 14:27:24 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Wed, 1 Dec 2021 05:27:24 -0800 (PST)
Subject: [R] Degree symbol as axis label superscript
In-Reply-To: <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>
References: <7974ab4-92ad-9a75-98f6-a7914bb8e5@appl-ecosys.com>
 <CAHXS41yk-_kHGAZFcUTv0PzzSSKrSRFUCOC5+8TavnPh2qZKmg@mail.gmail.com>
Message-ID: <595e5212-a82-597f-1f5-176bac88575@appl-ecosys.com>

On Wed, 1 Dec 2021, ani jaya wrote:

> one of my solution :
> text(x,y,"\u00B0C", cex=1.1, font=2)
> it will produce "?C"

Ani,

That's what I did.

Thank you,

Rich


From jrkr|de@u @end|ng |rom gm@||@com  Wed Dec  1 15:17:15 2021
From: jrkr|de@u @end|ng |rom gm@||@com (John Kane)
Date: Wed, 1 Dec 2021 09:17:15 -0500
Subject: [R] Syntax help for 'Pivot_longer'
In-Reply-To: <CAMVDa_6YBoPskUyEkXZ6oo76yK0UE59p=s5OssfZj-0apc=oqA@mail.gmail.com>
References: <CAMVDa_4_ktvBh2rgrKZtnNveCpbOwkrmwbM8aeG=wx3kF=gs5g@mail.gmail.com>
 <64556987.6135303.1638115192363.JavaMail.zimbra@psyctc.org>
 <CAMVDa_4bz5HVXx7FXCZT979KTnMvSgqO9P7vzCW3BjLC13sDFQ@mail.gmail.com>
 <68011A37-C87F-4E29-A212-E0CAC604A9B4@dcn.davis.ca.us>
 <CAMVDa_6YBoPskUyEkXZ6oo76yK0UE59p=s5OssfZj-0apc=oqA@mail.gmail.com>
Message-ID: <CAKZQJMDJpaGAWF2h=L7qqQgGK5P7acDgv7MfGkdw64F8dYfA4w@mail.gmail.com>

Hi Phillip,

Let's say your original data is in a data.frame called "mydata".

What you want to do is issue de command
dput(mydata)

then just copy the output and paste it into the message.

Here is a very simple example


dat1 <-   data.frame(xx = LETTERS[1:10], yy = 10:1)

dput(dat1)

====================output to copy and paste===========

structure(list(xx = c("A", "B", "C", "D", "E", "F", "G", "H",
"I", "J"), yy = 10:1), class = "data.frame", row.names = c(NA,
-10L))

=============================================

 If you have a very large data set then something like
head(dput(myfile), 100) will likely supply enough data for us to work
with.


On Mon, 29 Nov 2021 at 05:20, Philip Monk <prmonk at gmail.com> wrote:
>
> Apologies, all.  No offence was intended.
>
> I'll go away and do a lot more reading and thinking then come back
> with a clearly articulated query if and when that is appropriate.
> I'm out of time this week, so it won't be for some time.
>
> Thank you all for the helpful replies.
>
> Best wishes,
>
> Philip
>
> On Mon, 29 Nov 2021 at 00:31, Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
> >
> > This "data_long" appears to be a mess you are not satisfied with, rather than the "data" you started with or a model of what you want.
> >
> > On November 28, 2021 9:06:54 AM PST, Philip Monk <prmonk at gmail.com> wrote:
> > >Thanks for your suggestions, Chris.
> > >
> > >I'm writing from Gmail's web client, and have checked the message is
> > >being sent as plain text (though I also did this previously so it may
> > >be that I need to change to Outlook).  Let me know if it doesn't work.
> > >
> > >Hopefully I've used dput properly (see example below with apologies to
> > >Burt and the PG).   In my defence, I have very limited time due to
> > >caring responsibilities so am time-poor out of necessity rather than
> > >laziness.
> > >
> > >Reading the 'pivot_longer' documentation I think I need to use
> > >'names_pattern' to split the weather data into different columns, but
> > >I don't understand the required syntax.
> > >
> > >Thanks for your help,
> > >
> > >Philip
> > >
> > >rm(list=ls())
> > >library(ggplot2)
> > >library(ggpubr)
> > >library(tidyverse)
> > >library(rstatix)
> > >library(ez)
> > >library(dplyr)
> > >
> > >data_long <-
> > >  structure(
> > >    list(
> > >      Buffer = c(
> > >        "100",
> > >        "200",
> > >        "300",
> > >        "400",
> > >        "500",
> > >        "600",
> > >        "700",
> > >        "800",
> > >        "900",
> > >        "1000",
> > >        "1100",
> > >        "1200",
> > >        "1300",
> > >        "1400",
> > >        "1500",
> > >        "1600",
> > >        "1700",
> > >        "1800",
> > >        "1900",
> > >        "Temperature",
> > >        "Wind speed",
> > >        "Wind trend",
> > >        "Wind direction",
> > >        "Humidity",
> > >        "Pressure",
> > >        "Pressure trend"
> > >      ),
> > >      `15/01/2010` = c(
> > >        6.091741043,
> > >        5.271975614,
> > >        4.451891901,
> > >        3.385694303,
> > >        2.900508112,
> > >        3.110238149,
> > >        3.150580922,
> > >        3.079728958,
> > >        2.327902499,
> > >        1.641887823,
> > >        1.63370882,
> > >        0.986559368,
> > >        0.920601397,
> > >        0.571882394,
> > >        0.340505009,
> > >        0.813480877,
> > >        0.471988882,
> > >        0.269067515,
> > >        0.303179244,
> > >        12,
> > >        10,
> > >        1,
> > >        22.5,
> > >        40,
> > >        1024,
> > >        1
> > >      ),
> > >      `16/02/2010` = c(
> > >        6.405879111,
> > >        5.994054977,
> > >        5.61142085,
> > >        4.77953426,
> > >        4.305900444,
> > >        3.616699448,
> > >        2.848148846,
> > >        2.016807672,
> > >        1.452876728,
> > >        2.120099832,
> > >        1.661317381,
> > >        1.133219897,
> > >        1.237239562,
> > >        0.93675648,
> > >        0.7379146,
> > >        1.026085605,
> > >        0.566766122,
> > >        0.13349775,
> > >        0.082892149,
> > >        15,
> > >        9,
> > >        1,
> > >        45,
> > >        44.5,
> > >        1018.5,
> > >        1
> > >      ),
> > >      `20/03/2010` = c(
> > >        8.925945159,
> > >        7.375445078,
> > >        6.120095292,
> > >        5.608927408,
> > >        5.61367474,
> > >        4.800003992,
> > >        4.216782177,
> > >        4.05288041,
> > >        3.779922823,
> > >        4.267840277,
> > >        3.747342619,
> > >        2.414025636,
> > >        2.647100163,
> > >        2.272566024,
> > >        2.526476424,
> > >        2.643863876,
> > >        1.290173713,
> > >        0.612263766,
> > >        0.465457136,
> > >        16,
> > >        10.5,
> > >        1,
> > >        67.5,
> > >        22,
> > >        1025,
> > >        1
> > >      ),
> > >      `24/04/2011` = c(
> > >        6.278147269,
> > >        5.805619599,
> > >        5.149985946,
> > >        4.542354226,
> > >        4.320657374,
> > >        4.006103489,
> > >        3.642003696,
> > >        3.315992643,
> > >        3.181741995,
> > >        3.321634055,
> > >        2.814670223,
> > >        2.180686348,
> > >        2.253223258,
> > >        2.07198929,
> > >        1.912840489,
> > >        1.825988411,
> > >        1.360936689,
> > >        0.666152106,
> > >        0.537232782,
> > >        23,
> > >        19.5,
> > >        0,
> > >        191.25,
> > >        24.5,
> > >        1005.5,
> > >        1
> > >      )
> > >    ),
> > >    row.names = c(NA, 26L),
> > >    class = "data.frame"
> > >  )
> > >
> > ># Converts data table from wide (many columns) to long (many rows) and
> > >creates the new object 'data_long'
> > ># Column 1 is the 'Buffer' number (100-2000), Columns 2-25 contain
> > >monthly data covering 2 years.
> > ># Column headers for columns 2:25 are mutated into a column called
> > >'Date', values for each buffer and each date into the column 'LST'
> > >
> > >data_long <- data %>% pivot_longer(cols = 2:25, names_pattern = names_to =
> > >                                     "Date", values_to = "LST")
> > >
> > ># Instructs R to treat the 'Date' column data as a date
> > >data_long$Date <- as.Date(data_long$Date, format = "%d/%m/%Y")
> > >
> > ># Creates a new column called 'Month' by extracting the month number
> > >from the date in the 'Date' column
> > >data_long <- mutate(data_long, Month = format(data_long$Date, "%m"))
> > >
> > ># Creates a new column called 'Year' by extracting the Year number
> > >(YYYY as %Y not %y) from the date in the 'Date' column
> > >data_long <- mutate(data_long, Year = format(data_long$Date, "%Y"))
> > >
> > ># Creates a new column called 'JulianDay' by calculating the Julian
> > >Day (day of the year from 1 January) from the date in the 'Date'
> > >column.
> > >data_long <- mutate(data_long, JulianDay = format(data_long$Date, "%j"))
> > >
> > ># Creates a new column called 'TimePeriod' where 1 = pre-construction,
> > >and 2 = post-construction of solar park.
> > ># Uses 'if_else' - If Year < 2015 value = 1, else 2.
> > >data_long <- mutate(data_long, TimePeriod = if_else(data_long$Year <
> > >2015, 1,2, missing = NULL))
> > >
> > ># Instructs R to treat the 'TimePeriod' column as a (categorical)
> > >factor - it is either 1 (pre-construction, or 2 (post-construction)
> > >data_long$TimePeriod <- as.factor(data_long$TimePeriod)
> > >
> > ># Change data types of Month, Year nad JulianDay
> > >data_long$Month <- as.numeric(data_long$Month)
> > >data_long$Year <- as.numeric(data_long$Year)
> > >data_long$JulianDay <- as.numeric(data_long$JulianDay)
> > >
> > ># 'Compactly display the internal structure of an R object'
> > >str(data_long)
> > >
> > ># Adds 'data_long' to R search path so that R can access it when
> > >evaluating a variable (simplifies syntax).
> > >attach(data_long)
> > >
> > >
> > >On Sun, 28 Nov 2021 at 15:59, Chris Evans <chrishold at psyctc.org> wrote:
> > >>
> > >> Often the issue is that different variables in the wide format are of different types so won't simply
> > >> pivot_longer without you making decisions which the function shouldn't make for you.  However, I think
> > >> the error messages when that happens are fairly clear so perhaps that's not what's happening here.
> > >>
> > >> I'm happy to have a look at this as I've slowly become a convert to using tidyverse principles and tools
> > >> (sometimes seen, legalistically correctly I think, as outside the remit of this Email list) but I agree
> > >> that the help for pivot_longer() and many other tidyverse functions is not as good as it could be particularly
> > >> for people new to R.  Often there is better documentation in vignettes (so look for that) or in other things
> > >> on the web.
> > >>
> > >> However, for me the data that was posted are mangled by the post coming in HTML format.  Please read the
> > >> list documentation and resubmit the question in raw text Email and submit a bit of your data using
> > >> dput() (see ?dput and search out "R reproducible examples") and then I'll look at it.
> > >>
> > >> Very best (all),
> > >>
> > >> Chris
> > >>
> > >> ----- Original Message -----
> > >> > From: "Philip Monk" <prmonk at gmail.com>
> > >> > To: "R-help Mailing List" <r-help at r-project.org>
> > >> > Sent: Sunday, 28 November, 2021 13:57:07
> > >> > Subject: [R] Syntax help for 'Pivot_longer'
> > >>
> > >> > Hello,
> > >> >
> > >> > I have a wide table that I transform to a long table for analysis.
> > >> > The wide table has 25 columns - the first is labels, then columns 2:25
> > >> > are monthly data of LST which is in 19 rows.
> > >> >
> > >> > I mutate this with :
> > >> >
> > >> > data_long <- data %>% pivot_longer(cols = 2:25, names_to =
> > >> >                                     "Date", values_to = "LST")
> > >> >
> > >> > I've decided to add some weather data which might be relevant,
> > >> > inputting this as an additional 7 rows of data in the wide format (see
> > >> > example below of the first 5 months of data).
> > >> >
> > >> > I have belatedly realised that I cannot work out how to pivot this
> > >> > into the long format I need - the documentation doesn't provide enough
> > >> > syntax examples for me to work it out (I've not long been using 'R').
> > >> >
> > >> > How do I mutate this to provide the additional columns in the long
> > >> > table for the weather variables?
> > >> >
> > >> > Thanks for your time,
> > >> >
> > >> > Philip
> > >> >
> > >> > Part-time PhD Student (Environmental Science)
> > >> > Lancaster University, UK.
> > >> >
> > >> >
> > >> >
> > >> > Wide data
> > >> > ------------------
> > >> >
> > >> > Buffer            15/01/2010     16/02/2010     20/03/2010
> > >> > 24/04/2011      07/05/2010
> > >> >
> > >> > 100                6.091741043   6.405879111   8.925945159
> > >> > 6.278147269   6.133940129
> > >> >
> > >> > 200                5.271975614   5.994054977   7.375445078
> > >> > 5.805619599   5.537759202
> > >> >
> > >> > 300                4.451891901   5.61142085     6.120095292
> > >> > 5.149985946   5.353001442
> > >> >
> > >> > 400                3.385694303   4.77953426     5.608927408
> > >> > 4.542354226   4.824773827
> > >> >
> > >> > 500                2.900508112   4.305900444   5.61367474
> > >> > 4.320657374   4.520022189
> > >> >
> > >> > 600                3.110238149   3.616699448   4.800003992
> > >> > 4.006103489   4.188421662
> > >> >
> > >> > 700                 3.150580922   2.848148846   4.216782177
> > >> > 3.642003696   3.725611032
> > >> >
> > >> > 800                 3.079728958   2.016807672   4.05288041
> > >> > 3.315992643   3.278124347
> > >> >
> > >> > 900                 2.327902499   1.452876728   3.779922823
> > >> > 3.181741995   3.29577819
> > >> >
> > >> > 1000               1.641887823   2.120099832   4.267840277
> > >> > 3.321634055   3.551965361
> > >> >
> > >> > 1100               1.63370882     1.661317381   3.747342619
> > >> > 2.814670223   2.807355369
> > >> >
> > >> > 1200               0.986559368   1.133219897   2.414025636
> > >> > 2.180686348   2.166547946
> > >> >
> > >> > 1300               0.920601397   1.237239562   2.647100163
> > >> > 2.253223258   2.411947081
> > >> >
> > >> > 1400               0.571882394   0.93675648     2.272566024
> > >> > 2.07198929     1.954723088
> > >> >
> > >> > 1500               0.340505009   0.7379146       2.526476424
> > >> > 1.912840489   2.003872651
> > >> >
> > >> > 1600               0.813480877   1.026085605   2.643863876
> > >> > 1.825988411   2.278799668
> > >> >
> > >> > 1700               0.471988882   0.566766122   1.290173713
> > >> > 1.360936689   1.45967449
> > >> >
> > >> > 1800               0.269067515   0.13349775     0.612263766
> > >> > 0.666152106   0.680354177
> > >> >
> > >> > 1900               0.303179244   0.082892149   0.465457136
> > >> > 0.537232782   0.287185161
> > >> >
> > >> > Temperautre   12                    15                     16
> > >> >          23                   21.5
> > >> >
> > >> > Wind speed     10                    9                      10.5
> > >> >          9.5                   9.5
> > >> >
> > >> > Wind trend       1                      1                      1
> > >> >                0                     1
> > >> >
> > >> > Wind direction  22.5                45                      67.5
> > >> >         191.25            56.25
> > >> >
> > >> > Humidity           40                   44.5                   22
> > >> >              24.5                7
> > >> >
> > >> > Pressure          1024               1018.5               1025
> > >> >       1005.5            1015.5
> > >> >
> > >> > Pressure trend 1                      1                        1
> > >> >               1                      1
> > >> >
> > >> >
> > >> >
> > >> >
> > >> > long data
> > >> > -----------------
> > >> > Buffer         Date             LST             Temperature      Wind
> > >> > speed ......
> > >> > 1                  01.01.21     4                  5                        10
> > >> > 2                  01.02.21     5                  2                        11
> > >> > 3                  01.03.21     7                  5                        15
> > >> > 4                  01.04.21     9                  6                        7
> > >> > 5                  01.05.21     7                  5                        10
> > >> >
> > >> > ______________________________________________
> > >> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> > https://stat.ethz.ch/mailman/listinfo/r-help
> > >> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >> > and provide commented, minimal, self-contained, reproducible code.
> > >>
> > >> --
> > >> Chris Evans (he/him) <chris at psyctc.org>
> > >> Visiting Professor, UDLA, Quito, Ecuador & Honorary Professor, University of Roehampton, London, UK.
> > >> Work web site: https://www.psyctc.org/psyctc/
> > >> CORE site:     https://www.coresystemtrust.org.uk/
> > >> Personal site: https://www.psyctc.org/pelerinage2016/
> > >> OMbook:        https://ombook.psyctc.org/book/
> > >
> > >______________________________________________
> > >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >https://stat.ethz.ch/mailman/listinfo/r-help
> > >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > >and provide commented, minimal, self-contained, reproducible code.
> >
> > --
> > Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
John Kane
Kingston ON Canada


From dpweyg@nd @end|ng |rom gm@||@com  Wed Dec  1 16:30:39 2021
From: dpweyg@nd @end|ng |rom gm@||@com (Dennis Weygand)
Date: Wed, 1 Dec 2021 10:30:39 -0500
Subject: [R] readxl
Message-ID: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>

I have been using readxl function for years...
Suddenly, today, I get an error message:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

Does anyone know what has happened?
D.P. Weygand
Old Dominion University
Norfolk, VA

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Dec  1 16:41:39 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 07:41:39 -0800
Subject: [R] readxl
In-Reply-To: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>
References: <CAJgAAVSqg4P+fALoj2fQB8Ro8LfccYHYN3BGk96V=wZaXqhWiw@mail.gmail.com>
Message-ID: <0A2E3424-A14D-4E98-B49C-65927E5151BE@dcn.davis.ca.us>

Probably some kind of failure occurred during package updating and one or more of the packages readxl depends on was removed but not successfully re-installed.

Run

  install.packages( "lifecycle" )

and then

  update.packages()

and try using your function again. If a similar error occurs, repeat for the next missing package.

On December 1, 2021 7:30:39 AM PST, Dennis Weygand <dpweygand at gmail.com> wrote:
>I have been using readxl function for years...
>Suddenly, today, I get an error message:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>Does anyone know what has happened?
>D.P. Weygand
>Old Dominion University
>Norfolk, VA
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 17:11:24 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 11:11:24 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
Message-ID: <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>

Jeff,

Can you use max and min evaluations on any other data type then numeric? 
If so, how do you evaluate max or min of text content? String length? 
Ascii values of text characters?


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
> Well, no it is not. The email list stripped off the attachment.
>
> The data is numeric, happens to be all whole numbers.
>
>
> Kindest Regards,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
>> Hi Jeff,
>>
>>
>> Thanks for the data review offer. Attached is the CSV.
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
>>> I don't know anything about this package, but read.csv returns a 
>>> data frame. How you go about forming a matrix using that data frame 
>>> depends what is in it. If it is all numeric then as.matrix may be 
>>> all you need.
>>>
>>> Half of any R data analysis is data... and the details are almost 
>>> always crucial. Since you have told us nothing useful about the 
>>> data, it is up to you to inspect your data and figure out what to do 
>>> with it.
>>>
>>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via 
>>> R-help" <r-help at r-project.org> wrote:
>>>> Hi,
>>>>
>>>>
>>>> I am working to understand the Rfast functions of colMins and 
>>>> colMaxs. I
>>>> worked through the example listed on page 54 of the PDF.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>
>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>
>>>> However, I read the instructions listed on page 54 of the PDF saying I
>>>> need to bring data into R using a matrix. I think read.csv brings the
>>>> data in as a dataframe. I think colMins is failing because it is 
>>>> looking
>>>> for a matrix but finds a dataframe.
>>>>
>>>>> colMaxs(Data)
>>>> Error in colMaxs(Data) :
>>>> ?? Not compatible with requested type: [type=list; target=double].
>>>>> colMins(Data, na.rm = TRUE)
>>>> Error in colMins(Data, na.rm = TRUE) :
>>>> ?? unused argument (na.rm = TRUE)
>>>>> colMins(Data, value = FALSE, parallel = FALSE)
>>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>>>> ?? Not compatible with requested type: [type=list; target=double].
>>>>
>>>> QUESTION
>>>> What is the best practice to bring a csv file into R Studio so it 
>>>> can be
>>>> accessed by colMaxs and colMins, please?
>>>>
>>>>
>>>> Thanks,
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From petr@p|k@| @end|ng |rom prechez@@cz  Wed Dec  1 17:19:18 2021
From: petr@p|k@| @end|ng |rom prechez@@cz (PIKAL Petr)
Date: Wed, 1 Dec 2021 16:19:18 +0000
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
 <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
Message-ID: <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>

Hi.

It is always worth to consult excellent R help.

max and min return the maximum or minimum of all the values present in their arguments, as integer if all are logical or integer, as double if all are numeric, and character otherwise.

Character versions are sorted lexicographically, and this depends on the collating sequence of the locale in use: the help for ?Comparison? gives details. The max/min of an empty character vector is defined to be character NA. (One could argue that as "" is the smallest character element, the maximum should be "", but there is no obvious candidate for the minimum.)

Cheers
Petr

> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H.
> Dawson, DSL via R-help
> Sent: Wednesday, December 1, 2021 5:11 PM
> To: r-help at r-project.org
> Subject: Re: [R] Question about Rfast colMins and colMaxs
> 
> Jeff,
> 
> Can you use max and min evaluations on any other data type then numeric?
> If so, how do you evaluate max or min of text content? String length?
> Ascii values of text characters?
> 
> 
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
> 
> 
> On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
> > Well, no it is not. The email list stripped off the attachment.
> >
> > The data is numeric, happens to be all whole numbers.
> >
> >
> > Kindest Regards,
> > *Stephen Dawson, DSL*
> > /Executive Strategy Consultant/
> > Business & Technology
> > +1 (865) 804-3454
> > http://www.shdawson.com <http://www.shdawson.com>
> >
> >
> > On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
> >> Hi Jeff,
> >>
> >>
> >> Thanks for the data review offer. Attached is the CSV.
> >>
> >>
> >> *Stephen Dawson, DSL*
> >> /Executive Strategy Consultant/
> >> Business & Technology
> >> +1 (865) 804-3454
> >> http://www.shdawson.com <http://www.shdawson.com>
> >>
> >>
> >> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
> >>> I don't know anything about this package, but read.csv returns a
> >>> data frame. How you go about forming a matrix using that data frame
> >>> depends what is in it. If it is all numeric then as.matrix may be
> >>> all you need.
> >>>
> >>> Half of any R data analysis is data... and the details are almost
> >>> always crucial. Since you have told us nothing useful about the
> >>> data, it is up to you to inspect your data and figure out what to do
> >>> with it.
> >>>
> >>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via
> >>> R-help" <r-help at r-project.org> wrote:
> >>>> Hi,
> >>>>
> >>>>
> >>>> I am working to understand the Rfast functions of colMins and
> >>>> colMaxs. I worked through the example listed on page 54 of the PDF.
> >>>>
> >>>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>>
> >>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
> >>>>
> >>>> My data is in a CSV file. So, I bring it into R Studio using:
> >>>> Data <- read.csv("./input/DataSet05.csv", header=T)
> >>>>
> >>>> However, I read the instructions listed on page 54 of the PDF
> >>>> saying I need to bring data into R using a matrix. I think read.csv
> >>>> brings the data in as a dataframe. I think colMins is failing
> >>>> because it is looking for a matrix but finds a dataframe.
> >>>>
> >>>>> colMaxs(Data)
> >>>> Error in colMaxs(Data) :
> >>>>    Not compatible with requested type: [type=list; target=double].
> >>>>> colMins(Data, na.rm = TRUE)
> >>>> Error in colMins(Data, na.rm = TRUE) :
> >>>>    unused argument (na.rm = TRUE)
> >>>>> colMins(Data, value = FALSE, parallel = FALSE)
> >>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
> >>>>    Not compatible with requested type: [type=list; target=double].
> >>>>
> >>>> QUESTION
> >>>> What is the best practice to bring a csv file into R Studio so it
> >>>> can be accessed by colMaxs and colMins, please?
> >>>>
> >>>>
> >>>> Thanks,
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-
> guide.html
> and provide commented, minimal, self-contained, reproducible code.

From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Wed Dec  1 17:31:44 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 08:31:44 -0800
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <05fe01d7e665$7afa5330$70eef990$@verizon.net>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
Message-ID: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>

Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).

Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.

    dta <- read.csv( "yourdata.csv" )
    dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]

I don't know this package Rfast or its functions, but I would imagine that you could then use

    dta_maxs <- colMaxs( as.matrix( dta_num ) )

which might be a few microseconds faster than a typical base R solution:

    dta_maxs <- apply( dta_num, 2, max )

which works fine without loading a special package for this rather basic functionality.

Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.

Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).

On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>Stephen,
>
>Although what is in the STANDARD R distribution can vary several ways, in
>general, if you need to add a line like:
>
>library(something)
>or
>require(something)
>
>and your code does not work unless you have done that, then you can imagine
>it is not sort of built in to R as it starts.
>
>Having said that, tons of exceptions may exist that cause R to load in
>things on your machine for everyone or just for you without you having to
>notice.
>
>I think this forum lately has been deluged with questions about all kinds of
>add-on packages and in particular, lots of the ones in the tidyverse.
>Clearly the purpose here is not that broad.
>
>But since I use some packages like the tidyverse extensively, and I am far
>from alone, I wonder if someday the powers that be realize it is a losing
>battle to exclude at least some of it. It would be so nice not having to
>include a long list of packages for some programs or somehow arrange that
>people using something you shared had installed and loaded them. But there
>are too many packages out there of varying quality and usefulness and
>popularity with more every day being added. Worse, many are somewhat
>incompatible such as having functions with the same names that hide earlier
>ones loaded.
>
>Base R doe come with functions like colSums and colMeans and similar row
>functions. But as mentioned, a data.frame is a list of vectors and R
>supports certain functional programming constructs over lists using things
>like:
>
>lapply(df, min)
>sapply(df, min)
>
>And actually quite a few ways depending on what info you want back and
>whether you insist it be returned as a list or vector or other things . You
>can even supply additional arguments that might be needed such as if you
>want to ignore any NA values,
>
>lapply(df, min, na.rm=TRUE
>
>The package you looked at it is trying to be fast and uses what looks like
>compiled external code but so does lapply.
>
>If this is too bothersome for you, consider making a one-liner function like
>this:
>
>mycolMins <- function(df, ...) lapply(df, min, ...)
>
>Once defined, you can use that just fine and not think about it again and I
>note this answer (like others) is offering you something in base R that
>works fine on data.frames and the like.
>
>You can extend to many similar ideas like this one that calulates the min
>unless you over-ride it with max or mean or sd or a bizarre function like
>`[` so a call to:
>
>mycolCalc(df, `[`, 3)
>
>Will return exactly the third items in each row!
>
>I find it to be very common for someone these days to do a quick search for
>a way to do something in a language like R and not really look to see if it
>is a standard way or something special/ Matrices in R are not quite the same
>as some other objects like a data.frame or tibble and a package written to
>be used on one may (or may not) happen to work with another. Some packages
>are carefully written to try to detect what kind of object it gets and when
>possible convert it to another. The "apply" function is meant for matrices
>but if it sees something else it looks ta the dimensionality and tries to
>coerce it with as.matrix or as.array first. As others have noted, this mean
>a data.frame containing non-numeric parts may fail or should have any other
>columns hidden/removed as in this df that has some non-numeric fields:
>
>> df
>i       s   f     b i2
>1 1   hello 1.2  TRUE  5
>2 2   there 2.3 FALSE  4
>3 3 goodbye 3.4  TRUE  3
>
>So a bit more complex one-liner removes any non-numeric columns like this:
>
>> mycolMins(df[, sapply(df, is.numeric)])
>$i
>[1] 1
>
>$f
>[1] 1.2
>
>$i2
>[1] 3
>
>Clearly converting that to a matrix while whole would result in everything
>being converted to character and a minimum may be elusive.
>
>-----Original Message-----
>From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>DSL via R-help
>Sent: Tuesday, November 30, 2021 5:37 PM
>To: Bert Gunter <bgunter.4567 at gmail.com>
>Cc: r-help at r-project.org
>Subject: Re: [R] Question about Rfast colMins and colMaxs
>
>Oh, you are segmenting standard R from the rest of R.
>
>Well, that part did not come across to me in your original reply. I am not
>clear on a standard versus non-standard list. I will look into this aspect
>and see what I can learn going forward.
>
>
>Thanks,
>*Stephen Dawson, DSL*
>/Executive Strategy Consultant/
>Business & Technology
>+1 (865) 804-3454
>http://www.shdawson.com <http://www.shdawson.com>
>
>
>On 11/30/21 5:26 PM, Bert Gunter wrote:
>> ... but Rfast is *not* a "standard" package, as the rest of the PG 
>> excerpt says. So contact the maintainer and ask him/her what they 
>> think the best practice should be for their package. As has been 
>> pointed out already, it appears to differ from the usual "read it in 
>> as a data frame" procedure.
>>
>> Bert
>>
>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL 
>> <service at shdawson.com> wrote:
>>> Right, R Studio is not R.
>>>
>>> However, the Rfast package is part of R.
>>>
>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>
>>> So, rephrasing my question...
>>> What is the best practice to bring a csv file into R so it can be 
>>> accessed by colMaxs and colMins, please?
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>> RStudio is **not** R. In particular, the so-called TidyVerse 
>>>> consists of all *non*-standard contributed packages, about which the PG
>says:
>>>>
>>>> "For questions about functions in standard packages distributed with 
>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>> [The link is:
>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>> This gives the list of current _standard_ packages]
>>>>
>>>> If the question relates to a contributed package , e.g., one 
>>>> downloaded from CRAN, try contacting the package maintainer first. 
>>>> You can also use find("functionname") and
>>>> packageDescription("packagename") to find this information. Only 
>>>> send such questions to R-help or R-devel if you get no reply or need 
>>>> further assistance. This applies to both requests for help and to 
>>>> bug reports."
>>>>
>>>> Note that RStudio maintains its own help resources at:
>>>> https://community.rstudio.com/
>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>posted.
>>>>
>>>>
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming 
>>>> along and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help 
>>>> <r-help at r-project.org> wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> I am working to understand the Rfast functions of colMins and 
>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>
>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>
>>>>> However, I read the instructions listed on page 54 of the PDF 
>>>>> saying I need to bring data into R using a matrix. I think read.csv 
>>>>> brings the data in as a dataframe. I think colMins is failing 
>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>
>>>>>    > colMaxs(Data)
>>>>> Error in colMaxs(Data) :
>>>>>      Not compatible with requested type: [type=list; target=double].
>>>>>    > colMins(Data, na.rm = TRUE)
>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>      unused argument (na.rm = TRUE)
>>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in 
>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>      Not compatible with requested type: [type=list; target=double].
>>>>>
>>>>> QUESTION
>>>>> What is the best practice to bring a csv file into R Studio so it 
>>>>> can be accessed by colMaxs and colMins, please?
>>>>>
>>>>>
>>>>> Thanks,
>>>>> --
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide 
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 17:59:16 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 11:59:16 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
Message-ID: <b5c1473d-a04e-9951-f47f-df526721ef1f@shdawson.com>

Hi Jeff,


Thanks for the reply.

Your attitude in your writing is terse.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 11:31 AM, Jeff Newmiller wrote:
> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>
> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>
>      dta <- read.csv( "yourdata.csv" )
>      dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>
> I don't know this package Rfast or its functions, but I would imagine that you could then use
>
>      dta_maxs <- colMaxs( as.matrix( dta_num ) )
>
> which might be a few microseconds faster than a typical base R solution:
>
>      dta_maxs <- apply( dta_num, 2, max )
>
> which works fine without loading a special package for this rather basic functionality.
>
> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>
> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>
> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>> Stephen,
>>
>> Although what is in the STANDARD R distribution can vary several ways, in
>> general, if you need to add a line like:
>>
>> library(something)
>> or
>> require(something)
>>
>> and your code does not work unless you have done that, then you can imagine
>> it is not sort of built in to R as it starts.
>>
>> Having said that, tons of exceptions may exist that cause R to load in
>> things on your machine for everyone or just for you without you having to
>> notice.
>>
>> I think this forum lately has been deluged with questions about all kinds of
>> add-on packages and in particular, lots of the ones in the tidyverse.
>> Clearly the purpose here is not that broad.
>>
>> But since I use some packages like the tidyverse extensively, and I am far
> >from alone, I wonder if someday the powers that be realize it is a losing
>> battle to exclude at least some of it. It would be so nice not having to
>> include a long list of packages for some programs or somehow arrange that
>> people using something you shared had installed and loaded them. But there
>> are too many packages out there of varying quality and usefulness and
>> popularity with more every day being added. Worse, many are somewhat
>> incompatible such as having functions with the same names that hide earlier
>> ones loaded.
>>
>> Base R doe come with functions like colSums and colMeans and similar row
>> functions. But as mentioned, a data.frame is a list of vectors and R
>> supports certain functional programming constructs over lists using things
>> like:
>>
>> lapply(df, min)
>> sapply(df, min)
>>
>> And actually quite a few ways depending on what info you want back and
>> whether you insist it be returned as a list or vector or other things . You
>> can even supply additional arguments that might be needed such as if you
>> want to ignore any NA values,
>>
>> lapply(df, min, na.rm=TRUE
>>
>> The package you looked at it is trying to be fast and uses what looks like
>> compiled external code but so does lapply.
>>
>> If this is too bothersome for you, consider making a one-liner function like
>> this:
>>
>> mycolMins <- function(df, ...) lapply(df, min, ...)
>>
>> Once defined, you can use that just fine and not think about it again and I
>> note this answer (like others) is offering you something in base R that
>> works fine on data.frames and the like.
>>
>> You can extend to many similar ideas like this one that calulates the min
>> unless you over-ride it with max or mean or sd or a bizarre function like
>> `[` so a call to:
>>
>> mycolCalc(df, `[`, 3)
>>
>> Will return exactly the third items in each row!
>>
>> I find it to be very common for someone these days to do a quick search for
>> a way to do something in a language like R and not really look to see if it
>> is a standard way or something special/ Matrices in R are not quite the same
>> as some other objects like a data.frame or tibble and a package written to
>> be used on one may (or may not) happen to work with another. Some packages
>> are carefully written to try to detect what kind of object it gets and when
>> possible convert it to another. The "apply" function is meant for matrices
>> but if it sees something else it looks ta the dimensionality and tries to
>> coerce it with as.matrix or as.array first. As others have noted, this mean
>> a data.frame containing non-numeric parts may fail or should have any other
>> columns hidden/removed as in this df that has some non-numeric fields:
>>
>>> df
>> i       s   f     b i2
>> 1 1   hello 1.2  TRUE  5
>> 2 2   there 2.3 FALSE  4
>> 3 3 goodbye 3.4  TRUE  3
>>
>> So a bit more complex one-liner removes any non-numeric columns like this:
>>
>>> mycolMins(df[, sapply(df, is.numeric)])
>> $i
>> [1] 1
>>
>> $f
>> [1] 1.2
>>
>> $i2
>> [1] 3
>>
>> Clearly converting that to a matrix while whole would result in everything
>> being converted to character and a minimum may be elusive.
>>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>> DSL via R-help
>> Sent: Tuesday, November 30, 2021 5:37 PM
>> To: Bert Gunter <bgunter.4567 at gmail.com>
>> Cc: r-help at r-project.org
>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>
>> Oh, you are segmenting standard R from the rest of R.
>>
>> Well, that part did not come across to me in your original reply. I am not
>> clear on a standard versus non-standard list. I will look into this aspect
>> and see what I can learn going forward.
>>
>>
>> Thanks,
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 5:26 PM, Bert Gunter wrote:
>>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>>> excerpt says. So contact the maintainer and ask him/her what they
>>> think the best practice should be for their package. As has been
>>> pointed out already, it appears to differ from the usual "read it in
>>> as a data frame" procedure.
>>>
>>> Bert
>>>
>>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>>> <service at shdawson.com> wrote:
>>>> Right, R Studio is not R.
>>>>
>>>> However, the Rfast package is part of R.
>>>>
>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>
>>>> So, rephrasing my question...
>>>> What is the best practice to bring a csv file into R so it can be
>>>> accessed by colMaxs and colMins, please?
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>>> consists of all *non*-standard contributed packages, about which the PG
>> says:
>>>>> "For questions about functions in standard packages distributed with
>>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>>> [The link is:
>>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>>> This gives the list of current _standard_ packages]
>>>>>
>>>>> If the question relates to a contributed package , e.g., one
>>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>>> You can also use find("functionname") and
>>>>> packageDescription("packagename") to find this information. Only
>>>>> send such questions to R-help or R-devel if you get no reply or need
>>>>> further assistance. This applies to both requests for help and to
>>>>> bug reports."
>>>>>
>>>>> Note that RStudio maintains its own help resources at:
>>>>> https://community.rstudio.com/
>>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>> posted.
>>>>>
>>>>>
>>>>> Bert Gunter
>>>>>
>>>>> "The trouble with having an open mind is that people keep coming
>>>>> along and sticking things into it."
>>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>>
>>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>>> <r-help at r-project.org> wrote:
>>>>>> Hi,
>>>>>>
>>>>>>
>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>
>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>
>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>
>>>>>>     > colMaxs(Data)
>>>>>> Error in colMaxs(Data) :
>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>     > colMins(Data, na.rm = TRUE)
>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>       unused argument (na.rm = TRUE)
>>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>
>>>>>> QUESTION
>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>
>>>>>>
>>>>>> Thanks,
>>>>>> --
>>>>>> *Stephen Dawson, DSL*
>>>>>> /Executive Strategy Consultant/
>>>>>> Business & Technology
>>>>>> +1 (865) 804-3454
>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>> PLEASE do read the posting guide
>>>>>> http://www.R-project.org/posting-guide.html
>>>>>> and provide commented, minimal, self-contained, reproducible code.
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 18:05:13 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 12:05:13 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <BF32C534-58AA-42FF-9720-A07FBCF57F5C@dcn.davis.ca.us>
 <d9858425-2515-9cba-8250-a06c7e76239d@shdawson.com>
 <0051e760-7444-0d68-6492-1a3949fde288@shdawson.com>
 <4e480fce-de00-f72d-15b5-99776ede8927@shdawson.com>
 <b911b470798242b4b50db758837979e1@SRVEXCHCM1301.precheza.cz>
Message-ID: <48b9e858-ff8e-86cb-aa64-775f0d7958e4@shdawson.com>

Thank you, Petr, for the kind explanation.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 11:19 AM, PIKAL Petr wrote:
> Hi.
>
> It is always worth to consult excellent R help.
>
> max and min return the maximum or minimum of all the values present in their arguments, as integer if all are logical or integer, as double if all are numeric, and character otherwise.
>
> Character versions are sorted lexicographically, and this depends on the collating sequence of the locale in use: the help for ?Comparison? gives details. The max/min of an empty character vector is defined to be character NA. (One could argue that as "" is the smallest character element, the maximum should be "", but there is no obvious candidate for the minimum.)
>
> Cheers
> Petr
>
>> -----Original Message-----
>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H.
>> Dawson, DSL via R-help
>> Sent: Wednesday, December 1, 2021 5:11 PM
>> To: r-help at r-project.org
>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>
>> Jeff,
>>
>> Can you use max and min evaluations on any other data type then numeric?
>> If so, how do you evaluate max or min of text content? String length?
>> Ascii values of text characters?
>>
>>
>> *Stephen Dawson, DSL*
>> /Executive Strategy Consultant/
>> Business & Technology
>> +1 (865) 804-3454
>> http://www.shdawson.com <http://www.shdawson.com>
>>
>>
>> On 11/30/21 5:23 PM, Stephen H. Dawson, DSL via R-help wrote:
>>> Well, no it is not. The email list stripped off the attachment.
>>>
>>> The data is numeric, happens to be all whole numbers.
>>>
>>>
>>> Kindest Regards,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 5:14 PM, Stephen H. Dawson, DSL via R-help wrote:
>>>> Hi Jeff,
>>>>
>>>>
>>>> Thanks for the data review offer. Attached is the CSV.
>>>>
>>>>
>>>> *Stephen Dawson, DSL*
>>>> /Executive Strategy Consultant/
>>>> Business & Technology
>>>> +1 (865) 804-3454
>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>
>>>>
>>>> On 11/30/21 3:29 PM, Jeff Newmiller wrote:
>>>>> I don't know anything about this package, but read.csv returns a
>>>>> data frame. How you go about forming a matrix using that data frame
>>>>> depends what is in it. If it is all numeric then as.matrix may be
>>>>> all you need.
>>>>>
>>>>> Half of any R data analysis is data... and the details are almost
>>>>> always crucial. Since you have told us nothing useful about the
>>>>> data, it is up to you to inspect your data and figure out what to do
>>>>> with it.
>>>>>
>>>>> On November 30, 2021 10:55:13 AM PST, "Stephen H. Dawson, DSL via
>>>>> R-help" <r-help at r-project.org> wrote:
>>>>>> Hi,
>>>>>>
>>>>>>
>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>
>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>
>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>
>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>
>>>>>>> colMaxs(Data)
>>>>>> Error in colMaxs(Data) :
>>>>>>     Not compatible with requested type: [type=list; target=double].
>>>>>>> colMins(Data, na.rm = TRUE)
>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>     unused argument (na.rm = TRUE)
>>>>>>> colMins(Data, value = FALSE, parallel = FALSE)
>>>>>> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>     Not compatible with requested type: [type=list; target=double].
>>>>>>
>>>>>> QUESTION
>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>
>>>>>>
>>>>>> Thanks,
>>>> ______________________________________________
>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>> PLEASE do read the posting guide
>>>> http://www.R-project.org/posting-guide.html
>>>> and provide commented, minimal, self-contained, reproducible code.
>>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-
>> guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @erv|ce @end|ng |rom @hd@w@on@com  Wed Dec  1 18:06:23 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Wed, 1 Dec 2021 12:06:23 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <05fe01d7e665$7afa5330$70eef990$@verizon.net>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
Message-ID: <88a92cac-5dd6-9e75-7aba-5da491ebe59e@shdawson.com>

Thanks, Avi.

Yes, loading packages by library command is necessary to access a 
function not resident in the standard R code.

The data set I am reviewing has column names changing. The thought is to 
do a review of max and min for whatever the column names happen to be 
for the data input I am reviewing.


*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 11/30/21 10:42 PM, Avi Gross via R-help wrote:
> Stephen,
>
> Although what is in the STANDARD R distribution can vary several ways, in
> general, if you need to add a line like:
>
> library(something)
> or
> require(something)
>
> and your code does not work unless you have done that, then you can imagine
> it is not sort of built in to R as it starts.
>
> Having said that, tons of exceptions may exist that cause R to load in
> things on your machine for everyone or just for you without you having to
> notice.
>
> I think this forum lately has been deluged with questions about all kinds of
> add-on packages and in particular, lots of the ones in the tidyverse.
> Clearly the purpose here is not that broad.
>
> But since I use some packages like the tidyverse extensively, and I am far
> from alone, I wonder if someday the powers that be realize it is a losing
> battle to exclude at least some of it. It would be so nice not having to
> include a long list of packages for some programs or somehow arrange that
> people using something you shared had installed and loaded them. But there
> are too many packages out there of varying quality and usefulness and
> popularity with more every day being added. Worse, many are somewhat
> incompatible such as having functions with the same names that hide earlier
> ones loaded.
>
> Base R doe come with functions like colSums and colMeans and similar row
> functions. But as mentioned, a data.frame is a list of vectors and R
> supports certain functional programming constructs over lists using things
> like:
>
> lapply(df, min)
> sapply(df, min)
>
> And actually quite a few ways depending on what info you want back and
> whether you insist it be returned as a list or vector or other things . You
> can even supply additional arguments that might be needed such as if you
> want to ignore any NA values,
>
> lapply(df, min, na.rm=TRUE
>
> The package you looked at it is trying to be fast and uses what looks like
> compiled external code but so does lapply.
>
> If this is too bothersome for you, consider making a one-liner function like
> this:
>
> mycolMins <- function(df, ...) lapply(df, min, ...)
>
> Once defined, you can use that just fine and not think about it again and I
> note this answer (like others) is offering you something in base R that
> works fine on data.frames and the like.
>
> You can extend to many similar ideas like this one that calulates the min
> unless you over-ride it with max or mean or sd or a bizarre function like
> `[` so a call to:
>
> mycolCalc(df, `[`, 3)
>
> Will return exactly the third items in each row!
>
> I find it to be very common for someone these days to do a quick search for
> a way to do something in a language like R and not really look to see if it
> is a standard way or something special/ Matrices in R are not quite the same
> as some other objects like a data.frame or tibble and a package written to
> be used on one may (or may not) happen to work with another. Some packages
> are carefully written to try to detect what kind of object it gets and when
> possible convert it to another. The "apply" function is meant for matrices
> but if it sees something else it looks ta the dimensionality and tries to
> coerce it with as.matrix or as.array first. As others have noted, this mean
> a data.frame containing non-numeric parts may fail or should have any other
> columns hidden/removed as in this df that has some non-numeric fields:
>
>> df
> i       s   f     b i2
> 1 1   hello 1.2  TRUE  5
> 2 2   there 2.3 FALSE  4
> 3 3 goodbye 3.4  TRUE  3
>
> So a bit more complex one-liner removes any non-numeric columns like this:
>
>> mycolMins(df[, sapply(df, is.numeric)])
> $i
> [1] 1
>
> $f
> [1] 1.2
>
> $i2
> [1] 3
>
> Clearly converting that to a matrix while whole would result in everything
> being converted to character and a minimum may be elusive.
>
> -----Original Message-----
> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> DSL via R-help
> Sent: Tuesday, November 30, 2021 5:37 PM
> To: Bert Gunter <bgunter.4567 at gmail.com>
> Cc: r-help at r-project.org
> Subject: Re: [R] Question about Rfast colMins and colMaxs
>
> Oh, you are segmenting standard R from the rest of R.
>
> Well, that part did not come across to me in your original reply. I am not
> clear on a standard versus non-standard list. I will look into this aspect
> and see what I can learn going forward.
>
>
> Thanks,
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
>
> On 11/30/21 5:26 PM, Bert Gunter wrote:
>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>> excerpt says. So contact the maintainer and ask him/her what they
>> think the best practice should be for their package. As has been
>> pointed out already, it appears to differ from the usual "read it in
>> as a data frame" procedure.
>>
>> Bert
>>
>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>> <service at shdawson.com> wrote:
>>> Right, R Studio is not R.
>>>
>>> However, the Rfast package is part of R.
>>>
>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>
>>> So, rephrasing my question...
>>> What is the best practice to bring a csv file into R so it can be
>>> accessed by colMaxs and colMins, please?
>>>
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>> consists of all *non*-standard contributed packages, about which the PG
> says:
>>>> "For questions about functions in standard packages distributed with
>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>> [The link is:
>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>> This gives the list of current _standard_ packages]
>>>>
>>>> If the question relates to a contributed package , e.g., one
>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>> You can also use find("functionname") and
>>>> packageDescription("packagename") to find this information. Only
>>>> send such questions to R-help or R-devel if you get no reply or need
>>>> further assistance. This applies to both requests for help and to
>>>> bug reports."
>>>>
>>>> Note that RStudio maintains its own help resources at:
>>>> https://community.rstudio.com/
>>>> This is where questions about the TidyVerse, ggplot, etc. should be
> posted.
>>>>
>>>>
>>>> Bert Gunter
>>>>
>>>> "The trouble with having an open mind is that people keep coming
>>>> along and sticking things into it."
>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>
>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>> <r-help at r-project.org> wrote:
>>>>> Hi,
>>>>>
>>>>>
>>>>> I am working to understand the Rfast functions of colMins and
>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>
>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>
>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>
>>>>>     > colMaxs(Data)
>>>>> Error in colMaxs(Data) :
>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>     > colMins(Data, na.rm = TRUE)
>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>       unused argument (na.rm = TRUE)
>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>
>>>>> QUESTION
>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>> can be accessed by colMaxs and colMins, please?
>>>>>
>>>>>
>>>>> Thanks,
>>>>> --
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>> ______________________________________________
>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>> PLEASE do read the posting guide
>>>>> http://www.R-project.org/posting-guide.html
>>>>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  1 18:23:06 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 1 Dec 2021 09:23:06 -0800
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
Message-ID: <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>

"As to obtaining min or max of columns, such a question is nonsensical
when the column contains character data,"

That is false.

First, if it's plain (unclassed) character data, character data is
sorted lexicographically, which depends on the locale, as Petr already
pointed out.

Perhaps more useful, however, is that of the character data has been
classed as an *ordered* factor, then max, min, and range are all
meaningfully interpreted for it according to the ordering:

> z <- ordered(sample(letters[1:3], 10,rep = TRUE), levels = c('c','a','b'))
> z
 [1] a a c b b c a a b c
Levels: c < a < b
> max(z)
[1] b
Levels: c < a < b
> min(z)
[1] c
Levels: c < a < b
> range(z)
[1] c b
Levels: c < a < b
> sort(z)
 [1] c c c a a a a b b b
Levels: c < a < b
### etc.

See ?ordered for details, and particularly note:
"There are "factor" and "ordered" methods for the group generic Ops
which provide methods for the Comparison operators, and for the min,
max, and range generics in Summary of "ordered". (The rest of the
groups and the Math group generate an error as they are not meaningful
for factors.)"

(You would have to go down a rabbit hole to learn about group generics
for S3 classes, but I think you can ignore those details for the
purposes here).

Bert Gunter

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Dec 1, 2021 at 8:41 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>
> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>
> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>
>     dta <- read.csv( "yourdata.csv" )
>     dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>
> I don't know this package Rfast or its functions, but I would imagine that you could then use
>
>     dta_maxs <- colMaxs( as.matrix( dta_num ) )
>
> which might be a few microseconds faster than a typical base R solution:
>
>     dta_maxs <- apply( dta_num, 2, max )
>
> which works fine without loading a special package for this rather basic functionality.
>
> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>
> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>
> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
> >Stephen,
> >
> >Although what is in the STANDARD R distribution can vary several ways, in
> >general, if you need to add a line like:
> >
> >library(something)
> >or
> >require(something)
> >
> >and your code does not work unless you have done that, then you can imagine
> >it is not sort of built in to R as it starts.
> >
> >Having said that, tons of exceptions may exist that cause R to load in
> >things on your machine for everyone or just for you without you having to
> >notice.
> >
> >I think this forum lately has been deluged with questions about all kinds of
> >add-on packages and in particular, lots of the ones in the tidyverse.
> >Clearly the purpose here is not that broad.
> >
> >But since I use some packages like the tidyverse extensively, and I am far
> >from alone, I wonder if someday the powers that be realize it is a losing
> >battle to exclude at least some of it. It would be so nice not having to
> >include a long list of packages for some programs or somehow arrange that
> >people using something you shared had installed and loaded them. But there
> >are too many packages out there of varying quality and usefulness and
> >popularity with more every day being added. Worse, many are somewhat
> >incompatible such as having functions with the same names that hide earlier
> >ones loaded.
> >
> >Base R doe come with functions like colSums and colMeans and similar row
> >functions. But as mentioned, a data.frame is a list of vectors and R
> >supports certain functional programming constructs over lists using things
> >like:
> >
> >lapply(df, min)
> >sapply(df, min)
> >
> >And actually quite a few ways depending on what info you want back and
> >whether you insist it be returned as a list or vector or other things . You
> >can even supply additional arguments that might be needed such as if you
> >want to ignore any NA values,
> >
> >lapply(df, min, na.rm=TRUE
> >
> >The package you looked at it is trying to be fast and uses what looks like
> >compiled external code but so does lapply.
> >
> >If this is too bothersome for you, consider making a one-liner function like
> >this:
> >
> >mycolMins <- function(df, ...) lapply(df, min, ...)
> >
> >Once defined, you can use that just fine and not think about it again and I
> >note this answer (like others) is offering you something in base R that
> >works fine on data.frames and the like.
> >
> >You can extend to many similar ideas like this one that calulates the min
> >unless you over-ride it with max or mean or sd or a bizarre function like
> >`[` so a call to:
> >
> >mycolCalc(df, `[`, 3)
> >
> >Will return exactly the third items in each row!
> >
> >I find it to be very common for someone these days to do a quick search for
> >a way to do something in a language like R and not really look to see if it
> >is a standard way or something special/ Matrices in R are not quite the same
> >as some other objects like a data.frame or tibble and a package written to
> >be used on one may (or may not) happen to work with another. Some packages
> >are carefully written to try to detect what kind of object it gets and when
> >possible convert it to another. The "apply" function is meant for matrices
> >but if it sees something else it looks ta the dimensionality and tries to
> >coerce it with as.matrix or as.array first. As others have noted, this mean
> >a data.frame containing non-numeric parts may fail or should have any other
> >columns hidden/removed as in this df that has some non-numeric fields:
> >
> >> df
> >i       s   f     b i2
> >1 1   hello 1.2  TRUE  5
> >2 2   there 2.3 FALSE  4
> >3 3 goodbye 3.4  TRUE  3
> >
> >So a bit more complex one-liner removes any non-numeric columns like this:
> >
> >> mycolMins(df[, sapply(df, is.numeric)])
> >$i
> >[1] 1
> >
> >$f
> >[1] 1.2
> >
> >$i2
> >[1] 3
> >
> >Clearly converting that to a matrix while whole would result in everything
> >being converted to character and a minimum may be elusive.
> >
> >-----Original Message-----
> >From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
> >DSL via R-help
> >Sent: Tuesday, November 30, 2021 5:37 PM
> >To: Bert Gunter <bgunter.4567 at gmail.com>
> >Cc: r-help at r-project.org
> >Subject: Re: [R] Question about Rfast colMins and colMaxs
> >
> >Oh, you are segmenting standard R from the rest of R.
> >
> >Well, that part did not come across to me in your original reply. I am not
> >clear on a standard versus non-standard list. I will look into this aspect
> >and see what I can learn going forward.
> >
> >
> >Thanks,
> >*Stephen Dawson, DSL*
> >/Executive Strategy Consultant/
> >Business & Technology
> >+1 (865) 804-3454
> >http://www.shdawson.com <http://www.shdawson.com>
> >
> >
> >On 11/30/21 5:26 PM, Bert Gunter wrote:
> >> ... but Rfast is *not* a "standard" package, as the rest of the PG
> >> excerpt says. So contact the maintainer and ask him/her what they
> >> think the best practice should be for their package. As has been
> >> pointed out already, it appears to differ from the usual "read it in
> >> as a data frame" procedure.
> >>
> >> Bert
> >>
> >> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
> >> <service at shdawson.com> wrote:
> >>> Right, R Studio is not R.
> >>>
> >>> However, the Rfast package is part of R.
> >>>
> >>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>
> >>> So, rephrasing my question...
> >>> What is the best practice to bring a csv file into R so it can be
> >>> accessed by colMaxs and colMins, please?
> >>>
> >>> *Stephen Dawson, DSL*
> >>> /Executive Strategy Consultant/
> >>> Business & Technology
> >>> +1 (865) 804-3454
> >>> http://www.shdawson.com <http://www.shdawson.com>
> >>>
> >>>
> >>> On 11/30/21 3:19 PM, Bert Gunter wrote:
> >>>> RStudio is **not** R. In particular, the so-called TidyVerse
> >>>> consists of all *non*-standard contributed packages, about which the PG
> >says:
> >>>>
> >>>> "For questions about functions in standard packages distributed with
> >>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
> >>>> [The link is:
> >>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
> >>>> This gives the list of current _standard_ packages]
> >>>>
> >>>> If the question relates to a contributed package , e.g., one
> >>>> downloaded from CRAN, try contacting the package maintainer first.
> >>>> You can also use find("functionname") and
> >>>> packageDescription("packagename") to find this information. Only
> >>>> send such questions to R-help or R-devel if you get no reply or need
> >>>> further assistance. This applies to both requests for help and to
> >>>> bug reports."
> >>>>
> >>>> Note that RStudio maintains its own help resources at:
> >>>> https://community.rstudio.com/
> >>>> This is where questions about the TidyVerse, ggplot, etc. should be
> >posted.
> >>>>
> >>>>
> >>>>
> >>>> Bert Gunter
> >>>>
> >>>> "The trouble with having an open mind is that people keep coming
> >>>> along and sticking things into it."
> >>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
> >>>>
> >>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
> >>>> <r-help at r-project.org> wrote:
> >>>>> Hi,
> >>>>>
> >>>>>
> >>>>> I am working to understand the Rfast functions of colMins and
> >>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
> >>>>>
> >>>>> https://cran.r-project.org/web/packages/Rfast/index.html
> >>>>>
> >>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
> >>>>>
> >>>>> My data is in a CSV file. So, I bring it into R Studio using:
> >>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
> >>>>>
> >>>>> However, I read the instructions listed on page 54 of the PDF
> >>>>> saying I need to bring data into R using a matrix. I think read.csv
> >>>>> brings the data in as a dataframe. I think colMins is failing
> >>>>> because it is looking for a matrix but finds a dataframe.
> >>>>>
> >>>>>    > colMaxs(Data)
> >>>>> Error in colMaxs(Data) :
> >>>>>      Not compatible with requested type: [type=list; target=double].
> >>>>>    > colMins(Data, na.rm = TRUE)
> >>>>> Error in colMins(Data, na.rm = TRUE) :
> >>>>>      unused argument (na.rm = TRUE)
> >>>>>    > colMins(Data, value = FALSE, parallel = FALSE) Error in
> >>>>> colMins(Data, value = FALSE, parallel = FALSE) :
> >>>>>      Not compatible with requested type: [type=list; target=double].
> >>>>>
> >>>>> QUESTION
> >>>>> What is the best practice to bring a csv file into R Studio so it
> >>>>> can be accessed by colMaxs and colMins, please?
> >>>>>
> >>>>>
> >>>>> Thanks,
> >>>>> --
> >>>>> *Stephen Dawson, DSL*
> >>>>> /Executive Strategy Consultant/
> >>>>> Business & Technology
> >>>>> +1 (865) 804-3454
> >>>>> http://www.shdawson.com <http://www.shdawson.com>
> >>>>>
> >>>>> ______________________________________________
> >>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-help
> >>>>> PLEASE do read the posting guide
> >>>>> http://www.R-project.org/posting-guide.html
> >>>>> and provide commented, minimal, self-contained, reproducible code.
> >>>
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
> >
> >______________________________________________
> >R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >https://stat.ethz.ch/mailman/listinfo/r-help
> >PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >and provide commented, minimal, self-contained, reproducible code.
>
> --
> Sent from my phone. Please excuse my brevity.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From drj|m|emon @end|ng |rom gm@||@com  Wed Dec  1 22:36:42 2021
From: drj|m|emon @end|ng |rom gm@||@com (Jim Lemon)
Date: Thu, 2 Dec 2021 08:36:42 +1100
Subject: [R] help
In-Reply-To: <CAB5P51vj8bRx2MkmnUTg_GASugy_zLu=c_9XDRFgdVhJBVxtdQ@mail.gmail.com>
References: <CAB5P51vj8bRx2MkmnUTg_GASugy_zLu=c_9XDRFgdVhJBVxtdQ@mail.gmail.com>
Message-ID: <CA+8X3fU3RZuppVj3fbUnFg4Rf1hxDdwMke8BMpuTYcBu0zxK2A@mail.gmail.com>

Hi mehdi,
Try this (first example in the help page):

ref<-rnorm(30,sd=2)
 # add a little noise
 model1<-ref+rnorm(30)/2
 # add more noise
 model2<-ref+rnorm(30)
 # display the diagram with the better model
 oldpar<-taylor.diagram(ref,model1)
 # now add the worse model
 taylor.diagram(ref,model2,add=TRUE,col="blue")
 # get approximate legend position
 lpos<-1.5*sd(ref)
 # add a legend
 legend(lpos,lpos,legend=c("Better","Worse"),pch=19,col=c("red","blue"))
 # now restore par values
 par(oldpar)

What you have done is to leave out the "reference" model (ref), so
that the second argument is missing.

Jim

On Wed, Dec 1, 2021 at 7:29 PM mehdi ghasemi <ghasemimehdi61 at gmail.com> wrote:
>
> Hi Dr
>
> If we want to draw two plots only in a Taylor diagram ,What  the  attached  code should be modified ?
> thanks


From dpweyg@nd @end|ng |rom gm@||@com  Wed Dec  1 22:38:37 2021
From: dpweyg@nd @end|ng |rom gm@||@com (Dennis Weygand)
Date: Wed, 1 Dec 2021 16:38:37 -0500
Subject: [R] readxl/lifecycle/rlang
Message-ID: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>

I have been using read_excel for years... suddenly today I have this
problem:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

So I install lifecycle:

install.packages("lifecycle")
WARNING: Rtools is required to build R packages but is not currently
installed. Please download and install the appropriate version of Rtools
before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Installing package into ?C:/Users/dennisweygand/Documents/R/win-library/3.5?
(as ?lib? is unspecified)
also installing the dependency ?rlang?


  There are binary versions available but the source versions are later:
          binary source needs_compilation
rlang      0.4.5 0.4.12              TRUE
lifecycle  0.2.0  1.0.1             FALSE

  Binaries will be installed
trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/rlang_0.4.5.zip
'
Content type 'application/zip' length 1115838 bytes (1.1 MB)
downloaded 1.1 MB

package ?rlang? successfully unpacked and MD5 sums checked
Warning in install.packages :
  cannot remove prior installation of package ?rlang?

The downloaded binary packages are in
C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages
installing the source package ?lifecycle?

trying URL 'https://cran.rstudio.com/src/contrib/lifecycle_1.0.1.tar.gz'
Content type 'application/x-gzip' length 99716 bytes (97 KB)
downloaded 97 KB

ERROR: dependency 'rlang' is not available for package 'lifecycle'
* removing 'C:/Users/dennisweygand/Documents/R/win-library/3.5/lifecycle'
In R CMD INSTALL
Warning in install.packages :
  installation of package ?lifecycle? had non-zero exit status

The downloaded source packages are in
?C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages?


Did it work?
Try it again:

> T1 <- read_excel(fname,sheet="T1")
Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
:
  there is no package called ?lifecycle?

I am clueless: what am I doing wrong?
Can anyone help?
D.P. Weygand

	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 00:15:12 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Wed, 01 Dec 2021 15:15:12 -0800
Subject: [R] readxl/lifecycle/rlang
In-Reply-To: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
References: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
Message-ID: <9E673E53-77EA-4A77-AB36-352A950B44B4@dcn.davis.ca.us>

This

>package ?rlang? successfully unpacked and MD5 sums checked
>Warning in install.packages :
>  cannot remove prior installation of package ?rlang?

indicates that rlang didn't get re-installed. It is a warning because R seems to think it could still be working, but it isn't verifying that status.

Below that,

>ERROR: dependency 'rlang' is not available for package 'lifecycle'

indicates that there is still a problem with rlang.

The "cannot remove prior installation" often means that the installed package is open, or you have some other program (File Manager?) holding one of the directories open. Be sure to shut down all but one instance of R before modifying your package library.

It is also possible that anti-virus software is being overly protective.

And DONT keep bashing on the package that depends on rlang... install the one that was at the root of the problem: rlang. Only after that succeeds should you go back and try lifecycle. Once that one works, try installing/updating readxl again.


On December 1, 2021 1:38:37 PM PST, Dennis Weygand <dpweygand at gmail.com> wrote:
>I have been using read_excel for years... suddenly today I have this
>problem:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>So I install lifecycle:
>
>install.packages("lifecycle")
>WARNING: Rtools is required to build R packages but is not currently
>installed. Please download and install the appropriate version of Rtools
>before proceeding:
>
>https://cran.rstudio.com/bin/windows/Rtools/
>Installing package into ?C:/Users/dennisweygand/Documents/R/win-library/3.5?
>(as ?lib? is unspecified)
>also installing the dependency ?rlang?
>
>
>  There are binary versions available but the source versions are later:
>          binary source needs_compilation
>rlang      0.4.5 0.4.12              TRUE
>lifecycle  0.2.0  1.0.1             FALSE
>
>  Binaries will be installed
>trying URL 'https://cran.rstudio.com/bin/windows/contrib/3.5/rlang_0.4.5.zip
>'
>Content type 'application/zip' length 1115838 bytes (1.1 MB)
>downloaded 1.1 MB
>
>package ?rlang? successfully unpacked and MD5 sums checked
>Warning in install.packages :
>  cannot remove prior installation of package ?rlang?
>
>The downloaded binary packages are in
>C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages
>installing the source package ?lifecycle?
>
>trying URL 'https://cran.rstudio.com/src/contrib/lifecycle_1.0.1.tar.gz'
>Content type 'application/x-gzip' length 99716 bytes (97 KB)
>downloaded 97 KB
>
>ERROR: dependency 'rlang' is not available for package 'lifecycle'
>* removing 'C:/Users/dennisweygand/Documents/R/win-library/3.5/lifecycle'
>In R CMD INSTALL
>Warning in install.packages :
>  installation of package ?lifecycle? had non-zero exit status
>
>The downloaded source packages are in
>?C:\Users\dennisweygand\AppData\Local\Temp\RtmpKSler3\downloaded_packages?
>
>
>Did it work?
>Try it again:
>
>> T1 <- read_excel(fname,sheet="T1")
>Error in loadNamespace(i, c(lib.loc, .libPaths()), versionCheck = vI[[i]])
>:
>  there is no package called ?lifecycle?
>
>I am clueless: what am I doing wrong?
>Can anyone help?
>D.P. Weygand
>
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 09:05:39 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 11:05:39 +0300
Subject: [R] readxl/lifecycle/rlang
In-Reply-To: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
References: <CAJgAAVS-ZB=pDLA8gUagQr4_5q=k3sd49xuT3Q5xP7sVpRCoUQ@mail.gmail.com>
Message-ID: <20211202110539.692ed63d@Tarkus>

On Wed, 1 Dec 2021 16:38:37 -0500
Dennis Weygand <dpweygand at gmail.com> wrote:

> Installing package into
> ?C:/Users/dennisweygand/Documents/R/win-library/3.5? (as ?lib? is
> unspecified)

It could be time to install a newer version of R. CRAN doesn't provide
binary builds of packages for R 3.5...

>           binary source needs_compilation
> rlang      0.4.5 0.4.12              TRUE
> lifecycle  0.2.0  1.0.1             FALSE

...so the latest version of rlang you can currently install is 0.4.5,
but lifecycle wants rlang (? 0.4.10). You can either follow the link
https://cran.rstudio.com/bin/windows/Rtools/ and install Rtools to
compile rlang 0.4.12 from source, or install a later version of R (?
4.0) that CRAN provides Windows binaries for.

You could also try the XLConnect package (it works fine for me on
older installations of R), but it depends on Java. 

> 	[[alternative HTML version deleted]]

P.S. Please compose your messages in plain text to make sure that we
see them exactly as you write them.

-- 
Best regards,
Ivan


From @erv|ce @end|ng |rom @hd@w@on@com  Thu Dec  2 11:36:38 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Thu, 2 Dec 2021 05:36:38 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CAGxFJbSWcEQ6+wAHMWMbAZN8+H=-MZeAck3oswYK=bTQg9YW1w@mail.gmail.com>
 <a051a615-a38a-e590-ca5d-d23f0c1e0e6c@shdawson.com>
 <CAGxFJbRDXgVq5V7FRv1i+cF_3vJpt9bhfcRiezfjTqc7-YyuAg@mail.gmail.com>
 <5c27e9c9-3f7e-2d28-bbb8-566586a59c79@shdawson.com>
 <05fe01d7e665$7afa5330$70eef990$@verizon.net>
 <368D38C8-1302-49E6-AC20-6F54A5E29225@dcn.davis.ca.us>
 <CAGxFJbSx1bDcX89XJHVozLr7Lnpd=XpSYi1+zXcDEF+jq2qxvg@mail.gmail.com>
Message-ID: <86283450-8ded-7a8e-d45c-dfe826bdc8ff@shdawson.com>

Thank you, Bert. I appreciate you taking the time to write this information.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/1/21 12:23 PM, Bert Gunter wrote:
> "As to obtaining min or max of columns, such a question is nonsensical
> when the column contains character data,"
>
> That is false.
>
> First, if it's plain (unclassed) character data, character data is
> sorted lexicographically, which depends on the locale, as Petr already
> pointed out.
>
> Perhaps more useful, however, is that of the character data has been
> classed as an *ordered* factor, then max, min, and range are all
> meaningfully interpreted for it according to the ordering:
>
>> z <- ordered(sample(letters[1:3], 10,rep = TRUE), levels = c('c','a','b'))
>> z
>   [1] a a c b b c a a b c
> Levels: c < a < b
>> max(z)
> [1] b
> Levels: c < a < b
>> min(z)
> [1] c
> Levels: c < a < b
>> range(z)
> [1] c b
> Levels: c < a < b
>> sort(z)
>   [1] c c c a a a a b b b
> Levels: c < a < b
> ### etc.
>
> See ?ordered for details, and particularly note:
> "There are "factor" and "ordered" methods for the group generic Ops
> which provide methods for the Comparison operators, and for the min,
> max, and range generics in Summary of "ordered". (The rest of the
> groups and the Math group generate an error as they are not meaningful
> for factors.)"
>
> (You would have to go down a rabbit hole to learn about group generics
> for S3 classes, but I think you can ignore those details for the
> purposes here).
>
> Bert Gunter
>
> Bert Gunter
>
> "The trouble with having an open mind is that people keep coming along
> and sticking things into it."
> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>
>
> On Wed, Dec 1, 2021 at 8:41 AM Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:
>> Avi: As I understand it, the definition regarding what is on-topic is not targeted at tidyverse... it addresses the futility of trying to support the thousands of problem domains represented by contributed packages in one mailing list without drowning the subscribers in discussions about problem domains they are not interested in. This mailing list happens to be about the R language, and extends as far as the packages included with the R language. Tidyverse just happens to be outside this scope (though some here are more opposed to using it than others and express that sentiment in their responses).
>>
>> Stephen: As to obtaining min or max of columns, such a question is nonsensical when the column contains character data, and mostly nonsensical when the data are binary regardless of what package you are using. From this perspective, it only makes sense to look at extremes on numeric columns selected from the data after they are loaded into a data frame.
>>
>>      dta <- read.csv( "yourdata.csv" )
>>      dta_num <- dta[ , c("Elapsed_Time", "Age" ) ]
>>
>> I don't know this package Rfast or its functions, but I would imagine that you could then use
>>
>>      dta_maxs <- colMaxs( as.matrix( dta_num ) )
>>
>> which might be a few microseconds faster than a typical base R solution:
>>
>>      dta_maxs <- apply( dta_num, 2, max )
>>
>> which works fine without loading a special package for this rather basic functionality.
>>
>> Sometimes packages get developed to meet unusual needs (thousands of columns) or while chasing an optimization that turns out to be marginal (the real time sink may be in converting a data frame into a matrix so the compiled C code can then process it a smidge quicker), and none of this should be interfering in your learning of R but you end up following biased blogs or package vignettes that may or may not deliver on their promise to simplify your tasks.
>>
>> Some aspects of tidyverse are quite effective and I use them regularly... but there are a lot of these less valuable contributions also that are distractions or are best for corner cases. You can only figure out the difference by learning the basics first and comparing approaches (sometimes a package that requires you to manually convert to matrix is a good idea, but sometimes it is just a pain) for usefulness and/or speed (e.g. using the microbenchmark contributed package).
>>
>> On November 30, 2021 7:42:35 PM PST, Avi Gross via R-help <r-help at r-project.org> wrote:
>>> Stephen,
>>>
>>> Although what is in the STANDARD R distribution can vary several ways, in
>>> general, if you need to add a line like:
>>>
>>> library(something)
>>> or
>>> require(something)
>>>
>>> and your code does not work unless you have done that, then you can imagine
>>> it is not sort of built in to R as it starts.
>>>
>>> Having said that, tons of exceptions may exist that cause R to load in
>>> things on your machine for everyone or just for you without you having to
>>> notice.
>>>
>>> I think this forum lately has been deluged with questions about all kinds of
>>> add-on packages and in particular, lots of the ones in the tidyverse.
>>> Clearly the purpose here is not that broad.
>>>
>>> But since I use some packages like the tidyverse extensively, and I am far
>> >from alone, I wonder if someday the powers that be realize it is a losing
>>> battle to exclude at least some of it. It would be so nice not having to
>>> include a long list of packages for some programs or somehow arrange that
>>> people using something you shared had installed and loaded them. But there
>>> are too many packages out there of varying quality and usefulness and
>>> popularity with more every day being added. Worse, many are somewhat
>>> incompatible such as having functions with the same names that hide earlier
>>> ones loaded.
>>>
>>> Base R doe come with functions like colSums and colMeans and similar row
>>> functions. But as mentioned, a data.frame is a list of vectors and R
>>> supports certain functional programming constructs over lists using things
>>> like:
>>>
>>> lapply(df, min)
>>> sapply(df, min)
>>>
>>> And actually quite a few ways depending on what info you want back and
>>> whether you insist it be returned as a list or vector or other things . You
>>> can even supply additional arguments that might be needed such as if you
>>> want to ignore any NA values,
>>>
>>> lapply(df, min, na.rm=TRUE
>>>
>>> The package you looked at it is trying to be fast and uses what looks like
>>> compiled external code but so does lapply.
>>>
>>> If this is too bothersome for you, consider making a one-liner function like
>>> this:
>>>
>>> mycolMins <- function(df, ...) lapply(df, min, ...)
>>>
>>> Once defined, you can use that just fine and not think about it again and I
>>> note this answer (like others) is offering you something in base R that
>>> works fine on data.frames and the like.
>>>
>>> You can extend to many similar ideas like this one that calulates the min
>>> unless you over-ride it with max or mean or sd or a bizarre function like
>>> `[` so a call to:
>>>
>>> mycolCalc(df, `[`, 3)
>>>
>>> Will return exactly the third items in each row!
>>>
>>> I find it to be very common for someone these days to do a quick search for
>>> a way to do something in a language like R and not really look to see if it
>>> is a standard way or something special/ Matrices in R are not quite the same
>>> as some other objects like a data.frame or tibble and a package written to
>>> be used on one may (or may not) happen to work with another. Some packages
>>> are carefully written to try to detect what kind of object it gets and when
>>> possible convert it to another. The "apply" function is meant for matrices
>>> but if it sees something else it looks ta the dimensionality and tries to
>>> coerce it with as.matrix or as.array first. As others have noted, this mean
>>> a data.frame containing non-numeric parts may fail or should have any other
>>> columns hidden/removed as in this df that has some non-numeric fields:
>>>
>>>> df
>>> i       s   f     b i2
>>> 1 1   hello 1.2  TRUE  5
>>> 2 2   there 2.3 FALSE  4
>>> 3 3 goodbye 3.4  TRUE  3
>>>
>>> So a bit more complex one-liner removes any non-numeric columns like this:
>>>
>>>> mycolMins(df[, sapply(df, is.numeric)])
>>> $i
>>> [1] 1
>>>
>>> $f
>>> [1] 1.2
>>>
>>> $i2
>>> [1] 3
>>>
>>> Clearly converting that to a matrix while whole would result in everything
>>> being converted to character and a minimum may be elusive.
>>>
>>> -----Original Message-----
>>> From: R-help <r-help-bounces at r-project.org> On Behalf Of Stephen H. Dawson,
>>> DSL via R-help
>>> Sent: Tuesday, November 30, 2021 5:37 PM
>>> To: Bert Gunter <bgunter.4567 at gmail.com>
>>> Cc: r-help at r-project.org
>>> Subject: Re: [R] Question about Rfast colMins and colMaxs
>>>
>>> Oh, you are segmenting standard R from the rest of R.
>>>
>>> Well, that part did not come across to me in your original reply. I am not
>>> clear on a standard versus non-standard list. I will look into this aspect
>>> and see what I can learn going forward.
>>>
>>>
>>> Thanks,
>>> *Stephen Dawson, DSL*
>>> /Executive Strategy Consultant/
>>> Business & Technology
>>> +1 (865) 804-3454
>>> http://www.shdawson.com <http://www.shdawson.com>
>>>
>>>
>>> On 11/30/21 5:26 PM, Bert Gunter wrote:
>>>> ... but Rfast is *not* a "standard" package, as the rest of the PG
>>>> excerpt says. So contact the maintainer and ask him/her what they
>>>> think the best practice should be for their package. As has been
>>>> pointed out already, it appears to differ from the usual "read it in
>>>> as a data frame" procedure.
>>>>
>>>> Bert
>>>>
>>>> On Tue, Nov 30, 2021 at 2:11 PM Stephen H. Dawson, DSL
>>>> <service at shdawson.com> wrote:
>>>>> Right, R Studio is not R.
>>>>>
>>>>> However, the Rfast package is part of R.
>>>>>
>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>
>>>>> So, rephrasing my question...
>>>>> What is the best practice to bring a csv file into R so it can be
>>>>> accessed by colMaxs and colMins, please?
>>>>>
>>>>> *Stephen Dawson, DSL*
>>>>> /Executive Strategy Consultant/
>>>>> Business & Technology
>>>>> +1 (865) 804-3454
>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>
>>>>>
>>>>> On 11/30/21 3:19 PM, Bert Gunter wrote:
>>>>>> RStudio is **not** R. In particular, the so-called TidyVerse
>>>>>> consists of all *non*-standard contributed packages, about which the PG
>>> says:
>>>>>> "For questions about functions in standard packages distributed with
>>>>>> R (see the FAQ Add-on packages in R), ask questions on R-help.
>>>>>> [The link is:
>>>>>> https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
>>>>>> This gives the list of current _standard_ packages]
>>>>>>
>>>>>> If the question relates to a contributed package , e.g., one
>>>>>> downloaded from CRAN, try contacting the package maintainer first.
>>>>>> You can also use find("functionname") and
>>>>>> packageDescription("packagename") to find this information. Only
>>>>>> send such questions to R-help or R-devel if you get no reply or need
>>>>>> further assistance. This applies to both requests for help and to
>>>>>> bug reports."
>>>>>>
>>>>>> Note that RStudio maintains its own help resources at:
>>>>>> https://community.rstudio.com/
>>>>>> This is where questions about the TidyVerse, ggplot, etc. should be
>>> posted.
>>>>>>
>>>>>>
>>>>>> Bert Gunter
>>>>>>
>>>>>> "The trouble with having an open mind is that people keep coming
>>>>>> along and sticking things into it."
>>>>>> -- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )
>>>>>>
>>>>>> On Tue, Nov 30, 2021 at 10:55 AM Stephen H. Dawson, DSL via R-help
>>>>>> <r-help at r-project.org> wrote:
>>>>>>> Hi,
>>>>>>>
>>>>>>>
>>>>>>> I am working to understand the Rfast functions of colMins and
>>>>>>> colMaxs. I worked through the example listed on page 54 of the PDF.
>>>>>>>
>>>>>>> https://cran.r-project.org/web/packages/Rfast/index.html
>>>>>>>
>>>>>>> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>>>>>>>
>>>>>>> My data is in a CSV file. So, I bring it into R Studio using:
>>>>>>> Data <- read.csv("./input/DataSet05.csv", header=T)
>>>>>>>
>>>>>>> However, I read the instructions listed on page 54 of the PDF
>>>>>>> saying I need to bring data into R using a matrix. I think read.csv
>>>>>>> brings the data in as a dataframe. I think colMins is failing
>>>>>>> because it is looking for a matrix but finds a dataframe.
>>>>>>>
>>>>>>>     > colMaxs(Data)
>>>>>>> Error in colMaxs(Data) :
>>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>>     > colMins(Data, na.rm = TRUE)
>>>>>>> Error in colMins(Data, na.rm = TRUE) :
>>>>>>>       unused argument (na.rm = TRUE)
>>>>>>>     > colMins(Data, value = FALSE, parallel = FALSE) Error in
>>>>>>> colMins(Data, value = FALSE, parallel = FALSE) :
>>>>>>>       Not compatible with requested type: [type=list; target=double].
>>>>>>>
>>>>>>> QUESTION
>>>>>>> What is the best practice to bring a csv file into R Studio so it
>>>>>>> can be accessed by colMaxs and colMins, please?
>>>>>>>
>>>>>>>
>>>>>>> Thanks,
>>>>>>> --
>>>>>>> *Stephen Dawson, DSL*
>>>>>>> /Executive Strategy Consultant/
>>>>>>> Business & Technology
>>>>>>> +1 (865) 804-3454
>>>>>>> http://www.shdawson.com <http://www.shdawson.com>
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>>>>>> PLEASE do read the posting guide
>>>>>>> http://www.R-project.org/posting-guide.html
>>>>>>> and provide commented, minimal, self-contained, reproducible code.
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>> --
>> Sent from my phone. Please excuse my brevity.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From tr@xp|@yer @end|ng |rom gm@||@com  Thu Dec  2 12:23:27 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Thu, 2 Dec 2021 12:23:27 +0100
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
Message-ID: <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>

By reading some code today I have just discovered an alternative way to
define a function:
f <- \(x, y) x * y

Is that exactly the same as:
f <- function(x,y) x * y
?

Is there any benefit to the first or second way to define a function?

Regards
Martin

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 12:40:31 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 14:40:31 +0300
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
 <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
Message-ID: <20211202144031.4587b9ae@arachnoid>

On Thu, 2 Dec 2021 12:23:27 +0100
Martin M?ller Skarbiniks Pedersen <traxplayer at gmail.com> wrote:

> Is that exactly the same as:
> f <- function(x,y) x * y
> ?
> 
> Is there any benefit to the first or second way to define a function?

The \(arguments) syntax has been introduced in R 4.1.0:
https://cran.r-project.org/doc/manuals/r-release/NEWS.html (search for
"\(x)"). It is the same as function(arguments).

The only benefit is slightly less typing; could be useful if you use
the native R pipe (also introduced in R 4.1.0, search for "|>") and
want to call an anonymous function in the right-hand side of the pipe.

-- 
Best regards,
Ivan


From tr@xp|@yer @end|ng |rom gm@||@com  Thu Dec  2 13:18:00 2021
From: tr@xp|@yer @end|ng |rom gm@||@com (=?UTF-8?Q?Martin_M=C3=B8ller_Skarbiniks_Pedersen?=)
Date: Thu, 2 Dec 2021 13:18:00 +0100
Subject: [R] Fwd: alternative way to define a function
In-Reply-To: <20211202144031.4587b9ae@arachnoid>
References: <CAGAA5be=J=vjbwwqkndALdstoLF2AE_mHtvyEoreymMhcWVSSg@mail.gmail.com>
 <CAGAA5bfbwH5wBbWF1Ds6+ZTV_eS_NLXDx7tS7sVA3dACGwHxKA@mail.gmail.com>
 <20211202144031.4587b9ae@arachnoid>
Message-ID: <CAGAA5bfrPha_=gHZfNpJeXn1KWKdJ2n0S6y9NZWODcw9_57Gpg@mail.gmail.com>

On Thu, 2 Dec 2021 at 12:40, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
>
> The \(arguments) syntax has been introduced in R 4.1.0:
> https://cran.r-project.org/doc/manuals/r-release/NEWS.html (search for
> "\(x)"). It is the same as function(arguments).
>
> The only benefit is slightly less typing; could be useful if you use
> the native R pipe (also introduced in R 4.1.0, search for "|>") and
> want to call an anonymous function in the right-hand side of the pipe.

Thanks. It is a nice new feature.
I will start using it in my apply fun's eg: apply(mtcars, 2, \(x)
length(unique(x)))

Regards
Martin

	[[alternative HTML version deleted]]


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 11:50:13 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 10:50:13 +0000
Subject: [R] Problem with lm Giving Wrong Results
Message-ID: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>

In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


	[[alternative HTML version deleted]]


From M|ke@Fr@nc|@ @end|ng |rom cy|oethn@tur|o|cymru@gov@uk  Thu Dec  2 14:42:04 2021
From: M|ke@Fr@nc|@ @end|ng |rom cy|oethn@tur|o|cymru@gov@uk (Francis, Mike)
Date: Thu, 2 Dec 2021 13:42:04 +0000
Subject: [R] R 64 bit v 4.1.2
Message-ID: <AM6PR06MB466329EB7664394DF85E7BF0D0699@AM6PR06MB4663.eurprd06.prod.outlook.com>

Good afternoon,

Im hoping someone would be kind enough to help me with this issue.

currently using Windows 10 (OS BUILD 19042.1348). when I try to open R as standalone or from R studio the R application crashes. did some investigations and it appears the RGUI.EXE and MSVCRT.dll are causing the problem.
has anyone seen this issue before and how was it resolved.

see the info from the RGUI dump file.

This dump file has an exception of interest stored in it.
The stored exception information can be accessed via .ecxr.
(adc.1bc4): Security check failure or stack buffer overrun - code c0000409 (first/second chance not available)
Subcode: 0xd FAST_FAIL_INVALID_SET_OF_CONTEXT 
For analysis of this file, run !analyze -v
msvcrt!_except_validate_jump_buffer+0x3c:
00007ffd`30310a70 cd29            int     29h
0:000> !analyze -v
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************

*** WARNING: Unable to verify timestamp for R.dll

KEY_VALUES_STRING: 1

    Key  : Analysis.CPU.mSec
    Value: 2358

    Key  : Analysis.DebugAnalysisManager
    Value: Create

    Key  : Analysis.Elapsed.mSec
    Value: 3790

    Key  : Analysis.Init.CPU.mSec
    Value: 1234

    Key  : Analysis.Init.Elapsed.mSec
    Value: 26592

    Key  : Analysis.Memory.CommitPeak.Mb
    Value: 90

    Key  : FailFast.Name
    Value: INVALID_SET_OF_CONTEXT

    Key  : FailFast.Type
    Value: 13

    Key  : Timeline.Process.Start.DeltaSec
    Value: 1

    Key  : WER.OS.Branch
    Value: vb_release

    Key  : WER.OS.Timestamp
    Value: 2019-12-06T14:06:00Z

    Key  : WER.OS.Version
    Value: 10.0.19041.1

    Key  : WER.Process.Version
    Value: 4.12.15579.0


NTGLOBALFLAG:  0

PROCESS_BAM_CURRENT_THROTTLED: 0

PROCESS_BAM_PREVIOUS_THROTTLED: 0

APPLICATION_VERIFIER_FLAGS:  0

CONTEXT:  (.ecxr)
rax=000000874937a000 rbx=000000000000000c rcx=000000000000000d
rdx=000000874d3f4690 rsi=000000006e655e60 rdi=000000874d3f4690
rip=00007ffd30310a70 rsp=000000874d3f3108 rbp=000000000000000c
 r8=000000874d3f4540  r9=0000000000000000 r10=000000000000001d
r11=0000000000000000 r12=0000019eb7d98db0 r13=0000000000000001
r14=0000019eb7dbf6e0 r15=0000000000000000
iopl=0         nv up ei pl zr na po nc
cs=0033  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
msvcrt!_except_validate_jump_buffer+0x3c:
00007ffd`30310a70 cd29            int     29h
Resetting default scope

EXCEPTION_RECORD:  (.exr -1)
ExceptionAddress: 00007ffd30310a70 (msvcrt!_except_validate_jump_buffer+0x000000000000003c)
   ExceptionCode: c0000409 (Security check failure or stack buffer overrun)
  ExceptionFlags: 00000001
NumberParameters: 1
   Parameter[0]: 000000000000000d
Subcode: 0xd FAST_FAIL_INVALID_SET_OF_CONTEXT 

PROCESS_NAME:  Rgui.exe

ERROR_CODE: (NTSTATUS) 0xc0000409 - The system detected an overrun of a stack-based buffer in this application. This overrun could potentially allow a malicious user to gain control of this application.

EXCEPTION_CODE_STR:  c0000409

EXCEPTION_PARAMETER1:  000000000000000d

STACK_TEXT:  
00000087`4d3f3108 00007ffd`3030f854     : 00000000`0000000c 0000019e`b7d98db0 00000000`00000001 0000019e`b7dbf6e0 : msvcrt!_except_validate_jump_buffer+0x3c
00000087`4d3f3110 00000000`6c794fdf     : 00000087`4d3f4680 00000000`6c83c758 0000019e`b7f4ba38 00000000`6e655bb0 : msvcrt!longjmp+0x14
00000087`4d3f3140 00000087`4d3f4680     : 00000000`6c83c758 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7f4bae0 : R+0x94fdf
00000087`4d3f3148 00000000`6c83c758     : 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7f4bae0 00000000`6e655d98 : 0x00000087`4d3f4680
00000087`4d3f3150 0000019e`b7f4ba38     : 00000000`6e655bb0 0000019e`b7f4bae0 00000000`6e655d98 0000019e`b7f4bbc0 : R+0x13c758
00000087`4d3f3158 00000000`6e655bb0     : 0000019e`b7f4bae0 00000000`6e655d98 0000019e`b7f4bbc0 00000000`6cacdc24 : 0x0000019e`b7f4ba38
00000087`4d3f3160 0000019e`b7f4bae0     : 00000000`6e655d98 0000019e`b7f4bbc0 00000000`6cacdc24 0000019e`b7f46840 : R+0x1f55bb0
00000087`4d3f3168 00000000`6e655d98     : 0000019e`b7f4bbc0 00000000`6cacdc24 0000019e`b7f46840 0000019e`b7f4ba38 : 0x0000019e`b7f4bae0
00000087`4d3f3170 0000019e`b7f4bbc0     : 00000000`6cacdc24 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 : R+0x1f55d98
00000087`4d3f3178 00000000`6cacdc24     : 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 00000000`6c79540f : 0x0000019e`b7f4bbc0
00000087`4d3f3180 0000019e`b7f46840     : 0000019e`b7f4ba38 00000000`6e655bb0 00000000`6c79540f 0000019e`b7f46840 : R+0x3cdc24
00000087`4d3f3188 0000019e`b7f4ba38     : 00000000`6e655bb0 00000000`6c79540f 0000019e`b7f46840 0000019e`b7f4ba38 : 0x0000019e`b7f46840
00000087`4d3f3190 00000000`6e655bb0     : 00000000`6c79540f 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 : 0x0000019e`b7f4ba38
00000087`4d3f3198 00000000`6c79540f     : 0000019e`b7f46840 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7dbf6e0 : R+0x1f55bb0
00000087`4d3f31a0 0000019e`b7f46840     : 0000019e`b7f4ba38 00000000`6e655bb0 0000019e`b7dbf6e0 00000000`00000000 : R+0x9540f
00000087`4d3f31a8 0000019e`b7f4ba38     : 00000000`6e655bb0 0000019e`b7dbf6e0 00000000`00000000 00000000`6c83d149 : 0x0000019e`b7f46840
00000087`4d3f31b0 00000000`6e655bb0     : 0000019e`b7dbf6e0 00000000`00000000 00000000`6c83d149 0000019e`b7e182a8 : 0x0000019e`b7f4ba38
00000087`4d3f31b8 0000019e`b7dbf6e0     : 00000000`00000000 00000000`6c83d149 0000019e`b7e182a8 0000019e`b7f4bcc0 : R+0x1f55bb0
00000087`4d3f31c0 00000000`00000000     : 00000000`6c83d149 0000019e`b7e182a8 0000019e`b7f4bcc0 0000019e`b7f4ed08 : 0x0000019e`b7dbf6e0


SYMBOL_NAME:  msvcrt!_except_validate_jump_buffer+3c

MODULE_NAME: msvcrt

IMAGE_NAME:  msvcrt.dll

STACK_COMMAND:  ~0s ; .ecxr ; kb

FAILURE_BUCKET_ID:  FAIL_FAST_INVALID_SET_OF_CONTEXT_c0000409_msvcrt.dll!_except_validate_jump_buffer

OS_VERSION:  10.0.19041.1

BUILDLAB_STR:  vb_release

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

IMAGE_VERSION:  7.0.19041.546

FAILURE_ID_HASH:  {3e222f7c-7009-e3ad-3df7-4c44c21d59ab}

Followup:     MachineOwner
---------


Regards
Mike Francis
Peirianydd SCCM / SCCM Engineer
Cyfoeth Naturiol Cymru / Natural Resources Wales
Ffon / Mobile: 07876847084
E-Bost / Email: mike.francis at cyfoethnaturiolcymru.gov.uk
www.cyfoethnaturiol.cymru?/?www.naturalresources.wales?
?
Yn falch o arwain y ffordd at ddyfodol gwell i Gymru trwy reoli'r amgylchedd ac adnoddau naturiol yn gynaliadwy.
Proud to be leading the way to a better future for Wales by managing the environment and natural resources sustainably.
?
????
?
?


From er|cjberger @end|ng |rom gm@||@com  Thu Dec  2 15:28:11 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Thu, 2 Dec 2021 16:28:11 +0200
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAGgJW75+PsEgreXaa1gAF9+5VL3FsBJ56hTAd5safkZ_gJWqUA@mail.gmail.com>

Hi Thomas,
I could not reproduce your problem. Both examples worked fine for me.

Here is my setup:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] R.matlab_3.6.2

loaded via a namespace (and not attached):
[1] compiler_4.1.2    tools_4.1.2       R.methodsS3_1.8.1
R.utils_2.11.0    R.oo_1.24.0


On Thu, Dec 2, 2021 at 4:18 PM Labone, Thomas <labone at email.sc.edu> wrote:
>
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From pro|jcn@@h @end|ng |rom gm@||@com  Thu Dec  2 15:31:17 2021
From: pro|jcn@@h @end|ng |rom gm@||@com (J C Nash)
Date: Thu, 2 Dec 2021 09:31:17 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>

I get two similar graphs.

https://web.ncf.ca/nashjc/jfiles/Rplot-Labone-4095.pdf
https://web.ncf.ca/nashjc/jfiles/RplotLabone10K.pdf

Context:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8    LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
  [1] compiler_4.1.2  fastmap_1.1.0   htmltools_0.5.2 tools_4.1.2     yaml_2.2.1      rmarkdown_2.11  knitr_1.36
  [8] xfun_0.28       digest_0.6.28   rlang_0.4.12    evaluate_0.14
 >

Hope this helps,

JN


On 2021-12-02 5:50 a.m., Labone, Thomas wrote:
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 15:34:42 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 14:34:42 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
Message-ID: <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>

Thanks.

Can someone point me to the procedure for switching from the Intel Math Library back to the standard math library so that I can see if the problem is associated with using MKL?


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: J C Nash <profjcnash at gmail.com>
Sent: Thursday, December 2, 2021 9:31 AM
To: Labone, Thomas <labone at email.sc.edu>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

I get two similar graphs.

https://protect2.fireeye.com/v1/url?k=99a20372-c6393a53-99a24db3-862c53b6784d-c549bca0bcc4210d&q=1&e=8ce563a7-fac1-41d3-8699-13c4a9417e00&u=https%3A%2F%2Fweb.ncf.ca%2Fnashjc%2Fjfiles%2FRplot-Labone-4095.pdf
https://protect2.fireeye.com/v1/url?k=6d56bd36-32cd8417-6d56f3f7-862c53b6784d-85baef704a412b23&q=1&e=8ce563a7-fac1-41d3-8699-13c4a9417e00&u=https%3A%2F%2Fweb.ncf.ca%2Fnashjc%2Fjfiles%2FRplotLabone10K.pdf

Context:

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C               LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8    LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
  [1] compiler_4.1.2  fastmap_1.1.0   htmltools_0.5.2 tools_4.1.2     yaml_2.2.1      rmarkdown_2.11  knitr_1.36
  [8] xfun_0.28       digest_0.6.28   rlang_0.4.12    evaluate_0.14
 >

Hope this helps,

JN


On 2021-12-02 5:50 a.m., Labone, Thomas wrote:
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 16:17:51 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 18:17:51 +0300
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <be98af34-518a-7bb8-91fe-2a8fcf22a49d@gmail.com>
 <BN8PR19MB281713828C1958EFDD972659F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <20211202181751.58eda4b7@Tarkus>

On Thu, 2 Dec 2021 14:34:42 +0000
"Labone, Thomas" <labone at email.sc.edu> wrote:

> Can someone point me to the procedure for switching from the Intel
> Math Library back to the standard math library so that I can see if
> the problem is associated with using MKL?

Depends on how you have installed it. You mentioned using Linux Mint
(see also: the R-SIG-Debian mailing list), so try using
`update-alternatives` to set the value for all alternatives with "blas"
or "lapack" in their names. See `ls /etc/alternatives/ | grep -i -e blas
-e lapack` for the list.

-- 
Best regards,
Ivan


From w||||@mwdun|@p @end|ng |rom gm@||@com  Thu Dec  2 16:31:30 2021
From: w||||@mwdun|@p @end|ng |rom gm@||@com (Bill Dunlap)
Date: Thu, 2 Dec 2021 07:31:30 -0800
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu> wrote:

> In the code below the first and second plots should look pretty much the
> same, the only difference being that the first has n=1000 points and the
> second n=10000 points. On two of my Linux machines (info below) the second
> plot is a horizontal line (incorrect answer from lm), but on my Windows 10
> machine and a third Linux machine it works as expected. The interesting
> thing is that the code works as expected for n <= 4095 but fails for
> n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any
> ideas on how to fix it?
>
> set.seed(132)
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>             LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6
> grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK:
> /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
> LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Dec  2 17:48:36 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 2 Dec 2021 11:48:36 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <3ba31d6f-2eb0-b2e0-8cdb-b6266f8564a6@gmail.com>

On 02/12/2021 5:50 a.m., Labone, Thomas wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

The likely location of this problem is the BLAS.  You are using

BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

on the bad machines, and

BLAS/LAPACK: 
/opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
 >

on the good one, according to the sessionInfo you posted. I don't have 
any experience dealing with such things, but that's where I'd look for a 
fix.

Duncan Murdoch



> set.seed(132)
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
> 
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
> 
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
> 
> fit <- lm(log(k) ~ Z)
> summary(fit)
> 
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
> 
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
> 
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
> 
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
> 
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>   [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
> 
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
> 
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
> 
> locale:
>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>   [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
> 
> 
> 
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From |@bone @end|ng |rom em@||@@c@edu  Thu Dec  2 17:53:22 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Thu, 2 Dec 2021 16:53:22 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
Message-ID: <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>

> summary(fit)

Call:
lm(formula = log(k) ~ Z)

Residuals:
    Min      1Q  Median      3Q     Max
-21.241   1.327   1.776   2.245   4.418

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.03465    0.01916  -1.809   0.0705 .
Z           -0.24207    0.01916 -12.634   <2e-16 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Residual standard error: 1.914 on 9998 degrees of freedom
Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16

> summary(k)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> summary(Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
-3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> summary(gm*gsd^Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
>


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: Thursday, December 2, 2021 10:31 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 20:31:47 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 11:31:47 -0800
Subject: [R] A technical question on methods for "+"
Message-ID: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>

... and probably a dumb one and almost certainly not of interest to
most R users. But anyway...

?"+" says:
"The unary and binary arithmetic operators are generic functions:
methods can be written for them individually or via the Ops group
generic function. "

So:
"+.character" <- function(e1, e2) paste0(e1, e2)
## but this doesn't 'work':
> "a" + "b"
Error in "a" + "b" : non-numeric argument to binary operator

## but explicitly invoking the method does 'work' :
> "+.character"('a','b')
[1] "ab"

##Note also:
> methods("+")
[1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*

So what am I failing to understand?
Thanks.

Bert Gunter


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 21:01:12 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 02 Dec 2021 12:01:12 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
Message-ID: <ECBA8C41-8947-468C-B799-D6B3FDB06FDC@dcn.davis.ca.us>

I think the fact that character is a built-in type rather than an S3 class has something to do with it.

On December 2, 2021 11:31:47 AM PST, Bert Gunter <bgunter.4567 at gmail.com> wrote:
>... and probably a dumb one and almost certainly not of interest to
>most R users. But anyway...
>
>?"+" says:
>"The unary and binary arithmetic operators are generic functions:
>methods can be written for them individually or via the Ops group
>generic function. "
>
>So:
>"+.character" <- function(e1, e2) paste0(e1, e2)
>## but this doesn't 'work':
>> "a" + "b"
>Error in "a" + "b" : non-numeric argument to binary operator
>
>## but explicitly invoking the method does 'work' :
>> "+.character"('a','b')
>[1] "ab"
>
>##Note also:
>> methods("+")
>[1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>
>So what am I failing to understand?
>Thanks.
>
>Bert Gunter
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From @kw@|mmo @end|ng |rom gm@||@com  Thu Dec  2 21:10:32 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Thu, 2 Dec 2021 15:10:32 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
Message-ID: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>

This is because + dispatches on the class attribute, which a string like
"test" has set to NULL, so it doesn't dispatch. You can add the class
yourself like structure("test", class = "character") and that should work.

I'm not sure where it's explained, but most primitive functions dispatch on
the class attribute, which is different from UseMethod which calls class()
if the class attribute is NULL.

I think if you want to define something like what you have written, you
could write a function `%+%` use that instead

On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> ... and probably a dumb one and almost certainly not of interest to
> most R users. But anyway...
>
> ?"+" says:
> "The unary and binary arithmetic operators are generic functions:
> methods can be written for them individually or via the Ops group
> generic function. "
>
> So:
> "+.character" <- function(e1, e2) paste0(e1, e2)
> ## but this doesn't 'work':
> > "a" + "b"
> Error in "a" + "b" : non-numeric argument to binary operator
>
> ## but explicitly invoking the method does 'work' :
> > "+.character"('a','b')
> [1] "ab"
>
> ##Note also:
> > methods("+")
> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>
> So what am I failing to understand?
> Thanks.
>
> Bert Gunter
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 21:22:59 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 12:22:59 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
Message-ID: <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>

"This is because + dispatches on the class attribute, which a string
like "test" has set to NULL"
Not true.

> class('test')
[1] "character"

But apparently, as Denes and Jeff said, the class must be explicitly
set, rather than relying on its built-in/implicit type.

With the above hint, I looked up what ?class had to say. It is:

"Note that for objects x of an implicit (or an S4) class, when a (S3)
generic function foo(x) is called, method dispatch may use more
classes than are returned by class(x), e.g., for a numeric matrix, the
foo.numeric() method may apply. The exact full character vector of the
classes which UseMethod() uses, is available as .class2(x) since R
version 4.0.0. (This also applies to S4 objects when S3 dispatch is
considered, see below.)"

I think this is the "official" explanation, but I find it rather opaque.

Thanks to all for your Help in finding the explanation. Much appreciated.

Bert

On Thu, Dec 2, 2021 at 12:10 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
>
> This is because + dispatches on the class attribute, which a string like "test" has set to NULL, so it doesn't dispatch. You can add the class yourself like structure("test", class = "character") and that should work.
>
> I'm not sure where it's explained, but most primitive functions dispatch on the class attribute, which is different from UseMethod which calls class() if the class attribute is NULL.
>
> I think if you want to define something like what you have written, you could write a function `%+%` use that instead
>
> On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
>>
>> ... and probably a dumb one and almost certainly not of interest to
>> most R users. But anyway...
>>
>> ?"+" says:
>> "The unary and binary arithmetic operators are generic functions:
>> methods can be written for them individually or via the Ops group
>> generic function. "
>>
>> So:
>> "+.character" <- function(e1, e2) paste0(e1, e2)
>> ## but this doesn't 'work':
>> > "a" + "b"
>> Error in "a" + "b" : non-numeric argument to binary operator
>>
>> ## but explicitly invoking the method does 'work' :
>> > "+.character"('a','b')
>> [1] "ab"
>>
>> ##Note also:
>> > methods("+")
>> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>>
>> So what am I failing to understand?
>> Thanks.
>>
>> Bert Gunter
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @kw@|mmo @end|ng |rom gm@||@com  Thu Dec  2 21:30:20 2021
From: @kw@|mmo @end|ng |rom gm@||@com (Andrew Simmons)
Date: Thu, 2 Dec 2021 15:30:20 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <CAGxFJbQ9-n41DE+subRTJ1umRvPciaVavmpxeyyhQUiTpnH++Q@mail.gmail.com>
Message-ID: <CAPcHnpSUk1J-95MD=ckfsejNCMiRipg9TtKuOnZbx0xKpL2YVg@mail.gmail.com>

class() does not always return the class attribute, try something more like
attr(, "class"), you'll see what I mean

On Thu, Dec 2, 2021, 15:23 Bert Gunter <bgunter.4567 at gmail.com> wrote:

> "This is because + dispatches on the class attribute, which a string
> like "test" has set to NULL"
> Not true.
>
> > class('test')
> [1] "character"
>
> But apparently, as Denes and Jeff said, the class must be explicitly
> set, rather than relying on its built-in/implicit type.
>
> With the above hint, I looked up what ?class had to say. It is:
>
> "Note that for objects x of an implicit (or an S4) class, when a (S3)
> generic function foo(x) is called, method dispatch may use more
> classes than are returned by class(x), e.g., for a numeric matrix, the
> foo.numeric() method may apply. The exact full character vector of the
> classes which UseMethod() uses, is available as .class2(x) since R
> version 4.0.0. (This also applies to S4 objects when S3 dispatch is
> considered, see below.)"
>
> I think this is the "official" explanation, but I find it rather opaque.
>
> Thanks to all for your Help in finding the explanation. Much appreciated.
>
> Bert
>
> On Thu, Dec 2, 2021 at 12:10 PM Andrew Simmons <akwsimmo at gmail.com> wrote:
> >
> > This is because + dispatches on the class attribute, which a string like
> "test" has set to NULL, so it doesn't dispatch. You can add the class
> yourself like structure("test", class = "character") and that should work.
> >
> > I'm not sure where it's explained, but most primitive functions dispatch
> on the class attribute, which is different from UseMethod which calls
> class() if the class attribute is NULL.
> >
> > I think if you want to define something like what you have written, you
> could write a function `%+%` use that instead
> >
> > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >>
> >> ... and probably a dumb one and almost certainly not of interest to
> >> most R users. But anyway...
> >>
> >> ?"+" says:
> >> "The unary and binary arithmetic operators are generic functions:
> >> methods can be written for them individually or via the Ops group
> >> generic function. "
> >>
> >> So:
> >> "+.character" <- function(e1, e2) paste0(e1, e2)
> >> ## but this doesn't 'work':
> >> > "a" + "b"
> >> Error in "a" + "b" : non-numeric argument to binary operator
> >>
> >> ## but explicitly invoking the method does 'work' :
> >> > "+.character"('a','b')
> >> [1] "ab"
> >>
> >> ##Note also:
> >> > methods("+")
> >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> >>
> >> So what am I failing to understand?
> >> Thanks.
> >>
> >> Bert Gunter
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From murdoch@dunc@n @end|ng |rom gm@||@com  Thu Dec  2 21:40:03 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Thu, 2 Dec 2021 15:40:03 -0500
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
Message-ID: <b225551c-faab-afe9-313d-7959727271cc@gmail.com>

The reason for this behaviour is that finding methods is a lot slower 
than just evaluating the built-in function.  So R takes the time to 
determine if there's an attribute named "class" attached, but doesn't go 
searching further if there isn't one.

Duncan Murdoch

On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> This is because + dispatches on the class attribute, which a string like
> "test" has set to NULL, so it doesn't dispatch. You can add the class
> yourself like structure("test", class = "character") and that should work.
> 
> I'm not sure where it's explained, but most primitive functions dispatch on
> the class attribute, which is different from UseMethod which calls class()
> if the class attribute is NULL.
> 
> I think if you want to define something like what you have written, you
> could write a function `%+%` use that instead
> 
> On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> 
>> ... and probably a dumb one and almost certainly not of interest to
>> most R users. But anyway...
>>
>> ?"+" says:
>> "The unary and binary arithmetic operators are generic functions:
>> methods can be written for them individually or via the Ops group
>> generic function. "
>>
>> So:
>> "+.character" <- function(e1, e2) paste0(e1, e2)
>> ## but this doesn't 'work':
>>> "a" + "b"
>> Error in "a" + "b" : non-numeric argument to binary operator
>>
>> ## but explicitly invoking the method does 'work' :
>>> "+.character"('a','b')
>> [1] "ab"
>>
>> ##Note also:
>>> methods("+")
>> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
>>
>> So what am I failing to understand?
>> Thanks.
>>
>> Bert Gunter
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From r@ywong @end|ng |rom t@mu@edu  Thu Dec  2 21:52:24 2021
From: r@ywong @end|ng |rom t@mu@edu (Raymond Wong)
Date: Thu, 2 Dec 2021 14:52:24 -0600
Subject: [R] 2022 John M. Chambers Software Award
References: <5dfd88b1-6324-45cd-8628-3d4c31d356e3@Spark>
Message-ID: <546fdedf-a5a0-4991-ac21-6eda1813dc4d@Spark>

Dear R-help listers,

I would like to let you know that submission window of the John M. Chambers Software Award is now open. The submission deadline is December 15, 2021.

The Statistical Computing Section of the American Statistical Association announces the competition for the John M. Chambers Statistical Software Award. In 1998 the Association for Computing Machinery (ACM) presented the ACM Software System Award to John Chambers for the design and development of S. Dr. Chambers generously donated his award to the Statistical Computing Section to endow an annual prize for statistical software written by, or in collaboration with, an undergraduate or graduate student.

Please visit?http://asa.stat.uconn.edu?for more information.

Best,
Raymond


	[[alternative HTML version deleted]]


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 21:57:11 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Thu, 2 Dec 2021 23:57:11 +0300
Subject: [R] Forwarding missing arguments to the `[` method
Message-ID: <20211202235711.203958c0@Tarkus>

Hi everyone,

Suppose I've got a class 'foo' that's a matrix tagged with a vector of
length() == nrow(foo):

foo <- function(x, ...) UseMethod('foo')
foo.matrix <- function(x, y, ...) {
	stopifnot(
		!is.recursive(y),
		length(y) == nrow(x),
		length(list(...)) == 0
	)
	structure(x, class = 'foo', foo = y)
}

The invariant that the vector follows the rows of the matrix must be
maintained, so I write a [.foo method:

`[.foo` <- function(x, i, j, ..., drop = TRUE) {
	ret <- NextMethod() # could drop dimensions
	if (is.matrix(ret)) foo(
		ret,
		unname(setNames(attr(x, 'foo'), dimnames(x)[[1]])[i])
	)
	else ret
}

Note the acrobatics required to handle indexing objects of class foo by
the dimnames of the matrix. If I used foo(attr(x,'foo')[i]) instead,
indexing by dimnames would result in the correct subset of the matrix
tagged with a vector of NAs.

Now I would like to implement sub-assignment. I would like to access
the correct subset of the 'foo' vector (for example, if value is also
of class foo, I would like to check if the 'foo' attributes match
between value and x), but I don't want to copy&paste the code or create
a separate method, so I call `[.foo` instead:

`[<-.foo` <- function(x, i, j, ..., value) {
	xsub <- x[i,j]
	# safety checks on attr(xsub, 'foo')
	NextMethod()
}

...except this doesn't quite work:

x <- foo(volcano, 1:nrow(volcano))
x[] <- 1
# Error in NextMethod() : argument "i" is missing, with no default
traceback()
# 5: NextMethod() at foo.R#15
# 4: `[.foo`(x, i, j) at foo.R#24
# 3: x[i, j] at foo.R#24
# 2: `[<-.foo`(`*tmp*`, , value = 1)
# 1: `[<-`(`*tmp*`, , value = 1)

Why can I forward missing i,j to built-in `[`

-- 
Best regards,
Ivan


From kry|ov@r00t @end|ng |rom gm@||@com  Thu Dec  2 22:00:01 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 3 Dec 2021 00:00:01 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211202235711.203958c0@Tarkus>
References: <20211202235711.203958c0@Tarkus>
Message-ID: <20211203000001.58aba4d6@Tarkus>

Sorry for sending an unfinished message!

On Thu, 2 Dec 2021 23:57:11 +0300
Ivan Krylov <krylov.r00t at gmail.com> wrote:

> Why can I forward missing i,j to built-in `[`

Why can I forward missing i,j to the built-in `[` method but not
to user-defined methods? How can I fix this? Default i and j to TRUE?
Are there less involved methods of handling my problem of subsetting
attr(x, 'foo') with the dimnames of x? Preferrably without setting
dimnames on attr(x, 'foo') itself.

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  2 22:16:56 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 2 Dec 2021 13:16:56 -0800
Subject: [R] A technical question on methods for "+"
In-Reply-To: <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
Message-ID: <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>

Those are both helpful comments. Would it not be useful to say
something along these lines in ?class. ?
The key point I missed is that there often(but not always) must be an
*explicit* class **attribute** for method dispatch; and class() does
not indicate whether its value is explicit or not (just recapitulating
what you both said). Ops methods are such a case (for anything but
classes inheriting from numeric?), and perhaps a mention there might
be useful, too.

Again, thanks for the help.

Bert

On Thu, Dec 2, 2021 at 12:40 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
>
> The reason for this behaviour is that finding methods is a lot slower
> than just evaluating the built-in function.  So R takes the time to
> determine if there's an attribute named "class" attached, but doesn't go
> searching further if there isn't one.
>
> Duncan Murdoch
>
> On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> > This is because + dispatches on the class attribute, which a string like
> > "test" has set to NULL, so it doesn't dispatch. You can add the class
> > yourself like structure("test", class = "character") and that should work.
> >
> > I'm not sure where it's explained, but most primitive functions dispatch on
> > the class attribute, which is different from UseMethod which calls class()
> > if the class attribute is NULL.
> >
> > I think if you want to define something like what you have written, you
> > could write a function `%+%` use that instead
> >
> > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> >
> >> ... and probably a dumb one and almost certainly not of interest to
> >> most R users. But anyway...
> >>
> >> ?"+" says:
> >> "The unary and binary arithmetic operators are generic functions:
> >> methods can be written for them individually or via the Ops group
> >> generic function. "
> >>
> >> So:
> >> "+.character" <- function(e1, e2) paste0(e1, e2)
> >> ## but this doesn't 'work':
> >>> "a" + "b"
> >> Error in "a" + "b" : non-numeric argument to binary operator
> >>
> >> ## but explicitly invoking the method does 'work' :
> >>> "+.character"('a','b')
> >> [1] "ab"
> >>
> >> ##Note also:
> >>> methods("+")
> >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> >>
> >> So what am I failing to understand?
> >> Thanks.
> >>
> >> Bert Gunter
> >>
> >> ______________________________________________
> >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide
> >> http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Thu Dec  2 22:41:52 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Thu, 02 Dec 2021 13:41:52 -0800
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211203000001.58aba4d6@Tarkus>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
Message-ID: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>

I think you need a reprex... I don't think your claim is correct as stated.

On December 2, 2021 1:00:01 PM PST, Ivan Krylov <krylov.r00t at gmail.com> wrote:
>Sorry for sending an unfinished message!
>
>On Thu, 2 Dec 2021 23:57:11 +0300
>Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
>> Why can I forward missing i,j to built-in `[`
>
>Why can I forward missing i,j to the built-in `[` method but not
>to user-defined methods? How can I fix this? Default i and j to TRUE?
>Are there less involved methods of handling my problem of subsetting
>attr(x, 'foo') with the dimnames of x? Preferrably without setting
>dimnames on attr(x, 'foo') itself.
>

-- 
Sent from my phone. Please excuse my brevity.


From y@ngk@|9999 @end|ng |rom y@hoo@com  Fri Dec  3 01:21:24 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Fri, 3 Dec 2021 00:21:24 +0000 (UTC)
Subject: [R] SOMAscan data analysis
References: <975453562.357165.1638490884679.ref@mail.yahoo.com>
Message-ID: <975453562.357165.1638490884679@mail.yahoo.com>

Hello R team,we have a huge SOMAscan data set. This is an aptamer-based protecomics assay capable of measuring 1305 human protein analytes. does anyone know which package can load the data and do analysis??I apricate?any suggestion, your experience, web page, paper....?
Thank you,Kai
	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Fri Dec  3 05:06:45 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Fri, 3 Dec 2021 17:06:45 +1300
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
Message-ID: <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>

What puzzles me is why you are not just using
lapply(some.data.frame, min)
lapply(some.data.frame, max)
or as.vector(lapply(...))
Why go to another package for this?
Is it the indices you want?

col.min.indices <- function (some.data.frame) {
    v <- sapply(some.data.frame, function (column)
           which(column == min(column))[1])
    names(v) <- colnames(some.data.frame)
    v
}


On Wed, 1 Dec 2021 at 07:55, Stephen H. Dawson, DSL via R-help <
r-help at r-project.org> wrote:

> Hi,
>
>
> I am working to understand the Rfast functions of colMins and colMaxs. I
> worked through the example listed on page 54 of the PDF.
>
> https://cran.r-project.org/web/packages/Rfast/index.html
>
> https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>
> My data is in a CSV file. So, I bring it into R Studio using:
> Data <- read.csv("./input/DataSet05.csv", header=T)
>
> However, I read the instructions listed on page 54 of the PDF saying I
> need to bring data into R using a matrix. I think read.csv brings the
> data in as a dataframe. I think colMins is failing because it is looking
> for a matrix but finds a dataframe.
>
>  > colMaxs(Data)
> Error in colMaxs(Data) :
>    Not compatible with requested type: [type=list; target=double].
>  > colMins(Data, na.rm = TRUE)
> Error in colMins(Data, na.rm = TRUE) :
>    unused argument (na.rm = TRUE)
>  > colMins(Data, value = FALSE, parallel = FALSE)
> Error in colMins(Data, value = FALSE, parallel = FALSE) :
>    Not compatible with requested type: [type=list; target=double].
>
> QUESTION
> What is the best practice to bring a csv file into R Studio so it can be
> accessed by colMaxs and colMins, please?
>
>
> Thanks,
> --
> *Stephen Dawson, DSL*
> /Executive Strategy Consultant/
> Business & Technology
> +1 (865) 804-3454
> http://www.shdawson.com <http://www.shdawson.com>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From deep@y@n@@@rk@r @end|ng |rom gm@||@com  Fri Dec  3 06:11:42 2021
From: deep@y@n@@@rk@r @end|ng |rom gm@||@com (Deepayan Sarkar)
Date: Fri, 3 Dec 2021 10:41:42 +0530
Subject: [R] A technical question on methods for "+"
In-Reply-To: <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>
References: <CAGxFJbQQZtPXyxnZ58o93_LnKCDM13aYYoGw06jZ-1grtXRAPg@mail.gmail.com>
 <CAPcHnpRtQ4N5wbGBSczm_P1Z5dRy6D7xU09zt_eMHnPTm=jSXA@mail.gmail.com>
 <b225551c-faab-afe9-313d-7959727271cc@gmail.com>
 <CAGxFJbQYJTZHPN0rzwK6aj4cQdafFPcXfng+x_8S=Vo6eYR6-g@mail.gmail.com>
Message-ID: <CADfFDC7Dx_egX4pQAyTQoPo_v2h-O3qAGLKTtpMJ1Ao51mH-0g@mail.gmail.com>

On Fri, Dec 3, 2021 at 3:14 AM Bert Gunter <bgunter.4567 at gmail.com> wrote:
>
> Those are both helpful comments. Would it not be useful to say
> something along these lines in ?class. ?
> The key point I missed is that there often(but not always) must be an
> *explicit* class **attribute** for method dispatch; and class() does
> not indicate whether its value is explicit or not (just recapitulating
> what you both said). Ops methods are such a case (for anything but
> classes inheriting from numeric?), and perhaps a mention there might
> be useful, too.

?Ops already says

     Note that a method will be used for one of these groups or one of
     its members _only_ if it corresponds to a '"class"' attribute, as
     the internal code dispatches on 'oldClass' and not on 'class'.
     This is for efficiency: having to dispatch on, say, 'Ops.integer'
     would be too slow.

Can you suggest some text to make this clearer?

FWIW, the following seems to work as you would want (at the cost of
global inefficiency):

`+` <- function(e1, e2) UseMethod("+")
`+.default` <- function(e1, e2 = 0) .Primitive("+")(e1, e2)

and then

"+.character" <- function(e1, e2) paste0(e1, e2)

> "jan" + "feb"
[1] "janfeb"
> Reduce("+", letters)
[1] "abcdefghijklmnopqrstuvwxyz"

-Deepayan

> Again, thanks for the help.
>
> Bert
>
> On Thu, Dec 2, 2021 at 12:40 PM Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> >
> > The reason for this behaviour is that finding methods is a lot slower
> > than just evaluating the built-in function.  So R takes the time to
> > determine if there's an attribute named "class" attached, but doesn't go
> > searching further if there isn't one.
> >
> > Duncan Murdoch
> >
> > On 02/12/2021 3:10 p.m., Andrew Simmons wrote:
> > > This is because + dispatches on the class attribute, which a string like
> > > "test" has set to NULL, so it doesn't dispatch. You can add the class
> > > yourself like structure("test", class = "character") and that should work.
> > >
> > > I'm not sure where it's explained, but most primitive functions dispatch on
> > > the class attribute, which is different from UseMethod which calls class()
> > > if the class attribute is NULL.
> > >
> > > I think if you want to define something like what you have written, you
> > > could write a function `%+%` use that instead
> > >
> > > On Thu, Dec 2, 2021, 14:32 Bert Gunter <bgunter.4567 at gmail.com> wrote:
> > >
> > >> ... and probably a dumb one and almost certainly not of interest to
> > >> most R users. But anyway...
> > >>
> > >> ?"+" says:
> > >> "The unary and binary arithmetic operators are generic functions:
> > >> methods can be written for them individually or via the Ops group
> > >> generic function. "
> > >>
> > >> So:
> > >> "+.character" <- function(e1, e2) paste0(e1, e2)
> > >> ## but this doesn't 'work':
> > >>> "a" + "b"
> > >> Error in "a" + "b" : non-numeric argument to binary operator
> > >>
> > >> ## but explicitly invoking the method does 'work' :
> > >>> "+.character"('a','b')
> > >> [1] "ab"
> > >>
> > >> ##Note also:
> > >>> methods("+")
> > >> [1] +.character +.Date      +.IDate*    +.POSIXt    +.trellis*
> > >>
> > >> So what am I failing to understand?
> > >> Thanks.
> > >>
> > >> Bert Gunter
> > >>
> > >> ______________________________________________
> > >> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > >> https://stat.ethz.ch/mailman/listinfo/r-help
> > >> PLEASE do read the posting guide
> > >> http://www.R-project.org/posting-guide.html
> > >> and provide commented, minimal, self-contained, reproducible code.
> > >>
> > >
> > >       [[alternative HTML version deleted]]
> > >
> > > ______________________________________________
> > > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > > https://stat.ethz.ch/mailman/listinfo/r-help
> > > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> > > and provide commented, minimal, self-contained, reproducible code.
> > >
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Dec  3 07:52:09 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 3 Dec 2021 09:52:09 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
Message-ID: <20211203095209.1928a976@Tarkus>

On Thu, 02 Dec 2021 13:41:52 -0800
Jeff Newmiller <jdnewmil at dcn.davis.ca.us> wrote:

> I think you need a reprex... I don't think your claim is correct as
> stated.

Sorry, let me try again. The following "works" for me in the sense of
throwing the same error on R 3.3 and R-devel:

foo <- function(x, ...) UseMethod('foo')

# foo is a matrix tagged with a vector of length() == nrow(foo)
foo.matrix <- function(x, y, ...) {
	stopifnot(
		!is.recursive(y),
		length(y) == nrow(x),
		length(list(...)) == 0
	)
	structure(x, class = 'foo', foo = y)
}

# the vector must be subsetted at the same time as x
`[.foo` <- function(x, i, j, ..., drop = TRUE) {
	ret <- NextMethod() # could drop dimensions
	if (is.matrix(ret)) foo(
		ret,
		unname(setNames(attr(x, 'foo'), dimnames(x)[[1]])[i])
	)
	else ret
}

`[<-.foo` <- function(x, i, j, ..., value) {
	xsub <- x[i, j, drop = FALSE]
	# TODO: some checks on xsub
	NextMethod()
}

x <- foo(volcano, 1:nrow(volcano))
invisible(x[]) # doesn't stop despite missing i
x[] <- 1       # fails in `[.foo` with "i missing"
# Error in NextMethod() : argument "i" is missing, with no default
traceback()
# 9: NextMethod() at foo.R#15
# 8: `[.foo`(x, i, j, drop = FALSE) at foo.R#24
# 7: x[i, j, drop = FALSE] at foo.R#24
# 6: `[<-.foo`(`*tmp*`, , value = 1) at foo.R#30
# 5: `[<-`(`*tmp*`, , value = 1) at foo.R#30
# 4: eval(ei, envir)
# 3: eval(ei, envir)
# 2: withVisible(eval(ei, envir))
# 1: source("foo.R", echo = TRUE)

Or did you mean some other claim?

-- 
Best regards,
Ivan


From er|cjberger @end|ng |rom gm@||@com  Fri Dec  3 10:40:38 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Fri, 3 Dec 2021 11:40:38 +0200
Subject: [R] SOMAscan data analysis
In-Reply-To: <975453562.357165.1638490884679@mail.yahoo.com>
References: <975453562.357165.1638490884679.ref@mail.yahoo.com>
 <975453562.357165.1638490884679@mail.yahoo.com>
Message-ID: <CAGgJW75fbT=xvF=df+8fmy3XZ-+dzj=yd=H86BQ9XG2TayM=Yw@mail.gmail.com>

Hi Kai,
Check out https://www.bioconductor.org
or the help there at
https://www.bioconductor.org/help/

You can also post your question there.

Best,
Eric


On Fri, Dec 3, 2021 at 2:22 AM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hello R team,we have a huge SOMAscan data set. This is an aptamer-based
> protecomics assay capable of measuring 1305 human protein analytes. does
> anyone know which package can load the data and do analysis? I apricate any
> suggestion, your experience, web page, paper....
> Thank you,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From |@bone @end|ng |rom em@||@@c@edu  Fri Dec  3 16:28:53 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Fri, 3 Dec 2021 15:28:53 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>

Thanks for the feedback everyone. If you go to https://github.com/csantill/RPerformanceWBLAS/blob/master/RPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?

R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2 tools_4.1.2



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA



________________________________
From: Labone, Thomas <labone at email.sc.edu>
Sent: Thursday, December 2, 2021 11:53 AM
To: Bill Dunlap <williamwdunlap at gmail.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

> summary(fit)

Call:
lm(formula = log(k) ~ Z)

Residuals:
    Min      1Q  Median      3Q     Max
-21.241   1.327   1.776   2.245   4.418

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept) -0.03465    0.01916  -1.809   0.0705 .
Z           -0.24207    0.01916 -12.634   <2e-16 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1

Residual standard error: 1.914 on 9998 degrees of freedom
Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16

> summary(k)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> summary(Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
-3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> summary(gm*gsd^Z)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
>


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


________________________________
From: Bill Dunlap <williamwdunlap at gmail.com>
Sent: Thursday, December 2, 2021 10:31 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

On the 'bad' machines, what did you get for
   summary(fit)
   summary(k)
   summary(Z)
   summary(gm*gsd^Z)
?

-Bill

On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?

set.seed(132)

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This works
n <- 1000# OK <= 4095
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#this does not
n <- 10000# fails >= 4096 = 2^12
Z <- qnorm(ppoints(n))

k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))

quantile(k,probs=c(0.025,0.5,0.975))
summary(k)

fit <- lm(log(k) ~ Z)
summary(fit)

gm <- exp(coef(fit)[1])
gsd <- exp(coef(fit)[2])
gm
gsd

plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
lines(Z,gm*gsd^Z,col="red")


#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() #for two Linux machines having problem
R version 4.1.2 (2021-11-01)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 20.2

Matrix products: default
BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> sessionInfo() # for a third Linux machine not having the problem
R version 4.1.1 (2021-08-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Linux Mint 19.3

Matrix products: default
BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_4.1.1 tools_4.1.1



Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA


        [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

	[[alternative HTML version deleted]]


From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Dec  3 17:00:51 2021
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 3 Dec 2021 11:00:51 -0500
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
Message-ID: <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>

It might also be a BLAS+processor problem - I got bit pretty hard by
that, with an example here:

https://stat.ethz.ch/pipermail/r-help/2019-July/463477.html

With a key excerpt here:

On Thu, Jul 18, 2019 at 1:59 PM Ivan Krylov <krylov.r00t using gmail.com> wrote:
> Yes, this might be bad. I have heard about OpenBLAS (specifically, the
> matrix product routine) misbehaving on certain AVX-512 capable
> processors, so much that they had to disable some optimizations in
> 0.3.6 [*], which you already have installed. Still, would `env
> OPENBLAS_CORETYPE=Haswell R --vanilla` give a better result?
>

On Fri, Dec 3, 2021 at 10:29 AM Labone, Thomas <labone at email.sc.edu> wrote:
>
> Thanks for the feedback everyone. If you go to https://github.com/csantill/RPerformanceWBLAS/blob/master/RPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?
>
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
> LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2 tools_4.1.2
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>
> ________________________________
> From: Labone, Thomas <labone at email.sc.edu>
> Sent: Thursday, December 2, 2021 11:53 AM
> To: Bill Dunlap <williamwdunlap at gmail.com>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> > summary(fit)
>
> Call:
> lm(formula = log(k) ~ Z)
>
> Residuals:
>     Min      1Q  Median      3Q     Max
> -21.241   1.327   1.776   2.245   4.418
>
> Coefficients:
>             Estimate Std. Error t value Pr(>|t|)
> (Intercept) -0.03465    0.01916  -1.809   0.0705 .
> Z           -0.24207    0.01916 -12.634   <2e-16 ***
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.914 on 9998 degrees of freedom
> Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
> F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16
>
> > summary(k)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> > summary(Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> -3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> > summary(gm*gsd^Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
> >
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
> ________________________________
> From: Bill Dunlap <williamwdunlap at gmail.com>
> Sent: Thursday, December 2, 2021 10:31 AM
> To: Labone, Thomas <labone at email.sc.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> On the 'bad' machines, what did you get for
>    summary(fit)
>    summary(k)
>    summary(Z)
>    summary(gm*gsd^Z)
> ?
>
> -Bill
>
> On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From @erv|ce @end|ng |rom @hd@w@on@com  Fri Dec  3 17:22:31 2021
From: @erv|ce @end|ng |rom @hd@w@on@com (Stephen H. Dawson, DSL)
Date: Fri, 3 Dec 2021 11:22:31 -0500
Subject: [R] Question about Rfast colMins and colMaxs
In-Reply-To: <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>
References: <f6735434-7d5a-c648-c892-0fa1ccc5c774@shdawson.com>
 <CABcYAdL60P_E430RRwgh+v5L932Ph7OJ0KhvFK-0kUnUYc7V8A@mail.gmail.com>
Message-ID: <3c27662b-1729-64b8-3c9b-e18a62b2664c@shdawson.com>

Thanks, Richard.

I am researching other library options for data inspection. I have many 
csv files I am reviewing with different column names and data types. 
Flexibility of a quick review of max and min is quite valuable at this 
juncture.

I will implement your code recommendation next week and see how it performs.


Kindest Regards,
*Stephen Dawson, DSL*
/Executive Strategy Consultant/
Business & Technology
+1 (865) 804-3454
http://www.shdawson.com <http://www.shdawson.com>


On 12/2/21 11:06 PM, Richard O'Keefe wrote:
> What puzzles me is why you are not just using
> lapply(some.data.frame, min)
> lapply(some.data.frame, max)
> or as.vector(lapply(...))
> Why go to another package for this?
> Is it the indices you want?
>
> col.min.indices <- function (some.data.frame) {
> ??? v <- sapply(some.data.frame, function (column)
> which(column == min(column))[1])
> ??? names(v) <- colnames(some.data.frame)
> ??? v
> }
>
>
> On Wed, 1 Dec 2021 at 07:55, Stephen H. Dawson, DSL via R-help 
> <r-help at r-project.org <mailto:r-help at r-project.org>> wrote:
>
>     Hi,
>
>
>     I am working to understand the Rfast functions of colMins and
>     colMaxs. I
>     worked through the example listed on page 54 of the PDF.
>
>     https://cran.r-project.org/web/packages/Rfast/index.html
>     <https://cran.r-project.org/web/packages/Rfast/index.html>
>
>     https://cran.r-project.org/web/packages/Rfast/Rfast.pdf
>     <https://cran.r-project.org/web/packages/Rfast/Rfast.pdf>
>
>     My data is in a CSV file. So, I bring it into R Studio using:
>     Data <- read.csv("./input/DataSet05.csv", header=T)
>
>     However, I read the instructions listed on page 54 of the PDF
>     saying I
>     need to bring data into R using a matrix. I think read.csv brings the
>     data in as a dataframe. I think colMins is failing because it is
>     looking
>     for a matrix but finds a dataframe.
>
>     ?> colMaxs(Data)
>     Error in colMaxs(Data) :
>     ?? Not compatible with requested type: [type=list; target=double].
>     ?> colMins(Data, na.rm = TRUE)
>     Error in colMins(Data, na.rm = TRUE) :
>     ?? unused argument (na.rm = TRUE)
>     ?> colMins(Data, value = FALSE, parallel = FALSE)
>     Error in colMins(Data, value = FALSE, parallel = FALSE) :
>     ?? Not compatible with requested type: [type=list; target=double].
>
>     QUESTION
>     What is the best practice to bring a csv file into R Studio so it
>     can be
>     accessed by colMaxs and colMins, please?
>
>
>     Thanks,
>     -- 
>     *Stephen Dawson, DSL*
>     /Executive Strategy Consultant/
>     Business & Technology
>     +1 (865) 804-3454
>     http://www.shdawson.com <http://www.shdawson.com>
>     <http://www.shdawson.com <http://www.shdawson.com>>
>
>     ______________________________________________
>     R-help at r-project.org <mailto:R-help at r-project.org> mailing list --
>     To UNSUBSCRIBE and more, see
>     https://stat.ethz.ch/mailman/listinfo/r-help
>     <https://stat.ethz.ch/mailman/listinfo/r-help>
>     PLEASE do read the posting guide
>     http://www.R-project.org/posting-guide.html
>     <http://www.R-project.org/posting-guide.html>
>     and provide commented, minimal, self-contained, reproducible code.
>


From |@bone @end|ng |rom em@||@@c@edu  Fri Dec  3 17:37:29 2021
From: |@bone @end|ng |rom em@||@@c@edu (Labone, Thomas)
Date: Fri, 3 Dec 2021 16:37:29 +0000
Subject: [R] Problem with lm Giving Wrong Results
In-Reply-To: <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>
References: <BN8PR19MB28179DD4CA2C4AFE9F34CE3FF9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAHqSRuSn05tHOjdDAL6gSXZbaV80YA5WvAzsKfPdR8i3tAw-VA@mail.gmail.com>
 <BN8PR19MB2817E1E5AF9FE6ED8CFF8C82F9699@BN8PR19MB2817.namprd19.prod.outlook.com>
 <BN8PR19MB28173C7C388770DDE4FA58EFF96A9@BN8PR19MB2817.namprd19.prod.outlook.com>
 <CAM_vjunZUZNdThGEZu1FYxV6K3BZ+WkZ-LMJ2VqGKCeL+63LYg@mail.gmail.com>
Message-ID: <BN8PR19MB28172DA2143E1CBDE313C6F1F96A9@BN8PR19MB2817.namprd19.prod.outlook.com>

Two of the machines having the problem are AVX-512 capable (e.g., i7-7820X) but another one is an old Samsung Series 5 with an i5-3317U. I guess I will start with the folks at Linux Mint.

Tom


Thomas R. LaBone
PhD student
Department of Epidemiology and Biostatistics
Arnold School of Public Health
University of South Carolina
Columbia, South Carolina USA



________________________________
From: Sarah Goslee <sarah.goslee at gmail.com>
Sent: Friday, December 3, 2021 11:00 AM
To: Labone, Thomas <labone at email.sc.edu>
Cc: Bill Dunlap <williamwdunlap at gmail.com>; r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Problem with lm Giving Wrong Results

It might also be a BLAS+processor problem - I got bit pretty hard by
that, with an example here:

https://stat.ethz.ch/pipermail/r-help/2019-July/463477.html

With a key excerpt here:

On Thu, Jul 18, 2019 at 1:59 PM Ivan Krylov <krylov.r00t using gmail.com> wrote:
> Yes, this might be bad. I have heard about OpenBLAS (specifically, the
> matrix product routine) misbehaving on certain AVX-512 capable
> processors, so much that they had to disable some optimizations in
> 0.3.6 [*], which you already have installed. Still, would `env
> OPENBLAS_CORETYPE=Haswell R --vanilla` give a better result?
>

On Fri, Dec 3, 2021 at 10:29 AM Labone, Thomas <labone at email.sc.edu> wrote:
>
> Thanks for the feedback everyone. If you go to https://protect2.fireeye.com/v1/url?k=f8bdd2b7-a726ea7c-f8bd9c76-86ce7c8b8969-1acf41b3a3825b65&q=1&e=05c346dc-4f60-4e2e-ada8-1abaa8792515&u=https%3A%2F%2Fgithub.com%2Fcsantill%2FRPerformanceWBLAS%2Fblob%2Fmaster%2FRPerformanceBLAS.md you will find the Linux commands to change the default math library. When I switch the BLAS library from MKL to the system default (see sessionInfo below), everything works as expected. I installed version 2020.0-166-1 of "Intel-MKL" from the Linux Mint Software Manager. I may be coming to a hasty conclusion, but there appears to be something wrong with that package or how it interacts with other system software. Any suggestions on who I should notify about the problem (e.g., Intel, Mint, Ubuntu)?
>
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
> LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2 tools_4.1.2
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>
> ________________________________
> From: Labone, Thomas <labone at email.sc.edu>
> Sent: Thursday, December 2, 2021 11:53 AM
> To: Bill Dunlap <williamwdunlap at gmail.com>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> > summary(fit)
>
> Call:
> lm(formula = log(k) ~ Z)
>
> Residuals:
>     Min      1Q  Median      3Q     Max
> -21.241   1.327   1.776   2.245   4.418
>
> Coefficients:
>             Estimate Std. Error t value Pr(>|t|)
> (Intercept) -0.03465    0.01916  -1.809   0.0705 .
> Z           -0.24207    0.01916 -12.634   <2e-16 ***
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1
>
> Residual standard error: 1.914 on 9998 degrees of freedom
> Multiple R-squared:  0.01467, Adjusted R-squared:  0.01457
> F-statistic: 148.8 on 1 and 9998 DF,  p-value: < 2.2e-16
>
> > summary(k)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.2735  3.7658  5.9052  7.5113  9.4399 82.9531
> > summary(Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
> -3.8906 -0.6744  0.0000  0.0000  0.6744  3.8906
> > summary(gm*gsd^Z)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  0.3767  0.8204  0.9659  0.9947  1.1372  2.4772
> >
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
> ________________________________
> From: Bill Dunlap <williamwdunlap at gmail.com>
> Sent: Thursday, December 2, 2021 10:31 AM
> To: Labone, Thomas <labone at email.sc.edu>
> Cc: r-help at r-project.org <r-help at r-project.org>
> Subject: Re: [R] Problem with lm Giving Wrong Results
>
> On the 'bad' machines, what did you get for
>    summary(fit)
>    summary(k)
>    summary(Z)
>    summary(gm*gsd^Z)
> ?
>
> -Bill
>
> On Thu, Dec 2, 2021 at 6:18 AM Labone, Thomas <labone at email.sc.edu<mailto:labone at email.sc.edu>> wrote:
> In the code below the first and second plots should look pretty much the same, the only difference being that the first has n=1000 points and the second n=10000 points. On two of my Linux machines (info below) the second plot is a horizontal line (incorrect answer from lm), but on my Windows 10 machine and a third Linux machine it works as expected. The interesting thing is that the code works as expected for n <= 4095 but fails for n>=4096 (which equals 2^12). Can anyone else reproduce this problem? Any ideas on how to fix it?
>
> set.seed(132)
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> # This works
> n <- 1000# OK <= 4095
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> #this does not
> n <- 10000# fails >= 4096 = 2^12
> Z <- qnorm(ppoints(n))
>
> k <- sort(rlnorm(n,log(2131),log(1.61)) / rlnorm(n,log(355),log(1.61)))
>
> quantile(k,probs=c(0.025,0.5,0.975))
> summary(k)
>
> fit <- lm(log(k) ~ Z)
> summary(fit)
>
> gm <- exp(coef(fit)[1])
> gsd <- exp(coef(fit)[2])
> gm
> gsd
>
> plot(Z,k,log="y",xlim=c(-4,4),ylim=c(0.1,100))
> lines(Z,gm*gsd^Z,col="red")
>
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() #for two Linux machines having problem
> R version 4.1.2 (2021-11-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 20.2
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.2  Matrix_1.3-4    tools_4.1.2     expm_0.999-6    grid_4.1.2      lattice_0.20-45
>
> #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > sessionInfo() # for a third Linux machine not having the problem
> R version 4.1.1 (2021-08-10)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Linux Mint 19.3
>
> Matrix products: default
> BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_rt.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8
>  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] compiler_4.1.1 tools_4.1.1
>
>
>
> Thomas R. LaBone
> PhD student
> Department of Epidemiology and Biostatistics
> Arnold School of Public Health
> University of South Carolina
> Columbia, South Carolina USA
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org<mailto:R-help at r-project.org> mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
Sarah Goslee (she/her)
https://protect2.fireeye.com/v1/url?k=c805d788-979eef43-c8059949-86ce7c8b8969-1bd7107f3d9bccca&q=1&e=05c346dc-4f60-4e2e-ada8-1abaa8792515&u=http%3A%2F%2Fwww.numberwright.com%2F

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 21:55:34 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 12:55:34 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
Message-ID: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>

I find solutions when the data_frame is grouped, but none when it's not.

The data:
# A tibble: 813,693 ? 9
    site_nbr  year   mon   day    hr   min tz      cfs sampdt
    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
  1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
  2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
  3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
  4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
  5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
  6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
  7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
  8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
  9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
# ? with 813,683 more rows

The script:
library(tidyverse)

max_pdx_disc <- pdx_disc %>%
     summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))

The error:
> source('../scripts/filter_by_column_max.r') 
Error: Problem with `summarise()` column `max_cfs_sampdt`.
  `max_cfs_sampdt = sampt(which.max(cfs))`.
  could not find function "sampt"
> Run `rlang::last_error()` to see where the error occurred.

I looked at the the last_error and the traceback without understanding how
to filter the row with the maximum cfs value.

What do I read to learn how to return this row?

TIA,

Rich


From bgunter@4567 @end|ng |rom gm@||@com  Fri Dec  3 22:21:34 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 3 Dec 2021 13:21:34 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <CAGxFJbQ1fKUteG3yAGjB-CA+vHqoiMYg_nxAMT1rsFbsgQwKwA@mail.gmail.com>

which.max(dat$cfs), I presume.
see ?which.max

(as usual, true tidyverse questions belong on RStudio's help site, not here).

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )

On Fri, Dec 3, 2021 at 12:56 PM Rich Shepard <rshepard at appl-ecosys.com> wrote:
>
> I find solutions when the data_frame is grouped, but none when it's not.
>
> The data:
> # A tibble: 813,693 ? 9
>     site_nbr  year   mon   day    hr   min tz      cfs sampdt
>     <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
>   1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
>   2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
>   3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
>   4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
>   5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
>   6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
>   7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
>   8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
>   9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
> 10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
> # ? with 813,683 more rows
>
> The script:
> library(tidyverse)
>
> max_pdx_disc <- pdx_disc %>%
>      summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))
>
> The error:
> > source('../scripts/filter_by_column_max.r')
> Error: Problem with `summarise()` column `max_cfs_sampdt`.
>   `max_cfs_sampdt = sampt(which.max(cfs))`.
>   could not find function "sampt"
> > Run `rlang::last_error()` to see where the error occurred.
>
> I looked at the the last_error and the traceback without understanding how
> to filter the row with the maximum cfs value.
>
> What do I read to learn how to return this row?
>
> TIA,
>
> Rich
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Fri Dec  3 22:46:27 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Fri, 03 Dec 2021 13:46:27 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>

cfs is not a function. Don't put parentheses next to it. Use square brackets for indexing.

On December 3, 2021 12:55:34 PM PST, Rich Shepard <rshepard at appl-ecosys.com> wrote:
>I find solutions when the data_frame is grouped, but none when it's not.
>
>The data:
># A tibble: 813,693 ? 9
>    site_nbr  year   mon   day    hr   min tz      cfs sampdt
>    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
>  1 14211720  1988    10     1     0    10 PDT   16800 1988-10-01 00:10:00
>  2 14211720  1988    10     1     0    20 PDT   16800 1988-10-01 00:20:00
>  3 14211720  1988    10     1     0    30 PDT   17300 1988-10-01 00:30:00
>  4 14211720  1988    10     1     0    40 PDT   18200 1988-10-01 00:40:00
>  5 14211720  1988    10     1     0    50 PDT   18100 1988-10-01 00:50:00
>  6 14211720  1988    10     1     1     0 PDT   18400 1988-10-01 01:00:00
>  7 14211720  1988    10     1     1    10 PDT   18700 1988-10-01 01:10:00
>  8 14211720  1988    10     1     1    20 PDT   19200 1988-10-01 01:20:00
>  9 14211720  1988    10     1     1    30 PDT   19200 1988-10-01 01:30:00
>10 14211720  1988    10     1     1    40 PDT   18900 1988-10-01 01:40:00
># ? with 813,683 more rows
>
>The script:
>library(tidyverse)
>
>max_pdx_disc <- pdx_disc %>%
>     summarize(max_cfs = max(cfs), max_cfs_sampdt = cfs(which.max(cfs)))
>
>The error:
>> source('../scripts/filter_by_column_max.r') 
>Error: Problem with `summarise()` column `max_cfs_sampdt`.
>  `max_cfs_sampdt = sampt(which.max(cfs))`.
>  could not find function "sampt"
>> Run `rlang::last_error()` to see where the error occurred.
>
>I looked at the the last_error and the traceback without understanding how
>to filter the row with the maximum cfs value.
>
>What do I read to learn how to return this row?
>
>TIA,
>
>Rich
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 22:50:30 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 13:50:30 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <195122AB-777B-4AAE-8D08-DFA54B1DDF70@dcn.davis.ca.us>
Message-ID: <652ed27f-4936-d722-7eb8-89c1680704@appl-ecosys.com>

On Fri, 3 Dec 2021, Jeff Newmiller wrote:

> cfs is not a function. Don't put parentheses next to it. Use square
> brackets for indexing.

Jeff,

Thanks.

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Fri Dec  3 23:08:54 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 14:08:54 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
Message-ID: <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>

On Fri, 3 Dec 2021, Rich Shepard wrote:

> I find solutions when the data_frame is grouped, but none when it's not.

Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
value.

Now I need to read more than ?filter to learn why I'm not getting the
relevant row with:
> which.max(pdx_disc$cfs)
[1] 8054

> filter(pdx_disc, cfs == 8054)
# A tibble: 0 ? 9
# ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
#   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>

Regards,

Rich


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Fri Dec  3 23:56:21 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Fri, 3 Dec 2021 22:56:21 +0000
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
Message-ID: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>

Hello,

Inline.

?s 22:08 de 03/12/21, Rich Shepard escreveu:
> On Fri, 3 Dec 2021, Rich Shepard wrote:
> 
>> I find solutions when the data_frame is grouped, but none when it's not.
> 
> Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
> value.
> 
> Now I need to read more than ?filter to learn why I'm not getting the
> relevant row with:
>> which.max(pdx_disc$cfs)
> [1] 8054

This is the *index* for which cfs is the first maximum, not the maximum 
value itself.

> 
>> filter(pdx_disc, cfs == 8054)

Therefore, you probably want any of


filter(pdx_disc, cfs == cfs[8054])

filter(pdx_disc, cfs == cfs[which.max(cfs)])

filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler


Hope this helps,

Rui Barradas


> # A tibble: 0 ? 9
> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
> #?? hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
> 
> Regards,
> 
> Rich
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 00:06:28 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 15:06:28 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
Message-ID: <8ec7c17c-638f-2bd1-f771-e277d51f618f@appl-ecosys.com>

On Fri, 3 Dec 2021, Rui Barradas wrote:

>> which.max(pdx_disc$cfs)
>> [1] 8054

> This is the *index* for which cfs is the first maximum, not the maximum
> value itself.

Rui,

Mea culpa! I completely forgot this.

> Therefore, you probably want any of
> filter(pdx_disc, cfs == cfs[8054])
> filter(pdx_disc, cfs == cfs[which.max(cfs)])
> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler

> Hope this helps,

Yes, it does.

Thank you very much,

Rich


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec  4 00:27:34 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Fri, 3 Dec 2021 15:27:34 -0800
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
Message-ID: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>

Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
cfs == ... are not the same:

> x <- rep(1:2,3)
> x
[1] 1 2 1 2 1 2
> x[which.max(x)]
[1] 2
> x[x==max(x)]
[1] 2 2 2

So maybe your point is: which does the OP want (in case there are
repeated maxes)? I suspect the == forms, but ...?

Bert Gunter

On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>
> Hello,
>
> Inline.
>
> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
> > On Fri, 3 Dec 2021, Rich Shepard wrote:
> >
> >> I find solutions when the data_frame is grouped, but none when it's not.
> >
> > Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
> > value.
> >
> > Now I need to read more than ?filter to learn why I'm not getting the
> > relevant row with:
> >> which.max(pdx_disc$cfs)
> > [1] 8054
>
> This is the *index* for which cfs is the first maximum, not the maximum
> value itself.
>
> >
> >> filter(pdx_disc, cfs == 8054)
>
> Therefore, you probably want any of
>
>
> filter(pdx_disc, cfs == cfs[8054])
>
> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>
> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> > # A tibble: 0 ? 9
> > # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
> > #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
> >
> > Regards,
> >
> > Rich
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> > http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 00:59:01 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 15:59:01 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
Message-ID: <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>

On Fri, 3 Dec 2021, Bert Gunter wrote:

> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
> cfs == ... are not the same:
>
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
>
> So maybe your point is: which does the OP want (in case there are
> repeated maxes)? I suspect the == forms, but ...?

Bert,

When I looked at the results I saw there were many rows with the maximum
(and minimum) values. I thought those represented instrument limits, and
they apparently do. For example, 99.9000 cubic feet per second is reached
multiple times over the past 32 years.

> max(pdx_disc$cfs)
[1] 99900

and

> filter(pdx_disc, cfs == max(cfs))
# A tibble: 74 ? 9
    site_nbr  year   mon   day    hr   min tz      cfs sampdt
    <chr>    <int> <int> <int> <dbl> <dbl> <chr> <dbl> <dttm>
  1 14211720  1988    11    28     0     0 PST   99900 1988-11-28 00:00:00
  2 14211720  1988    11    28     5     0 PST   99900 1988-11-28 05:00:00
  3 14211720  1988    11    28     5    10 PST   99900 1988-11-28 05:10:00
  4 14211720  1988    11    28     5    20 PST   99900 1988-11-28 05:20:00
  5 14211720  1988    11    29     6    20 PST   99900 1988-11-29 06:20:00
  6 14211720  1988    11    29    13     0 PST   99900 1988-11-29 13:00:00
  7 14211720  1988    11    29    13    10 PST   99900 1988-11-29 13:10:00
  8 14211720  1988    11    29    15    20 PST   99900 1988-11-29 15:20:00
  9 14211720  1989     1    11     0     0 PST   99900 1989-01-11 00:00:00
10 14211720  1989     1    11     0    10 PST   99900 1989-01-11 00:10:00
# ? with 64 more rows

So the gauge was pegged at its top end quite a few times over the years.
Makes me wonder just how much higher really was.

Carpe weekend,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Sat Dec  4 01:03:15 2021
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Fri, 3 Dec 2021 16:03:15 -0800 (PST)
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
 <dcdb237c-a7da-da8-ef6c-1dd79266167e@appl-ecosys.com>
Message-ID: <78a9e35b-bfd9-c153-189e-f57bcec97ef8@appl-ecosys.com>

On Fri, 3 Dec 2021, Rich Shepard wrote:

> they apparently do. For example, 99.9000 cubic feet per second is reached
                                    99,900

Rich


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec  4 08:33:46 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 4 Dec 2021 07:33:46 +0000
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
Message-ID: <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>

Hello,

You're right, I carelessly coded this.

which.max returns the index to the first maximum of a vector, while the 
comparison of a vector with its max() returns an index to all vector 
elements.

?s 23:27 de 03/12/21, Bert Gunter escreveu:
> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and
> cfs == ... are not the same:
> 
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
> 
> So maybe your point is: which does the OP want (in case there are
> repeated maxes)? I suspect the == forms, but ...?
> 
> Bert Gunter
> 
> On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Inline.
>>
>> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
>>> On Fri, 3 Dec 2021, Rich Shepard wrote:
>>>
>>>> I find solutions when the data_frame is grouped, but none when it's not.
>>>
>>> Thanks, Bert. ?which.max confirmed that's all I need to find the maximum
>>> value.
>>>
>>> Now I need to read more than ?filter to learn why I'm not getting the
>>> relevant row with:
>>>> which.max(pdx_disc$cfs)
>>> [1] 8054
>>
>> This is the *index* for which cfs is the first maximum, not the maximum
>> value itself.
>>
>>>
>>>> filter(pdx_disc, cfs == 8054)
>>
>> Therefore, you probably want any of

Should be "one of", not "any of"

Rui Barradas

>>
>>
>> filter(pdx_disc, cfs == cfs[8054])
>>
>> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>>
>> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>> # A tibble: 0 ? 9
>>> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
>>> #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
>>>
>>> Regards,
>>>
>>> Rich
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.


From @orenh @end|ng |rom m@th@@@u@dk  Sat Dec  4 16:54:57 2021
From: @orenh @end|ng |rom m@th@@@u@dk (=?utf-8?B?U8O4cmVuIEjDuGpzZ2FhcmQ=?=)
Date: Sat, 4 Dec 2021 15:54:57 +0000
Subject: [R] Handling dependencies on Bioconductor packages for packages on
 CRAN
Message-ID: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>

Dear all

My gRbase package imports the packages from Bioconductor: graph, RBGL and Rgraphviz

If these packages are not installed, then gRbase can not be installed. The error message is:

   ERROR: dependency ?graph? is not available for package ?gRbase?

If I, prior to installation, run setRepositories and highlight 'BioC software', then gRbase installs as it should, because the graph package from Bioconductor is installed along with it. However, this extra step is an obstacle to many users of the package which means that either people do not use the package or people ask questions about this issue on stack overflow, R-help, by email to me etc. It is not a problem to get the package on CRAN because, I guess, the CRAN check machines already have the three bioconductor packages installed.

Therefore, I wonder if there is a way of specifying, in the DESCRIPTION file or elsewhere, that these packages should be installed automatically from bioconductor.

An alternative would be if one could force the error message

   ERROR: dependency ?graph? is not available for package ?gRbase?

to be accompanied by a message about what the user then should do.

Any good suggestions? Thanks in advance.

Best regards
S?ren

	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Sat Dec  4 16:59:27 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sat, 4 Dec 2021 07:59:27 -0800
Subject: [R] 
 Handling dependencies on Bioconductor packages for packages on CRAN
In-Reply-To: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
References: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
Message-ID: <CAGxFJbQAo2NZGn4jVjRkZ-1dnZpYCM=LWTy_qOZk-SoU9gnPww@mail.gmail.com>

I suggest you post this on r-package-devel.  That seems a better fit.

Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Sat, Dec 4, 2021 at 7:55 AM S?ren H?jsgaard <sorenh at math.aau.dk> wrote:

> Dear all
>
> My gRbase package imports the packages from Bioconductor: graph, RBGL and
> Rgraphviz
>
> If these packages are not installed, then gRbase can not be installed. The
> error message is:
>
>    ERROR: dependency ?graph? is not available for package ?gRbase?
>
> If I, prior to installation, run setRepositories and highlight 'BioC
> software', then gRbase installs as it should, because the graph package
> from Bioconductor is installed along with it. However, this extra step is
> an obstacle to many users of the package which means that either people do
> not use the package or people ask questions about this issue on stack
> overflow, R-help, by email to me etc. It is not a problem to get the
> package on CRAN because, I guess, the CRAN check machines already have the
> three bioconductor packages installed.
>
> Therefore, I wonder if there is a way of specifying, in the DESCRIPTION
> file or elsewhere, that these packages should be installed automatically
> from bioconductor.
>
> An alternative would be if one could force the error message
>
>    ERROR: dependency ?graph? is not available for package ?gRbase?
>
> to be accompanied by a message about what the user then should do.
>
> Any good suggestions? Thanks in advance.
>
> Best regards
> S?ren
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Sat Dec  4 18:39:47 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Sat, 4 Dec 2021 12:39:47 -0500
Subject: [R] Find tibble row with maximum recorded value
In-Reply-To: <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>
References: <1a6458d9-47e0-678e-5ef6-64ee20af72f4@appl-ecosys.com>
 <b8971dc-d212-de5d-d9f5-b52a51ac8539@appl-ecosys.com>
 <88fd95e4-d0c6-cad9-914e-4c3f182455cc@sapo.pt>
 <CAGxFJbRzabmD3vg--iTA985cFcd9C2QXihGze0qjLEgRmeQFOw@mail.gmail.com>
 <625d5058-e9a5-00a7-9ffc-8810dcd45d54@sapo.pt>
Message-ID: <01d401d7e935$eed11fa0$cc735ee0$@verizon.net>

The right answer obviously depends on the REQUIREMENTS and they may not have been fully stated.

This is a bit like finding the mode of a set of numbers. The most frequent value may not be as representative of the data as the mean or even the median for some purposes, as well as other measures of central tendency.

What does Rich want? Choices can include getting the entire row where the value happens first, or maybe even the last or ALL of them as a group.

Be that as it may, if you return all of them, as a mini-data.frame, it is easy enough to then choose to keep them all, or just the first by subsetting  it to get row 1, or even to get the last row by applying nrow() to the result.

I can think of many ways you want an answer including beyond this, some kind of blending of the other columns you get back to make some kind of composite row from all the rows that matched.

Without clear requirements, there often is no right answer.

-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Rui Barradas
Sent: Saturday, December 4, 2021 2:34 AM
To: Bert Gunter <bgunter.4567 at gmail.com>
Cc: R-help <r-help at r-project.org>
Subject: Re: [R] Find tibble row with maximum recorded value

Hello,

You're right, I carelessly coded this.

which.max returns the index to the first maximum of a vector, while the comparison of a vector with its max() returns an index to all vector elements.

?s 23:27 de 03/12/21, Bert Gunter escreveu:
> Perhaps you meant to point this out, but the cfs[which.max(cfs)] and 
> cfs == ... are not the same:
> 
>> x <- rep(1:2,3)
>> x
> [1] 1 2 1 2 1 2
>> x[which.max(x)]
> [1] 2
>> x[x==max(x)]
> [1] 2 2 2
> 
> So maybe your point is: which does the OP want (in case there are 
> repeated maxes)? I suspect the == forms, but ...?
> 
> Bert Gunter
> 
> On Fri, Dec 3, 2021 at 2:56 PM Rui Barradas <ruipbarradas at sapo.pt> wrote:
>>
>> Hello,
>>
>> Inline.
>>
>> ?s 22:08 de 03/12/21, Rich Shepard escreveu:
>>> On Fri, 3 Dec 2021, Rich Shepard wrote:
>>>
>>>> I find solutions when the data_frame is grouped, but none when it's not.
>>>
>>> Thanks, Bert. ?which.max confirmed that's all I need to find the 
>>> maximum value.
>>>
>>> Now I need to read more than ?filter to learn why I'm not getting 
>>> the relevant row with:
>>>> which.max(pdx_disc$cfs)
>>> [1] 8054
>>
>> This is the *index* for which cfs is the first maximum, not the 
>> maximum value itself.
>>
>>>
>>>> filter(pdx_disc, cfs == 8054)
>>
>> Therefore, you probably want any of

Should be "one of", not "any of"

Rui Barradas

>>
>>
>> filter(pdx_disc, cfs == cfs[8054])
>>
>> filter(pdx_disc, cfs == cfs[which.max(cfs)])
>>
>> filter(pdx_disc, cfs == max(cfs))    # I find this one better, simpler
>>
>>
>> Hope this helps,
>>
>> Rui Barradas
>>
>>
>>> # A tibble: 0 ? 9
>>> # ? with 9 variables: site_nbr <chr>, year <int>, mon <int>, day <int>,
>>> #   hr <dbl>, min <dbl>, tz <chr>, cfs <dbl>, sampdt <dttm>
>>>
>>> Regards,
>>>
>>> Rich
>>>
>>> ______________________________________________
>>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>>> https://stat.ethz.ch/mailman/listinfo/r-help
>>> PLEASE do read the posting guide
>>> http://www.R-project.org/posting-guide.html
>>> and provide commented, minimal, self-contained, reproducible code.
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see 
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide 
>> http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


From S@ndhy@pr@k@@hyj97 @end|ng |rom out|ook@com  Mon Dec  6 14:33:50 2021
From: S@ndhy@pr@k@@hyj97 @end|ng |rom out|ook@com (Sandhya Prakash)
Date: Mon, 6 Dec 2021 13:33:50 +0000
Subject: [R] 
 Error: the leading minor of order 6 is not positive definite
In-Reply-To: <CAKZQJMA=+jz9iUG0HTByTo3m_dbnZg+teVEq6ArM42duL5c46A@mail.gmail.com>
References: <HKAPR01MB373096AF40371243EF9A3BB2DB819@HKAPR01MB3730.apcprd01.prod.exchangelabs.com>
 <CAKZQJMA=+jz9iUG0HTByTo3m_dbnZg+teVEq6ArM42duL5c46A@mail.gmail.com>
Message-ID: <HKAPR01MB3730E255A1788C0E888DE88ADB6D9@HKAPR01MB3730.apcprd01.prod.exchangelabs.com>

I will look into it sir if I don't get it I'll mail my code sir thakyou for your reply sir

Get Outlook for Android<https://aka.ms/AAb9ysg>
________________________________
From: John Kane <jrkrideau at gmail.com>
Sent: Thursday, October 28, 2021 9:27:06 PM
To: Sandhya Prakash <sandhyaprakashyj97 at outlook.com>
Cc: r-help at r-project.org <r-help at r-project.org>
Subject: Re: [R] Error: the leading minor of order 6 is not positive definite

I think we need the code you are running, any error messages you are
getting and some sample data. A handy way to supply sample data is to
use the dput() function. See ?dput.  If you have a very large data set
then something like head(dput(myfile), 100) will likely supply enough
data for us to work with.

On Mon, 25 Oct 2021 at 16:26, Sandhya Prakash
<Sandhyaprakashyj97 at outlook.com> wrote:
>
> Hi I'm too running a canonical correlation code but I'm getting my error like this can you please help me
>
> Get Outlook for Android<https://aka.ms/AAb9ysg>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.



--
John Kane
Kingston ON Canada

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec  6 18:32:20 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 6 Dec 2021 17:32:20 +0000 (UTC)
Subject: [R] GTsummary add title with multi row
References: <1243221180.3311066.1638811940179.ref@mail.yahoo.com>
Message-ID: <1243221180.3311066.1638811940179@mail.yahoo.com>

Hi R team,When I use GTsummary to run summary table, I can add table title by using?modify_caption() function. But it is one row title only.Is it possible to add title with multi rows for one summary table?Thanks,Kai
	[[alternative HTML version deleted]]


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec  6 18:47:29 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Mon, 6 Dec 2021 09:47:29 -0800
Subject: [R] GTsummary add title with multi row
In-Reply-To: <1243221180.3311066.1638811940179@mail.yahoo.com>
References: <1243221180.3311066.1638811940179.ref@mail.yahoo.com>
 <1243221180.3311066.1638811940179@mail.yahoo.com>
Message-ID: <CAGxFJbTU0pAD5ObCPZeMpis2-AY+u9TP3K7Dk7qsKJ4waqLjZw@mail.gmail.com>

Please read and follow the Posting Guide linked below, which says, among
other things:

"For questions about functions in standard packages distributed with R (see
the FAQ Add-on packages in R), ask questions on R-help.
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

If the question relates to a contributed package , e.g., one downloaded
from CRAN, try contacting the package maintainer first. You can also use
find("functionname") and packageDescription("packagename") to find this
information. Only send such questions to R-help or R-devel if you get no
reply or need further assistance. This applies to both requests for help
and to bug reports."

Note that RStudio maintains its own help resources at:
https://community.rstudio.com/
This is where questions about the TidyVerse, ggplot, etc. should be posted.


Bert Gunter

"The trouble with having an open mind is that people keep coming along and
sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Mon, Dec 6, 2021 at 9:32 AM Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hi R team,When I use GTsummary to run summary table, I can add table title
> by using modify_caption() function. But it is one row title only.Is it
> possible to add title with multi rows for one summary table?Thanks,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From ||809 @end|ng |rom nc|@c@  Tue Dec  7 01:33:25 2021
From: ||809 @end|ng |rom nc|@c@ (Brian Lunergan)
Date: Mon, 6 Dec 2021 19:33:25 -0500
Subject: [R] Puzzled about loading the Rattle interface package...
Message-ID: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>

Evening folks:

Hope I'm in the right place to ask this.

Running R 4.1.2 on Linux Mint 19.3. I do have R Commander and R Studio
in place and working, so I'm not without choices for a GUI to use R.
However, I wanted to try out the Rattle interface.

The package installs OK, but it apparently needs the RGtk2 package to
run its graphic state. When I try to install that package I get the
following:

> install.packages("RGtk2")
Installing package into ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1?
(as ?lib? is unspecified)
trying URL 'https://cloud.r-project.org/src/contrib/RGtk2_2.20.36.2.tar.gz'
Content type 'application/x-gzip' length 2792234 bytes (2.7 MB)
==================================================
downloaded 2.7 MB

* installing *source* package ?RGtk2? ...
** package ?RGtk2? successfully unpacked and MD5 sums checked
** using staged installation
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for INTROSPECTION... no
checking for GTK... no
configure: error: GTK version 2.8.0 required
ERROR: configuration failed for package ?RGtk2?
* removing ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1/RGtk2?

The downloaded source packages are in
	?/tmp/Rtmphfaxc3/downloaded_packages?
Warning message:
In install.packages("RGtk2") :
  installation of package ?RGtk2? had non-zero exit status
>

I'm at a bit of a loss as to how to solve this. Any help would be
appreciated. Otherwise, I guess I'd be SOL for trying it out and fall
back to my existing two options.

Thanks...
-- 
Brian Lunergan
Russell, ON
Canada




-------------- next part --------------
A non-text attachment was scrubbed...
Name: OpenPGP_signature
Type: application/pgp-signature
Size: 665 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20211206/c3d758ba/attachment.sig>

From er|cjberger @end|ng |rom gm@||@com  Tue Dec  7 12:34:59 2021
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 7 Dec 2021 13:34:59 +0200
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
Message-ID: <CAGgJW75gDVELg-gXmMTeX0vKjZ-YMA42wfvVrpakXeyQ05O5Sg@mail.gmail.com>

Hi Brian,
I have never tried Rattle but I did a quick search and found this link
which might give some clues.

https://book.huihoo.com/data-mining-desktop-survival-guide/Installing_GTK.html

Good luck,
Eric


On Tue, Dec 7, 2021 at 1:29 PM Brian Lunergan <ff809 at ncf.ca> wrote:
>
> Evening folks:
>
> Hope I'm in the right place to ask this.
>
> Running R 4.1.2 on Linux Mint 19.3. I do have R Commander and R Studio
> in place and working, so I'm not without choices for a GUI to use R.
> However, I wanted to try out the Rattle interface.
>
> The package installs OK, but it apparently needs the RGtk2 package to
> run its graphic state. When I try to install that package I get the
> following:
>
> > install.packages("RGtk2")
> Installing package into ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1?
> (as ?lib? is unspecified)
> trying URL 'https://cloud.r-project.org/src/contrib/RGtk2_2.20.36.2.tar.gz'
> Content type 'application/x-gzip' length 2792234 bytes (2.7 MB)
> ==================================================
> downloaded 2.7 MB
>
> * installing *source* package ?RGtk2? ...
> ** package ?RGtk2? successfully unpacked and MD5 sums checked
> ** using staged installation
> checking for pkg-config... /usr/bin/pkg-config
> checking pkg-config is at least version 0.9.0... yes
> checking for INTROSPECTION... no
> checking for GTK... no
> configure: error: GTK version 2.8.0 required
> ERROR: configuration failed for package ?RGtk2?
> * removing ?/home/brian/R/x86_64-pc-linux-gnu-library/4.1/RGtk2?
>
> The downloaded source packages are in
>         ?/tmp/Rtmphfaxc3/downloaded_packages?
> Warning message:
> In install.packages("RGtk2") :
>   installation of package ?RGtk2? had non-zero exit status
> >
>
> I'm at a bit of a loss as to how to solve this. Any help would be
> appreciated. Otherwise, I guess I'd be SOL for trying it out and fall
> back to my existing two options.
>
> Thanks...
> --
> Brian Lunergan
> Russell, ON
> Canada
>
>
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Tue Dec  7 12:44:50 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Tue, 7 Dec 2021 14:44:50 +0300
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
Message-ID: <20211207144450.12c98795@arachnoid>

On Mon, 6 Dec 2021 19:33:25 -0500
Brian Lunergan <ff809 at ncf.ca> wrote:

> Running R 4.1.2 on Linux Mint 19.3.

> configure: error: GTK version 2.8.0 required

Thanks for mentioning your GNU/Linux distro! You need the libgtk2.0-dev
APT package installed in order to build the RGtk2 R package from
source. Alternatively, if you use the distro-built R (installed via
APT), you can install the r-cran-rgtk2 APT package and avoid building
the RGtk2 package from source.
 
Ask in the R-SIG-Debian mailing list if your problems continue.

-- 
Best regards,
Ivan


From mtmorg@n@b|oc @end|ng |rom gm@||@com  Tue Dec  7 23:23:25 2021
From: mtmorg@n@b|oc @end|ng |rom gm@||@com (Martin Morgan)
Date: Tue, 7 Dec 2021 22:23:25 +0000
Subject: [R] 
 Handling dependencies on Bioconductor packages for packages on CRAN
In-Reply-To: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
References: <a77815a906d885f112e8d21d96bcb016785cf977.camel@math.aau.dk>
Message-ID: <BN8PR04MB6241A598EBC14229670AF759F96E9@BN8PR04MB6241.namprd04.prod.outlook.com>

One possibility is to make graph a Suggests: dependency, and preface any code using it (or, e.g., in an .onLoad function) with

  if (!requireNamespace("graph", quietly = TRUE))
    stop(
      "install the Bioconductor 'graph' package using these commands\n\n",
      ## standard Bioconductor package installation instructions
      "  if (!requireNamespace('BiocManager', quiety = TRUE))\n",
      "    install.packages('BiocManager')\n",
      "  BiocManager::install('graph')\n\n"
    )

Use graph:: for any function used in the graph package. The code could be simplified if BiocManager were an Imports: dependency of your package -- it would already be installed. The 'Suggests:' dependency would not cause problems with CRAN, because Suggest'ed packages are available when the package is built / checked.

The user experience of package installation would be 'non-standard' (didn't I just install gRbase??), so this is not an ideal solution.

Martin

?On 12/4/21, 10:55 AM, "R-help on behalf of S?ren H?jsgaard" <r-help-bounces at r-project.org on behalf of sorenh at math.aau.dk> wrote:

    Dear all

    My gRbase package imports the packages from Bioconductor: graph, RBGL and Rgraphviz

    If these packages are not installed, then gRbase can not be installed. The error message is:

       ERROR: dependency ?graph? is not available for package ?gRbase?

    If I, prior to installation, run setRepositories and highlight 'BioC software', then gRbase installs as it should, because the graph package from Bioconductor is installed along with it. However, this extra step is an obstacle to many users of the package which means that either people do not use the package or people ask questions about this issue on stack overflow, R-help, by email to me etc. It is not a problem to get the package on CRAN because, I guess, the CRAN check machines already have the three bioconductor packages installed.

    Therefore, I wonder if there is a way of specifying, in the DESCRIPTION file or elsewhere, that these packages should be installed automatically from bioconductor.

    An alternative would be if one could force the error message

       ERROR: dependency ?graph? is not available for package ?gRbase?

    to be accompanied by a message about what the user then should do.

    Any good suggestions? Thanks in advance.

    Best regards
    S?ren

    	[[alternative HTML version deleted]]

    ______________________________________________
    R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
    https://stat.ethz.ch/mailman/listinfo/r-help
    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
    and provide commented, minimal, self-contained, reproducible code.

From ||809 @end|ng |rom nc|@c@  Tue Dec  7 23:43:59 2021
From: ||809 @end|ng |rom nc|@c@ (Brian Lunergan)
Date: Tue, 7 Dec 2021 17:43:59 -0500
Subject: [R] Puzzled about loading the Rattle interface package...
In-Reply-To: <20211207144450.12c98795@arachnoid>
References: <bbc71d93-80c5-1ca2-2d24-ef21bdba417a@ncf.ca>
 <20211207144450.12c98795@arachnoid>
Message-ID: <44d374cb-6d43-a083-1bd9-f59b41e9951c@ncf.ca>

On 2021-12-07 6:44 a.m., Ivan Krylov wrote:
> On Mon, 6 Dec 2021 19:33:25 -0500
> Brian Lunergan <ff809 at ncf.ca> wrote:
> 
>> Running R 4.1.2 on Linux Mint 19.3.
> 
>> configure: error: GTK version 2.8.0 required
> 
> Thanks for mentioning your GNU/Linux distro! You need the libgtk2.0-dev
> APT package installed in order to build the RGtk2 R package from
> source. Alternatively, if you use the distro-built R (installed via
> APT), you can install the r-cran-rgtk2 APT package and avoid building
> the RGtk2 package from sour
Thanks for the note. First step was:

sudo apt-get install libgtk2.0-dev

Requested pkg plus a couple of suggestions installed just fine. Then
fired up R and hit it with:

install.packages("RGtk2")

Request worked just fine. Final moves:

library(rattle)
rattle()

And up pops the interface. I now have 3 well functioning choices for a
GUI for R.

Thanks again for the assist.
-- 
Brian Lunergan
Russell, ON
Canada


-------------- next part --------------
A non-text attachment was scrubbed...
Name: OpenPGP_signature
Type: application/pgp-signature
Size: 665 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-help/attachments/20211207/0c600529/attachment.sig>

From kry|ov@r00t @end|ng |rom gm@||@com  Wed Dec  8 14:52:00 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Wed, 8 Dec 2021 16:52:00 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
Message-ID: <20211208165200.203ae1f4@arachnoid>

Got some progress on this, but still not sure how to continue. First, a
much more simple script reproducing the behaviour that confuses me:

foo <- function(x, ...) structure(x, class = 'foo')
`[.foo` <- function(x, i, ..., drop = TRUE) {
	print(sys.call())
	print(match.call())
	foo(NextMethod()) # x[] should return an object of class foo
}
`[<-.foo` <- function(x, i, ..., value) {
	print(sys.call())
	print(match.call())
	x[i, ..., drop = FALSE]
	# imagine that we need to perform some checks on the
	# subset of x that we're about to replace
	NextMethod()
}

x <- foo(42)
x[]      # this works
x[] <- 1 # this doesn't

Now, the crucial difference between the x[] and x[] <- 1 calls is that
in the former case, the `i` argument isn't even specified:

x[]
# `[.foo`(x, )
# `[.foo`(x = x)
# [1] 42
# attr(,"class")
# [1] "foo"

While in the latter case, `i` is specified in the x[] call (but
missing):

x[] <- 1
# `[<-.foo`(`*tmp*`, , value = 1)
# `[<-.foo`(x = `*tmp*`, value = 1)
# x[i, ..., drop = FALSE]
# `[.foo`(x = x, i = i, drop = FALSE)
Error in NextMethod() : argument "i" is missing, with no default

What's the best way to forward the arguments from [<-.class methods to
the [.class methods in order to handle cases like x[] properly?

-- 
Best regards,
Ivan


From bgunter@4567 @end|ng |rom gm@||@com  Wed Dec  8 16:57:23 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Wed, 8 Dec 2021 07:57:23 -0800
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211208165200.203ae1f4@arachnoid>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
Message-ID: <CAGxFJbT7XUYk13i809JLsqkj2gC_ai4zqHb6AJBq3s=CAMMN=w@mail.gmail.com>

I haven't followed this thread, so this may be stupid, but have you
looked at the do.call(`[`,...) idiom? Something like:

 x <- array(1:8, c(2,2,2))
> x
, , 1

     [,1] [,2]
[1,]    1    3
[2,]    2    4

, , 2

     [,1] [,2]
[1,]    5    7
[2,]    6    8

> l <- as.list(rep(TRUE, 2))
> do.call(`[`, c(list(x), l, list(1, drop = TRUE)))
     [,1] [,2]
[1,]    1    3
[2,]    2    4

Feel free to ignore without comment if this is unhelpful.


Bert Gunter

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Wed, Dec 8, 2021 at 5:52 AM Ivan Krylov <krylov.r00t at gmail.com> wrote:
>
> Got some progress on this, but still not sure how to continue. First, a
> much more simple script reproducing the behaviour that confuses me:
>
> foo <- function(x, ...) structure(x, class = 'foo')
> `[.foo` <- function(x, i, ..., drop = TRUE) {
>         print(sys.call())
>         print(match.call())
>         foo(NextMethod()) # x[] should return an object of class foo
> }
> `[<-.foo` <- function(x, i, ..., value) {
>         print(sys.call())
>         print(match.call())
>         x[i, ..., drop = FALSE]
>         # imagine that we need to perform some checks on the
>         # subset of x that we're about to replace
>         NextMethod()
> }
>
> x <- foo(42)
> x[]      # this works
> x[] <- 1 # this doesn't
>
> Now, the crucial difference between the x[] and x[] <- 1 calls is that
> in the former case, the `i` argument isn't even specified:
>
> x[]
> # `[.foo`(x, )
> # `[.foo`(x = x)
> # [1] 42
> # attr(,"class")
> # [1] "foo"
>
> While in the latter case, `i` is specified in the x[] call (but
> missing):
>
> x[] <- 1
> # `[<-.foo`(`*tmp*`, , value = 1)
> # `[<-.foo`(x = `*tmp*`, value = 1)
> # x[i, ..., drop = FALSE]
> # `[.foo`(x = x, i = i, drop = FALSE)
> Error in NextMethod() : argument "i" is missing, with no default
>
> What's the best way to forward the arguments from [<-.class methods to
> the [.class methods in order to handle cases like x[] properly?
>
> --
> Best regards,
> Ivan
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From m@ech|er @end|ng |rom @t@t@m@th@ethz@ch  Thu Dec  9 15:47:02 2021
From: m@ech|er @end|ng |rom @t@t@m@th@ethz@ch (Martin Maechler)
Date: Thu, 9 Dec 2021 15:47:02 +0100
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <20211208165200.203ae1f4@arachnoid>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
Message-ID: <25010.5862.561615.738945@stat.math.ethz.ch>

>>>>> Ivan Krylov 
>>>>>     on Wed, 8 Dec 2021 16:52:00 +0300 writes:

I have always learnt a lot about programming when reading other
people's code .. notably if those people new what they are
doing.

In this case, studying R-core's

`[.data.frame`  and

`[<-.data.frame`

{or for S4 methods, the 'Matrix' or 'Rmpfr' packages}

should show you a lot.

What you should take from there:
Do work with *both*
    missing(drop)
and
    nargs()

(and more)
in order to distinguish m[i] from m[i,] etc


Best,
Martin


    > Got some progress on this, but still not sure how to continue. First, a
    > much more simple script reproducing the behaviour that confuses me:

> foo <- function(x, ...) structure(x, class = 'foo')
> `[.foo` <- function(x, i, ..., drop = TRUE) {
> 	print(sys.call())
> 	print(match.call())
> 	foo(NextMethod()) # x[] should return an object of class foo
> }
> `[<-.foo` <- function(x, i, ..., value) {
> 	print(sys.call())
> 	print(match.call())
> 	x[i, ..., drop = FALSE]
> 	# imagine that we need to perform some checks on the
> 	# subset of x that we're about to replace
> 	NextMethod()
> }
> 
> x <- foo(42)
> x[]      # this works
> x[] <- 1 # this doesn't
> 
> Now, the crucial difference between the x[] and x[] <- 1 calls is that
> in the former case, the `i` argument isn't even specified:
> 
> x[]
> # `[.foo`(x, )
> # `[.foo`(x = x)
> # [1] 42
> # attr(,"class")
> # [1] "foo"
> 
> While in the latter case, `i` is specified in the x[] call (but
> missing):
> 
> x[] <- 1
> # `[<-.foo`(`*tmp*`, , value = 1)
> # `[<-.foo`(x = `*tmp*`, value = 1)
> # x[i, ..., drop = FALSE]
> # `[.foo`(x = x, i = i, drop = FALSE)
> Error in NextMethod() : argument "i" is missing, with no default
> 
> What's the best way to forward the arguments from [<-.class methods to
> the [.class methods in order to handle cases like x[] properly?
> 
> -- 
> Best regards,
> Ivan
> 
> ______________________________________________


From |ortune4me32 @end|ng |rom gm@||@com  Wed Dec  8 21:19:06 2021
From: |ortune4me32 @end|ng |rom gm@||@com (Ekene Esiaka)
Date: Thu, 9 Dec 2021 00:19:06 +0400
Subject: [R] Error in loading tidyverse library
Message-ID: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>

Tidyverse cannot load on my rstudio as seen below.

Thanks for your understanding.

From bgunter@4567 @end|ng |rom gm@||@com  Thu Dec  9 21:04:01 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Thu, 9 Dec 2021 12:04:01 -0800
Subject: [R] Error in loading tidyverse library
In-Reply-To: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>
References: <CAFx2afecn_6KMohT-Mwo=eFxUsp7Y+Ru=vKydK52C7=7uZWc2w@mail.gmail.com>
Message-ID: <CAGxFJbR9nrBBezUymMTTNnA7EOn=HENyiERVbQNL9KY=x-mpGw@mail.gmail.com>

1. There is no "below" . Most attachments are stripped by the mail server.

2. Please read and follow the Posting Guide linked below. Your post did not.

3. RStudio is **not** R. In particular, the so-called TidyVerse
consists of all *non*-standard contributed packages, about which the
Posting Guide says:

"For questions about functions in standard packages distributed with R
(see the FAQ Add-on packages in R), ask questions on R-help.
[The link is:
https://cran.r-project.org/doc/FAQ/R-FAQ.html#Add-on-packages-in-R
This gives the list of current _standard_ packages]

If the question relates to a contributed package , e.g., one
downloaded from CRAN, try contacting the package maintainer first. You
can also use find("functionname") and
packageDescription("packagename") to find this information. Only send
such questions to R-help or R-devel if you get no reply or need
further assistance. This applies to both requests for help and to bug
reports."

Note that RStudio maintains its own help resources at:
https://community.rstudio.com/
This is where questions about the TidyVerse, ggplot, etc. should be posted.

Bert Gunter

"The trouble with having an open mind is that people keep coming along
and sticking things into it."
-- Opus (aka Berkeley Breathed in his "Bloom County" comic strip )


On Thu, Dec 9, 2021 at 11:59 AM Ekene Esiaka <fortune4me32 at gmail.com> wrote:
>
> Tidyverse cannot load on my rstudio as seen below.
>
> Thanks for your understanding.
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.


From kry|ov@r00t @end|ng |rom gm@||@com  Fri Dec 10 15:20:39 2021
From: kry|ov@r00t @end|ng |rom gm@||@com (Ivan Krylov)
Date: Fri, 10 Dec 2021 17:20:39 +0300
Subject: [R] Forwarding missing arguments to the `[` method
In-Reply-To: <25010.5862.561615.738945@stat.math.ethz.ch>
References: <20211202235711.203958c0@Tarkus> <20211203000001.58aba4d6@Tarkus>
 <6848253E-EA56-4C2E-B78A-5BDCEA571922@dcn.davis.ca.us>
 <20211208165200.203ae1f4@arachnoid>
 <25010.5862.561615.738945@stat.math.ethz.ch>
Message-ID: <20211210172039.13569c7e@arachnoid>

On Thu, 9 Dec 2021 15:47:02 +0100
Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> What you should take from there:
> Do work with *both*
>     missing(drop)
> and
>     nargs()
> 
> (and more)
> in order to distinguish m[i] from m[i,] etc

Thanks for the advice! `[<-.data.frame` does make for enlightening
reading. 

I've also considered editing the call, like lm() does:

`[<-.foo` <- function(x, i, ..., value) {
	cl <- match.call(expand.dots = FALSE)
	cl[[1L]] <- quote(`[`)
	cl$value <- NULL
	x.subset <- eval(cl, parent.frame())
	# ... checks on x.subset ...
	NextMethod()
}

...but that fails _some_ of my tests (but not others) with "object
`*tmp*` not found"). Non-standard evaluation is probably not the answer
here. I'll have to handle the forms of the call with different nargs()
manually and separately.

-- 
Best regards,
Ivan


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 11:47:21 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 10:47:21 +0000 (UTC)
Subject: [R] Repeating a R code and counting how many repetitions working
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
Message-ID: <1386111968.1475570.1639219641470@mail.yahoo.com>

Dear R-experts,

Here below my R code. I am trying to do 2 things :

1) I would like to repeat this R code 10000 times

2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.

Many thanks for your precious help.

########################################
library(boot)

s= sample(178:798, 10000, replace=TRUE)
mean(s)

a=sample(s,size=5)
mean(a)

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
mean(temp)

}
boot.out<-boot(data=dat,statistic=med,R=10000)
boot.ci(boot.out,type="bca")
########################################


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec 11 12:55:37 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 11 Dec 2021 11:55:37 +0000
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <1386111968.1475570.1639219641470@mail.yahoo.com>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
Message-ID: <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>

Hello,

The problem can be solved with ?replicate.
in the code below I only repeat N <- 1e3, not 1e4.


set.seed(2021)
N <- 1e3
out <- replicate(N, {
   boot.out <- boot(data = dat, statistic = med, R = 10000)
   boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])


Hope this helps,

Rui Barradas

?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. I am trying to do 2 things :
> 
> 1) I would like to repeat this R code 10000 times
> 
> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
> 
> Many thanks for your precious help.
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> boot.out<-boot(data=dat,statistic=med,R=10000)
> boot.ci(boot.out,type="bca")
> ########################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 16:37:10 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 15:37:10 +0000 (UTC)
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
Message-ID: <962792240.1594071.1639237030530@mail.yahoo.com>

Dear Rui,

I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1

########################################
library(boot)

s= sample(178:798, 10000, replace=TRUE)
mean(s)

a=sample(s,size=5)
mean(a)

dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,]
mean(temp)
}

N <- 100
out <- replicate(N, {
? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])
########################################







Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

The problem can be solved with ?replicate.
in the code below I only repeat N <- 1e3, not 1e4.


set.seed(2021)
N <- 1e3
out <- replicate(N, {
? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])


Hope this helps,

Rui Barradas

?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
> Dear R-experts,
> 
> Here below my R code. I am trying to do 2 things :
> 
> 1) I would like to repeat this R code 10000 times
> 
> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
> 
> Many thanks for your precious help.
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> 
> }
> boot.out<-boot(data=dat,statistic=med,R=10000)
> boot.ci(boot.out,type="bca")
> ########################################
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
> 


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sat Dec 11 21:29:15 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sat, 11 Dec 2021 20:29:15 +0000
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <962792240.1594071.1639237030530@mail.yahoo.com>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
 <962792240.1594071.1639237030530@mail.yahoo.com>
Message-ID: <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>

Hello,

As for the code, I think it's simple. Before calling boot.ci you need to 
call boot. And replicate calls the expression between {} N times. After 
running boot.ci, the component bca is extracted. See ?boot.ci, section 
Value, after bca:


These latter four components will be matrices with 5 columns, the first 
column containing the level, the next two containing the indices of the 
order statistics used in the calculations and the final two the 
calculated endpoints themselves.


The four components are all intervals but normal, which is a matrix with 
3 columns only.
So I extract the 4th and 5th columns.


boot.ci(boot.out, type = "bca")$bca[, 4:5]


Also, try dropping the dimensions in the med function.


med <- function(d, i) {
   temp <- d[i, , drop = TRUE]
   mean(temp)
}


Your sample a is so small that there are only 3125 arrangements with 
repetition, and only 111 different mean values of those arrangements.

arr <- RcppAlgos::permuteGeneral(a, length(a), repetition = TRUE)
dim(arr)
#[1] 3125    5

length(table( rowMeans(arr) ))
#[1] 111



Now, the equal values. The return value of 1 means that all BCa 
intervals include mean(s). The outer mean(.) is a mean of an indicator 
function given by a logical conjunction. And there are only TRUE's.

Hope this helps,

Rui Barradas


?s 15:37 de 11/12/21, varin sacha escreveu:
> Dear Rui,
> 
> I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
> Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> }
> 
> N <- 100
> out <- replicate(N, {
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################
> 
> 
> 
> 
> 
> 
> 
> Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit :
> 
> 
> 
> 
> 
> Hello,
> 
> The problem can be solved with ?replicate.
> in the code below I only repeat N <- 1e3, not 1e4.
> 
> 
> set.seed(2021)
> N <- 1e3
> out <- replicate(N, {
>  ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>  ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
>> Dear R-experts,
>>
>> Here below my R code. I am trying to do 2 things :
>>
>> 1) I would like to repeat this R code 10000 times
>>
>> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
>>
>> Many thanks for your precious help.
>>
>> ########################################
>> library(boot)
>>
>> s= sample(178:798, 10000, replace=TRUE)
>> mean(s)
>>
>> a=sample(s,size=5)
>> mean(a)
>>
>> dat<-data.frame(a)
>> med<-function(d,i) {
>> temp<-d[i,]
>> mean(temp)
>>
>> }
>> boot.out<-boot(data=dat,statistic=med,R=10000)
>> boot.ci(boot.out,type="bca")
>> ########################################
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>


From v@r|n@@ch@ @end|ng |rom y@hoo@|r  Sat Dec 11 22:35:23 2021
From: v@r|n@@ch@ @end|ng |rom y@hoo@|r (varin sacha)
Date: Sat, 11 Dec 2021 21:35:23 +0000 (UTC)
Subject: [R] 
 Repeating a R code and counting how many repetitions working
In-Reply-To: <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>
References: <1386111968.1475570.1639219641470.ref@mail.yahoo.com>
 <1386111968.1475570.1639219641470@mail.yahoo.com>
 <ff36571e-9a5c-6709-81cc-09ab0939f2ef@sapo.pt>
 <962792240.1594071.1639237030530@mail.yahoo.com>
 <832b2c29-10d5-b63c-1d5c-3cb0ea316652@sapo.pt>
Message-ID: <1121837911.1668812.1639258523244@mail.yahoo.com>

Dear Rui,

Many thanks, I got it now, thanks.

In my R code, I have moved the replication term 
N <-1000
out <- replicate(N, {

This time I get what I am looking for.

########################################
library(boot)

s<- sample(178:798, 10000, replace=TRUE)
mean(s)

N <- 10000
out <- replicate(N, {
a<- sample(s,size=5)
mean(a)
dat<-data.frame(a)
med<-function(d,i) {
temp<-d[i,,drop=TRUE]
mean(temp)
}

? boot.out <- boot(data = dat, statistic = med, R = 10000)
? boot.ci(boot.out, type = "bca")$bca[, 4:5]
})
mean(out[1,] < mean(s) & mean(s) < out[2,])
########################################




Le samedi 11 d?cembre 2021, 21:29:18 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit : 





Hello,

As for the code, I think it's simple. Before calling boot.ci you need to 
call boot. And replicate calls the expression between {} N times. After 
running boot.ci, the component bca is extracted. See ?boot.ci, section 
Value, after bca:


These latter four components will be matrices with 5 columns, the first 
column containing the level, the next two containing the indices of the 
order statistics used in the calculations and the final two the 
calculated endpoints themselves.


The four components are all intervals but normal, which is a matrix with 
3 columns only.
So I extract the 4th and 5th columns.


boot.ci(boot.out, type = "bca")$bca[, 4:5]


Also, try dropping the dimensions in the med function.


med <- function(d, i) {
? temp <- d[i, , drop = TRUE]
? mean(temp)
}


Your sample a is so small that there are only 3125 arrangements with 
repetition, and only 111 different mean values of those arrangements.

arr <- RcppAlgos::permuteGeneral(a, length(a), repetition = TRUE)
dim(arr)
#[1] 3125? ? 5

length(table( rowMeans(arr) ))
#[1] 111



Now, the equal values. The return value of 1 means that all BCa 
intervals include mean(s). The outer mean(.) is a mean of an indicator 
function given by a logical conjunction. And there are only TRUE's.

Hope this helps,

Rui Barradas


?s 15:37 de 11/12/21, varin sacha escreveu:
> Dear Rui,
> 
> I really thank you a lot for your response. Even if I don't fully understand your R code, there is something strange happening while running the code.
> Indeed, I have run this R code here below 20 times and I always got the same answer : [1] 1
> 
> ########################################
> library(boot)
> 
> s= sample(178:798, 10000, replace=TRUE)
> mean(s)
> 
> a=sample(s,size=5)
> mean(a)
> 
> dat<-data.frame(a)
> med<-function(d,i) {
> temp<-d[i,]
> mean(temp)
> }
> 
> N <- 100
> out <- replicate(N, {
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> ########################################
> 
> 
> 
> 
> 
> 
> 
> Le samedi 11 d?cembre 2021, 12:55:43 UTC+1, Rui Barradas <ruipbarradas at sapo.pt> a ?crit :
> 
> 
> 
> 
> 
> Hello,
> 
> The problem can be solved with ?replicate.
> in the code below I only repeat N <- 1e3, not 1e4.
> 
> 
> set.seed(2021)
> N <- 1e3
> out <- replicate(N, {
>? ? boot.out <- boot(data = dat, statistic = med, R = 10000)
>? ? boot.ci(boot.out, type = "bca")$bca[, 4:5]
> })
> mean(out[1,] < mean(s) & mean(s) < out[2,])
> 
> 
> Hope this helps,
> 
> Rui Barradas
> 
> ?s 10:47 de 11/12/21, varin sacha via R-help escreveu:
>> Dear R-experts,
>>
>> Here below my R code. I am trying to do 2 things :
>>
>> 1) I would like to repeat this R code 10000 times
>>
>> 2) Out of the 10000 repetitions I would have liked R to tell me how many times the "true" mean value of the population called "s" in my R example here below is included in the 10000 BCa confidence intervals constructed.
>>
>> Many thanks for your precious help.
>>
>> ########################################
>> library(boot)
>>
>> s= sample(178:798, 10000, replace=TRUE)
>> mean(s)
>>
>> a=sample(s,size=5)
>> mean(a)
>>
>> dat<-data.frame(a)
>> med<-function(d,i) {
>> temp<-d[i,]
>> mean(temp)
>>
>> }
>> boot.out<-boot(data=dat,statistic=med,R=10000)
>> boot.ci(boot.out,type="bca")
>> ########################################
>>
>> ______________________________________________
>> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
>>


From @k@h@y_e4 @end|ng |rom hotm@||@com  Sun Dec 12 17:43:44 2021
From: @k@h@y_e4 @end|ng |rom hotm@||@com (akshay kulkarni)
Date: Sun, 12 Dec 2021 16:43:44 +0000
Subject: [R] help with parellel processing and RSelenium
Message-ID: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>

dear members,
                         I am a stock trader based in INDIA using R for my research. I have two questions:


  1.  I want to send the same function with different arguments to different cores. This link in SO https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
  2.  gives the following solution:

   library(parallel)

cl <- makeCluster(4)
clusterExport(cl, "foo")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {
  if (core == 1) {
    foo(5, 4, 1/2, 3, "a")
  } else if (core == 2) {
    foo(5, 3, 1/3, 1, "b")
  } else if (core == 3) {
    foo(5, 4, 1/4, 1, "c")
  } else if (core == 4) {
    foo(5, 2, 1/5, 0, "d")
  }})

My question is: what is the structure of the output "r" in the above code? I think it is a list with r[[1]] = output of foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")

and so on. AM I right?

  1.

I am using RSelenium to scrape a website. Javascript has a document.ready function which ensures that any JS code is run only after the whole document is

  *

loaded. Is there a similar function in RSelenium? Or will the execution of the next expression takes place only after the whole page is loaded (with the

  *

"navigate" method of RSelenium)?

Thanking you,

Yours sincerely,

AKSHAY M KULKARNI




	[[alternative HTML version deleted]]


From ru|pb@rr@d@@ @end|ng |rom @@po@pt  Sun Dec 12 18:12:17 2021
From: ru|pb@rr@d@@ @end|ng |rom @@po@pt (Rui Barradas)
Date: Sun, 12 Dec 2021 17:12:17 +0000
Subject: [R] help with parellel processing and RSelenium
In-Reply-To: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
References: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
Message-ID: <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>

Hello,

Inline.

?s 16:43 de 12/12/21, akshay kulkarni escreveu:
> dear members,
>                           I am a stock trader based in INDIA using R for my research. I have two questions:
> 
> 
>    1.  I want to send the same function with different arguments to different cores. This link in SO https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
>    2.  gives the following solution:
> 
>     library(parallel)
> 
> cl <- makeCluster(4)
> clusterExport(cl, "foo")
> cores <- seq_along(cl)
> r <- clusterApply(cl[cores], cores, function(core) {
>    if (core == 1) {
>      foo(5, 4, 1/2, 3, "a")
>    } else if (core == 2) {
>      foo(5, 3, 1/3, 1, "b")
>    } else if (core == 3) {
>      foo(5, 4, 1/4, 1, "c")
>    } else if (core == 4) {
>      foo(5, 2, 1/5, 0, "d")
>    }})
> 
> My question is: what is the structure of the output "r" in the above code? I think it is a list with r[[1]] = output of foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")
> 
> and so on. AM I right?

Yes, you are right. Why don't you try and print r[[1]]?

Anyway, I would put the parameters in a list and pass them to the 
function following the below lines.


library(parallel)

foo <- function(pars){
   x <- pars$x
   y <- pars$y
   z <- pars$z
   w <- pars$w
   alpha <- pars$alpha
   res <- (x + y)*z^w
   list(result = res, message = alpha)
}
params <- list(
   list(x=5, y=4, z=1/2, w=3, alpha="a"),
   list(x=5, y=3, z=1/3, w=1, alpha="b"),
   list(x=5, y=4, z=1/4, w=1, alpha="c"),
   list(x=5, y=2, z=1/5, w=0, alpha="d")
)

cl <- makeCluster(4)
clusterExport(cl, "foo")
clusterExport(cl, "params")
cores <- seq_along(cl)
r <- clusterApply(cl[cores], cores, function(core) {
   foo(params[[core]])
})
stopCluster(cl)

do.call(rbind.data.frame, r)


Hope this helps,

Rui Barradas


> 
>    1.
> 
> I am using RSelenium to scrape a website. Javascript has a document.ready function which ensures that any JS code is run only after the whole document is
> 
>    *
> 
> loaded. Is there a similar function in RSelenium? Or will the execution of the next expression takes place only after the whole page is loaded (with the
> 
>    *
> 
> "navigate" method of RSelenium)?
> 
> Thanking you,
> 
> Yours sincerely,
> 
> AKSHAY M KULKARNI
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From bgunter@4567 @end|ng |rom gm@||@com  Mon Dec 13 00:05:43 2021
From: bgunter@4567 @end|ng |rom gm@||@com (Bert Gunter)
Date: Sun, 12 Dec 2021 15:05:43 -0800
Subject: [R] help with parellel processing and RSelenium
In-Reply-To: <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
References: <PU4P216MB1568176D8E2D12B18E55FD0BC8739@PU4P216MB1568.KORP216.PROD.OUTLOOK.COM>
 <aa97559a-2bf6-3442-956e-f7834fe2c2fc@sapo.pt>
Message-ID: <CAGxFJbRtRZ9fMbZRPO0ABoH63rsZeBL+a-ekxygny45oi66_jQ@mail.gmail.com>

I would suggest instead:

foo <- function(pars){
   with(pars,
   (res <- (x + y)*z^w
   list(result = res, message = alpha) ))
}

On Sun, Dec 12, 2021, 9:12 AM Rui Barradas <ruipbarradas at sapo.pt> wrote:

> Hello,
>
> Inline.
>
> ?s 16:43 de 12/12/21, akshay kulkarni escreveu:
> > dear members,
> >                           I am a stock trader based in INDIA using R for
> my research. I have two questions:
> >
> >
> >    1.  I want to send the same function with different arguments to
> different cores. This link in SO
> https://stackoverflow.com/questions/25045998/send-function-calls-with-different-arguments-to-different-processors-in-r-using
> >    2.  gives the following solution:
> >
> >     library(parallel)
> >
> > cl <- makeCluster(4)
> > clusterExport(cl, "foo")
> > cores <- seq_along(cl)
> > r <- clusterApply(cl[cores], cores, function(core) {
> >    if (core == 1) {
> >      foo(5, 4, 1/2, 3, "a")
> >    } else if (core == 2) {
> >      foo(5, 3, 1/3, 1, "b")
> >    } else if (core == 3) {
> >      foo(5, 4, 1/4, 1, "c")
> >    } else if (core == 4) {
> >      foo(5, 2, 1/5, 0, "d")
> >    }})
> >
> > My question is: what is the structure of the output "r" in the above
> code? I think it is a list with r[[1]] = output of
> foo(5,4,1/2,3,"a"),r[[2]] = output of foo(5,1/3,1,"b")
> >
> > and so on. AM I right?
>
> Yes, you are right. Why don't you try and print r[[1]]?
>
> Anyway, I would put the parameters in a list and pass them to the
> function following the below lines.
>
>
> library(parallel)
>
> foo <- function(pars){
>    x <- pars$x
>    y <- pars$y
>    z <- pars$z
>    w <- pars$w
>    alpha <- pars$alpha
>    res <- (x + y)*z^w
>    list(result = res, message = alpha)
> }
> params <- list(
>    list(x=5, y=4, z=1/2, w=3, alpha="a"),
>    list(x=5, y=3, z=1/3, w=1, alpha="b"),
>    list(x=5, y=4, z=1/4, w=1, alpha="c"),
>    list(x=5, y=2, z=1/5, w=0, alpha="d")
> )
>
> cl <- makeCluster(4)
> clusterExport(cl, "foo")
> clusterExport(cl, "params")
> cores <- seq_along(cl)
> r <- clusterApply(cl[cores], cores, function(core) {
>    foo(params[[core]])
> })
> stopCluster(cl)
>
> do.call(rbind.data.frame, r)
>
>
> Hope this helps,
>
> Rui Barradas
>
>
> >
> >    1.
> >
> > I am using RSelenium to scrape a website. Javascript has a
> document.ready function which ensures that any JS code is run only after
> the whole document is
> >
> >    *
> >
> > loaded. Is there a similar function in RSelenium? Or will the execution
> of the next expression takes place only after the whole page is loaded
> (with the
> >
> >    *
> >
> > "navigate" method of RSelenium)?
> >
> > Thanking you,
> >
> > Yours sincerely,
> >
> > AKSHAY M KULKARNI
> >
> >
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> > https://stat.ethz.ch/mailman/listinfo/r-help
> > PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> > and provide commented, minimal, self-contained, reproducible code.
> >
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec 13 05:30:11 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 13 Dec 2021 04:30:11 +0000 (UTC)
Subject: [R] subset data frame problem
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
Message-ID: <1544959082.741682.1639369811604@mail.yahoo.com>

Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
but the code return a wrong result. Can someone help me for this??
Thanks,Kai
	[[alternative HTML version deleted]]


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 13 05:46:49 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Sun, 12 Dec 2021 20:46:49 -0800
Subject: [R] subset data frame problem
In-Reply-To: <1544959082.741682.1639369811604@mail.yahoo.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
Message-ID: <FAA748FD-6726-4792-B27C-D202C6F3529F@dcn.davis.ca.us>

Use one ampersand, not two.

And post plain text.

On December 12, 2021 8:30:11 PM PST, Kai Yang via R-help <r-help at r-project.org> wrote:
>Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
>but the code return a wrong result. Can someone help me for this??
>Thanks,Kai
>	[[alternative HTML version deleted]]
>
>______________________________________________
>R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
>https://stat.ethz.ch/mailman/listinfo/r-help
>PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>and provide commented, minimal, self-contained, reproducible code.

-- 
Sent from my phone. Please excuse my brevity.


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 13:00:20 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 01:00:20 +1300
Subject: [R] subset data frame problem
In-Reply-To: <1544959082.741682.1639369811604@mail.yahoo.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
Message-ID: <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>

You want to DELETE rows satisfying the condition P & Q.
The subset() function requires an expression saying what
you want to RETAIN, so you need subset(PD, !(P & Q)).

test <- subset(PD, !(Class == "1st" & Survived == "No"))

By de Morgan's laws, !(P & Q) is the same as (!P) | (!Q)
so you could also write

test <- subset(PD, Class != "1st" | Survived != "No")

I'd actually be tempted to do this in two steps:

unwanted <- PD$Class == "1st" & PD$Survived == "No"
test <- PD[!unwanted,]




On Mon, 13 Dec 2021 at 17:30, Kai Yang via R-help <r-help at r-project.org>
wrote:

> Hi R team,I want to delete records from a data frame if Class = '1st' and
> Survived = 'No'. I wrote the code below, test <- subset(PD, Class != '1st'
> && Survived != 'No')
> but the code return a wrong result. Can someone help me for this?
> Thanks,Kai
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From y@ngk@|9999 @end|ng |rom y@hoo@com  Mon Dec 13 17:30:24 2021
From: y@ngk@|9999 @end|ng |rom y@hoo@com (Kai Yang)
Date: Mon, 13 Dec 2021 16:30:24 +0000 (UTC)
Subject: [R] subset data frame problem
In-Reply-To: <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>
References: <1544959082.741682.1639369811604.ref@mail.yahoo.com>
 <1544959082.741682.1639369811604@mail.yahoo.com>
 <CABcYAdJW3de20oN3zfs2CygGOAS4J_U+n1tffEbQqqpr8BnMmQ@mail.gmail.com>
Message-ID: <263901411.834130.1639413024738@mail.yahoo.com>

 Thans Richard, it works well. --- Kai
    On Monday, December 13, 2021, 04:00:33 AM PST, Richard O'Keefe <raoknz at gmail.com> wrote:  
 
 You want to DELETE rows satisfying the condition P & Q.The subset() function requires an expression saying whatyou want to RETAIN, so you need subset(PD, !(P & Q)).
test <- subset(PD, !(Class == "1st" & Survived == "No"))
By de Morgan's laws, !(P & Q) is the same as (!P) | (!Q)so you could also write
test <- subset(PD, Class != "1st" | Survived != "No")
I'd actually be tempted to do this in two steps:
unwanted <- PD$Class == "1st" & PD$Survived == "No"test <- PD[!unwanted,]



On Mon, 13 Dec 2021 at 17:30, Kai Yang via R-help <r-help at r-project.org> wrote:

Hi R team,I want to delete records from a data frame if?Class = '1st' and Survived = 'No'. I wrote the code below,?test <- subset(PD, Class != '1st' && Survived != 'No')
but the code return a wrong result. Can someone help me for this??
Thanks,Kai
? ? ? ? [[alternative HTML version deleted]]

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

  
	[[alternative HTML version deleted]]


From @ndy@j@cob@on @end|ng |rom no@@@gov  Mon Dec 13 17:37:30 2021
From: @ndy@j@cob@on @end|ng |rom no@@@gov (Andy Jacobson)
Date: Mon, 13 Dec 2021 09:37:30 -0700
Subject: [R] checkpointing
Message-ID: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>

Has anyone ever considered what it would take to implement checkpointing in R, so that long-running processes could be interrupted and resumed later, from a different process or even a different machine?

Thanks,

Andy

-- 
Andy Jacobson
andy.jacobson at noaa.gov

NOAA Global Monitoring Lab
325 Broadway
Boulder, Colorado 80305

303/497-4916


From jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@  Mon Dec 13 17:53:45 2021
From: jdnewm|| @end|ng |rom dcn@d@v|@@c@@u@ (Jeff Newmiller)
Date: Mon, 13 Dec 2021 08:53:45 -0800
Subject: [R] checkpointing
In-Reply-To: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
Message-ID: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>

This sounds like an OS feature, not an R feature... certainly not a portable R feature.

On December 13, 2021 8:37:30 AM PST, Andy Jacobson via R-help <r-help at r-project.org> wrote:
>Has anyone ever considered what it would take to implement checkpointing in R, so that long-running processes could be interrupted and resumed later, from a different process or even a different machine?
>
>Thanks,
>
>Andy
>

-- 
Sent from my phone. Please excuse my brevity.


From m|n@h@|| @end|ng |rom um|ch@edu  Mon Dec 13 18:58:32 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Mon, 13 Dec 2021 20:58:32 +0300
Subject: [R] checkpointing
In-Reply-To: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
Message-ID: <550482.1639418312@apollo2.minshall.org>

Jeff,

> This sounds like an OS feature, not an R feature... certainly not a
> portable R feature.

i'm not arguing for it, but this seems to me like something that could
be a language feature.

cheers, Greg


From murdoch@dunc@n @end|ng |rom gm@||@com  Mon Dec 13 19:51:38 2021
From: murdoch@dunc@n @end|ng |rom gm@||@com (Duncan Murdoch)
Date: Mon, 13 Dec 2021 13:51:38 -0500
Subject: [R] checkpointing
In-Reply-To: <550482.1639418312@apollo2.minshall.org>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
Message-ID: <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>

On 13/12/2021 12:58 p.m., Greg Minshall wrote:
> Jeff,
> 
>> This sounds like an OS feature, not an R feature... certainly not a
>> portable R feature.
> 
> i'm not arguing for it, but this seems to me like something that could
> be a language feature.
> 

R functions can call libraries written in other languages, and can start 
processes, etc.  R doesn't know everything going on in every function 
call, and would have a lot of trouble saving it.

If you added some limitations, e.g. a process that periodically has its 
entire state stored in R variables, then it would be a lot easier.

Duncan Murdoch


From m|n@h@|| @end|ng |rom um|ch@edu  Mon Dec 13 20:06:30 2021
From: m|n@h@|| @end|ng |rom um|ch@edu (Greg Minshall)
Date: Mon, 13 Dec 2021 22:06:30 +0300
Subject: [R] checkpointing
In-Reply-To: <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
 <082ae6ab-48d2-bb6f-2e40-cd6d4407bbe9@gmail.com>
Message-ID: <559095.1639422390@apollo2.minshall.org>

Duncan,

> R functions can call libraries written in other languages, and can
> start processes, etc.  R doesn't know everything going on in every
> function call, and would have a lot of trouble saving it.

indeed, that obvious fact hadn't occurred to me.  i withdraw my
contention.  :)

cheers, Greg


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 22:06:42 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 10:06:42 +1300
Subject: [R] checkpointing
In-Reply-To: <550482.1639418312@apollo2.minshall.org>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
 <550482.1639418312@apollo2.minshall.org>
Message-ID: <CABcYAdKtptck=NJMM18ZJJSVpD-F2Djr6NFG9unxwarXhbSmBA@mail.gmail.com>

I used to work on a Prolog implementation that did something similar.
At any point you could explicitly save a snapshot of the current state
and then from the operating system command line, resume it.
This wasn't really for checkpointing.  It was so that you could load
up a customised environment, initialise it, and then future runs would
be able to start up much quicker.

Initially it was all very simple.
(Hah!)  As long as you only expected a snapshot to work on the same kind
of machine with exactly the same operating system and libraries and the
same user files in the same (logical) places.

Then as operating systems added features, it got harder and harder.
First we had to cut back to discarding the stacks and restarting from
top level on resumption.
Finally, when address space layout randomisation came along (and by the
way, this was back in the 1980s) we gave up.

Bring in clusters with MPI and I for one don't want to go there.


On Tue, 14 Dec 2021 at 06:59, Greg Minshall <minshall at umich.edu> wrote:

> Jeff,
>
> > This sounds like an OS feature, not an R feature... certainly not a
> > portable R feature.
>
> i'm not arguing for it, but this seems to me like something that could
> be a language feature.
>
> cheers, Greg
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From r@oknz @end|ng |rom gm@||@com  Mon Dec 13 23:09:45 2021
From: r@oknz @end|ng |rom gm@||@com (Richard O'Keefe)
Date: Tue, 14 Dec 2021 11:09:45 +1300
Subject: [R] checkpointing
In-Reply-To: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
Message-ID: <CABcYAdK9Ykd8rEUB7k=YZW=c2FUu1wVc+tJBssiFoYYJ-Wf6aQ@mail.gmail.com>

Use VirtualBox.  You can take a 'snapshot' of a running virtual
machine, either from the GUI or from the CLI (vboxmanage snapshot ...)
and restore it later.

This requires NO changes to R.  Snapshots can be restored on
another machine of the same kind with the same system software.

VirtualBox is free.  Parallels is (just) under USD100.

On Tue, 14 Dec 2021 at 05:38, Andy Jacobson via R-help <r-help at r-project.org>
wrote:

> Has anyone ever considered what it would take to implement checkpointing
> in R, so that long-running processes could be interrupted and resumed
> later, from a different process or even a different machine?
>
> Thanks,
>
> Andy
>
> --
> Andy Jacobson
> andy.jacobson at noaa.gov
>
> NOAA Global Monitoring Lab
> 325 Broadway
> Boulder, Colorado 80305
>
> 303/497-4916
>
> ______________________________________________
> R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>

	[[alternative HTML version deleted]]


From @v|gro@@ @end|ng |rom ver|zon@net  Tue Dec 14 01:06:17 2021
From: @v|gro@@ @end|ng |rom ver|zon@net (Avi Gross)
Date: Mon, 13 Dec 2021 19:06:17 -0500
Subject: [R] checkpointing
In-Reply-To: <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
References: <64d5aa63-7862-26c6-1404-17e5ebfeea23@noaa.gov>
 <6950383F-18FE-46B6-94B0-8CE25D4486E9@dcn.davis.ca.us>
Message-ID: <01c901d7f07e$6aa4f4e0$3feedea0$@verizon.net>

Jeff,

I am wondering what it even means to do what you say. In a compiled
language, I can imagine wrapping up an executable along with some kind of
run-time image (which may actually contain the parts of the executable that
includes what has not run yet) and revive it elsewhere.

But even there, how would it work if say the executable kept opening more
files for reading or appending and you move it to place those files did not
exists or had different contents or other such scenarios? What happens to
open pipes with another process attached, for an OS that supports pipes?
When you restart, the other processes re not there even if you supply an
image of a pipe and I am sure others can imagine much more.

R is interpreted. You could say the main interpreter may be like an
executable and there may be multiple threads active at the time you stop the
process and bundle it to be restarted later. But R has many fairly dynamic
features including some the interpreter has not even looked at yet. Besides
files it may want to open, there are any number of statements like
library(filename) it may encounter and of course other files it may
source(code) . In general, the info on what may be needed later is not in
any serious way bundled with the file and many things may be hard to predict
even with a look ahead as often arguments to functions are not evaluated
till some indefinite later time or even never. 

I am trying to imagine how you stop and restore say an R program running
connected to something like RSTUDIO which is also connected to a Python
program with data and instructions flowing back and forth.

It does not strike me as easy to make a reliable method to do this, albeit
as noted, there are operating systems that do allow you to suspend arbitrary
processes and restart them locally perhaps only before the system reboots.

But I can think of exceptions, including some I see others have thought of.
An example might be an R program that reads in lots of data, then makes
objects like data.frames and then pauses in some kind of nested loop that
will process the data while having the current indices saved in variables.
It could literally ask to be frozen so it starts up from there when asked
to. R can be set to intercept some signals and perhaps voluntarily save all
the variables as they are (including the data it may be operating on and
what it is making from it (as in what search items it has already found) as
well as the needed index info) and exit gracefully. If the application is
restarted, it might note the file with saved info and read in all the data
and continue from there. The above is not a serious proposal and has lots of
things that can go wrong, but I can imagine it as an app that sets itself up
doing heavy lifting once and later every time you want to do a search, it
loads the data and gets from you something to search for and does it quickly
and resuspends till needed. But this example is not exactly what you asked
for.

I have actually done weird things like the above including things that
simply start up again after a reboot as if nothing happened. 

What is a more interesting question for me is what R features might make
sense that help construct a program that is in some sense re-startable if
used right. I can imagine a package that lets you set things like a "level"
for debugging so that your code when started at some point says:

# initialize.
# load any left-in-file data if it exists.

if (level < 2) {
  do stuff
  level <- 2
  }

if (level < 3) {
  do more stuff
  level <- 3
  }

...

Something like the above might wrap parts in something like a "try()" that
intercepts some interrupt condition and saves the needed status info.

What I wonder is if long-running processes that can be up for months say in
a web-server, may already have ways to save all kinds of status info so when
they start up again after a normal reboot, are able to continue almost as if
nothing had happened.


-----Original Message-----
From: R-help <r-help-bounces at r-project.org> On Behalf Of Jeff Newmiller
Sent: Monday, December 13, 2021 11:54 AM
To: Andy Jacobson <andy.jacobson at noaa.gov>; Andy Jacobson via R-help
<r-help at r-project.org>; r-help at r-project.org
Subject: Re: [R] checkpointing

This sounds like an OS feature, not an R feature... certainly not a portable
R feature.

On December 13, 2021 8:37:30 AM PST, Andy Jacobson via R-help
<r-help at r-project.org> wrote:
>Has anyone ever considered what it would take to implement checkpointing in
R, so that long-running processes could be interrupted and resumed later,
from a different process or even a different machine?
>
>Thanks,
>
>Andy
>

--
Sent from my phone. Please excuse my brevity.

______________________________________________
R-help at r-project.org mailing list -- To UNSUBSCRIBE and more, see
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.


